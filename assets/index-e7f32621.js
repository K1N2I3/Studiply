import{r as e,a as t,R as s,b as r}from"./vendor-93499ec0.js";import{i as a,g as n,a as i,c as o,q as l,w as c,b as d,d as u,s as h,e as m,u as x,f as p,o as g,h as b,j as f,k as w,l as y,m as v,n as j,p as N,r as k,t as S}from"./firebase-48788c29.js";import{A as C}from"./agora-b6d169b2.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var E={exports:{}},A={},T=e,I=Symbol.for("react.element"),P=Symbol.for("react.fragment"),q=Object.prototype.hasOwnProperty,R=T.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,M={key:!0,ref:!0,__self:!0,__source:!0};function D(e,t,s){var r,a={},n=null,i=null;for(r in void 0!==s&&(n=""+s),void 0!==t.key&&(n=""+t.key),void 0!==t.ref&&(i=t.ref),t)q.call(t,r)&&!M.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:I,type:e,key:n,ref:i,props:a,_owner:R.current}}A.Fragment=P,A.jsx=D,A.jsxs=D,E.exports=A;var L,F,U=E.exports,$={},O=t;
/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */
function B(){return B=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},B.apply(this,arguments)}$.createRoot=O.createRoot,$.hydrateRoot=O.hydrateRoot,(F=L||(L={})).Pop="POP",F.Push="PUSH",F.Replace="REPLACE";const _="popstate";function z(e){return void 0===e&&(e={}),function(e,t,s,r){void 0===r&&(r={});let{window:a=document.defaultView,v5Compat:n=!1}=r,i=a.history,o=L.Pop,l=null,c=d();null==c&&(c=0,i.replaceState(B({},i.state,{idx:c}),""));function d(){return(i.state||{idx:null}).idx}function u(){o=L.Pop;let e=d(),t=null==e?null:e-c;c=e,l&&l({action:o,location:p.location,delta:t})}function h(e,t){o=L.Push;let r=V(p.location,e,t);s&&s(r,e),c=d()+1;let u=G(r,c),h=p.createHref(r);try{i.pushState(u,"",h)}catch(m){if(m instanceof DOMException&&"DataCloneError"===m.name)throw m;a.location.assign(h)}n&&l&&l({action:o,location:p.location,delta:1})}function m(e,t){o=L.Replace;let r=V(p.location,e,t);s&&s(r,e),c=d();let a=G(r,c),u=p.createHref(r);i.replaceState(a,"",u),n&&l&&l({action:o,location:p.location,delta:0})}function x(e){let t="null"!==a.location.origin?a.location.origin:a.location.href,s="string"==typeof e?e:Y(e);return s=s.replace(/ $/,"%20"),W(t,"No window.location.(origin|href) available to create URL for href: "+s),new URL(s,t)}let p={get action(){return o},get location(){return e(a,i)},listen(e){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(_,u),l=e,()=>{a.removeEventListener(_,u),l=null}},createHref:e=>t(a,e),createURL:x,encodeLocation(e){let t=x(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:h,replace:m,go:e=>i.go(e)};return p}(function(e,t){let{pathname:s,search:r,hash:a}=e.location;return V("",{pathname:s,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"==typeof t?t:Y(t)},null,e)}function W(e,t){if(!1===e||null==e)throw new Error(t)}function H(e,t){if(!e){"undefined"!=typeof console&&console.warn(t);try{throw new Error(t)}catch(s){}}}function G(e,t){return{usr:e.state,key:e.key,idx:t}}function V(e,t,s,r){return void 0===s&&(s=null),B({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?Q(t):t,{state:s,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function Y(e){let{pathname:t="/",search:s="",hash:r=""}=e;return s&&"?"!==s&&(t+="?"===s.charAt(0)?s:"?"+s),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function Q(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substr(s),e=e.substr(0,s));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}var J,K;function X(e,t,s){return void 0===s&&(s="/"),function(e,t,s,r){let a="string"==typeof t?Q(t):t,n=he(a.pathname||"/",s);if(null==n)return null;let i=Z(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let s=e.length===t.length&&e.slice(0,-1).every((e,s)=>e===t[s]);return s?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(i);let o=null;for(let l=0;null==o&&l<i.length;++l){let e=ue(n);o=ce(i[l],e,r)}return o}(e,t,s,!1)}function Z(e,t,s,r){void 0===t&&(t=[]),void 0===s&&(s=[]),void 0===r&&(r="");let a=(e,a,n)=>{let i={relativePath:void 0===n?e.path||"":n,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};i.relativePath.startsWith("/")&&(W(i.relativePath.startsWith(r),'Absolute route path "'+i.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(r.length));let o=ge([r,i.relativePath]),l=s.concat(i);e.children&&e.children.length>0&&(W(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),Z(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:le(o,e.index),routesMeta:l})};return e.forEach((e,t)=>{var s;if(""!==e.path&&null!=(s=e.path)&&s.includes("?"))for(let r of ee(e.path))a(e,t,r);else a(e,t)}),t}function ee(e){let t=e.split("/");if(0===t.length)return[];let[s,...r]=t,a=s.endsWith("?"),n=s.replace(/\?$/,"");if(0===r.length)return a?[n,""]:[n];let i=ee(r.join("/")),o=[];return o.push(...i.map(e=>""===e?n:[n,e].join("/"))),a&&o.push(...i),o.map(t=>e.startsWith("/")&&""===t?"/":t)}(K=J||(J={})).data="data",K.deferred="deferred",K.redirect="redirect",K.error="error";const te=/^:[\w-]+$/,se=3,re=2,ae=1,ne=10,ie=-2,oe=e=>"*"===e;function le(e,t){let s=e.split("/"),r=s.length;return s.some(oe)&&(r+=ie),t&&(r+=re),s.filter(e=>!oe(e)).reduce((e,t)=>e+(te.test(t)?se:""===t?ae:ne),r)}function ce(e,t,s){void 0===s&&(s=!1);let{routesMeta:r}=e,a={},n="/",i=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===n?t:t.slice(n.length)||"/",d=de({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&s&&!r[r.length-1].route.index&&(d=de({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:ge([n,d.pathname]),pathnameBase:be(ge([n,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(n=ge([n,d.pathnameBase]))}return i}function de(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[s,r]=function(e,t,s){void 0===t&&(t=!1);void 0===s&&(s=!0);H("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,s)=>(r.push({paramName:t,isOptional:null!=s}),s?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let n=new RegExp(a,t?void 0:"i");return[n,r]}(e.path,e.caseSensitive,e.end),a=t.match(s);if(!a)return null;let n=a[0],i=n.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:r.reduce((e,t,s)=>{let{paramName:r,isOptional:a}=t;if("*"===r){let e=o[s]||"";i=n.slice(0,n.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[s];return e[r]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:n,pathnameBase:i,pattern:e}}function ue(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return H(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function he(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,r=e.charAt(s);return r&&"/"!==r?null:e.slice(s)||"/"}function me(e,t,s,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+s+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function xe(e,t){let s=function(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}(e);return t?s.map((e,t)=>t===s.length-1?e.pathname:e.pathnameBase):s.map(e=>e.pathnameBase)}function pe(e,t,s,r){let a;void 0===r&&(r=!1),"string"==typeof e?a=Q(e):(a=B({},e),W(!a.pathname||!a.pathname.includes("?"),me("?","pathname","search",a)),W(!a.pathname||!a.pathname.includes("#"),me("#","pathname","hash",a)),W(!a.search||!a.search.includes("#"),me("#","search","hash",a)));let n,i=""===e||""===a.pathname,o=i?"/":a.pathname;if(null==o)n=s;else{let e=t.length-1;if(!r&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}n=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:s,search:r="",hash:a=""}="string"==typeof e?Q(e):e,n=s?s.startsWith("/")?s:function(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?s.length>1&&s.pop():"."!==e&&s.push(e)}),s.length>1?s.join("/"):"/"}(s,t):t;return{pathname:n,search:fe(r),hash:we(a)}}(a,n),c=o&&"/"!==o&&o.endsWith("/"),d=(i||"."===o)&&s.endsWith("/");return l.pathname.endsWith("/")||!c&&!d||(l.pathname+="/"),l}const ge=e=>e.join("/").replace(/\/\/+/g,"/"),be=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),fe=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",we=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";const ye=["post","put","patch","delete"];new Set(ye);const ve=["get",...ye];
/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */
function je(){return je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},je.apply(this,arguments)}new Set(ve);const Ne=e.createContext(null),ke=e.createContext(null),Se=e.createContext(null),Ce=e.createContext(null),Ee=e.createContext({outlet:null,matches:[],isDataRoute:!1}),Ae=e.createContext(null);function Te(){return null!=e.useContext(Ce)}function Ie(){return Te()||W(!1),e.useContext(Ce).location}function Pe(t){e.useContext(Se).static||e.useLayoutEffect(t)}function qe(){let{isDataRoute:t}=e.useContext(Ee);return t?function(){let{router:t}=function(){let t=e.useContext(Ne);return t||W(!1),t}(Oe.UseNavigateStable),s=_e(Be.UseNavigateStable),r=e.useRef(!1);return Pe(()=>{r.current=!0}),e.useCallback(function(e,a){void 0===a&&(a={}),r.current&&("number"==typeof e?t.navigate(e):t.navigate(e,je({fromRouteId:s},a)))},[t,s])}():function(){Te()||W(!1);let t=e.useContext(Ne),{basename:s,future:r,navigator:a}=e.useContext(Se),{matches:n}=e.useContext(Ee),{pathname:i}=Ie(),o=JSON.stringify(xe(n,r.v7_relativeSplatPath)),l=e.useRef(!1);return Pe(()=>{l.current=!0}),e.useCallback(function(e,r){if(void 0===r&&(r={}),!l.current)return;if("number"==typeof e)return void a.go(e);let n=pe(e,JSON.parse(o),i,"path"===r.relative);null==t&&"/"!==s&&(n.pathname="/"===n.pathname?s:ge([s,n.pathname])),(r.replace?a.replace:a.push)(n,r.state,r)},[s,a,o,i,t])}()}function Re(){let{matches:t}=e.useContext(Ee),s=t[t.length-1];return s?s.params:{}}function Me(t,s){let{relative:r}=void 0===s?{}:s,{future:a}=e.useContext(Se),{matches:n}=e.useContext(Ee),{pathname:i}=Ie(),o=JSON.stringify(xe(n,a.v7_relativeSplatPath));return e.useMemo(()=>pe(t,JSON.parse(o),i,"path"===r),[t,o,i,r])}function De(t,s){return function(t,s,r,a){Te()||W(!1);let{navigator:n}=e.useContext(Se),{matches:i}=e.useContext(Ee),o=i[i.length-1],l=o?o.params:{};!o||o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d,u=Ie();if(s){var h;let e="string"==typeof s?Q(s):s;"/"===c||(null==(h=e.pathname)?void 0:h.startsWith(c))||W(!1),d=e}else d=u;let m=d.pathname||"/",x=m;if("/"!==c){let e=c.replace(/^\//,"").split("/");x="/"+m.replace(/^\//,"").split("/").slice(e.length).join("/")}let p=X(t,{pathname:x}),g=function(t,s,r,a){var n;void 0===s&&(s=[]);void 0===r&&(r=null);void 0===a&&(a=null);if(null==t){var i;if(!r)return null;if(r.errors)t=r.matches;else{if(!(null!=(i=a)&&i.v7_partialHydration&&0===s.length&&!r.initialized&&r.matches.length>0))return null;t=r.matches}}let o=t,l=null==(n=r)?void 0:n.errors;if(null!=l){let e=o.findIndex(e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id]));e>=0||W(!1),o=o.slice(0,Math.min(o.length,e+1))}let c=!1,d=-1;if(r&&a&&a.v7_partialHydration)for(let e=0;e<o.length;e++){let t=o[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(d=e),t.route.id){let{loaderData:e,errors:s}=r,a=t.route.loader&&void 0===e[t.route.id]&&(!s||void 0===s[t.route.id]);if(t.route.lazy||a){c=!0,o=d>=0?o.slice(0,d+1):[o[0]];break}}}return o.reduceRight((t,a,n)=>{let i,u=!1,h=null,m=null;var x;r&&(i=l&&a.route.id?l[a.route.id]:void 0,h=a.route.errorElement||Fe,c&&(d<0&&0===n?(x="route-fallback",!1||ze[x]||(ze[x]=!0),u=!0,m=null):d===n&&(u=!0,m=a.route.hydrateFallbackElement||null)));let p=s.concat(o.slice(0,n+1)),g=()=>{let s;return s=i?h:u?m:a.route.Component?e.createElement(a.route.Component,null):a.route.element?a.route.element:t,e.createElement($e,{match:a,routeContext:{outlet:t,matches:p,isDataRoute:null!=r},children:s})};return r&&(a.route.ErrorBoundary||a.route.errorElement||0===n)?e.createElement(Ue,{location:r.location,revalidation:r.revalidation,component:h,error:i,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}(p&&p.map(e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:ge([c,n.encodeLocation?n.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?c:ge([c,n.encodeLocation?n.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),i,r,a);if(s&&g)return e.createElement(Ce.Provider,{value:{location:je({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:L.Pop}},g);return g}(t,s)}function Le(){let t=function(){var t;let s=e.useContext(Ae),r=function(){let t=e.useContext(ke);return t||W(!1),t}(Be.UseRouteError),a=_e(Be.UseRouteError);if(void 0!==s)return s;return null==(t=r.errors)?void 0:t[a]}(),s=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},s),r?e.createElement("pre",{style:a},r):null,null)}const Fe=e.createElement(Le,null);class Ue extends e.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?e.createElement(Ee.Provider,{value:this.props.routeContext},e.createElement(Ae.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function $e(t){let{routeContext:s,match:r,children:a}=t,n=e.useContext(Ne);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),e.createElement(Ee.Provider,{value:s},a)}var Oe=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Oe||{}),Be=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Be||{});function _e(t){let s=function(){let t=e.useContext(Ee);return t||W(!1),t}(),r=s.matches[s.matches.length-1];return r.route.id||W(!1),r.route.id}const ze={};function We(t){let{to:s,replace:r,state:a,relative:n}=t;Te()||W(!1);let{future:i,static:o}=e.useContext(Se),{matches:l}=e.useContext(Ee),{pathname:c}=Ie(),d=qe(),u=pe(s,xe(l,i.v7_relativeSplatPath),c,"path"===n),h=JSON.stringify(u);return e.useEffect(()=>d(JSON.parse(h),{replace:r,state:a,relative:n}),[d,h,n,r,a]),null}function He(e){W(!1)}function Ge(t){let{basename:s="/",children:r=null,location:a,navigationType:n=L.Pop,navigator:i,static:o=!1,future:l}=t;Te()&&W(!1);let c=s.replace(/^\/*/,"/"),d=e.useMemo(()=>({basename:c,navigator:i,static:o,future:je({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);"string"==typeof a&&(a=Q(a));let{pathname:u="/",search:h="",hash:m="",state:x=null,key:p="default"}=a,g=e.useMemo(()=>{let e=he(u,c);return null==e?null:{location:{pathname:e,search:h,hash:m,state:x,key:p},navigationType:n}},[c,u,h,m,x,p,n]);return null==g?null:e.createElement(Se.Provider,{value:d},e.createElement(Ce.Provider,{children:r,value:g}))}function Ve(e){let{children:t,location:s}=e;return De(Ye(t),s)}function Ye(t,s){void 0===s&&(s=[]);let r=[];return e.Children.forEach(t,(t,a)=>{if(!e.isValidElement(t))return;let n=[...s,a];if(t.type===e.Fragment)return void r.push.apply(r,Ye(t.props.children,n));t.type!==He&&W(!1),t.props.index&&t.props.children&&W(!1);let i={id:t.props.id||n.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(i.children=Ye(t.props.children,n)),r.push(i)}),r}
/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qe(){return Qe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},Qe.apply(this,arguments)}function Je(e){return void 0===e&&(e=""),new URLSearchParams("string"==typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,s)=>{let r=e[s];return t.concat(Array.isArray(r)?r.map(e=>[s,e]):[[s,r]])},[]))}new Promise(()=>{});const Ke=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(To){}const Xe=s.startTransition;function Ze(t){let{basename:s,children:r,future:a,window:n}=t,i=e.useRef();null==i.current&&(i.current=z({window:n,v5Compat:!0}));let o=i.current,[l,c]=e.useState({action:o.action,location:o.location}),{v7_startTransition:d}=a||{},u=e.useCallback(e=>{d&&Xe?Xe(()=>c(e)):c(e)},[c,d]);return e.useLayoutEffect(()=>o.listen(u),[o,u]),e.useEffect(()=>{return null==(e=a)||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),void(t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation));var e,t},[a]),e.createElement(Ge,{basename:s,children:r,location:l.location,navigationType:l.action,navigator:o,future:a})}const et="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,tt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,st=e.forwardRef(function(t,s){let r,{onClick:a,relative:n,reloadDocument:i,replace:o,state:l,target:c,to:d,preventScrollReset:u,viewTransition:h}=t,m=function(e,t){if(null==e)return{};var s,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||(a[s]=e[s]);return a}(t,Ke),{basename:x}=e.useContext(Se),p=!1;if("string"==typeof d&&tt.test(d)&&(r=d,et))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),s=he(t.pathname,x);t.origin===e.origin&&null!=s?d=s+t.search+t.hash:p=!0}catch(To){}let g=function(t,s){let{relative:r}=void 0===s?{}:s;Te()||W(!1);let{basename:a,navigator:n}=e.useContext(Se),{hash:i,pathname:o,search:l}=Me(t,{relative:r}),c=o;return"/"!==a&&(c="/"===o?a:ge([a,o])),n.createHref({pathname:c,search:l,hash:i})}(d,{relative:n}),b=function(t,s){let{target:r,replace:a,state:n,preventScrollReset:i,relative:o,viewTransition:l}=void 0===s?{}:s,c=qe(),d=Ie(),u=Me(t,{relative:o});return e.useCallback(e=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(e,r)){e.preventDefault();let s=void 0!==a?a:Y(d)===Y(u);c(t,{replace:s,state:n,preventScrollReset:i,relative:o,viewTransition:l})}},[d,c,u,a,n,r,t,i,o,l])}(d,{replace:o,state:l,target:c,preventScrollReset:u,relative:n,viewTransition:h});return e.createElement("a",Qe({},m,{href:r||g,onClick:p||i?a:function(e){a&&a(e),e.defaultPrevented||b(e)},ref:s,target:c}))});var rt,at,nt,it;function ot(t){let s=e.useRef(Je(t)),r=e.useRef(!1),a=Ie(),n=e.useMemo(()=>function(e,t){let s=Je(e);return t&&t.forEach((e,r)=>{s.has(r)||t.getAll(r).forEach(e=>{s.append(r,e)})}),s}(a.search,r.current?null:s.current),[a.search]),i=qe(),o=e.useCallback((e,t)=>{const s=Je("function"==typeof e?e(n):e);r.current=!0,i("?"+s,t)},[i,n]);return[n,o]}(at=rt||(rt={})).UseScrollRestoration="useScrollRestoration",at.UseSubmit="useSubmit",at.UseSubmitFetcher="useSubmitFetcher",at.UseFetcher="useFetcher",at.useViewTransitionState="useViewTransitionState",(it=nt||(nt={})).UseFetcher="useFetcher",it.UseFetchers="useFetchers",it.UseScrollRestoration="useScrollRestoration";const lt=a({apiKey:"AIzaSyBLASoEG5NwdnsVov-lvT_KJX1rg-m6QLc",authDomain:"study-hub-1297a.firebaseapp.com",projectId:"study-hub-1297a",storageBucket:"study-hub-1297a.firebasestorage.app",messagingSenderId:"278786999386",appId:"1:278786999386:web:7f7d9a148714565cd28463"}),ct=n(lt),dt=i(lt),ut=Object.freeze(Object.defineProperty({__proto__:null,auth:ct,db:dt,default:lt},Symbol.toStringTag,{value:"Module"})),ht=e.createContext(),mt=()=>{const t=e.useContext(ht);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t},xt=({children:t})=>{const[s,r]=e.useState("light");e.useEffect(()=>{const e=localStorage.getItem("theme")||"light";r(e),a(e)},[]);const a=e=>{document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e)},n={theme:s,toggleTheme:e=>{r(e),a(e)},isDark:"dark"===s,isLight:"light"===s};return U.jsx(ht.Provider,{value:n,children:t})};
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var pt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=(t,s)=>{const r=e.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:o="",children:l,...c},d)=>{return e.createElement("svg",{ref:d,...pt,width:a,height:a,stroke:r,strokeWidth:i?24*Number(n)/Number(a):n,className:["lucide",`lucide-${u=t,u.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,o].join(" "),...c},[...s.map(([t,s])=>e.createElement(t,s)),...Array.isArray(l)?l:[l]]);var u});return r.displayName=`${t}`,r},bt=gt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),ft=gt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),wt=gt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),yt=gt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),vt=gt("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),jt=gt("Atom",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["path",{d:"M20.2 20.2c2.04-2.03.02-7.36-4.5-11.9-4.54-4.52-9.87-6.54-11.9-4.5-2.04 2.03-.02 7.36 4.5 11.9 4.54 4.52 9.87 6.54 11.9 4.5Z",key:"1l2ple"}],["path",{d:"M15.7 15.7c4.52-4.54 6.54-9.87 4.5-11.9-2.03-2.04-7.36-.02-11.9 4.5-4.52 4.54-6.54 9.87-4.5 11.9 2.03 2.04 7.36.02 11.9-4.5Z",key:"1wam0m"}]]),Nt=gt("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),kt=gt("BadgeEuro",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"M7 12h5",key:"gblrwe"}],["path",{d:"M15 9.4a4 4 0 1 0 0 5.2",key:"1makmb"}]]),St=gt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Ct=gt("BatteryFull",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}],["line",{x1:"6",x2:"6",y1:"11",y2:"13",key:"1wd6dw"}],["line",{x1:"10",x2:"10",y1:"11",y2:"13",key:"haxvl5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"13",key:"c6fn6x"}]]),Et=gt("BatteryLow",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}],["line",{x1:"6",x2:"6",y1:"11",y2:"13",key:"1wd6dw"}]]),At=gt("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]),Tt=gt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),It=gt("BookMarked",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}],["polyline",{points:"10 2 10 10 13 7 16 10 16 2",key:"13o6vz"}]]),Pt=gt("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),qt=gt("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),Rt=gt("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),Mt=gt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),Dt=gt("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),Lt=gt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Ft=gt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),Ut=gt("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),$t=gt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Ot=gt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),Bt=gt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),_t=gt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),zt=gt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Wt=gt("Chrome",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["line",{x1:"21.17",x2:"12",y1:"8",y2:"8",key:"a0cw5f"}],["line",{x1:"3.95",x2:"8.54",y1:"6.06",y2:"14",key:"1kftof"}],["line",{x1:"10.88",x2:"15.46",y1:"21.94",y2:"14",key:"1ymyh8"}]]),Ht=gt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Gt=gt("Code2",[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]]),Vt=gt("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]),Yt=gt("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]),Qt=gt("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]),Jt=gt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Kt=gt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Xt=gt("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),Zt=gt("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),es=gt("Diamond",[["path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41l-7.59-7.59a2.41 2.41 0 0 0-3.41 0Z",key:"1f1r0c"}]]),ts=gt("Dna",[["path",{d:"M2 15c6.667-6 13.333 0 20-6",key:"1pyr53"}],["path",{d:"M9 22c1.798-1.998 2.518-3.995 2.807-5.993",key:"q3hbxp"}],["path",{d:"M15 2c-1.798 1.998-2.518 3.995-2.807 5.993",key:"80uv8i"}],["path",{d:"m17 6-2.5-2.5",key:"5cdfhj"}],["path",{d:"m14 8-1-1",key:"15nbz5"}],["path",{d:"m7 18 2.5 2.5",key:"16tu1a"}],["path",{d:"m3.5 14.5.5.5",key:"hapbhd"}],["path",{d:"m20 9 .5.5",key:"1n7z02"}],["path",{d:"m6.5 12.5 1 1",key:"cs35ky"}],["path",{d:"m16.5 10.5 1 1",key:"696xn5"}],["path",{d:"m10 16 1.5 1.5",key:"11lckj"}]]),ss=gt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),rs=gt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),as=gt("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]),ns=gt("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),is=gt("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),os=gt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ls=gt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),cs=gt("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),ds=gt("FlaskConical",[["path",{d:"M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2",key:"pzvekw"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M7 16h10",key:"wp8him"}]]),us=gt("Gem",[["path",{d:"M6 3h12l4 6-10 13L2 9Z",key:"1pcd5k"}],["path",{d:"M11 3 8 9l4 13 4-13-3-6",key:"1fcu3u"}],["path",{d:"M2 9h20",key:"16fsjt"}]]),hs=gt("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),ms=gt("Globe2",[["path",{d:"M21.54 15H17a2 2 0 0 0-2 2v4.54",key:"1djwo0"}],["path",{d:"M7 3.34V5a3 3 0 0 0 3 3v0a2 2 0 0 1 2 2v0c0 1.1.9 2 2 2v0a2 2 0 0 0 2-2v0c0-1.1.9-2 2-2h3.17",key:"1fi5u6"}],["path",{d:"M11 21.95V18a2 2 0 0 0-2-2v0a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05",key:"xsiumc"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),xs=gt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),ps=gt("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]),gs=gt("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),bs=gt("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),fs=gt("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),ws=gt("Infinity",[["path",{d:"M12 12c-2-2.67-4-4-6-4a4 4 0 1 0 0 8c2 0 4-1.33 6-4Zm0 0c2 2.67 4 4 6 4a4 4 0 0 0 0-8c-2 0-4 1.33-6 4Z",key:"1z0uae"}]]),ys=gt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),vs=gt("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]),js=gt("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]),Ns=gt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),ks=gt("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]),Ss=gt("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]),Cs=gt("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),Es=gt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),As=gt("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]),Ts=gt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Is=gt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Ps=gt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),qs=gt("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]),Rs=gt("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]),Ms=gt("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),Ds=gt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),Ls=gt("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),Fs=gt("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),Us=gt("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),$s=gt("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),Os=gt("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),Bs=gt("Paintbrush",[["path",{d:"M18.37 2.63 14 7l-1.59-1.59a2 2 0 0 0-2.82 0L8 7l9 9 1.59-1.59a2 2 0 0 0 0-2.82L17 10l4.37-4.37a2.12 2.12 0 1 0-3-3Z",key:"m6k5sh"}],["path",{d:"M9 8c-2 3-4 3.5-7 4l8 10c2-1 6-5 6-7",key:"arzq70"}],["path",{d:"M14.5 17.5 4.5 15",key:"s7fvrz"}]]),_s=gt("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),zs=gt("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),Ws=gt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),Hs=gt("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]),Gs=gt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Vs=gt("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),Ys=gt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Qs=gt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]),Js=gt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Ks=gt("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]),Xs=gt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Zs=gt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),er=gt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),tr=gt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),sr=gt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),rr=gt("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),ar=gt("Sparkle",[["path",{d:"m12 3-1.9 5.8a2 2 0 0 1-1.287 1.288L3 12l5.8 1.9a2 2 0 0 1 1.288 1.287L12 21l1.9-5.8a2 2 0 0 1 1.287-1.288L21 12l-5.8-1.9a2 2 0 0 1-1.288-1.287Z",key:"nraa5p"}]]),nr=gt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),ir=gt("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),or=gt("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),lr=gt("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),cr=gt("Sword",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}]]),dr=gt("Swords",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]]),ur=gt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),hr=gt("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z",key:"s6e0r"}]]),mr=gt("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]),xr=gt("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]),pr=gt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),gr=gt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),br=gt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),fr=gt("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),wr=gt("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),yr=gt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),vr=gt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),jr=gt("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Nr=gt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),kr=gt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Sr=gt("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.34l1 1L22 8v8",key:"ubwiq0"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2l10 10Z",key:"1l10zd"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Cr=gt("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),Er=gt("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]),Ar=gt("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),Tr=gt("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]),Ir=gt("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),Pr=gt("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),qr=gt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Rr=gt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Mr=gt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Dr=({message:t,onComplete:s})=>{const[r,a]=e.useState(5);return e.useEffect(()=>{if(r<=0)return void s();const e=setTimeout(()=>{a(r-1)},1e3);return()=>clearTimeout(e)},[r,s]),U.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-[9999]",children:U.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 animate-in fade-in zoom-in duration-300",children:[U.jsx("div",{className:"flex justify-center mb-6",children:U.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-red-500 to-red-600 rounded-full flex items-center justify-center",children:U.jsx(ft,{className:"w-8 h-8 text-white"})})}),U.jsx("h2",{className:"text-2xl font-bold text-gray-900 text-center mb-4",children:"Account Deleted"}),t&&U.jsx("div",{className:"mb-6",children:U.jsx("p",{className:"text-gray-700 text-center leading-relaxed",children:t})}),!t&&U.jsx("p",{className:"text-gray-700 text-center mb-6",children:"Your account has been deleted by an administrator. You will be logged out shortly."}),U.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-6",children:[U.jsx(Ht,{className:"w-5 h-5 text-gray-500"}),U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"text-3xl font-bold text-red-600",children:r}),U.jsxs("p",{className:"text-sm text-gray-500",children:[1===r?"second":"seconds"," remaining"]})]})]}),U.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-4",children:U.jsx("div",{className:"bg-gradient-to-r from-red-500 to-red-600 h-2 rounded-full transition-all duration-1000 ease-linear",style:{width:(5-r)/5*100+"%"}})}),U.jsx("p",{className:"text-xs text-gray-500 text-center",children:"You will be redirected to the homepage automatically."})]})})},Lr=({message:t,onComplete:s})=>{const[r,a]=e.useState(5);return e.useEffect(()=>{if(r<=0)return void s();const e=setTimeout(()=>{a(r-1)},1e3);return()=>clearTimeout(e)},[r,s]),U.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-[9999]",children:U.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 animate-in fade-in zoom-in duration-300",children:[U.jsx("div",{className:"flex justify-center mb-6",children:U.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-red-500 to-red-600 rounded-full flex items-center justify-center",children:U.jsx(ft,{className:"w-8 h-8 text-white"})})}),U.jsx("h2",{className:"text-2xl font-bold text-gray-900 text-center mb-4",children:"Account Banned"}),U.jsx("div",{className:"mb-6",children:U.jsx("p",{className:"text-gray-700 text-center leading-relaxed",children:t||"Your account has been banned by the administrator."})}),U.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-6",children:[U.jsx(Ht,{className:"w-5 h-5 text-gray-500"}),U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"text-3xl font-bold text-red-600",children:r}),U.jsxs("p",{className:"text-sm text-gray-500",children:[1===r?"second":"seconds"," remaining"]})]})]}),U.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-4",children:U.jsx("div",{className:"bg-gradient-to-r from-red-500 to-red-600 h-2 rounded-full transition-all duration-1000 ease-linear",style:{width:(5-r)/5*100+"%"}})}),U.jsx("p",{className:"text-xs text-gray-500 text-center",children:"You will be redirected to the homepage automatically."})]})})},Fr=async e=>{if(e)try{const t=u(dt,"users",e);await x(t,{lastSeen:p(),isOnline:!0})}catch(t){console.error("Error updating user presence:",t)}},Ur=e=>{var t,s;if(!e)return!1;if(!0===e.isOnline)return!0;if(!1===e.isOnline){if(e.lastSeen){const s=(null==(t=e.lastSeen)?void 0:t.toDate)?e.lastSeen.toDate():new Date(e.lastSeen);if(new Date-s<1e4)return!0}return!1}if(e.lastSeen){const t=(null==(s=e.lastSeen)?void 0:s.toDate)?e.lastSeen.toDate():new Date(e.lastSeen);return new Date-t<3e4}return!1},$r=e=>{if(!e)return()=>{};Fr(e);let t=null,s=0;const r=setInterval(()=>{Fr(e),s=Date.now()},1e4);let a=null;const n=()=>{"visible"===document.visibilityState?(a&&(clearTimeout(a),a=null),Fr(e)):(a&&clearTimeout(a),a=setTimeout(()=>{if("hidden"===document.visibilityState){const t=u(dt,"users",e);x(t,{isOnline:!1}).catch(console.error)}},3e4))};document.addEventListener("visibilitychange",n);const i=["mousemove","mousedown","mouseup","keypress","keydown","scroll","touchstart","touchmove","click","focus","resize"];let o=null;const l=()=>{"visible"===document.visibilityState&&(o||((()=>{const r=Date.now();r-s<2e3?(t&&clearTimeout(t),t=setTimeout(()=>{Fr(e),s=Date.now()},2e3-(r-s))):(Fr(e),s=r)})(),o=setTimeout(()=>{o=null},1e3)))};i.forEach(e=>{window.addEventListener(e,l,{passive:!0})});const c=()=>{const t=u(dt,"users",e);x(t,{isOnline:!1}).catch(console.error)};return window.addEventListener("beforeunload",c),()=>{clearInterval(r),t&&clearTimeout(t),o&&clearTimeout(o),a&&clearTimeout(a),document.removeEventListener("visibilitychange",n),window.removeEventListener("beforeunload",c),i.forEach(e=>{window.removeEventListener(e,l)});const s=u(dt,"users",e);x(s,{isOnline:!1}).catch(console.error)}},Or=e.createContext(),Br=()=>{const t=e.useContext(Or);if(!t)throw new Error("useSimpleAuth must be used within a SimpleAuthProvider");return t},_r=({children:t})=>{const[s,r]=e.useState(null),[a,n]=e.useState(!0),[i,x]=e.useState(!1),[p,b]=e.useState(""),[f,w]=e.useState(!1),[y,v]=e.useState(""),{toggleTheme:j}=mt();e.useEffect(()=>{const e=localStorage.getItem("simpleUser");if(e){const t=JSON.parse(e);void 0===t.isTutor&&(t.isTutor=!1),r(t)}n(!1)},[]),e.useEffect(()=>{if(!(null==s?void 0:s.id))return;const e="studiply.email@gmail.com"===(null==s?void 0:s.email);console.log(" Setting up user status listener for:",s.id,e?"(Admin)":"");const t=u(dt,"users",s.id);let r=null;const a=g(t,s=>{if(s.exists()){r&&(clearTimeout(r),r=null);const e=s.data();if(!0===e.banned){console.log(" User account banned, showing ban notice...");const t=e.banMessage||"Your account has been banned by the administrator.";return v(t),void w(!0)}e.deletionNotice&&(localStorage.setItem("deletionNotice",e.deletionNotice),console.log(" Deletion notice found:",e.deletionNotice))}else{if(console.log(" User document not found, verifying..."),e)return void console.log(" Admin user document not found, this might be a false positive. Skipping deletion notice.");r&&clearTimeout(r),r=setTimeout(async()=>{try{if((await m(t)).exists())console.log(" Document exists after verification, false alarm - ignoring");else{console.log(" User document confirmed deleted, showing deletion notice...");const e=localStorage.getItem("deletionNotice")||"";b(e),x(!0),localStorage.removeItem("deletionNotice")}}catch(e){console.error(" Error verifying user document:",e),console.log(" Verification failed, assuming false positive - not showing deletion notice")}},3e3)}},t=>{console.error(" Error listening to user document:",t),e&&console.log(" Admin user listener error, ignoring (might be permission issue)")});return()=>{console.log(" Cleaning up user status listener"),r&&clearTimeout(r),a()}},[null==s?void 0:s.id,null==s?void 0:s.email,j]);e.useEffect(()=>{if(!(null==s?void 0:s.id))return;console.log(" Initializing presence updates for user:",s.id);const e=$r(s.id);return()=>{console.log(" Cleaning up presence updates"),e()}},[null==s?void 0:s.id]);const N={user:s,login:async(e,t)=>{try{const s=await(async(e,t)=>{try{const s=o(dt,"users"),r=l(s,c("email","==",e.toLowerCase().trim())),a=await d(r);if(a.empty)return{success:!1,error:"User not found, please register first"};const n=a.docs[0].data();return!0===n.banned?{success:!1,error:n.banMessage||"Your account has been banned by the administrator."}:n.password!==t.trim()?{success:!1,error:"Incorrect password"}:{success:!0,user:{id:n.id,name:n.name||"User",email:n.email,school:n.school||"",grade:n.grade||"",phone:n.phone||"",location:n.location||"",bio:n.bio||"",subjects:n.subjects||[],avatar:n.avatar||null,isTutor:n.isTutor||!1,tutorProfile:n.tutorProfile||null}}}catch(s){return console.error("Login error:",s),{success:!1,error:"Login failed, please try again"}}})(e,t);if(s.success){const e=s.user;void 0===e.isTutor&&(e.isTutor=!1),r(e),localStorage.setItem("simpleUser",JSON.stringify(e))}return s}catch(s){return{success:!1,error:"Login failed, please try again"}}},register:async e=>{try{const t=await(async e=>{try{const{email:t,password:s,name:r,school:a,grade:n,phone:i,location:m,bio:x,subjects:p}=e,g=o(dt,"users"),b=l(g,c("email","==",t.toLowerCase().trim()));if(!(await d(b)).empty)return{success:!1,error:"User already exists with this email"};const f=Date.now().toString(),w=u(dt,"users",f);return await h(w,{id:f,name:r.trim(),email:t.toLowerCase().trim(),password:s.trim(),school:a,grade:n,phone:i,location:m,bio:x,subjects:p,isTutor:!1,tutorProfile:null,emailVerified:!0,createdAt:(new Date).toISOString()}),{success:!0,message:"Registration successful!",user:{id:f,name:r.trim()||"User",email:t.toLowerCase().trim(),school:a,grade:n,phone:i,location:m,bio:x,subjects:p,avatar:null,isTutor:!1,tutorProfile:null}}}catch(t){return console.error("Registration error:",t),{success:!1,error:"Registration failed, please try again"}}})(e);if(t.success){const e=t.user;e.isTutor=!1,r(e),localStorage.setItem("simpleUser",JSON.stringify(e))}return t}catch(t){return{success:!1,error:"Registration failed, please try again"}}},logout:async()=>{try{await(async()=>({success:!0}))(),r(null),localStorage.removeItem("simpleUser"),localStorage.setItem("theme","light"),document.documentElement.setAttribute("data-theme","light"),j&&j("light")}catch(e){console.error("Logout error:",e)}},reloadUser:async()=>{const e=localStorage.getItem("simpleUser");if(e){const s=JSON.parse(e);try{const e=await(async e=>{try{const t=await m(u(dt,"users",e));if(t.exists()){const e=t.data();return{success:!0,user:{id:t.id,...e,name:e.name||"User",avatar:e.avatar||null,isTutor:e.isTutor||!1}}}return{success:!1,error:"User not found"}}catch(t){return console.error("Error getting user details:",t),{success:!1,error:t.message}}})(s.id);if(e.success){const t=e.user;r(t),localStorage.setItem("simpleUser",JSON.stringify(t))}else void 0===s.isTutor&&(s.isTutor=!1),r(s)}catch(t){console.error("Error reloading user:",t),void 0===s.isTutor&&(s.isTutor=!1),r(s)}}},updateUser:e=>{r(e),localStorage.setItem("simpleUser",JSON.stringify(e))},loading:a};return U.jsxs(Or.Provider,{value:N,children:[t,i&&U.jsx(Dr,{message:p,onComplete:()=>{console.log(" Deletion notice complete, logging out..."),r(null),localStorage.removeItem("simpleUser"),localStorage.removeItem("deletionNotice"),localStorage.setItem("theme","light"),document.documentElement.setAttribute("data-theme","light"),j&&j("light"),window.location.href="/"}}),f&&U.jsx(Lr,{message:y,onComplete:()=>{console.log(" Ban notice complete, logging out..."),r(null),localStorage.removeItem("simpleUser"),localStorage.setItem("theme","light"),document.documentElement.setAttribute("data-theme","light"),j&&j("light"),window.location.href="/"}})]})},zr=({type:t="success",title:s,message:r,duration:a=4e3,onClose:n,show:i=!1})=>{const[o,l]=e.useState(!1),[c,d]=e.useState(!1),[u,h]=e.useState(100);e.useEffect(()=>{if(i&&(l(!0),d(!0),h(100),a>0)){const e=Date.now(),t=setInterval(()=>{const s=Date.now()-e,r=Math.max(0,a-s);h(r/a*100),r<=0&&(clearInterval(t),m())},50);return()=>clearInterval(t)}},[i,a]);const m=()=>{d(!1),setTimeout(()=>{l(!1),n&&n()},300)},x=(()=>{switch(t){case"success":default:return{bg:"bg-green-50 border-green-200",title:"text-green-800",message:"text-green-700",icon:"text-green-500"};case"error":return{bg:"bg-red-50 border-red-200",title:"text-red-800",message:"text-red-700",icon:"text-red-500"};case"warning":return{bg:"bg-yellow-50 border-yellow-200",title:"text-yellow-800",message:"text-yellow-700",icon:"text-yellow-500"};case"info":return{bg:"bg-blue-50 border-blue-200",title:"text-blue-800",message:"text-blue-700",icon:"text-blue-500"}}})();return o?U.jsxs("div",{className:"max-w-sm w-full",children:[U.jsxs("div",{className:`\n          ${x.bg} border-2 rounded-2xl shadow-2xl\n          transition-all duration-300 ease-out\n          ${c?"opacity-100 translate-y-0":"opacity-0 -translate-y-8"} animate-slide-down\n        `,style:{backgroundColor:"success"===t?"#f0fdf4":"error"===t?"#fef2f2":"warning"===t?"#fffbeb":"#eff6ff",borderColor:"success"===t?"#bbf7d0":"error"===t?"#fecaca":"warning"===t?"#fed7aa":"#bfdbfe"},children:[U.jsxs("div",{className:"absolute inset-0 rounded-2xl overflow-hidden",children:[U.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-white/20 to-transparent rounded-full -translate-y-10 translate-x-10"}),U.jsx("div",{className:"absolute bottom-0 left-0 w-16 h-16 bg-gradient-to-tr from-white/20 to-transparent rounded-full translate-y-8 -translate-x-8"})]}),U.jsxs("div",{className:"relative p-6",children:[U.jsx("button",{onClick:m,className:"absolute top-3 right-3 p-1 rounded-full hover:bg-white/50 transition-colors duration-200 group",children:U.jsx(Rr,{className:"w-4 h-4 text-gray-500 group-hover:text-gray-700"})}),U.jsxs("div",{className:"flex items-start space-x-4 pr-8",children:[U.jsx("div",{className:"flex-shrink-0",children:U.jsx("div",{className:`\n                  w-12 h-12 rounded-full flex items-center justify-center\n                  shadow-lg border-2\n                  ${c?"animate-bounce":""}\n                `,style:{backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"rgba(255, 255, 255, 0.5)"},children:(()=>{switch(t){case"success":default:return U.jsx($t,{className:"w-6 h-6 text-green-500"});case"error":return U.jsx(qr,{className:"w-6 h-6 text-red-500"});case"warning":return U.jsx(ft,{className:"w-6 h-6 text-yellow-500"});case"info":return U.jsx(ys,{className:"w-6 h-6 text-blue-500"})}})()})}),U.jsxs("div",{className:"flex-1 min-w-0",children:[s&&U.jsx("h4",{className:`text-lg font-bold ${x.title} mb-1`,children:s}),r&&U.jsx("p",{className:`text-sm ${x.message} leading-relaxed`,children:r})]})]}),a>0&&U.jsx("div",{className:"absolute top-0 left-0 right-0 h-0.5 bg-gray-100/30 rounded-t-2xl overflow-hidden",children:U.jsx("div",{className:`\n                  h-full transition-all duration-100 ease-linear\n                  ${"success"===t?"bg-gradient-to-r from-green-300 to-green-400":"error"===t?"bg-gradient-to-r from-red-300 to-red-400":"warning"===t?"bg-gradient-to-r from-yellow-300 to-yellow-400":"bg-gradient-to-r from-blue-300 to-blue-400"}\n                `,style:{width:`${u}%`}})})]})]}),U.jsx("style",{children:"\n        @keyframes slideDown {\n          0% { opacity: 0; transform: translateY(-20px); }\n          100% { opacity: 1; transform: translateY(0); }\n        }\n        .animate-slide-down { animation: slideDown 300ms ease-out; }\n      "})]}):null},Wr=e.createContext(),Hr=()=>e.useContext(Wr),Gr=({children:t})=>{const[s,r]=e.useState([]),a=(e,t,s=3e3,a=null)=>{const n={id:Date.now()+Math.random(),type:e,message:t,duration:s,title:a};r(e=>[...e,n])},n={showSuccess:(e,t=4e3,s=null)=>a("success",e,t,s),showError:(e,t=5e3,s=null)=>a("error",e,t,s),showWarning:(e,t=4e3,s=null)=>a("warning",e,t,s),showInfo:(e,t=4e3,s=null)=>a("info",e,t,s),showNotification:a};return U.jsxs(Wr.Provider,{value:n,children:[t,s.map((e,t)=>U.jsx("div",{className:"fixed left-1/2 top-6 z-[9999] transform -translate-x-1/2",style:{transform:`translate(-50%, 0) translateY(${90*t}px)`,zIndex:9999-t},children:U.jsx(zr,{show:!0,onClose:()=>{return t=e.id,void r(e=>e.filter(e=>e.id!==t));var t},type:e.type,title:e.title||Vr(e.type),message:e.message,duration:e.duration})},e.id))]})},Vr=e=>{switch(e){case"success":return"Success";case"error":return"Error";case"warning":return"Warning";case"info":return"Info";default:return"Notification"}},Yr=({isOpen:e,onClose:t,streakData:s})=>{const{isDark:r}=mt();if(!e||!s)return null;const{currentStreak:a,longestStreak:n,isNewStreak:i}=s,o=[7,30,60,100].find(e=>a<e)||null,l=o?a/o*100:100;return U.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[U.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:t}),U.jsxs("div",{className:"relative w-full max-w-md rounded-3xl border shadow-2xl "+(r?"border-white/20 bg-gradient-to-br from-[#1a1240] via-[#2d1b5e] to-[#1a1240]":"border-gray-200 bg-white"),children:[U.jsx("button",{onClick:t,className:"absolute top-4 right-4 p-2 rounded-lg transition "+(r?"hover:bg-white/10 text-white/70 hover:text-white":"hover:bg-gray-100 text-gray-500 hover:text-gray-700"),children:U.jsx(Rr,{className:"h-5 w-5"})}),U.jsxs("div",{className:"p-8 text-center",children:[U.jsxs("div",{className:"relative mb-6",children:[U.jsx("div",{className:"w-24 h-24 mx-auto rounded-full flex items-center justify-center "+(r?"bg-gradient-to-br from-orange-500/20 to-red-500/20":"bg-gradient-to-br from-orange-100 to-red-100"),children:U.jsx(cs,{className:"h-12 w-12 "+(r?"text-orange-400":"text-orange-500")})}),i&&U.jsx("div",{className:"absolute -top-2 -right-2",children:U.jsx(nr,{className:"h-6 w-6 text-yellow-400 animate-pulse"})})]}),U.jsx("h2",{className:"text-3xl font-bold mb-2 "+(r?"text-white":"text-slate-900"),children:i?" Streak Updated!":" Your Streak"}),U.jsxs("div",{className:"mb-6",children:[U.jsx("p",{className:"text-sm mb-2 "+(r?"text-white/70":"text-slate-600"),children:"Current Streak"}),U.jsx("div",{className:"text-6xl font-black mb-2 "+(r?"bg-gradient-to-r from-orange-400 via-red-400 to-pink-400 bg-clip-text text-transparent":"bg-gradient-to-r from-orange-500 via-red-500 to-pink-500 bg-clip-text text-transparent"),children:a}),U.jsxs("p",{className:"text-lg font-semibold "+(r?"text-white/80":"text-slate-700"),children:[1===a?"day":"days"," in a row!"]})]}),n>a&&U.jsxs("div",{className:"mb-6 p-4 rounded-2xl "+(r?"bg-white/5":"bg-slate-50"),children:[U.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[U.jsx(fr,{className:"h-5 w-5 "+(r?"text-yellow-400":"text-yellow-600")}),U.jsx("p",{className:"text-sm font-semibold "+(r?"text-white/70":"text-slate-600"),children:"Longest Streak"})]}),U.jsxs("p",{className:"text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:[n," days"]})]}),o&&U.jsxs("div",{className:"mb-6",children:[U.jsxs("div",{className:"flex items-center justify-between mb-2",children:[U.jsx("p",{className:"text-sm font-semibold "+(r?"text-white/70":"text-slate-600"),children:"Next Milestone"}),U.jsxs("p",{className:"text-sm font-semibold "+(r?"text-white/70":"text-slate-600"),children:[a," / ",o," days"]})]}),U.jsx("div",{className:"h-3 rounded-full overflow-hidden "+(r?"bg-white/10":"bg-slate-200"),children:U.jsx("div",{className:"h-full bg-gradient-to-r from-orange-500 via-red-500 to-pink-500 transition-all duration-500",style:{width:`${Math.min(l,100)}%`}})}),U.jsxs("p",{className:"text-xs mt-2 "+(r?"text-white/50":"text-slate-500"),children:[o-a," more days to reach ",o," days!"]})]}),a>=7&&U.jsx("div",{className:"mb-4 p-3 rounded-xl "+(r?"bg-green-500/20 border border-green-500/30":"bg-green-50 border border-green-200"),children:U.jsxs("div",{className:"flex items-center justify-center gap-2",children:[U.jsx(nr,{className:"h-5 w-5 "+(r?"text-green-400":"text-green-600")}),U.jsx("p",{className:"text-sm font-semibold "+(r?"text-green-300":"text-green-700"),children:"Week Warrior Achievement Unlocked! "})]})}),a>=30&&U.jsx("div",{className:"mb-4 p-3 rounded-xl "+(r?"bg-purple-500/20 border border-purple-500/30":"bg-purple-50 border border-purple-200"),children:U.jsxs("div",{className:"flex items-center justify-center gap-2",children:[U.jsx(nr,{className:"h-5 w-5 "+(r?"text-purple-400":"text-purple-600")}),U.jsx("p",{className:"text-sm font-semibold "+(r?"text-purple-300":"text-purple-700"),children:"Monthly Champion Achievement Unlocked! "})]})}),U.jsx("button",{onClick:t,className:"w-full py-3 rounded-xl font-semibold transition bg-gradient-to-r from-orange-500 to-red-500 text-white hover:from-orange-600 hover:to-red-600",children:"Continue"})]})]})]})},Qr=async(e,t)=>{try{const s=(null==t?void 0:t.achievements)||[],r=[],a=(null==t||t.totalXP,(null==t?void 0:t.currentLevel)||1),n=(null==t?void 0:t.gold)||0,i=((null==t?void 0:t.completedQuests)||[]).length,o=(null==t?void 0:t.currentStreak)||0,l={first_quest:i>=1,level_5:a>=5,level_10:a>=10,level_20:a>=20,level_30:a>=30,level_50:a>=50,gold_1000:n>=1e3,quest_master:i>=50,streak_7:o>=7,streak_30:o>=30};r.filter(e=>!s.includes(e));for(const[e,t]of Object.entries(l))t&&!s.includes(e)&&r.push(e);const c=[...s,...r];if(r.length>0){console.log(" New achievements unlocked:",r);const t=u(dt,"studyprogress",e);await h(t,{achievements:c,updatedAt:(new Date).toISOString()},{merge:!0})}return{newAchievements:r,allAchievements:c}}catch(s){return console.error("Error checking achievements:",s),{newAchievements:[],allAchievements:(null==t?void 0:t.achievements)||[]}}},Jr={}.VITE_API_BASE_URL||"http://localhost:3003/api",Kr=(e={})=>{const t=new URLSearchParams;Object.entries(e).forEach(([e,s])=>{null!=s&&""!==s&&t.append(e,s)});const s=t.toString();return s?`?${s}`:""},Xr=async({subject:e,category:t,questId:s})=>{const r=await fetch(`${Jr}/quests/by-key${Kr({subject:e,category:t,questId:s})}`);if(!r.ok)throw new Error("Failed to fetch quest");return r.json()},Zr={italian:{grammar:{"quest-1":{id:"quest-1",title:"Italian Alphabet & Pronunciation",description:"Learn the Italian alphabet and basic pronunciation rules",type:"quest",difficulty:"beginner",xpReward:80,goldReward:40,icon:"",timeEstimate:"25 min",skills:["language-learning","pronunciation"],requirements:[],deliverables:[{type:"pronunciation-exercises",description:"Practice Italian alphabet pronunciation",format:"audio"}],resources:["Italian alphabet guide","Audio pronunciation","Practice exercises"],learningMaterial:{title:"Italian Alphabet & Pronunciation Basics",content:'\n# Italian Alphabet & Pronunciation Guide\n\n## Italian Alphabet\nItalian uses 21 letters, excluding J, K, W, X, Y (which are only used in foreign words).\n\n### Basic Letters\nA, B, C, D, E, F, G, H, I, L, M, N, O, P, Q, R, S, T, U, V, Z\n\n### Pronunciation Rules\n1. **Vowel Sounds**:\n   - A: like "father" in English\n   - E: like "bed" in English  \n   - I: like "machine" in English\n   - O: like "more" in English\n   - U: like "rule" in English\n\n2. **Consonant Sounds**:\n   - C: [k] sound before a, o, u; [ch] sound before e, i\n   - G: [g] sound before a, o, u; [j] sound before e, i\n   - H: silent, but affects C and G pronunciation\n\n### Common Greetings\n- **Ciao** [chao] - Hello/Goodbye (informal)\n- **Buongiorno** [bwon-jor-no] - Good morning\n- **Buonasera** [bwona-se-ra] - Good evening\n- **Salve** [sal-ve] - Hello (formal)\n\n## Key Learning Points\n1. Italian is a phonetic language - each letter has a fixed sound\n2. Stress usually falls on the second-to-last syllable\n3. Double consonants require extended pronunciation time\n          ',readingTime:"5-8 minutes",keyPoints:["Italian has 21 letters","Vowel sounds are clear and distinct","C and G pronunciation rules","Common greeting usage contexts"]},steps:[{id:"step-1",title:"Learn the Italian Alphabet",type:"multiple-choice",question:"How many letters are in the Italian alphabet?",options:["21","26","25","24"],correctAnswer:0,explanation:"The Italian alphabet has 21 letters, excluding J, K, W, X, and Y which are only used in foreign words."},{id:"step-2",title:"Practice Pronunciation",type:"text-input",question:'Write the Italian word for "hello" using the Italian alphabet.',placeholder:"Type the Italian word for hello...",correctAnswers:["ciao","buongiorno","salve"],explanation:'Common Italian greetings include "ciao" (informal), "buongiorno" (good morning), and "salve" (formal hello).'},{id:"step-3",title:"Vowel Sounds",type:"multiple-choice",question:'How do you pronounce the Italian letter "E"?',options:['Like "bed" in English','Like "machine" in English','Like "more" in English','Like "rule" in English'],correctAnswer:0,explanation:'The Italian "E" is pronounced like the "e" in "bed" in English.'},{id:"step-4",title:"Consonant Rules",type:"multiple-choice",question:'How is the letter "C" pronounced before "E" and "I"?',options:["[k] sound","[ch] sound","[s] sound","[g] sound"],correctAnswer:1,explanation:'Before "E" and "I", the letter "C" is pronounced as [ch] sound, like in "ciao".'},{id:"step-5",title:"Double Consonants",type:"multiple-choice",question:"What is special about double consonants in Italian?",options:["They are silent","They require extended pronunciation","They change the vowel sound","They are optional"],correctAnswer:1,explanation:"Double consonants in Italian require extended pronunciation time, making them distinct from single consonants."}]}}},mathematics:{algebra:{"quest-1":{id:"quest-1",title:"Linear Equations",description:"Learn to solve linear equations with one variable",type:"quest",difficulty:"beginner",xpReward:100,goldReward:50,icon:"",timeEstimate:"30 min",skills:["mathematical-thinking","problem-solving"],requirements:[],deliverables:[{type:"equation-solving",description:"Solve 10 linear equations",format:"text"}],resources:["Algebra textbook","Practice problems","Video tutorials"],learningMaterial:{title:"Linear Equations Fundamentals",content:"\n# Introduction to Linear Equations\n\n## What are Linear Equations?\nLinear equations are equations where the highest power is 1, typically in the form: ax + b = 0\n\n## Basic Concepts\n\n### 1. Equation Definition\n- **Equation**: An equality containing unknown variables\n- **Solution**: The value of the unknown that makes the equation true\n- **Root**: The solution of the equation\n\n### 2. Standard Form of Linear Equations\nax + b = 0 (a  0)\n\n### 3. Steps to Solve Linear Equations\n1. **Transpose**: Move terms with unknowns to one side, constants to the other\n2. **Combine like terms**: Simplify the equation\n3. **Divide by coefficient**: Divide both sides by the coefficient of the unknown\n\n## Worked Examples\n\n### Example 1: 2x + 3 = 7\n**Step 1**: Transpose\n2x = 7 - 3\n2x = 4\n\n**Step 2**: Divide by coefficient\nx = 4  2\nx = 2\n\n### Example 2: 3x - 5 = 10\n**Step 1**: Transpose\n3x = 10 + 5\n3x = 15\n\n**Step 2**: Divide by coefficient\nx = 15  3\nx = 5\n\n## Checking Your Answer\nSubstitute the solution back into the original equation to verify.\n\n## Common Mistakes\n1. Forgetting to change signs when transposing\n2. Calculation errors when dividing by coefficient\n3. Forgetting to check the answer\n          ",readingTime:"6-10 minutes",keyPoints:["Standard form of linear equations","Basic steps to solve equations","Transposing and combining like terms","Importance of checking answers"]},steps:[{id:"step-1",title:"Basic Concepts",type:"multiple-choice",question:"What is the solution to 2x + 3 = 7?",options:["x = 2","x = 4","x = 5","x = 1"],correctAnswer:0,explanation:"Subtract 3 from both sides: 2x = 4, then divide by 2: x = 2"},{id:"step-2",title:"Practice",type:"text-input",question:"Solve: 3x - 5 = 10",placeholder:"Enter your answer...",correctAnswers:["x = 5","5"],explanation:"Add 5 to both sides: 3x = 15, then divide by 3: x = 5"},{id:"step-3",title:"Negative Coefficients",type:"multiple-choice",question:"What is the solution to -2x + 4 = 8?",options:["x = 2","x = -2","x = 6","x = -6"],correctAnswer:1,explanation:"Subtract 4 from both sides: -2x = 4, then divide by -2: x = -2"},{id:"step-4",title:"Fractions in Equations",type:"multiple-choice",question:"What is the solution to (1/2)x + 3 = 7?",options:["x = 8","x = 4","x = 2","x = 6"],correctAnswer:0,explanation:"Subtract 3 from both sides: (1/2)x = 4, then multiply by 2: x = 8"},{id:"step-5",title:"Word Problems",type:"multiple-choice",question:"If a number plus 5 equals 12, what is the number?",options:["7","17","2.4","60"],correctAnswer:0,explanation:"Let x be the number. Then x + 5 = 12, so x = 12 - 5 = 7"}]}}},physics:{mechanics:{"quest-1":{id:"quest-1",title:"Newton's Laws of Motion",description:"Understand the fundamental laws governing motion",type:"quest",difficulty:"beginner",xpReward:120,goldReward:60,icon:"",timeEstimate:"35 min",skills:["scientific-thinking","analytical-reasoning"],requirements:[],deliverables:[{type:"physics-problems",description:"Solve motion problems using Newton's laws",format:"text"}],resources:["Physics textbook","Interactive simulations","Problem sets"],learningMaterial:{title:"Newton's Laws of Motion",content:"\n# Newton's Laws of Motion\n\n## Introduction\nNewton's three laws of motion form the foundation of classical mechanics and describe the relationship between forces and motion.\n\n## Newton's First Law (Law of Inertia)\nAn object at rest stays at rest, and an object in motion stays in motion, unless acted upon by an external force.\n\n### Key Concepts:\n- **Inertia**: The tendency of objects to resist changes in motion\n- **Equilibrium**: When forces are balanced, there is no acceleration\n- **Examples**: A book on a table, a car coasting on a flat road\n\n## Newton's Second Law\nForce equals mass times acceleration (F = ma)\n\n### Key Concepts:\n- **Force**: A push or pull that causes acceleration\n- **Mass**: The amount of matter in an object\n- **Acceleration**: The rate of change of velocity\n- **Examples**: Pushing a shopping cart, throwing a ball\n\n## Newton's Third Law (Action-Reaction)\nFor every action, there is an equal and opposite reaction.\n\n### Key Concepts:\n- **Action-Reaction Pairs**: Forces always come in pairs\n- **Equal Magnitude**: Forces are equal in strength\n- **Opposite Direction**: Forces act in opposite directions\n- **Examples**: Walking, rocket propulsion, swimming\n\n## Applications\n\n### Everyday Examples\n- Walking: Your foot pushes backward, ground pushes you forward\n- Driving: Engine pushes car forward, friction opposes motion\n- Swimming: Arms push water backward, water pushes you forward\n\n### Engineering Applications\n- Rocket design and propulsion\n- Vehicle safety systems\n- Sports equipment design\n          ",readingTime:"8-12 minutes",keyPoints:["First Law: Objects resist changes in motion","Second Law: F = ma relationship","Third Law: Action-reaction pairs","Real-world applications of Newton's laws"]},steps:[{id:"step-1",title:"First Law",type:"multiple-choice",question:"What does Newton's First Law state?",options:["F = ma","An object at rest stays at rest","For every action there is an equal reaction","Energy is conserved"],correctAnswer:1,explanation:"Newton's First Law states that an object at rest stays at rest, and an object in motion stays in motion, unless acted upon by an external force."},{id:"step-2",title:"Second Law",type:"multiple-choice",question:"What is the formula for Newton's Second Law?",options:["F = ma","E = mc","v = d/t","P = mv"],correctAnswer:0,explanation:"Newton's Second Law states that Force equals mass times acceleration (F = ma)."},{id:"step-3",title:"Third Law",type:"multiple-choice",question:"What does Newton's Third Law state?",options:["F = ma","An object at rest stays at rest","For every action there is an equal and opposite reaction","Energy is conserved"],correctAnswer:2,explanation:"Newton's Third Law states that for every action, there is an equal and opposite reaction."},{id:"step-4",title:"Force Applications",type:"multiple-choice",question:"When you walk, what force pushes you forward?",options:["Your foot pushing backward","The ground pushing you forward","Gravity pulling you down","Air resistance"],correctAnswer:1,explanation:"The ground pushes you forward (reaction force) when your foot pushes backward (action force)."},{id:"step-5",title:"Mass vs Weight",type:"multiple-choice",question:"What is the difference between mass and weight?",options:["They are the same thing","Mass is matter, weight is force","Weight is matter, mass is force","No difference"],correctAnswer:1,explanation:"Mass is the amount of matter in an object, while weight is the force of gravity acting on that mass."}]}}},chemistry:{organic:{"quest-1":{id:"quest-1",title:"Organic Compounds",description:"Learn about carbon-based molecules and their properties",type:"quest",difficulty:"beginner",xpReward:110,goldReward:55,icon:"",timeEstimate:"40 min",skills:["chemical-thinking","molecular-understanding"],requirements:[],deliverables:[{type:"molecular-structures",description:"Draw and identify organic compounds",format:"diagram"}],resources:["Chemistry textbook","Molecular models","Interactive tools"],learningMaterial:{title:"Organic Compounds Fundamentals",content:"\n# Introduction to Organic Compounds\n\n## What are Organic Compounds?\nOrganic compounds are carbon-based molecules that form the basis of all living things and many synthetic materials.\n\n## Carbon Chemistry\n\n### Why Carbon is Special\n- **Four valence electrons**: Can form 4 covalent bonds\n- **Versatile bonding**: Single, double, and triple bonds\n- **Chain formation**: Can form long chains and rings\n- **Diversity**: Millions of possible compounds\n\n### Types of Carbon Bonds\n- **Single bonds**: C-C (alkanes)\n- **Double bonds**: C=C (alkenes)\n- **Triple bonds**: CC (alkynes)\n- **Aromatic bonds**: Benzene rings\n\n## Functional Groups\n\n### Hydrocarbons\n- **Alkanes**: Single bonds only (methane, ethane)\n- **Alkenes**: Double bonds (ethene, propene)\n- **Alkynes**: Triple bonds (ethyne, propyne)\n\n### Oxygen-Containing Groups\n- **Alcohols**: -OH group (methanol, ethanol)\n- **Aldehydes**: -CHO group (formaldehyde, acetaldehyde)\n- **Ketones**: -CO- group (acetone)\n- **Carboxylic acids**: -COOH group (acetic acid)\n\n### Nitrogen-Containing Groups\n- **Amines**: -NH2 group (methylamine)\n- **Amides**: -CONH2 group (acetamide)\n\n## Importance of Organic Compounds\n\n### Biological Significance\n- **Proteins**: Made of amino acids\n- **Carbohydrates**: Sugars and starches\n- **Lipids**: Fats and oils\n- **Nucleic acids**: DNA and RNA\n\n### Industrial Applications\n- **Pharmaceuticals**: Medicine development\n- **Plastics**: Polymer chemistry\n- **Fuels**: Petroleum products\n- **Materials**: Synthetic fibers\n          ",readingTime:"10-15 minutes",keyPoints:["Carbon can form 4 covalent bonds","Functional groups determine properties","Organic compounds are essential for life","Industrial applications of organic chemistry"]},steps:[{id:"step-1",title:"Carbon Chemistry",type:"multiple-choice",question:"How many bonds can carbon form?",options:["2","3","4","6"],correctAnswer:2,explanation:"Carbon can form 4 covalent bonds, allowing it to create complex organic molecules."},{id:"step-2",title:"Functional Groups",type:"multiple-choice",question:"What functional group is -OH?",options:["Aldehyde","Ketone","Alcohol","Ether"],correctAnswer:2,explanation:"The -OH group is characteristic of alcohols."},{id:"step-3",title:"Hydrocarbons",type:"multiple-choice",question:"What is the simplest hydrocarbon?",options:["Ethane","Methane","Propane","Butane"],correctAnswer:1,explanation:"Methane (CH) is the simplest hydrocarbon with one carbon atom."},{id:"step-4",title:"Isomers",type:"multiple-choice",question:"What are isomers?",options:["Same molecular formula, different structure","Different molecular formula, same structure","Same atoms, different elements","Different atoms, same elements"],correctAnswer:0,explanation:"Isomers are compounds with the same molecular formula but different structural arrangements."},{id:"step-5",title:"Organic Reactions",type:"multiple-choice",question:"What type of reaction is combustion?",options:["Addition reaction","Substitution reaction","Oxidation reaction","Reduction reaction"],correctAnswer:2,explanation:"Combustion is an oxidation reaction where organic compounds react with oxygen to produce CO and HO."}]}}},history:{ancient:{"quest-1":{id:"quest-1",title:"Ancient Civilizations",description:"Explore the great civilizations of the ancient world",type:"quest",difficulty:"beginner",xpReward:90,goldReward:45,icon:"",timeEstimate:"30 min",skills:["historical-thinking","cultural-understanding"],requirements:[],deliverables:[{type:"timeline-creation",description:"Create a timeline of ancient civilizations",format:"text"}],resources:["History textbook","Maps","Archaeological evidence"],learningMaterial:{title:"Ancient Civilizations Overview",content:"\n# Ancient Civilizations: Foundations of Human Society\n\n## What are Ancient Civilizations?\nAncient civilizations were the first complex societies that developed writing, government, and advanced technologies.\n\n## Key Ancient Civilizations\n\n### Mesopotamia (3500-500 BCE)\n- **Location**: Between Tigris and Euphrates rivers (modern Iraq)\n- **Achievements**: First writing system (cuneiform), wheel, irrigation\n- **Government**: City-states with kings\n- **Culture**: Ziggurats, Epic of Gilgamesh\n\n### Ancient Egypt (3100-30 BCE)\n- **Location**: Nile River valley\n- **Achievements**: Pyramids, hieroglyphics, calendar, medicine\n- **Government**: Pharaohs as divine rulers\n- **Culture**: Mummification, Book of the Dead\n\n### Ancient Greece (800-146 BCE)\n- **Location**: Greek peninsula and islands\n- **Achievements**: Democracy, philosophy, theater, Olympics\n- **Government**: City-states (Athens, Sparta)\n- **Culture**: Mythology, art, architecture\n\n### Ancient Rome (753 BCE-476 CE)\n- **Location**: Italian peninsula, expanded across Mediterranean\n- **Achievements**: Law, engineering, roads, aqueducts\n- **Government**: Republic, then Empire\n- **Culture**: Latin language, gladiators, Christianity\n\n## Common Features of Ancient Civilizations\n\n### Social Structure\n- **Rulers**: Kings, pharaohs, emperors\n- **Priests**: Religious leaders\n- **Merchants**: Traders and craftspeople\n- **Farmers**: Agricultural workers\n- **Slaves**: Forced labor\n\n### Technological Advances\n- **Writing**: Record keeping and communication\n- **Metallurgy**: Bronze and iron working\n- **Architecture**: Monumental buildings\n- **Mathematics**: Number systems and calculations\n- **Astronomy**: Calendar systems\n\n### Cultural Achievements\n- **Art**: Sculpture, painting, pottery\n- **Literature**: Epic poems, plays, histories\n- **Religion**: Polytheistic belief systems\n- **Philosophy**: Questions about life and existence\n          ",readingTime:"8-12 minutes",keyPoints:["Four major ancient civilizations","Common features of early societies","Technological and cultural achievements","Social structure and government systems"]},steps:[{id:"step-1",title:"Ancient Egypt",type:"multiple-choice",question:"Which civilization built the pyramids?",options:["Ancient Greeks","Ancient Egyptians","Ancient Romans","Ancient Chinese"],correctAnswer:1,explanation:"The Ancient Egyptians built the pyramids as tombs for pharaohs."},{id:"step-2",title:"Mesopotamia",type:"multiple-choice",question:"Where was the first writing system developed?",options:["Egypt","Greece","Mesopotamia","China"],correctAnswer:2,explanation:"Cuneiform, the first known writing system, was developed in ancient Mesopotamia."},{id:"step-3",title:"Ancient Greece",type:"multiple-choice",question:"What form of government was developed in ancient Athens?",options:["Monarchy","Democracy","Dictatorship","Theocracy"],correctAnswer:1,explanation:"Ancient Athens developed democracy, where citizens could participate in government decisions."},{id:"step-4",title:"Ancient Rome",type:"multiple-choice",question:"What was the Roman Empire known for?",options:["Building pyramids","Creating the first democracy","Extensive road networks and law","Inventing the wheel"],correctAnswer:2,explanation:"The Roman Empire was known for its extensive road networks, legal system, and engineering achievements."},{id:"step-5",title:"Cultural Achievements",type:"multiple-choice",question:"What was a common feature of ancient civilizations?",options:["They all spoke the same language","They all had writing systems and monumental architecture","They all lived in the same climate","They all used the same currency"],correctAnswer:1,explanation:"Ancient civilizations commonly developed writing systems and built monumental architecture as expressions of their power and culture."}]}}},computerScience:{programming:{"quest-1":{id:"quest-1",title:"Introduction to Programming",description:"Learn the basics of computer programming",type:"quest",difficulty:"beginner",xpReward:130,goldReward:65,icon:"",timeEstimate:"45 min",skills:["logical-thinking","problem-solving"],requirements:[],deliverables:[{type:"code-exercises",description:"Write your first programs",format:"code"}],resources:["Programming tutorial","Code editor","Practice exercises"],learningMaterial:{title:"Introduction to Programming",content:'\n# Programming Fundamentals\n\n## What is Programming?\nProgramming is the process of creating instructions for computers to follow. It involves writing code that tells a computer what to do.\n\n## Basic Programming Concepts\n\n### Variables\n- **Definition**: Storage locations that hold data\n- **Types**: Numbers, text, true/false values\n- **Examples**: age = 25, name = "Alice", isStudent = true\n\n### Data Types\n- **Integers**: Whole numbers (1, 2, 3, -5)\n- **Floats**: Decimal numbers (3.14, 2.5)\n- **Strings**: Text data ("Hello", "World")\n- **Booleans**: True or false values\n\n### Control Structures\n- **If statements**: Make decisions based on conditions\n- **Loops**: Repeat actions multiple times\n- **Functions**: Reusable blocks of code\n\n## Programming Languages\n\n### Popular Languages\n- **Python**: Easy to learn, great for beginners\n- **JavaScript**: Web development and applications\n- **Java**: Enterprise software and Android apps\n- **C++**: System programming and games\n\n### Choosing a Language\n- **Beginner-friendly**: Python, JavaScript\n- **Web development**: HTML, CSS, JavaScript\n- **Mobile apps**: Swift (iOS), Kotlin (Android)\n- **Data science**: Python, R\n\n## Problem-Solving Process\n\n### 1. Understand the Problem\n- Read the requirements carefully\n- Identify inputs and expected outputs\n- Break down complex problems\n\n### 2. Plan Your Solution\n- Think through the steps\n- Consider different approaches\n- Write pseudocode (plain English steps)\n\n### 3. Write the Code\n- Start with simple solutions\n- Test frequently\n- Debug errors as they appear\n\n### 4. Test and Refine\n- Test with different inputs\n- Check edge cases\n- Optimize if needed\n\n## Programming Best Practices\n\n### Code Organization\n- Use meaningful variable names\n- Add comments to explain complex logic\n- Keep functions small and focused\n- Follow consistent formatting\n\n### Debugging Tips\n- Read error messages carefully\n- Use print statements to trace execution\n- Test with simple examples first\n- Ask for help when stuck\n          ',readingTime:"10-15 minutes",keyPoints:["Variables store data in programs","Different data types for different information","Control structures guide program flow","Problem-solving process for programming"]},steps:[{id:"step-1",title:"Variables",type:"multiple-choice",question:"What is a variable in programming?",options:["A storage location for data","A type of function","A programming language","A computer part"],correctAnswer:0,explanation:"A variable is a storage location that holds data that can be changed during program execution."},{id:"step-2",title:"Data Types",type:"multiple-choice",question:"Which is NOT a common data type?",options:["String","Integer","Boolean","Triangle"],correctAnswer:3,explanation:"String, Integer, and Boolean are common data types. Triangle is not a programming data type."},{id:"step-3",title:"Control Structures",type:"multiple-choice",question:"What is a loop in programming?",options:["A way to stop a program","A way to repeat code multiple times","A way to store data","A way to print text"],correctAnswer:1,explanation:"A loop is a control structure that repeats a block of code multiple times."},{id:"step-4",title:"Functions",type:"multiple-choice",question:"What is a function in programming?",options:["A variable that stores data","A reusable block of code that performs a task","A type of loop","A programming language"],correctAnswer:1,explanation:"A function is a reusable block of code that performs a specific task and can be called multiple times."},{id:"step-5",title:"Algorithms",type:"multiple-choice",question:"What is an algorithm?",options:["A programming language","A step-by-step procedure to solve a problem","A type of variable","A computer part"],correctAnswer:1,explanation:"An algorithm is a step-by-step procedure or set of rules to solve a problem or complete a task."}]}}},literature:{poetry:{"quest-1":{id:"quest-1",title:"Poetry Analysis",description:"Learn to analyze and understand poetry",type:"quest",difficulty:"beginner",xpReward:95,goldReward:47,icon:"",timeEstimate:"35 min",skills:["literary-analysis","critical-thinking"],requirements:[],deliverables:[{type:"poetry-analysis",description:"Analyze a classic poem",format:"text"}],resources:["Poetry anthology","Literary analysis guide","Examples"],learningMaterial:{title:"Poetry Analysis Fundamentals",content:'\n# Understanding Poetry: A Beginner\'s Guide\n\n## What is Poetry?\nPoetry is a form of literature that uses language, rhythm, and imagery to express ideas and emotions in a concentrated and artistic way.\n\n## Key Elements of Poetry\n\n### Rhythm and Meter\n- **Rhythm**: The pattern of stressed and unstressed syllables\n- **Meter**: The regular pattern of rhythm in a poem\n- **Examples**: Iambic pentameter, trochaic tetrameter\n\n### Rhyme and Sound\n- **Rhyme**: Words that sound the same at the end of lines\n- **Alliteration**: Repetition of consonant sounds\n- **Assonance**: Repetition of vowel sounds\n- **Onomatopoeia**: Words that imitate sounds\n\n### Figurative Language\n- **Metaphor**: Direct comparison without "like" or "as"\n- **Simile**: Comparison using "like" or "as"\n- **Personification**: Giving human qualities to non-human things\n- **Symbolism**: Using objects to represent ideas\n\n## Types of Poetry\n\n### Traditional Forms\n- **Sonnet**: 14-line poem with specific rhyme scheme\n- **Haiku**: 3-line poem with 5-7-5 syllable pattern\n- **Limerick**: 5-line humorous poem\n- **Ballad**: Narrative poem that tells a story\n\n### Free Verse\n- **No fixed structure**: No regular meter or rhyme\n- **Natural speech patterns**: More conversational tone\n- **Modern poetry**: Popular in 20th and 21st centuries\n\n## How to Analyze Poetry\n\n### Step 1: Read Aloud\n- Listen to the rhythm and sound\n- Notice the emotional impact\n- Identify the overall mood\n\n### Step 2: Identify Structure\n- Count lines and stanzas\n- Look for rhyme patterns\n- Notice line breaks and punctuation\n\n### Step 3: Analyze Language\n- Find figurative language\n- Look for repeated words or phrases\n- Consider word choice and tone\n\n### Step 4: Interpret Meaning\n- What is the main theme?\n- What emotions does it convey?\n- What is the poet trying to say?\n\n## Common Themes in Poetry\n- **Love and relationships**\n- **Nature and the environment**\n- **Death and loss**\n- **Identity and self-discovery**\n- **Social and political issues**\n          ',readingTime:"8-12 minutes",keyPoints:["Poetry uses rhythm, rhyme, and figurative language","Different types of poetry have different structures","Analysis involves reading, structure, language, and meaning","Common themes include love, nature, and identity"]},steps:[{id:"step-1",title:"Poetic Devices",type:"multiple-choice",question:"What is a metaphor?",options:["A comparison using like or as","A direct comparison without like or as","The repetition of sounds","The pattern of stressed syllables"],correctAnswer:1,explanation:"A metaphor is a direct comparison between two unlike things without using like or as."},{id:"step-2",title:"Rhyme Scheme",type:"multiple-choice",question:"What is the rhyme scheme of a sonnet?",options:["ABAB CDCD EFEF GG","AABB CCDD EEFF GG","ABBA ABBA CDE CDE","All of the above"],correctAnswer:3,explanation:"Different types of sonnets have different rhyme schemes, including all the options listed."},{id:"step-3",title:"Simile vs Metaphor",type:"multiple-choice",question:"What is the difference between a simile and a metaphor?",options:["No difference","Simile uses like or as, metaphor does not","Metaphor is longer than simile","Simile is more poetic than metaphor"],correctAnswer:1,explanation:"A simile uses like or as to make comparisons, while a metaphor makes direct comparisons without these words."},{id:"step-4",title:"Poetry Forms",type:"multiple-choice",question:"What is a haiku?",options:["A 14-line poem","A 3-line poem with 5-7-5 syllables","A poem without rhyme","A long narrative poem"],correctAnswer:1,explanation:"A haiku is a traditional Japanese poem with 3 lines and a 5-7-5 syllable pattern."},{id:"step-5",title:"Poetry Themes",type:"multiple-choice",question:"What are common themes in poetry?",options:["Only love and romance","Love, nature, death, identity, and social issues","Only nature and animals","Only historical events"],correctAnswer:1,explanation:"Poetry explores many themes including love, nature, death, identity, and social issues."}]}}},psychology:{cognitive:{"quest-1":{id:"quest-1",title:"Cognitive Psychology",description:"Understand how the mind processes information",type:"quest",difficulty:"beginner",xpReward:105,goldReward:52,icon:"",timeEstimate:"40 min",skills:["psychological-thinking","research-methods"],requirements:[],deliverables:[{type:"cognitive-experiment",description:"Design a simple cognitive experiment",format:"text"}],resources:["Psychology textbook","Research papers","Case studies"],learningMaterial:{title:"Cognitive Psychology Fundamentals",content:"\n# Introduction to Cognitive Psychology\n\n## What is Cognitive Psychology?\nCognitive psychology is the study of mental processes including how people think, perceive, remember, and learn.\n\n## Key Mental Processes\n\n### Memory Systems\n- **Sensory Memory**: Brief storage of sensory information\n- **Short-term Memory**: Temporary storage (72 items)\n- **Long-term Memory**: Permanent storage of information\n- **Working Memory**: Active processing of information\n\n### Attention\n- **Selective Attention**: Focusing on one thing while ignoring others\n- **Divided Attention**: Paying attention to multiple things\n- **Sustained Attention**: Maintaining focus over time\n- **Attention Deficit**: Difficulty maintaining focus\n\n### Perception\n- **Bottom-up Processing**: Building perception from sensory input\n- **Top-down Processing**: Using knowledge to interpret sensations\n- **Gestalt Principles**: How we organize visual information\n- **Perceptual Illusions**: When perception doesn't match reality\n\n## Cognitive Development\n\n### Information Processing Model\n1. **Input**: Information enters the system\n2. **Processing**: Information is analyzed and interpreted\n3. **Storage**: Information is stored in memory\n4. **Output**: Information is retrieved and used\n\n### Problem-Solving Strategies\n- **Algorithm**: Step-by-step procedure\n- **Heuristic**: Mental shortcut or rule of thumb\n- **Insight**: Sudden understanding of a problem\n- **Trial and Error**: Trying different approaches\n\n## Research Methods\n\n### Experimental Design\n- **Independent Variable**: What the researcher manipulates\n- **Dependent Variable**: What is measured\n- **Control Group**: Group that doesn't receive treatment\n- **Random Assignment**: Randomly assigning participants to groups\n\n### Cognitive Tasks\n- **Memory Tests**: Recall and recognition tasks\n- **Attention Tasks**: Focus and concentration tests\n- **Problem-Solving Tasks**: Logic and reasoning tests\n- **Reaction Time**: Speed of mental processing\n\n## Applications\n\n### Education\n- **Learning Styles**: Visual, auditory, kinesthetic\n- **Memory Techniques**: Mnemonics and chunking\n- **Study Strategies**: Spaced repetition and elaboration\n\n### Technology\n- **User Interface Design**: Making technology user-friendly\n- **Human-Computer Interaction**: How people use computers\n- **Artificial Intelligence**: Modeling human cognition\n\n### Clinical Applications\n- **Cognitive Therapy**: Changing negative thought patterns\n- **Memory Training**: Improving memory function\n- **Attention Training**: Enhancing focus and concentration\n          ",readingTime:"10-15 minutes",keyPoints:["Cognitive psychology studies mental processes","Memory, attention, and perception are key areas","Research methods include experiments and tasks","Applications in education, technology, and therapy"]},steps:[{id:"step-1",title:"Memory Systems",type:"multiple-choice",question:"What are the three stages of memory?",options:["Encoding, storage, retrieval","Short-term, long-term, working","Sensory, short-term, long-term","Implicit, explicit, procedural"],correctAnswer:0,explanation:"The three stages of memory are encoding (input), storage (retention), and retrieval (output)."},{id:"step-2",title:"Attention",type:"multiple-choice",question:"What is selective attention?",options:["Paying attention to everything at once","Focusing on one thing while ignoring others","Remembering everything you see","Processing information unconsciously"],correctAnswer:1,explanation:"Selective attention is the ability to focus on one stimulus while filtering out others."},{id:"step-3",title:"Perception",type:"multiple-choice",question:"What is perception?",options:["The process of storing information","The process of interpreting sensory information","The process of forgetting information","The process of learning new skills"],correctAnswer:1,explanation:"Perception is the process of interpreting and organizing sensory information to understand the world."},{id:"step-4",title:"Problem Solving",type:"multiple-choice",question:"What is the first step in problem solving?",options:["Implementing a solution","Defining the problem","Testing the solution","Gathering resources"],correctAnswer:1,explanation:"The first step in problem solving is defining and understanding the problem clearly."},{id:"step-5",title:"Cognitive Development",type:"multiple-choice",question:"Who developed the theory of cognitive development?",options:["Sigmund Freud","Jean Piaget","B.F. Skinner","Carl Rogers"],correctAnswer:1,explanation:"Jean Piaget developed the theory of cognitive development, describing how children's thinking changes with age."}]}}},sociology:{"social-structures":{"quest-1":{id:"quest-1",title:"Social Institutions",description:"Learn about social institutions and their functions",type:"quest",difficulty:"beginner",xpReward:100,goldReward:50,icon:"",timeEstimate:"35 min",skills:["sociological-thinking","social-analysis"],requirements:[],deliverables:[{type:"social-analysis",description:"Analyze a social institution in your community",format:"text"}],resources:["Sociology textbook","Social research","Community studies"],learningMaterial:{title:"Social Institutions and Society",content:"\n# Understanding Social Institutions\n\n## What are Social Institutions?\nSocial institutions are organized patterns of beliefs and behaviors centered on basic social needs. They provide structure and stability to society.\n\n## Major Social Institutions\n\n### Family\n- **Definition**: The basic unit of society, responsible for reproduction and socialization\n- **Functions**: Child-rearing, emotional support, economic cooperation\n- **Types**: Nuclear, extended, single-parent, blended families\n- **Changes**: From traditional to modern family structures\n\n### Education\n- **Purpose**: Transmitting knowledge, skills, and cultural values\n- **Functions**: Socialization, social mobility, economic preparation\n- **Levels**: Primary, secondary, higher education\n- **Issues**: Access, quality, inequality in education\n\n### Religion\n- **Definition**: System of beliefs and practices related to the sacred\n- **Functions**: Meaning-making, social cohesion, moral guidance\n- **Types**: Monotheistic, polytheistic, non-theistic\n- **Role**: Personal spirituality and social organization\n\n### Government/Politics\n- **Purpose**: Making and enforcing laws, maintaining order\n- **Functions**: Law-making, defense, public services\n- **Types**: Democracy, authoritarianism, totalitarianism\n- **Power**: How power is distributed and exercised\n\n### Economy\n- **Definition**: System for producing, distributing, and consuming goods\n- **Functions**: Resource allocation, employment, wealth creation\n- **Types**: Capitalism, socialism, mixed economies\n- **Issues**: Inequality, unemployment, economic cycles\n\n## How Institutions Work Together\n\n### Interdependence\n- Institutions are interconnected and influence each other\n- Changes in one institution affect others\n- Example: Economic changes affect family structures\n\n### Socialization\n- Institutions teach us how to behave in society\n- They transmit cultural values and norms\n- They prepare us for different social roles\n\n### Social Control\n- Institutions maintain social order\n- They enforce rules and norms\n- They provide consequences for deviant behavior\n\n## Studying Social Institutions\n\n### Sociological Perspectives\n- **Functionalist**: How institutions contribute to social stability\n- **Conflict**: How institutions maintain inequality\n- **Symbolic Interactionist**: How people create meaning in institutions\n\n### Research Methods\n- **Surveys**: Asking people about their experiences\n- **Interviews**: In-depth conversations with individuals\n- **Observation**: Watching how institutions work in practice\n- **Historical Analysis**: Studying how institutions change over time\n          ",readingTime:"8-12 minutes",keyPoints:["Social institutions provide structure to society","Major institutions include family, education, religion, government, and economy","Institutions are interconnected and influence each other","Sociologists study institutions from different perspectives"]},steps:[{id:"step-1",title:"Social Institutions",type:"multiple-choice",question:"Which is NOT a major social institution?",options:["Family","Education","Government","Weather"],correctAnswer:3,explanation:"Family, Education, and Government are major social institutions. Weather is a natural phenomenon, not a social institution."},{id:"step-2",title:"Social Functions",type:"multiple-choice",question:"What is the primary function of education?",options:["To provide entertainment","To socialize individuals and transmit culture","To make money","To control the weather"],correctAnswer:1,explanation:"Education serves to socialize individuals and transmit cultural knowledge from one generation to the next."},{id:"step-3",title:"Social Stratification",type:"multiple-choice",question:"What is social stratification?",options:["The process of making friends","The division of society into different social classes","The study of weather patterns","The organization of schools"],correctAnswer:1,explanation:"Social stratification is the division of society into different social classes based on factors like wealth, power, and status."},{id:"step-4",title:"Social Groups",type:"multiple-choice",question:"What is a primary group?",options:["A large organization","A small, intimate group with close relationships","A group of strangers","A government agency"],correctAnswer:1,explanation:"A primary group is a small, intimate group with close, personal relationships, like family or close friends."},{id:"step-5",title:"Social Change",type:"multiple-choice",question:"What causes social change?",options:["Only natural disasters","Technological innovation, social movements, and cultural shifts","Only government decisions","Only individual choices"],correctAnswer:1,explanation:"Social change is caused by multiple factors including technological innovation, social movements, cultural shifts, and other social forces."}]}}},economics:{microeconomics:{"quest-1":{id:"quest-1",title:"Supply and Demand",description:"Understand the fundamental principles of market economics",type:"quest",difficulty:"beginner",xpReward:110,goldReward:55,icon:"",timeEstimate:"30 min",skills:["economic-thinking","market-analysis"],requirements:[],deliverables:[{type:"market-analysis",description:"Analyze supply and demand for a product",format:"text"}],resources:["Economics textbook","Market data","Case studies"],learningMaterial:{title:"Supply and Demand Fundamentals",content:"\n# Understanding Supply and Demand\n\n## What is Supply and Demand?\nSupply and demand is the fundamental economic model that explains how prices are determined in markets.\n\n## The Law of Demand\n- **Definition**: As price increases, quantity demanded decreases\n- **Reason**: People buy less when things are more expensive\n- **Graph**: Downward-sloping demand curve\n- **Example**: If pizza costs $20, fewer people will buy it than if it costs $5\n\n## The Law of Supply\n- **Definition**: As price increases, quantity supplied increases\n- **Reason**: Higher prices make it more profitable to produce\n- **Graph**: Upward-sloping supply curve\n- **Example**: If pizza sells for $20, more restaurants will want to make pizza\n\n## Market Equilibrium\n- **Definition**: Where supply and demand curves intersect\n- **Equilibrium Price**: The price where quantity supplied equals quantity demanded\n- **Equilibrium Quantity**: The amount bought and sold at equilibrium price\n- **Market Clearing**: No excess supply or demand\n\n## Factors Affecting Demand\n\n### Price of the Good\n- **Direct relationship**: Higher price = lower demand\n- **Movement along curve**: Price changes cause movement along demand curve\n\n### Other Factors (Shift the Curve)\n- **Income**: Higher income usually increases demand\n- **Tastes and Preferences**: What people like changes demand\n- **Prices of Related Goods**: Substitutes and complements\n- **Population**: More people = more demand\n- **Expectations**: Future price expectations affect current demand\n\n## Factors Affecting Supply\n\n### Price of the Good\n- **Direct relationship**: Higher price = higher supply\n- **Movement along curve**: Price changes cause movement along supply curve\n\n### Other Factors (Shift the Curve)\n- **Cost of Production**: Higher costs reduce supply\n- **Technology**: Better technology increases supply\n- **Number of Sellers**: More sellers = more supply\n- **Government Policies**: Taxes and regulations affect supply\n- **Natural Conditions**: Weather affects agricultural supply\n\n## Market Dynamics\n\n### Shortage\n- **Definition**: When demand exceeds supply at current price\n- **Result**: Prices tend to rise\n- **Example**: Popular concert tickets sell out quickly\n\n### Surplus\n- **Definition**: When supply exceeds demand at current price\n- **Result**: Prices tend to fall\n- **Example**: Too many winter coats in summer\n\n### Price Elasticity\n- **Elastic Demand**: Quantity demanded changes significantly with price\n- **Inelastic Demand**: Quantity demanded changes little with price\n- **Factors**: Availability of substitutes, necessity of good, time period\n\n## Real-World Applications\n\n### Consumer Behavior\n- Understanding why people buy certain products\n- How advertising affects demand\n- Seasonal demand patterns\n\n### Business Decisions\n- Setting prices to maximize profit\n- Deciding what to produce\n- Responding to market changes\n\n### Government Policy\n- Price controls and their effects\n- Taxes and subsidies\n- Market regulation\n          ",readingTime:"10-15 minutes",keyPoints:["Demand decreases as price increases","Supply increases as price increases","Equilibrium occurs where supply and demand intersect","Many factors can shift supply and demand curves"]},steps:[{id:"step-1",title:"Demand Curve",type:"multiple-choice",question:"What happens to demand when price increases?",options:["Demand increases","Demand decreases","Demand stays the same","Demand becomes infinite"],correctAnswer:1,explanation:"According to the law of demand, when price increases, quantity demanded decreases (and vice versa)."},{id:"step-2",title:"Market Equilibrium",type:"multiple-choice",question:"What is market equilibrium?",options:["When supply equals demand","When prices are highest","When there is no competition","When government controls prices"],correctAnswer:0,explanation:"Market equilibrium occurs when supply equals demand, determining the market price and quantity."},{id:"step-3",title:"Supply Factors",type:"multiple-choice",question:"What happens to supply when production costs increase?",options:["Supply increases","Supply decreases","Supply stays the same","Supply becomes infinite"],correctAnswer:1,explanation:"When production costs increase, suppliers are less willing to produce at the same price, so supply decreases."},{id:"step-4",title:"Price Elasticity",type:"multiple-choice",question:"What is elastic demand?",options:["Demand that never changes","Demand that changes significantly with price","Demand that is always high","Demand that is always low"],correctAnswer:1,explanation:"Elastic demand means that quantity demanded changes significantly when price changes."},{id:"step-5",title:"Market Shortages",type:"multiple-choice",question:"What happens in a market shortage?",options:["Prices tend to fall","Prices tend to rise","Supply and demand are equal","No one wants the product"],correctAnswer:1,explanation:"In a shortage, demand exceeds supply, so prices tend to rise as buyers compete for limited goods."}]}}},geography:{physical:{"quest-1":{id:"quest-1",title:"Earth's Physical Features",description:"Learn about the Earth's landforms and natural features",type:"quest",difficulty:"beginner",xpReward:90,goldReward:45,icon:"",timeEstimate:"30 min",skills:["geographical-thinking","spatial-analysis"],requirements:[],deliverables:[{type:"landform-identification",description:"Identify different landforms on a map",format:"diagram"}],resources:["Geography textbook","Maps","Satellite imagery"],learningMaterial:{title:"Earth's Physical Features and Landforms",content:"\n# Understanding Earth's Physical Geography\n\n## What is Physical Geography?\nPhysical geography studies the natural features and processes of Earth's surface, including landforms, climate, and ecosystems.\n\n## Major Landforms\n\n### Mountains\n- **Formation**: Tectonic plate collision, volcanic activity\n- **Characteristics**: High elevation, steep slopes, rocky terrain\n- **Examples**: Himalayas, Andes, Rocky Mountains\n- **Importance**: Water sources, biodiversity, recreation\n\n### Plains\n- **Formation**: Sediment deposition, erosion\n- **Characteristics**: Flat or gently rolling terrain\n- **Examples**: Great Plains, Pampas, Steppes\n- **Importance**: Agriculture, transportation, settlement\n\n### Plateaus\n- **Formation**: Uplift, volcanic activity\n- **Characteristics**: Elevated flat areas\n- **Examples**: Tibetan Plateau, Colorado Plateau\n- **Importance**: Water sources, mineral resources\n\n### Valleys\n- **Formation**: River erosion, glacial activity\n- **Characteristics**: Low areas between higher land\n- **Examples**: Grand Canyon, Rhine Valley\n- **Importance**: Transportation routes, fertile soil\n\n## Water Features\n\n### Rivers\n- **Formation**: Precipitation, snowmelt, springs\n- **Characteristics**: Flowing water, erosion and deposition\n- **Examples**: Amazon, Nile, Mississippi\n- **Importance**: Transportation, irrigation, hydroelectric power\n\n### Lakes\n- **Formation**: Glacial activity, tectonic movement, volcanic craters\n- **Characteristics**: Standing water bodies\n- **Examples**: Great Lakes, Lake Baikal, Caspian Sea\n- **Importance**: Freshwater supply, recreation, transportation\n\n### Oceans\n- **Formation**: Tectonic plate movement\n- **Characteristics**: Large saltwater bodies\n- **Examples**: Pacific, Atlantic, Indian Ocean\n- **Importance**: Climate regulation, transportation, resources\n\n## Climate and Weather\n\n### Climate Zones\n- **Tropical**: Hot and humid year-round\n- **Temperate**: Four distinct seasons\n- **Polar**: Cold year-round\n- **Desert**: Hot and dry\n- **Mediterranean**: Hot, dry summers; mild, wet winters\n\n### Weather Patterns\n- **Precipitation**: Rain, snow, sleet, hail\n- **Temperature**: Daily and seasonal variations\n- **Wind**: Global wind patterns, local breezes\n- **Storms**: Hurricanes, tornadoes, blizzards\n\n## Natural Processes\n\n### Erosion\n- **Water Erosion**: Rivers, rain, waves\n- **Wind Erosion**: Sand and dust movement\n- **Glacial Erosion**: Ice movement and melting\n- **Effects**: Landform changes, soil loss\n\n### Deposition\n- **River Deposition**: Deltas, floodplains\n- **Wind Deposition**: Sand dunes, loess\n- **Glacial Deposition**: Moraines, till\n- **Effects**: New landforms, fertile soil\n\n### Tectonic Activity\n- **Plate Movement**: Continental drift\n- **Earthquakes**: Sudden ground movement\n- **Volcanoes**: Magma and ash eruption\n- **Effects**: Mountain building, landform creation\n\n## Human Impact\n\n### Environmental Changes\n- **Deforestation**: Loss of forest cover\n- **Urbanization**: City growth and expansion\n- **Pollution**: Air, water, and soil contamination\n- **Climate Change**: Global temperature increase\n\n### Conservation\n- **Protected Areas**: National parks, wildlife reserves\n- **Sustainable Development**: Balancing growth and environment\n- **Renewable Energy**: Solar, wind, hydroelectric power\n- **Environmental Policies**: Laws and regulations\n          ",readingTime:"8-12 minutes",keyPoints:["Physical geography studies Earth's natural features","Major landforms include mountains, plains, plateaus, and valleys","Water features include rivers, lakes, and oceans","Natural processes like erosion and deposition shape the landscape"]},steps:[{id:"step-1",title:"Landforms",type:"multiple-choice",question:"What is the highest type of landform?",options:["Hill","Mountain","Plateau","Valley"],correctAnswer:1,explanation:"Mountains are the highest landforms, typically rising more than 1,000 feet above surrounding land."},{id:"step-2",title:"Water Bodies",type:"multiple-choice",question:"What is the largest ocean?",options:["Atlantic","Pacific","Indian","Arctic"],correctAnswer:1,explanation:"The Pacific Ocean is the largest ocean, covering more than 30% of Earth's surface."},{id:"step-3",title:"Climate Zones",type:"multiple-choice",question:"What characterizes a tropical climate?",options:["Four distinct seasons","Hot and humid year-round","Cold year-round","Hot and dry"],correctAnswer:1,explanation:"Tropical climates are characterized by hot and humid conditions year-round with little seasonal variation."},{id:"step-4",title:"Natural Processes",type:"multiple-choice",question:"What is erosion?",options:["The building up of landforms","The wearing away of landforms by natural forces","The creation of mountains","The formation of rivers"],correctAnswer:1,explanation:"Erosion is the process of wearing away landforms by natural forces like water, wind, and ice."},{id:"step-5",title:"Tectonic Activity",type:"multiple-choice",question:"What causes earthquakes?",options:["Weather changes","Movement of tectonic plates","Ocean currents","Wind patterns"],correctAnswer:1,explanation:"Earthquakes are caused by the movement and interaction of tectonic plates beneath Earth's surface."}]}}},art:{painting:{"quest-1":{id:"quest-1",title:"Art History and Techniques",description:"Explore different art movements and painting techniques",type:"quest",difficulty:"beginner",xpReward:85,goldReward:42,icon:"",timeEstimate:"35 min",skills:["artistic-thinking","visual-analysis"],requirements:[],deliverables:[{type:"art-analysis",description:"Analyze a famous painting",format:"text"}],resources:["Art history book","Museum collections","Artist biographies"],learningMaterial:{title:"Art History and Visual Techniques",content:"\n# Understanding Art History and Techniques\n\n## What is Art?\nArt is the expression of human creativity and imagination through visual, auditory, or performance forms.\n\n## Major Art Movements\n\n### Renaissance (1400-1600)\n- **Characteristics**: Realistic representation, perspective, humanism\n- **Key Artists**: Leonardo da Vinci, Michelangelo, Raphael\n- **Techniques**: Oil painting, chiaroscuro, linear perspective\n- **Famous Works**: Mona Lisa, Sistine Chapel ceiling\n\n### Impressionism (1860-1880)\n- **Characteristics**: Capturing light and color, loose brushstrokes\n- **Key Artists**: Claude Monet, Pierre-Auguste Renoir, Edgar Degas\n- **Techniques**: Plein air painting, broken color, visible brushstrokes\n- **Famous Works**: Water Lilies, Luncheon of the Boating Party\n\n### Post-Impressionism (1880-1900)\n- **Characteristics**: Emotional expression, bold colors, geometric forms\n- **Key Artists**: Vincent van Gogh, Paul Czanne, Paul Gauguin\n- **Techniques**: Thick paint application, bold color choices\n- **Famous Works**: Starry Night, The Card Players\n\n### Modern Art (1900-1970)\n- **Characteristics**: Breaking traditional rules, experimentation\n- **Key Artists**: Pablo Picasso, Henri Matisse, Jackson Pollock\n- **Techniques**: Cubism, abstract expressionism, collage\n- **Famous Works**: Les Demoiselles d'Avignon, Guernica\n\n## Art Techniques\n\n### Drawing\n- **Pencil**: Graphite, charcoal, colored pencils\n- **Ink**: Pen and ink, brush and ink, markers\n- **Paper**: Different textures and weights\n- **Methods**: Hatching, cross-hatching, stippling\n\n### Painting\n- **Watercolor**: Transparent, fluid, quick-drying\n- **Oil**: Rich colors, slow-drying, blendable\n- **Acrylic**: Fast-drying, versatile, water-soluble\n- **Tempera**: Egg-based, matte finish, traditional\n\n### Sculpture\n- **Materials**: Stone, wood, metal, clay, glass\n- **Methods**: Carving, modeling, casting, assembling\n- **Techniques**: Relief, in-the-round, installation\n- **Tools**: Chisels, hammers, files, welding equipment\n\n### Digital Art\n- **Software**: Photoshop, Illustrator, Procreate\n- **Tablets**: Drawing tablets, stylus pens\n- **Techniques**: Digital painting, vector graphics, 3D modeling\n- **Advantages**: Undo function, layers, infinite colors\n\n## Elements of Art\n\n### Line\n- **Definition**: A mark made by a moving point\n- **Types**: Straight, curved, thick, thin, broken\n- **Functions**: Outline, texture, movement, direction\n\n### Shape\n- **Definition**: A two-dimensional area with boundaries\n- **Types**: Geometric (circles, squares) and organic (natural forms)\n- **Functions**: Composition, balance, emphasis\n\n### Color\n- **Primary**: Red, blue, yellow (cannot be mixed)\n- **Secondary**: Green, orange, purple (mixed from primaries)\n- **Warm Colors**: Red, orange, yellow (energy, warmth)\n- **Cool Colors**: Blue, green, purple (calm, distance)\n\n### Texture\n- **Definition**: The surface quality of an object\n- **Types**: Rough, smooth, bumpy, soft, hard\n- **Methods**: Actual texture (real) and implied texture (visual)\n\n### Space\n- **Positive Space**: The subject or objects in artwork\n- **Negative Space**: The empty areas around objects\n- **Perspective**: Creating depth and dimension\n- **Overlap**: Objects in front of others\n\n## Principles of Design\n\n### Balance\n- **Symmetrical**: Equal weight on both sides\n- **Asymmetrical**: Unequal but balanced composition\n- **Radial**: Elements arranged around a center point\n\n### Emphasis\n- **Focal Point**: The main area of interest\n- **Methods**: Color, size, contrast, placement\n- **Purpose**: Directing the viewer's attention\n\n### Movement\n- **Definition**: The path the eye follows through artwork\n- **Methods**: Lines, shapes, colors, repetition\n- **Types**: Actual movement (kinetic art) and implied movement\n\n### Unity\n- **Definition**: All elements working together harmoniously\n- **Methods**: Repetition, similarity, proximity\n- **Purpose**: Creating a cohesive composition\n          ",readingTime:"10-15 minutes",keyPoints:["Art movements reflect historical and cultural changes","Different techniques use various materials and methods","Elements of art are the building blocks of visual composition","Principles of design guide how elements are arranged"]},steps:[{id:"step-1",title:"Art Movements",type:"multiple-choice",question:"Which art movement is known for its emphasis on light and color?",options:["Cubism","Impressionism","Surrealism","Abstract Expressionism"],correctAnswer:1,explanation:"Impressionism is known for its emphasis on capturing light and color in outdoor scenes."},{id:"step-2",title:"Painting Techniques",type:"multiple-choice",question:"What is chiaroscuro?",options:["A type of brush","The use of light and dark contrast","A color mixing technique","A canvas preparation method"],correctAnswer:1,explanation:"Chiaroscuro is the use of light and dark contrast to create depth and volume in painting."},{id:"step-3",title:"Elements of Art",type:"multiple-choice",question:"What are the primary colors?",options:["Red, blue, green","Red, blue, yellow","Orange, purple, green","Black, white, gray"],correctAnswer:1,explanation:"The primary colors are red, blue, and yellow - they cannot be created by mixing other colors."},{id:"step-4",title:"Principles of Design",type:"multiple-choice",question:"What is balance in art?",options:["The use of bright colors","The distribution of visual weight in a composition","The size of the artwork","The speed of creating art"],correctAnswer:1,explanation:"Balance is the distribution of visual weight in a composition, creating a sense of stability."},{id:"step-5",title:"Art History",type:"multiple-choice",question:"Who painted the Mona Lisa?",options:["Vincent van Gogh","Leonardo da Vinci","Pablo Picasso","Michelangelo"],correctAnswer:1,explanation:"Leonardo da Vinci painted the Mona Lisa, one of the most famous paintings in the world."}]}}},music:{theory:{"quest-1":{id:"quest-1",title:"Music Theory Fundamentals",description:"Learn the basics of music theory and notation",type:"quest",difficulty:"beginner",xpReward:95,goldReward:47,icon:"",timeEstimate:"40 min",skills:["musical-thinking","aural-skills"],requirements:[],deliverables:[{type:"music-composition",description:"Write a simple melody",format:"notation"}],resources:["Music theory book","Piano/keyboard","Notation software"],learningMaterial:{title:"Music Theory Fundamentals",content:"\n# Understanding Music Theory\n\n## What is Music Theory?\nMusic theory is the study of how music works, including the principles and practices of musical composition and performance.\n\n## Musical Notes and Scales\n\n### The Musical Alphabet\n- **Notes**: A, B, C, D, E, F, G (then repeats)\n- **Sharps (#)**: Raise a note by half step\n- **Flats (b)**: Lower a note by half step\n- **Natural ()**: Cancel a sharp or flat\n\n### Major Scales\n- **Pattern**: Whole-Whole-Half-Whole-Whole-Whole-Half\n- **C Major**: C-D-E-F-G-A-B-C (all white keys)\n- **G Major**: G-A-B-C-D-E-F#-G (one sharp)\n- **F Major**: F-G-A-Bb-C-D-E-F (one flat)\n\n### Minor Scales\n- **Natural Minor**: Same pattern as major, starting on different note\n- **Harmonic Minor**: Raised 7th note\n- **Melodic Minor**: Raised 6th and 7th ascending, natural descending\n\n## Intervals and Chords\n\n### Intervals\n- **Unison**: Same note (C to C)\n- **Second**: Two notes apart (C to D)\n- **Third**: Three notes apart (C to E)\n- **Perfect Fourth**: Four notes apart (C to F)\n- **Perfect Fifth**: Five notes apart (C to G)\n- **Octave**: Eight notes apart (C to C)\n\n### Triads (Three-Note Chords)\n- **Major Triad**: Root, major third, perfect fifth (C-E-G)\n- **Minor Triad**: Root, minor third, perfect fifth (C-Eb-G)\n- **Diminished Triad**: Root, minor third, diminished fifth (C-Eb-Gb)\n- **Augmented Triad**: Root, major third, augmented fifth (C-E-G#)\n\n### Seventh Chords\n- **Major 7th**: Major triad + major 7th (C-E-G-B)\n- **Minor 7th**: Minor triad + minor 7th (C-Eb-G-Bb)\n- **Dominant 7th**: Major triad + minor 7th (C-E-G-Bb)\n- **Half-Diminished**: Diminished triad + minor 7th (C-Eb-Gb-Bb)\n\n## Rhythm and Time\n\n### Note Values\n- **Whole Note**: 4 beats (semibreve)\n- **Half Note**: 2 beats (minim)\n- **Quarter Note**: 1 beat (crotchet)\n- **Eighth Note**: 1/2 beat (quaver)\n- **Sixteenth Note**: 1/4 beat (semiquaver)\n\n### Time Signatures\n- **4/4 Time**: 4 beats per measure, quarter note gets 1 beat\n- **3/4 Time**: 3 beats per measure (waltz time)\n- **2/4 Time**: 2 beats per measure (march time)\n- **6/8 Time**: 6 eighth notes per measure (compound time)\n\n### Tempo\n- **Largo**: Very slow (40-60 BPM)\n- **Andante**: Walking pace (76-108 BPM)\n- **Moderato**: Moderate (108-120 BPM)\n- **Allegro**: Fast (120-168 BPM)\n- **Presto**: Very fast (168-200 BPM)\n\n## Musical Forms\n\n### Binary Form (A-B)\n- **A Section**: First musical idea\n- **B Section**: Contrasting musical idea\n- **Example**: Many folk songs and dances\n\n### Ternary Form (A-B-A)\n- **A Section**: First musical idea\n- **B Section**: Contrasting middle section\n- **A Section**: Return of first idea (often varied)\n- **Example**: Many classical minuets\n\n### Sonata Form\n- **Exposition**: Present main themes\n- **Development**: Develop and transform themes\n- **Recapitulation**: Restate themes in original key\n- **Example**: First movements of symphonies\n\n## Harmony and Key Relationships\n\n### Circle of Fifths\n- **Purpose**: Shows relationships between keys\n- **Clockwise**: Each key is a fifth higher\n- **Sharps**: Keys with sharps increase clockwise\n- **Flats**: Keys with flats increase counterclockwise\n\n### Chord Progressions\n- **I-V-vi-IV**: Common pop progression (C-G-Am-F)\n- **ii-V-I**: Jazz progression (Dm-G-C)\n- **I-vi-IV-V**: 50s progression (C-Am-F-G)\n- **Function**: How chords work together harmonically\n\n## Musical Instruments\n\n### String Instruments\n- **Violin**: Highest pitched, four strings\n- **Viola**: Slightly lower than violin\n- **Cello**: Lower pitched, held between knees\n- **Double Bass**: Lowest pitched, largest\n\n### Wind Instruments\n- **Woodwinds**: Flute, clarinet, oboe, bassoon\n- **Brass**: Trumpet, trombone, French horn, tuba\n- **Reed Instruments**: Use reeds to produce sound\n- **Valve Instruments**: Use valves to change pitch\n\n### Percussion\n- **Pitched**: Xylophone, timpani, piano\n- **Non-pitched**: Snare drum, cymbals, triangle\n- **Rhythm**: Provide rhythmic foundation\n- **Color**: Add timbral variety\n          ",readingTime:"12-18 minutes",keyPoints:["Music theory explains how music works","Scales and chords are the building blocks of harmony","Rhythm and time signatures organize musical time","Different forms provide structure to musical pieces"]},steps:[{id:"step-1",title:"Musical Notes",type:"multiple-choice",question:"How many notes are in a major scale?",options:["5","7","8","12"],correctAnswer:1,explanation:"A major scale consists of 7 different notes, typically arranged in a specific pattern of whole and half steps."},{id:"step-2",title:"Time Signatures",type:"multiple-choice",question:"What does 4/4 time signature mean?",options:["4 beats per measure, quarter note gets 1 beat","4 measures per song","4 different instruments","4 minutes long"],correctAnswer:0,explanation:"4/4 time signature means 4 beats per measure, with the quarter note receiving 1 beat."},{id:"step-3",title:"Major Scales",type:"multiple-choice",question:"What is the pattern for a major scale?",options:["Whole-Whole-Half-Whole-Whole-Whole-Half","Half-Whole-Half-Whole-Half-Whole-Half","Whole-Half-Whole-Whole-Half-Whole-Whole","All whole steps"],correctAnswer:0,explanation:"The major scale pattern is Whole-Whole-Half-Whole-Whole-Whole-Half (W-W-H-W-W-W-H)."},{id:"step-4",title:"Intervals",type:"multiple-choice",question:"What is a perfect fifth?",options:["Two notes that are the same","Five notes apart in the scale","The interval between C and G","A chord with five notes"],correctAnswer:2,explanation:"A perfect fifth is the interval between C and G (or any note and the note five steps up the scale)."},{id:"step-5",title:"Chords",type:"multiple-choice",question:"What is a major triad?",options:["Three notes played together","A chord with a root, major third, and perfect fifth","A chord with only major notes","A chord with four notes"],correctAnswer:1,explanation:"A major triad consists of a root note, a major third (4 semitones up), and a perfect fifth (7 semitones up)."}]}}},philosophy:{ethics:{"quest-1":{id:"quest-1",title:"Introduction to Ethics",description:"Explore fundamental ethical theories and moral reasoning",type:"quest",difficulty:"beginner",xpReward:100,goldReward:50,icon:"",timeEstimate:"35 min",skills:["ethical-reasoning","critical-thinking"],requirements:[],deliverables:[{type:"ethical-analysis",description:"Analyze a moral dilemma using ethical theories",format:"text"}],resources:["Ethics textbook","Philosophical readings","Case studies"],learningMaterial:{title:"Introduction to Utilitarianism",content:"\n# Utilitarian Ethics\n\n## What is Utilitarianism?\nUtilitarianism is an ethical theory that judges the moral value of actions based on their consequences, particularly their impact on overall happiness.\n\n## Core Principles\n\n### 1. Greatest Happiness Principle\n- Actions are right if they promote the greatest happiness\n- Consider the interests of all affected parties\n- Pursue the maximization of overall welfare\n\n### 2. Consequentialism\n- The moral value of actions depends entirely on their results\n- Motives and intentions are not the primary criteria for moral judgment\n- The goodness of outcomes determines the rightness of actions\n\n## Key Thinkers\n\n### Jeremy Bentham\n- Founder of utilitarianism\n- Proposed \"greatest happiness for the greatest number\"\n- Emphasized quantitative calculation of pleasure and pain\n\n### John Stuart Mill\n- Developed Bentham's theory\n- Distinguished between higher and lower pleasures\n- Emphasized the importance of individual liberty\n\n## Types of Utilitarianism\n\n### 1. Act Utilitarianism\n- Each action is judged by its specific consequences\n- Direct calculation of each action's utility\n\n### 2. Rule Utilitarianism\n- Actions are judged by the consequences of following rules\n- Considers the general utility of rules\n\n## Practical Applications\n\n### Medical Ethics\n- Resource allocation: How to distribute limited medical resources\n- Euthanasia: Moral considerations for relieving suffering\n\n### Public Policy\n- Cost-benefit analysis\n- Social welfare policy development\n\n## Criticisms and Responses\n\n### Main Criticisms\n1. **Justice Problem**: May sacrifice minority interests\n2. **Calculation Difficulty**: Hard to accurately calculate consequences\n3. **Rights Neglect**: May ignore individual rights\n\n### Utilitarian Responses\n1. Consideration of long-term consequences\n2. Importance of rules\n3. Balance between rights and utility\n          ",readingTime:"8-12 minutes",keyPoints:["Core principles of utilitarianism","Key ideas of Bentham and Mill","Act vs Rule utilitarianism","Practical applications and criticisms"]},steps:[{id:"step-1",title:"Utilitarianism Basics",type:"multiple-choice",question:"What is utilitarianism?",options:["A theory that focuses on individual rights","A theory that judges actions by their consequences","A theory that emphasizes duty and obligation","A theory that prioritizes personal virtue"],correctAnswer:1,explanation:"Utilitarianism is a consequentialist theory that judges the morality of actions based on their outcomes and consequences."},{id:"step-2",title:"Greatest Happiness Principle",type:"multiple-choice",question:"What is the greatest happiness principle?",options:["Actions are right if they promote individual happiness","Actions are right if they promote the greatest happiness for the greatest number","Actions are right if they follow moral rules","Actions are right if they demonstrate virtue"],correctAnswer:1,explanation:"The greatest happiness principle states that actions are right if they promote the greatest happiness for the greatest number of people."},{id:"step-3",title:"Deontological Ethics",type:"multiple-choice",question:"What is deontological ethics?",options:["Ethics based on consequences","Ethics based on duties and rules","Ethics based on character","Ethics based on divine commands"],correctAnswer:1,explanation:"Deontological ethics is based on duties and rules, where actions are right or wrong based on their adherence to moral rules, regardless of consequences."},{id:"step-4",title:"Virtue Ethics",type:"multiple-choice",question:"What is the focus of virtue ethics?",options:["Following rules and duties","Consequences of actions","Character and moral virtues","Divine commands"],correctAnswer:2,explanation:"Virtue ethics focuses on developing good character traits and moral virtues rather than following rules or calculating consequences."},{id:"step-5",title:"Moral Dilemmas",type:"multiple-choice",question:"What is a moral dilemma?",options:["A situation with no moral implications","A situation where moral principles conflict","A situation with only one right answer","A situation involving only good outcomes"],correctAnswer:1,explanation:"A moral dilemma is a situation where two or more moral principles or values conflict, making it difficult to determine the right course of action."}]}}},biology:{"cell-biology":{"quest-1":{id:"quest-1",title:"Cell Structure and Function",description:"Learn about the basic structure and function of cells",type:"quest",difficulty:"beginner",xpReward:110,goldReward:55,icon:"",timeEstimate:"40 min",skills:["scientific-thinking","biological-understanding"],requirements:[],deliverables:[{type:"cell-diagram",description:"Draw and label a plant cell",format:"diagram"}],resources:["Biology textbook","Microscope images","Interactive models"],learningMaterial:{title:"Cell Structure and Function",content:"\n# Cells: The Basic Unit of Life\n\n## Cell Theory\n1. All living things are composed of cells\n2. Cells are the basic unit of life\n3. New cells come from existing cells\n\n## Basic Cell Structure\n\n### 1. Cell Membrane\n- **Function**: Controls what enters and leaves the cell\n- **Structure**: Phospholipid bilayer\n- **Feature**: Selectively permeable\n\n### 2. Cytoplasm\n- **Function**: Main site of cellular metabolism\n- **Composition**: Organelles and cytosol\n- **Feature**: Semi-fluid state\n\n### 3. Nucleus\n- **Function**: Controls cell activities and heredity\n- **Structure**: Nuclear membrane, nucleolus, chromatin\n- **Feature**: Unique to eukaryotic cells\n\n## Important Organelles\n\n### Mitochondria\n- **Function**: Cellular respiration, ATP production\n- **Structure**: Double membrane, folded inner membrane\n- **Feature**: Has its own DNA\n\n### Chloroplasts (Plant cells)\n- **Function**: Photosynthesis\n- **Structure**: Double membrane, contains chlorophyll\n- **Feature**: Converts light energy to chemical energy\n\n### Endoplasmic Reticulum\n- **Function**: Protein synthesis and transport\n- **Types**: Rough ER, Smooth ER\n- **Feature**: Connected to nuclear membrane\n\n### Golgi Apparatus\n- **Function**: Protein processing and secretion\n- **Structure**: Stacked flattened vesicles\n- **Feature**: Works with ER\n\n## Cell Types\n\n### Prokaryotic Cells\n- **Features**: No nuclear membrane, no organelles\n- **Examples**: Bacteria, cyanobacteria\n- **Size**: Usually smaller\n\n### Eukaryotic Cells\n- **Features**: Has nuclear membrane, has organelles\n- **Examples**: Plant and animal cells\n- **Size**: Usually larger\n\n## Cell Division\n\n### Mitosis\n- **Process**: Interphase, prophase, metaphase, anaphase, telophase\n- **Result**: Two identical daughter cells\n- **Purpose**: Growth and repair\n\n### Meiosis\n- **Process**: Two consecutive divisions\n- **Result**: Four different daughter cells\n- **Purpose**: Formation of reproductive cells\n          ",readingTime:"10-15 minutes",keyPoints:["Basic principles of cell theory","Functions of cell membrane, cytoplasm, and nucleus","Roles of important organelles","Differences between prokaryotic and eukaryotic cells"]},steps:[{id:"step-1",title:"Cell Theory",type:"multiple-choice",question:"What is the powerhouse of the cell?",options:["Nucleus","Mitochondria","Ribosomes","Golgi apparatus"],correctAnswer:1,explanation:"Mitochondria are often called the powerhouse of the cell because they produce ATP, the energy currency of the cell."},{id:"step-2",title:"Cell Organelles",type:"multiple-choice",question:"Which organelle is responsible for photosynthesis in plant cells?",options:["Mitochondria","Chloroplasts","Nucleus","Endoplasmic reticulum"],correctAnswer:1,explanation:"Chloroplasts contain chlorophyll and are responsible for photosynthesis in plant cells."},{id:"step-3",title:"Cell Membrane",type:"multiple-choice",question:"What is the function of the cell membrane?",options:["To produce energy","To control what enters and leaves the cell","To store genetic material","To perform photosynthesis"],correctAnswer:1,explanation:"The cell membrane controls what enters and leaves the cell, maintaining homeostasis and protecting the cell."},{id:"step-4",title:"Prokaryotic vs Eukaryotic",type:"multiple-choice",question:"What is the main difference between prokaryotic and eukaryotic cells?",options:["Size difference","Eukaryotic cells have a nucleus, prokaryotic cells do not","Prokaryotic cells are more complex","No difference"],correctAnswer:1,explanation:"The main difference is that eukaryotic cells have a membrane-bound nucleus, while prokaryotic cells do not."},{id:"step-5",title:"Cell Division",type:"multiple-choice",question:"What process creates new cells?",options:["Photosynthesis","Cellular respiration","Cell division (mitosis)","Protein synthesis"],correctAnswer:2,explanation:"Cell division, specifically mitosis, is the process by which cells reproduce and create new cells."}]}}}},ea=async(e,t,s)=>{try{if(Zr[e]&&Zr[e][t]&&Zr[e][t][s])return console.log(":",Zr[e][t][s]),Zr[e][t][s];const r=await(async(e,t,s)=>{try{return(await Xr({subject:e,category:t,questId:s})).quest||null}catch(r){return console.error("Error fetching quest:",r),null}})(e,t,s);return r?(console.log(":",r),r):null}catch(r){return console.error("Error getting quest data:",r),null}},ta=async e=>{try{console.log("Getting user quest progress for userId:",e);const t=u(dt,"studyprogress",e),s=await m(t);if(s.exists()){const e=s.data();return console.log("User progress found in Firebase studyprogress:",e),e}{console.log("No user progress found in Firebase studyprogress, creating new");const e={totalXP:0,gold:0,completedQuests:[],currentLevel:1,skills:{},achievements:[],questHistory:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};return await h(t,e),console.log("New user progress created in studyprogress collection"),e}}catch(t){return console.error("Error getting user quest progress:",t),{totalXP:0,gold:0,completedQuests:[],currentLevel:1,skills:{},achievements:[]}}},sa={experienceRequired:e=>e<=1?0:Math.floor(100*Math.pow(e-1,1.5)),calculateLevel:e=>{let t=1;for(;sa.experienceRequired(t+1)<=e;)t++;return t},calculateLevelProgress:e=>{const t=sa.calculateLevel(e),s=sa.experienceRequired(t),r=e-s,a=sa.experienceRequired(t+1)-s;return{currentLevel:t,nextLevel:t+1,progressXP:r,requiredXP:a,progressPercentage:Math.round(r/a*100)}},getLevelRewards:e=>{const t={gold:50*e,skillPoints:Math.floor(e/2),achievements:[]};return e>=5&&t.achievements.push("level_5"),e>=10&&t.achievements.push("level_10"),e>=20&&t.achievements.push("level_20"),e>=30&&t.achievements.push("level_30"),e>=50&&t.achievements.push("level_50"),t}},ra=async(e,t)=>{try{console.log("Updating user level for userId:",e,"newTotalXP:",t);const s=sa.calculateLevelProgress(t),r=sa.getLevelRewards(s.currentLevel),a=await ta(e),n=a.currentLevel||1,i=s.currentLevel,o=i>n,l={...a,totalXP:t,currentLevel:i,levelProgress:s,updatedAt:(new Date).toISOString(),gold:a.gold||0};o&&(l.achievements=[...l.achievements||[],...r.achievements],console.log(` User leveled up! Level ${n}  ${i}`),console.log(" No gold reward on level up - gold remains:",l.gold));const c=u(dt,"studyprogress",e);await h(c,l,{merge:!0});const d=await Qr(e,l);return d.newAchievements.length>0&&(l.achievements=d.allAchievements,await h(c,l,{merge:!0})),console.log("User level updated successfully"),{...l,leveledUp:o,levelRewards:o?r:null,newAchievements:d.newAchievements}}catch(s){throw console.error("Error updating user level:",s),s}},aa=()=>U.jsxs("div",{className:"bg-gray-50",children:[U.jsxs("section",{className:"relative py-12 bg-gradient-to-br from-blue-50 via-white to-purple-50 overflow-hidden",children:[U.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-5"}),U.jsxs("div",{className:"relative max-w-6xl mx-auto px-4 text-center",children:[U.jsx("div",{className:"inline-flex items-center px-4 py-2 bg-white/60 backdrop-blur-sm rounded-full border border-gray-200 mb-8",children:U.jsx("span",{className:"text-sm font-medium text-gray-600",children:" A platform for students to learn together"})}),U.jsxs("h1",{className:"text-4xl md:text-6xl font-bold text-gray-900 mb-6 leading-tight",children:["Learn Together,",U.jsxs("span",{className:"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:[" ","Achieve More"]})]}),U.jsx("p",{className:"text-xl text-gray-600 mb-8 max-w-3xl mx-auto leading-relaxed",children:"Connect with fellow students for peer tutoring, use focus tools to stay concentrated, and complete study missions to track your progress."}),U.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[U.jsx(st,{to:"/register",className:"btn-primary text-lg px-8 py-4",children:"Start Learning Today"}),U.jsx(st,{to:"/tutoring",className:"btn-secondary text-lg px-8 py-4",children:"Explore Tutors"})]})]})]}),U.jsx("section",{className:"py-12 bg-white",children:U.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[U.jsxs("div",{className:"text-center mb-10",children:[U.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Everything You Need to Succeed"}),U.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Powerful tools designed to help you learn more effectively and achieve your academic goals"})]}),U.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:[{title:"Peer Tutoring",description:"Connect with fellow students for personalized help and collaborative learning",icon:"",color:"from-blue-500 to-blue-600"},{title:"Focus Mode",description:"Block distracting apps and websites to maintain concentration during study sessions",icon:"",color:"from-green-500 to-green-600"},{title:"Study Missions",description:"Complete daily challenges and earn rewards to stay motivated and track progress",icon:"",color:"from-purple-500 to-purple-600"}].map((e,t)=>U.jsxs("div",{className:"card-elevated group",children:[U.jsx("div",{className:`w-16 h-16 bg-gradient-to-r ${e.color} rounded-2xl flex items-center justify-center mx-auto mb-6 text-2xl shadow-lg group-hover:scale-110 transition-transform duration-300`,children:e.icon}),U.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4 text-center",children:e.title}),U.jsx("p",{className:"text-gray-600 text-center leading-relaxed",children:e.description})]},t))})]})}),U.jsx("section",{className:"py-12 bg-gray-50",children:U.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[U.jsxs("div",{className:"text-center mb-10",children:[U.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"How Studiply Works"}),U.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Get started in three simple steps and begin your learning journey today"})]}),U.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[U.jsxs("div",{className:"text-center group",children:[U.jsxs("div",{className:"relative mb-8",children:[U.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto shadow-lg group-hover:scale-110 transition-transform duration-300",children:U.jsx("span",{className:"text-2xl font-bold text-white",children:"1"})}),U.jsx("div",{className:"hidden md:block absolute top-10 left-full w-full h-0.5 bg-gradient-to-r from-blue-200 to-transparent"})]}),U.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Sign Up"}),U.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Create your free account and set up your profile in minutes"})]}),U.jsxs("div",{className:"text-center group",children:[U.jsxs("div",{className:"relative mb-8",children:[U.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-green-500 to-green-600 rounded-full flex items-center justify-center mx-auto shadow-lg group-hover:scale-110 transition-transform duration-300",children:U.jsx("span",{className:"text-2xl font-bold text-white",children:"2"})}),U.jsx("div",{className:"hidden md:block absolute top-10 left-full w-full h-0.5 bg-gradient-to-r from-green-200 to-transparent"})]}),U.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Connect & Learn"}),U.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Find tutors, join study groups, or get help with your homework"})]}),U.jsxs("div",{className:"text-center group",children:[U.jsx("div",{className:"relative mb-8",children:U.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-purple-500 to-purple-600 rounded-full flex items-center justify-center mx-auto shadow-lg group-hover:scale-110 transition-transform duration-300",children:U.jsx("span",{className:"text-2xl font-bold text-white",children:"3"})})}),U.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Achieve Goals"}),U.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Track your progress and unlock achievements as you learn"})]})]})]})}),U.jsxs("section",{className:"py-12 bg-gradient-to-r from-blue-600 to-purple-600 relative overflow-hidden",children:[U.jsx("div",{className:"absolute inset-0 bg-black/10"}),U.jsxs("div",{className:"relative max-w-4xl mx-auto px-4 text-center",children:[U.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-6",children:"Ready to Start Learning?"}),U.jsx("p",{className:"text-xl text-blue-100 mb-8 max-w-2xl mx-auto leading-relaxed",children:"Create your account and start connecting with other students for collaborative learning"}),U.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[U.jsx(st,{to:"/register",className:"bg-white text-blue-600 hover:bg-gray-50 font-semibold py-4 px-8 rounded-lg text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200",children:"Get Started Free"}),U.jsx(st,{to:"/tutoring",className:"border-2 border-white text-white hover:bg-white hover:text-blue-600 font-semibold py-4 px-8 rounded-lg text-lg transition-all duration-200",children:"Browse Tutors"})]})]})]})]}),na={},ia=function(e,t,s){if(!t||0===t.length)return e();const r=document.getElementsByTagName("link");return Promise.all(t.map(e=>{if((e=function(e){return"/"+e}(e))in na)return;na[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(!!s)for(let s=r.length-1;s>=0;s--){const a=r[s];if(a.href===e&&(!t||"stylesheet"===a.rel))return}else if(document.querySelector(`link[href="${e}"]${a}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script",n.crossOrigin=""),n.href=e,document.head.appendChild(n),t?new Promise((t,s)=>{n.addEventListener("load",t),n.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0})).then(()=>e()).catch(e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e})},oa=()=>{const t=qe(),{user:s,reloadUser:r}=Br(),{isDark:a}=mt(),{showSuccess:n,showError:i}=Hr(),[o,l]=e.useState(!1),[c,d]=e.useState({subjects:"",experience:"",description:"",availability:"",hourlyRate:""}),u=e=>{const{name:t,value:s}=e.target;d(e=>({...e,[t]:s}))};return U.jsxs("div",{className:"min-h-screen relative overflow-hidden "+(a?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:[U.jsx("style",{children:"\n        .hide-scrollbar::-webkit-scrollbar { width: 0; height: 0; }\n        .hide-scrollbar { scrollbar-width: none; }\n      "}),U.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[U.jsx("div",{className:"absolute -top-36 left-1/2 h-96 w-96 -translate-x-1/2 rounded-full bg-purple-500/30 blur-3xl animate-pulse"}),U.jsx("div",{className:"absolute top-1/2 right-12 h-80 w-80 rounded-full bg-pink-400/25 blur-[120px] animate-pulse",style:{animationDelay:"1s"}}),U.jsx("div",{className:"absolute bottom-10 left-10 h-72 w-72 rounded-full bg-blue-400/20 blur-[120px] animate-pulse",style:{animationDelay:"2s"}}),U.jsx("div",{className:"absolute top-1/4 left-1/4 h-64 w-64 rounded-full bg-indigo-400/15 blur-[100px] animate-pulse",style:{animationDelay:"0.5s"}})]}),U.jsxs("div",{className:"relative z-10 mx-auto flex w-full max-w-7xl flex-col gap-16 px-6 py-20 hide-scrollbar",children:[U.jsxs("section",{className:"text-center mt-8",children:[U.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-purple-500/10 px-4 py-2 text-xs font-semibold text-purple-500 mb-6",children:[U.jsx(nr,{className:"h-4 w-4"})," Transform your learning journey"]}),U.jsx("h1",{className:"text-6xl md:text-7xl lg:text-8xl font-black mb-6 tracking-tight "+(a?"bg-gradient-to-r from-purple-300 via-pink-300 to-blue-300 bg-clip-text text-transparent":"bg-gradient-to-r from-purple-700 via-pink-600 to-blue-700 bg-clip-text text-transparent"),children:"Welcome to Studiply"}),U.jsxs("p",{className:"text-xl md:text-2xl mb-12 max-w-3xl mx-auto leading-relaxed "+(a?"text-white/80":"text-slate-700"),children:["Connect with experienced students and get personalized help with your studies.",U.jsx("br",{}),U.jsx("span",{className:"font-semibold",children:"Learn together, grow together."})]}),U.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[U.jsxs("button",{onClick:()=>{t(s?"/tutoring":"/login")},className:"group inline-flex items-center justify-center gap-3 rounded-2xl px-8 py-4 md:px-12 md:py-6 text-lg md:text-xl font-bold shadow-2xl transition-all duration-300 hover:-translate-y-1 hover:shadow-3xl "+(a?"bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 text-white hover:from-blue-600 hover:via-purple-600 hover:to-pink-600":"bg-gradient-to-r from-blue-500 to-purple-600 text-white hover:from-blue-600 hover:to-purple-700"),children:[U.jsx("span",{children:"Get Started"}),U.jsx(yt,{className:"h-6 w-6 group-hover:translate-x-1 transition-transform"})]}),!(null==s?void 0:s.isTutor)&&U.jsxs("button",{onClick:()=>{t(s?"/become-tutor":"/login")},className:"inline-flex items-center justify-center gap-3 rounded-2xl px-8 py-4 md:px-12 md:py-6 text-lg md:text-xl font-bold shadow-xl transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl border-2 "+(a?"bg-white/10 text-purple-300 border-purple-400/50 hover:bg-white/15 hover:border-purple-400":"bg-white text-purple-600 border-purple-300 hover:bg-purple-50 hover:border-purple-400"),children:[U.jsx(Nr,{className:"h-6 w-6"}),U.jsx("span",{children:"Become a Tutor"})]})]})]}),U.jsxs("section",{className:"rounded-[32px] border px-8 py-12 md:py-16 shadow-2xl backdrop-blur-xl "+(a?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"text-center mb-12",children:[U.jsx("h2",{className:"text-4xl md:text-5xl font-black mb-4 tracking-tight "+(a?"bg-gradient-to-r from-indigo-300 via-purple-300 to-pink-300 bg-clip-text text-transparent":"bg-gradient-to-r from-indigo-700 via-purple-600 to-pink-600 bg-clip-text text-transparent"),children:"How Tutoring Works"}),U.jsx("p",{className:"text-lg md:text-xl max-w-3xl mx-auto "+(a?"text-white/70":"text-slate-600"),children:"Get personalized help from experienced students in just three simple steps"})]}),U.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 lg:gap-12",children:[U.jsx("div",{className:"group relative p-8 rounded-[28px] border transition-all duration-300 hover:-translate-y-2 hover:shadow-2xl "+(a?"border-white/10 bg-white/5 hover:border-blue-400/30 hover:bg-white/8":"border-slate-200 bg-slate-50 hover:border-blue-300 hover:bg-white hover:shadow-xl"),children:U.jsxs("div",{className:"flex flex-col items-center text-center",children:[U.jsxs("div",{className:"relative mb-6",children:[U.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 via-indigo-500 to-blue-600 rounded-2xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300",children:U.jsx(er,{className:"w-10 h-10 text-white"})}),U.jsx("div",{className:"absolute -top-3 -right-3 w-10 h-10 rounded-full flex items-center justify-center text-lg font-black shadow-lg "+(a?"bg-gradient-to-r from-blue-500 to-indigo-500 text-white border-2 border-white/20":"bg-gradient-to-r from-blue-500 to-indigo-500 text-white border-2 border-white"),children:"1"})]}),U.jsx("h3",{className:"text-2xl font-bold mb-4 "+(a?"text-white":"text-slate-900"),children:"Find a Tutor"}),U.jsx("p",{className:"text-base leading-relaxed "+(a?"text-white/70":"text-slate-600"),children:"Browse through our verified tutors and find the perfect match for your subject and learning style"})]})}),U.jsx("div",{className:"group relative p-8 rounded-[28px] border transition-all duration-300 hover:-translate-y-2 hover:shadow-2xl "+(a?"border-white/10 bg-white/5 hover:border-purple-400/30 hover:bg-white/8":"border-slate-200 bg-slate-50 hover:border-purple-300 hover:bg-white hover:shadow-xl"),children:U.jsxs("div",{className:"flex flex-col items-center text-center",children:[U.jsxs("div",{className:"relative mb-6",children:[U.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-purple-500 via-pink-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300",children:U.jsx(Ms,{className:"w-10 h-10 text-white"})}),U.jsx("div",{className:"absolute -top-3 -right-3 w-10 h-10 rounded-full flex items-center justify-center text-lg font-black shadow-lg "+(a?"bg-gradient-to-r from-purple-500 to-pink-500 text-white border-2 border-white/20":"bg-gradient-to-r from-purple-500 to-pink-500 text-white border-2 border-white"),children:"2"})]}),U.jsx("h3",{className:"text-2xl font-bold mb-4 "+(a?"text-white":"text-slate-900"),children:"Request a Session"}),U.jsx("p",{className:"text-base leading-relaxed "+(a?"text-white/70":"text-slate-600"),children:"Send a personalized request with your subject, preferred time, and specific learning goals"})]})}),U.jsx("div",{className:"group relative p-8 rounded-[28px] border transition-all duration-300 hover:-translate-y-2 hover:shadow-2xl "+(a?"border-white/10 bg-white/5 hover:border-emerald-400/30 hover:bg-white/8":"border-slate-200 bg-slate-50 hover:border-emerald-300 hover:bg-white hover:shadow-xl"),children:U.jsxs("div",{className:"flex flex-col items-center text-center",children:[U.jsxs("div",{className:"relative mb-6",children:[U.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-emerald-500 via-green-500 to-emerald-600 rounded-2xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300",children:U.jsx(kr,{className:"w-10 h-10 text-white"})}),U.jsx("div",{className:"absolute -top-3 -right-3 w-10 h-10 rounded-full flex items-center justify-center text-lg font-black shadow-lg "+(a?"bg-gradient-to-r from-emerald-500 to-green-500 text-white border-2 border-white/20":"bg-gradient-to-r from-emerald-500 to-green-500 text-white border-2 border-white"),children:"3"})]}),U.jsx("h3",{className:"text-2xl font-bold mb-4 "+(a?"text-white":"text-slate-900"),children:"Learn Together"}),U.jsx("p",{className:"text-base leading-relaxed "+(a?"text-white/70":"text-slate-600"),children:"Join an interactive online session and get personalized help to achieve your academic goals"})]})})]})]}),U.jsxs("section",{className:"rounded-[32px] border px-8 py-12 md:py-16 shadow-2xl backdrop-blur-xl "+(a?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"text-center mb-12",children:[U.jsx("h2",{className:"text-4xl md:text-5xl font-black mb-4 tracking-tight "+(a?"bg-gradient-to-r from-blue-300 via-purple-300 to-pink-300 bg-clip-text text-transparent":"bg-gradient-to-r from-blue-700 via-purple-600 to-pink-600 bg-clip-text text-transparent"),children:"Why Choose Studiply?"}),U.jsx("p",{className:"text-lg md:text-xl max-w-3xl mx-auto "+(a?"text-white/70":"text-slate-600"),children:"Experience the future of online learning with our innovative platform"})]}),U.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[U.jsxs("div",{className:"group p-6 rounded-[24px] border transition-all duration-300 hover:-translate-y-2 hover:shadow-xl text-center "+(a?"border-white/10 bg-white/5 hover:border-blue-400/30 hover:bg-white/8":"border-slate-200 bg-slate-50 hover:border-blue-300 hover:bg-white hover:shadow-lg"),children:[U.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg group-hover:scale-110 transition-transform duration-300",children:U.jsx(or,{className:"w-8 h-8 text-white"})}),U.jsx("h3",{className:"text-lg font-bold mb-2 "+(a?"text-white":"text-slate-900"),children:"Verified Tutors"}),U.jsx("p",{className:"text-sm "+(a?"text-white/70":"text-slate-600"),children:"All tutors are verified students with proven academic excellence"})]}),U.jsxs("div",{className:"group p-6 rounded-[24px] border transition-all duration-300 hover:-translate-y-2 hover:shadow-xl text-center "+(a?"border-white/10 bg-white/5 hover:border-purple-400/30 hover:bg-white/8":"border-slate-200 bg-slate-50 hover:border-purple-300 hover:bg-white hover:shadow-lg"),children:[U.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg group-hover:scale-110 transition-transform duration-300",children:U.jsx(Ht,{className:"w-8 h-8 text-white"})}),U.jsx("h3",{className:"text-lg font-bold mb-2 "+(a?"text-white":"text-slate-900"),children:"Flexible Scheduling"}),U.jsx("p",{className:"text-sm "+(a?"text-white/70":"text-slate-600"),children:"Book sessions at your convenience with flexible time slots"})]}),U.jsxs("div",{className:"group p-6 rounded-[24px] border transition-all duration-300 hover:-translate-y-2 hover:shadow-xl text-center "+(a?"border-white/10 bg-white/5 hover:border-emerald-400/30 hover:bg-white/8":"border-slate-200 bg-slate-50 hover:border-emerald-300 hover:bg-white hover:shadow-lg"),children:[U.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg group-hover:scale-110 transition-transform duration-300",children:U.jsx(ur,{className:"w-8 h-8 text-white"})}),U.jsx("h3",{className:"text-lg font-bold mb-2 "+(a?"text-white":"text-slate-900"),children:"Personalized Learning"}),U.jsx("p",{className:"text-sm "+(a?"text-white/70":"text-slate-600"),children:"Get tailored help based on your specific learning needs"})]}),U.jsxs("div",{className:"group p-6 rounded-[24px] border transition-all duration-300 hover:-translate-y-2 hover:shadow-xl text-center "+(a?"border-white/10 bg-white/5 hover:border-orange-400/30 hover:bg-white/8":"border-slate-200 bg-slate-50 hover:border-orange-300 hover:bg-white hover:shadow-lg"),children:[U.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-orange-500 to-orange-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg group-hover:scale-110 transition-transform duration-300",children:U.jsx(Cs,{className:"w-8 h-8 text-white"})}),U.jsx("h3",{className:"text-lg font-bold mb-2 "+(a?"text-white":"text-slate-900"),children:"Interactive Sessions"}),U.jsx("p",{className:"text-sm "+(a?"text-white/70":"text-slate-600"),children:"Engage in real-time video sessions with interactive tools"})]})]})]})]}),o&&U.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 ",children:U.jsx("div",{className:"rounded-[32px] shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto border "+(a?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:U.jsxs("div",{className:"p-8",children:[U.jsxs("div",{className:"flex justify-between items-center mb-8",children:[U.jsx("h2",{className:"text-3xl font-black "+(a?"bg-gradient-to-r from-blue-300 via-purple-300 to-pink-300 bg-clip-text text-transparent":"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent"),children:"Become a Tutor"}),U.jsx("button",{onClick:()=>l(!1),className:"text-2xl font-bold transition-colors "+(a?"text-white/60 hover:text-white":"text-gray-400 hover:text-gray-600"),children:""})]}),U.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),s)try{const{createTutorProfile:e}=await ia(()=>Promise.resolve().then(()=>Oa),void 0),a=await e(null==s?void 0:s.id,c);if(!a.success)throw new Error(a.error||"Failed to create tutor profile");{console.log("Tutor profile created successfully:",c);const e={...s,isTutor:!0};localStorage.setItem("simpleUser",JSON.stringify(e)),r(),l(!1),t("/tutoring"),n(" Welcome to Studiply Tutors! Your profile is now live and students can find you for tutoring sessions.","Tutor Profile Created!")}}catch(a){console.error("Error creating tutor profile:",a),i(`Failed to create tutor profile: ${a.message}`,"Setup Failed")}else i("Please log in first to become a tutor","Login Required")},className:"space-y-6",children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(a?"text-white/90":"text-slate-700"),children:"Subjects You Can Teach *"}),U.jsxs("select",{name:"subjects",value:c.subjects,onChange:u,className:"w-full px-4 py-3 rounded-xl border transition-all "+(a?"border-white/10 bg-white/5 text-white focus:border-purple-400/50 focus:ring-2 focus:ring-purple-500/30":"border-slate-200 bg-white text-slate-900 focus:border-purple-300 focus:ring-2 focus:ring-purple-500/20"),required:!0,children:[U.jsx("option",{value:"",children:"Select a subject"}),U.jsx("option",{value:"Mathematics",children:"Mathematics"}),U.jsx("option",{value:"Physics",children:"Physics"}),U.jsx("option",{value:"Chemistry",children:"Chemistry"}),U.jsx("option",{value:"Biology",children:"Biology"}),U.jsx("option",{value:"Computer Science",children:"Computer Science"}),U.jsx("option",{value:"English",children:"English"}),U.jsx("option",{value:"Spanish",children:"Spanish"}),U.jsx("option",{value:"French",children:"French"}),U.jsx("option",{value:"German",children:"German"}),U.jsx("option",{value:"History",children:"History"}),U.jsx("option",{value:"Geography",children:"Geography"}),U.jsx("option",{value:"Economics",children:"Economics"}),U.jsx("option",{value:"Business Studies",children:"Business Studies"}),U.jsx("option",{value:"Psychology",children:"Psychology"}),U.jsx("option",{value:"Philosophy",children:"Philosophy"}),U.jsx("option",{value:"Literature",children:"Literature"}),U.jsx("option",{value:"Art",children:"Art"}),U.jsx("option",{value:"Music",children:"Music"}),U.jsx("option",{value:"Other",children:"Other"})]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(a?"text-white/90":"text-slate-700"),children:"Teaching Experience *"}),U.jsxs("select",{name:"experience",value:c.experience,onChange:u,className:"w-full px-4 py-3 rounded-xl border transition-all "+(a?"border-white/10 bg-white/5 text-white focus:border-purple-400/50 focus:ring-2 focus:ring-purple-500/30":"border-slate-200 bg-white text-slate-900 focus:border-purple-300 focus:ring-2 focus:ring-purple-500/20"),required:!0,children:[U.jsx("option",{value:"",children:"Select your experience level"}),U.jsx("option",{value:"beginner",children:"Beginner (0-1 years)"}),U.jsx("option",{value:"intermediate",children:"Intermediate (1-3 years)"}),U.jsx("option",{value:"experienced",children:"Experienced (3-5 years)"}),U.jsx("option",{value:"expert",children:"Expert (5+ years)"})]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(a?"text-white/90":"text-slate-700"),children:"Teaching Description *"}),U.jsx("textarea",{name:"description",value:c.description,onChange:u,placeholder:"Describe your teaching style, methods, and what makes you a great tutor...",rows:4,className:"w-full px-4 py-3 rounded-xl border transition-all resize-none "+(a?"border-white/10 bg-white/5 text-white placeholder:text-white/40 focus:border-purple-400/50 focus:ring-2 focus:ring-purple-500/30":"border-slate-200 bg-white text-slate-900 placeholder:text-slate-400 focus:border-purple-300 focus:ring-2 focus:ring-purple-500/20"),required:!0})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(a?"text-white/90":"text-slate-700"),children:"Availability *"}),U.jsxs("select",{name:"availability",value:c.availability,onChange:u,className:"w-full px-4 py-3 rounded-xl border transition-all "+(a?"border-white/10 bg-white/5 text-white focus:border-purple-400/50 focus:ring-2 focus:ring-purple-500/30":"border-slate-200 bg-white text-slate-900 focus:border-purple-300 focus:ring-2 focus:ring-purple-500/20"),required:!0,children:[U.jsx("option",{value:"",children:"Select your availability"}),U.jsx("option",{value:"weekdays",children:"Weekdays only"}),U.jsx("option",{value:"weekends",children:"Weekends only"}),U.jsx("option",{value:"flexible",children:"Flexible schedule"}),U.jsx("option",{value:"evenings",children:"Evenings only"})]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(a?"text-white/90":"text-slate-700"),children:"Hourly Rate () *"}),U.jsxs("div",{className:"relative",children:[U.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-lg font-semibold "+(a?"text-white/60":"text-slate-500"),children:""}),U.jsx("input",{type:"number",name:"hourlyRate",value:c.hourlyRate,onChange:u,placeholder:"15",min:"5",max:"100",step:"1",className:"w-full pl-10 pr-4 py-3 rounded-xl border transition-all "+(a?"border-white/10 bg-white/5 text-white placeholder:text-white/40 focus:border-purple-400/50 focus:ring-2 focus:ring-purple-500/30":"border-slate-200 bg-white text-slate-900 placeholder:text-slate-400 focus:border-purple-300 focus:ring-2 focus:ring-purple-500/20"),required:!0})]}),U.jsx("p",{className:"mt-2 text-xs "+(a?"text-white/50":"text-slate-500"),children:"Set your hourly rate between 5 - 100. A 20% platform fee will be deducted from payments."})]}),U.jsxs("div",{className:"flex gap-4 pt-6",children:[U.jsx("button",{type:"button",onClick:()=>l(!1),className:"flex-1 px-6 py-3 rounded-xl font-semibold transition-all "+(a?"border-2 border-white/20 bg-white/5 text-white hover:bg-white/10 hover:border-white/30":"border-2 border-slate-300 bg-white text-slate-700 hover:bg-slate-50 hover:border-slate-400"),children:"Cancel"}),U.jsx("button",{type:"submit",className:"flex-1 px-6 py-3 rounded-xl font-semibold transition-all duration-300 hover:-translate-y-0.5 hover:shadow-xl "+(a?"bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 text-white hover:from-blue-600 hover:via-purple-600 hover:to-pink-600":"bg-gradient-to-r from-blue-500 to-purple-600 text-white hover:from-blue-600 hover:to-purple-700"),children:"Submit Application"})]})]})]})})})]})},la=["Curated quests tailored to your study goals","Track XP, badges, and streaks across every subject","Join live sessions with mentors that keep you motivated"],ca=()=>{const[t,s]=e.useState({email:"",password:""}),[r,a]=e.useState(""),[n,i]=e.useState(!1),[o,l]=e.useState(!1),[c,d]=e.useState(!1),[u,h]=e.useState(!1),[m,x]=e.useState({x:0,y:0}),{isDark:p}=mt(),{login:g,user:b,logout:f}=Br(),w=qe(),y=Ie();e.useEffect(()=>{l(!0);const e=new URLSearchParams(y.search),t=e.get("redirect_uri"),s=e.get("platform");return t&&"macos"===s&&b&&(console.log("macOS app callback detected, logging out user to show login form"),f()),document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden",()=>{document.body.style.overflow="",document.documentElement.style.overflow=""}},[b,y,f]),e.useEffect(()=>{const e=e=>{x({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),()=>window.removeEventListener("mousemove",e)},[]);const v=e=>{s({...t,[e.target.name]:e.target.value}),r&&a("")};return U.jsxs("div",{className:"fixed inset-0 h-screen w-screen overflow-hidden "+(p?"bg-gradient-to-br from-[#08051a] via-[#120b2c] to-[#1c1142] text-white":"bg-gradient-to-br from-[#f4f2ff] via-[#f9f0ff] to-[#ffe9f5] text-slate-900"),style:{paddingTop:"64px"},children:[U.jsx("style",{children:"\n        @keyframes floatSlow {\n          0%, 100% { transform: translateY(0px); }\n          50% { transform: translateY(-12px); }\n        }\n        @keyframes slideInLeft {\n          from {\n            opacity: 0;\n            transform: translateX(-40px);\n          }\n          to {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        @keyframes slideInRight {\n          from {\n            opacity: 0;\n            transform: translateX(40px);\n          }\n          to {\n            opacity: 1;\n            transform: translateX(0);\n          }\n        }\n        .form-panel-enter {\n          animation: slideInLeft 0.65s ease-out both;\n        }\n        .info-panel-enter {\n          animation: slideInRight 0.75s ease-out both;\n        }\n        .input-pill {\n          transition: all 0.28s ease;\n        }\n        .input-pill:focus {\n          transform: translateY(-2px);\n          box-shadow: 0 14px 34px -16px rgba(99, 102, 241, 0.55);\n        }\n        .cta-button {\n          position: relative;\n          overflow: hidden;\n        }\n        .cta-button::after {\n          content: '';\n          position: absolute;\n          inset: 0;\n          background: linear-gradient(120deg, transparent 0%, rgba(255,255,255,0.35) 50%, transparent 100%);\n          transform: translateX(-120%);\n          transition: transform 0.9s ease;\n        }\n        .cta-button:hover::after {\n          transform: translateX(120%);\n        }\n        .wave-panel {\n          position: relative;\n          overflow: hidden;\n          isolation: isolate;\n        }\n        .wave-panel::before,\n        .wave-panel::after {\n          content: '';\n          position: absolute;\n          left: -140px;\n          width: 260px;\n          height: 260px;\n          background: var(--panel-overlay, rgba(255,255,255,0.9));\n          border-radius: 50%;\n          opacity: 0.85;\n          filter: blur(0.5px);\n        }\n        .wave-panel::before {\n          top: -110px;\n        }\n        .wave-panel::after {\n          bottom: -110px;\n        }\n        .wave-panel .glow-accent {\n          position: absolute;\n          inset: 0;\n          background: radial-gradient(circle at 20% 30%, rgba(255,255,255,0.22), transparent 55%),\n                      radial-gradient(circle at 80% 75%, rgba(255,255,255,0.18), transparent 50%);\n          opacity: 0.9;\n        }\n        .floating-bubble {\n          animation: floatSlow 7s ease-in-out infinite;\n        }\n      "}),U.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[[...Array(18)].map((e,t)=>U.jsx("span",{className:"floating-bubble absolute rounded-full "+(p?"bg-white/10":"bg-purple-200/40"),style:{width:4*Math.random()+2+"px",height:4*Math.random()+2+"px",top:100*Math.random()+"%",left:100*Math.random()+"%",animationDelay:6*Math.random()+"s"}},t)),U.jsx("div",{className:"absolute h-[480px] w-[480px] rounded-full blur-3xl opacity-45",style:{background:"radial-gradient(circle, rgba(167,139,250,0.55) 0%, rgba(99,102,241,0.35) 55%, transparent 70%)",transform:`translate(calc(-40% + ${.05*(m.x-window.innerWidth/2)}px), calc(-35% + ${.05*(m.y-window.innerHeight/2)}px))`}}),U.jsx("div",{className:"absolute h-[420px] w-[420px] right-[-120px] bottom-[-80px] rounded-full blur-[100px] opacity-40",style:{background:"radial-gradient(circle, rgba(236,72,153,0.45) 0%, rgba(79,70,229,0.3) 60%, transparent 80%)",transform:`translate(${.04*(m.x-window.innerWidth/2)}px, ${.04*(m.y-window.innerHeight/2)}px)`}})]}),U.jsx("div",{className:"relative z-10 flex h-full items-center justify-center px-4 py-2 overflow-hidden",children:U.jsx("div",{className:"w-full max-w-5xl",children:U.jsxs("div",{className:"grid overflow-hidden rounded-[28px] border shadow-[0_40px_120px_-40px_rgba(79,70,229,0.4)] backdrop-blur-2xl md:grid-cols-[1.15fr_0.85fr] w-full min-h-[520px] max-h-[calc(100vh-96px)] "+(p?"border-white/10 bg-white/5":"border-white/70 bg-white/60"),children:[U.jsxs("div",{className:`form-panel-enter relative flex flex-col justify-center gap-6 p-6 sm:p-8 ${p?"bg-white/85 text-slate-900 shadow-lg shadow-purple-900/20":"bg-white"} md:rounded-r-[56px] md:rounded-l-none`,children:[U.jsxs("div",{className:"space-y-2",children:[U.jsx("div",{className:"inline-flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-[#7c3aed] via-[#a855f7] to-[#ec4899] text-white shadow-lg",children:U.jsx(nr,{className:"h-6 w-6"})}),U.jsxs("div",{children:[U.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.35em] text-purple-500",children:"Welcome back"}),U.jsx("h1",{className:"mt-1 text-2xl font-bold text-slate-900 sm:text-3xl",children:"Sign in to Studiply"}),U.jsx("p",{className:"mt-2 max-w-md text-xs text-slate-500 sm:text-sm",children:"Access your quests, track streaks, and continue where you left off."})]})]}),r&&U.jsx("div",{className:"rounded-2xl border px-4 py-3 text-sm font-medium "+(p?"border-red-200/60 bg-red-500/10 text-red-200":"border-red-200 bg-red-50 text-red-700"),children:r}),U.jsxs("form",{onSubmit:async e=>{var s;e.preventDefault(),i(!0),a("");try{const e=await g(t.email.trim().toLowerCase(),t.password.trim());if(e.success){const t=new URLSearchParams(y.search),r=t.get("redirect_uri"),a=t.get("platform");if(r&&"macos"===a){const t=e.user,s=e.token||"mock_token_for_macos",a=`${r}?status=success&user_id=${t.id}&email=${encodeURIComponent(t.email)}&name=${encodeURIComponent(t.name)}&token=${s}&is_tutor=${t.isTutor||!1}`;console.log("Redirecting to macOS app:",a),window.location.href=a}else{const e=(null==(s=y.state)?void 0:s.from)||"/tutoring";w(e,{replace:!0})}}else a(e.error)}catch(r){a("An unexpected error occurred")}finally{i(!1)}},className:"space-y-4",children:[U.jsxs("div",{className:"space-y-1.5",children:[U.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Email Address"}),U.jsxs("div",{className:"relative",children:[U.jsx("input",{name:"email",type:"email",required:!0,className:"input-pill w-full rounded-full border px-12 py-3 text-sm shadow-sm transition-all "+(p?"border-slate-200/40 bg-white/80 text-slate-900 placeholder:text-slate-500 focus:border-purple-400 focus:ring-4 focus:ring-purple-400/30":"border-slate-200 bg-white text-slate-900 placeholder:text-slate-400 focus:border-purple-400 focus:ring-4 focus:ring-purple-400/25"),placeholder:"Enter your email",value:t.email,onChange:v,disabled:n}),U.jsx(Is,{className:"absolute left-5 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"})]})]}),U.jsxs("div",{className:"space-y-1.5",children:[U.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Password"}),U.jsxs("div",{className:"relative",children:[U.jsx("input",{name:"password",type:u?"text":"password",required:!0,className:"input-pill w-full rounded-full border px-12 py-3 text-sm shadow-sm transition-all "+(p?"border-slate-200/40 bg-white/80 text-slate-900 placeholder:text-slate-500 focus:border-purple-400 focus:ring-4 focus:ring-purple-400/30":"border-slate-200 bg-white text-slate-900 placeholder:text-slate-400 focus:border-purple-400 focus:ring-4 focus:ring-purple-400/25"),placeholder:"Enter your password",value:t.password,onChange:v,disabled:n}),U.jsx(Ts,{className:"absolute left-5 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),U.jsx("button",{type:"button",onClick:()=>h(e=>!e),className:"absolute right-5 top-1/2 -translate-y-1/2 rounded-full p-1.5 text-slate-400 transition hover:bg-slate-100 hover:text-slate-700",children:u?U.jsx(is,{className:"h-4 w-4"}):U.jsx(os,{className:"h-4 w-4"})})]})]}),U.jsxs("div",{className:"flex items-center justify-between text-xs",children:[U.jsxs("label",{className:"inline-flex cursor-pointer items-center gap-2",children:[U.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-purple-500 focus:ring-purple-500",checked:c,onChange:e=>d(e.target.checked),disabled:n}),U.jsx("span",{className:"font-medium text-slate-600",children:"Remember me"})]}),U.jsx("button",{type:"button",className:"font-medium text-purple-500 transition hover:text-purple-600 hover:underline text-xs",children:"Forgot password?"})]}),U.jsx("button",{type:"submit",disabled:n,className:"cta-button w-full rounded-full bg-gradient-to-r from-[#6366f1] via-[#8b5cf6] to-[#ec4899] px-6 py-3 text-sm font-semibold text-white shadow-lg transition-all hover:-translate-y-1 hover:shadow-2xl disabled:translate-y-0 disabled:bg-slate-300 "+(n?"opacity-70":""),children:U.jsx("span",{className:"flex items-center justify-center gap-2",children:n?U.jsxs(U.Fragment,{children:[U.jsxs("svg",{className:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[U.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),U.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):U.jsxs(U.Fragment,{children:["Sign In",U.jsx(yt,{className:"h-4 w-4"})]})})}),U.jsxs("div",{className:"pt-1 text-center text-xs",children:[U.jsx("span",{className:"text-slate-500",children:"Or continue with"}),U.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2",children:["Google","Facebook"].map(e=>U.jsxs("button",{type:"button",className:"flex items-center justify-center gap-1.5 rounded-full border border-slate-200 bg-white py-2.5 text-xs font-semibold text-slate-600 transition hover:-translate-y-1 hover:border-purple-200 hover:text-purple-600 hover:shadow-lg",children:[U.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-slate-100 text-[10px] font-bold text-slate-500",children:"Google"===e?"G":"F"}),e]},e))})]})]}),U.jsxs("div",{className:"text-center text-sm text-slate-500 md:hidden",children:["Don't have an account?"," ",U.jsx(st,{to:"/register",className:"font-semibold text-purple-500 hover:text-purple-600 hover:underline",children:"Create one here"})]})]}),U.jsxs("div",{className:"info-panel-enter wave-panel relative hidden items-center justify-center bg-gradient-to-br from-[#5f48ff] via-[#7c3aed] to-[#ec4899] md:flex",style:{"--panel-overlay":p?"rgba(12,16,32,0.92)":"#ffffff"},children:[U.jsx("div",{className:"glow-accent"}),U.jsxs("div",{className:"relative z-10 mx-auto flex max-w-sm flex-col gap-4 px-8 py-8 text-white",children:[U.jsx("span",{className:"inline-flex w-max items-center gap-2 rounded-full border border-white/50 bg-white/10 px-3 py-1 text-[10px] font-semibold uppercase tracking-[0.35em]",children:"New here"}),U.jsx("h2",{className:"text-2xl font-bold leading-tight",children:"Build your personalised quest road-map in minutes."}),U.jsx("p",{className:"text-xs text-white/85",children:"Create collaborative quests, schedule real-time tutoring, and stay motivated with daily missions designed just for you."}),U.jsx("ul",{className:"space-y-2 text-xs text-white/90",children:la.map(e=>U.jsxs("li",{className:"flex items-start gap-2.5",children:[U.jsx("span",{className:"mt-[2px] rounded-full bg-white/15 p-1",children:U.jsx(Ot,{className:"h-3.5 w-3.5"})}),U.jsx("span",{children:e})]},e))}),U.jsxs(st,{to:"/register",className:"cta-button mt-2 inline-flex items-center justify-center gap-2 rounded-full bg-white/90 px-5 py-2.5 text-sm font-semibold text-purple-600 shadow-lg transition hover:-translate-y-1 hover:bg-white",children:["Create Account",U.jsx(yt,{className:"h-4 w-4"})]})]})]})]})})})]})};class da{constructor(e=0,t="Network Error"){this.status=e,this.text=t}}const ua={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:(()=>{if("undefined"!=typeof localStorage)return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}})()},ha=e=>e?"string"==typeof e?{publicKey:e}:"[object Object]"===e.toString()?e:{}:{},ma=async(e,t,s={})=>{const r=await fetch(ua.origin+e,{method:"POST",headers:s,body:t}),a=await r.text(),n=new da(r.status,a);if(r.ok)return n;throw n},xa=(e,t,s)=>{if(!e||"string"!=typeof e)throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||"string"!=typeof t)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!s||"string"!=typeof s)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},pa=e=>e.webdriver||!e.languages||0===e.languages.length,ga=()=>new da(451,"Unavailable For Headless Browser"),ba=(e,t)=>{if((e=>{var t;return!(null==(t=e.list)?void 0:t.length)||!e.watchVariable})(e))return!1;((e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if("string"!=typeof t)throw"The BlockList watchVariable has to be a string"})(e.list,e.watchVariable);const s=(r=t,a=e.watchVariable,r instanceof FormData?r.get(a):r[a]);var r,a;return"string"==typeof s&&e.list.includes(s)},fa=()=>new da(403,"Forbidden"),wa=async(e,t,s)=>{if(!t.throttle||!s)return!1;((e,t)=>{if("number"!=typeof e||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&"string"!=typeof t)throw"The LimitRate ID has to be a non-empty string"})(t.throttle,t.id);const r=t.id||e,a=await(async(e,t,s)=>{const r=Number(await s.get(e)||0);return t-Date.now()+r})(r,t.throttle,s);return a>0||(await s.set(r,Date.now().toString()),!1)},ya=()=>new da(429,"Too Many Requests"),va=(e,t="https://api.emailjs.com")=>{if(!e)return;const s=ha(e);ua.publicKey=s.publicKey,ua.blockHeadless=s.blockHeadless,ua.storageProvider=s.storageProvider,ua.blockList=s.blockList,ua.limitRate=s.limitRate,ua.origin=s.origin||t},ja=async(e,t,s,r)=>{const a=ha(r),n=a.publicKey||ua.publicKey,i=a.blockHeadless||ua.blockHeadless,o=a.storageProvider||ua.storageProvider,l={...ua.blockList,...a.blockList},c={...ua.limitRate,...a.limitRate};if(i&&pa(navigator))return Promise.reject(ga());if(xa(n,e,t),(e=>{if(e&&"[object Object]"!==e.toString())throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"})(s),s&&ba(l,s))return Promise.reject(fa());if(await wa(location.pathname,c,o))return Promise.reject(ya());const d={lib_version:"4.4.1",user_id:n,service_id:e,template_id:t,template_params:s};return ma("/api/v1.0/email/send",JSON.stringify(d),{"Content-type":"application/json"})},Na="q3eK04PCYjcxxpUzh",ka="service_wx8tfa8",Sa="template_2vft7pq",Ca="template_5fhs9v8",Ea=(()=>{const e={}.VITE_API_BASE_URL;if(e)return e;throw console.error(" VITE_API_BASE_URL is not set in production! Please configure it in Vercel environment variables."),new Error("Backend API URL is not configured. Please contact support.")})(),Aa=e=>{if(!e)return"";const t=e.trim();return t.startsWith("+")?"+"+t.slice(1).replace(/\D/g,""):t.replace(/\D/g,"")},Ta=({isOpen:t,onClose:s,phoneNumber:r,onVerified:a})=>{const{isDark:n}=mt(),{showSuccess:i,showError:o}=Hr(),[l,c]=e.useState(""),[d,u]=e.useState(!1),[h,m]=e.useState(!1),[x,p]=e.useState(0),[g,b]=e.useState("");e.useEffect(()=>{t&&r&&f()},[t]),e.useEffect(()=>{if(x>0){const e=setTimeout(()=>p(x-1),1e3);return()=>clearTimeout(e)}},[x]);const f=async()=>{if(r){u(!0),b("");try{const e=await(async e=>{try{const t=Aa(e),s=await fetch(`${Ea}/send-phone-verification`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:t})});return await s.json()}catch(g){return console.error("Error sending verification code:",g),{success:!1,error:"Network error. Please check your connection and try again."}}})(r);e.success?(i("Verification code sent!",3e3,"Success"),p(60),c("")):(b(e.error||"Failed to send verification code"),o(e.error||"Failed to send verification code",5e3,"Error"))}catch(e){b("Failed to send verification code. Please try again."),o("Failed to send verification code",5e3,"Error")}finally{u(!1)}}else o("Phone number is required",3e3,"Error")};return t?U.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:U.jsxs("div",{className:"relative rounded-3xl p-8 max-w-md w-full shadow-2xl "+(n?"bg-gradient-to-br from-slate-800 via-purple-900 to-slate-800 border border-purple-400/30":"bg-white border border-purple-200"),children:[U.jsx("button",{onClick:s,className:"absolute top-4 right-4 p-2 rounded-xl transition-all "+(n?"hover:bg-white/10 text-white/70 hover:text-white":"hover:bg-gray-100 text-gray-500 hover:text-gray-700"),children:U.jsx(Rr,{className:"w-5 h-5"})}),U.jsxs("div",{className:"text-center mb-6",children:[U.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center bg-gradient-to-br from-purple-500 to-pink-500",children:U.jsx(Gs,{className:"w-8 h-8 text-white"})}),U.jsx("h2",{className:"text-2xl font-bold mb-2 "+(n?"text-white":"text-gray-900"),children:"Verify Phone Number"}),U.jsx("p",{className:"text-sm "+(n?"text-white/70":"text-gray-600"),children:"We sent a 6-digit code to"}),U.jsx("p",{className:"font-semibold mt-1 "+(n?"text-purple-400":"text-purple-600"),children:r})]}),U.jsxs("div",{className:"mb-6",children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(n?"text-white/90":"text-gray-700"),children:"Verification Code"}),U.jsx("input",{type:"text",value:l,onChange:e=>{const t=e.target.value.replace(/\D/g,"").slice(0,6);c(t),b("")},placeholder:"000000",maxLength:6,className:"w-full px-4 py-4 rounded-xl border-2 text-center text-2xl font-mono tracking-widest transition-all "+(n?"bg-white/10 border-white/20 text-white placeholder:text-white/30 focus:border-purple-400 focus:ring-2 focus:ring-purple-500/30":"bg-gray-50 border-gray-200 text-gray-900 placeholder:text-gray-400 focus:border-purple-400 focus:ring-2 focus:ring-purple-500/20"),disabled:h||d,autoFocus:!0}),g&&U.jsxs("div",{className:"mt-3 flex items-center gap-2 text-red-500 text-sm",children:[U.jsx(bt,{className:"w-4 h-4"}),U.jsx("span",{children:g})]})]}),U.jsx("div",{className:"mb-6 text-center",children:x>0?U.jsxs("p",{className:"text-sm flex items-center justify-center gap-2 "+(n?"text-white/60":"text-gray-500"),children:[U.jsx(Ht,{className:"w-4 h-4"}),"Resend code in ",x,"s"]}):U.jsx("button",{onClick:f,disabled:d,className:`text-sm font-medium transition-all ${n?"text-purple-400 hover:text-purple-300":"text-purple-600 hover:text-purple-700"} disabled:opacity-50`,children:d?"Sending...":"Resend Code"})}),U.jsx("button",{onClick:async()=>{if(l&&6===l.length)if(r){m(!0),b("");try{const e=await(async(e,t)=>{try{const s=Aa(e),r=await fetch(`${Ea}/verify-phone`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:s,code:t})});return await r.json()}catch(g){return console.error("Error verifying code:",g),{success:!1,error:"Network error. Please check your connection and try again."}}})(r,l);e.success?(i("Phone number verified successfully!",3e3,"Success"),a&&a(),s()):(b(e.error||"Invalid verification code"),o(e.error||"Invalid verification code",5e3,"Error"))}catch(e){b("Failed to verify code. Please try again."),o("Failed to verify code",5e3,"Error")}finally{m(!1)}}else b("Phone number is required");else b("Please enter a 6-digit verification code")},disabled:6!==l.length||h||d,className:"w-full py-3.5 rounded-xl font-semibold transition-all "+(6!==l.length||h||d?n?"bg-white/10 text-white/50 cursor-not-allowed":"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600 shadow-lg shadow-purple-500/30"),children:h?U.jsxs("span",{className:"flex items-center justify-center gap-2",children:[U.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Verifying..."]}):"Verify"})]})}):null},Ia=()=>{const[t,s]=e.useState(1),[r,a]=e.useState({name:"",email:"",password:"",confirmPassword:"",grade:"",school:"",phone:"",location:"",bio:"",subjects:[]}),[n,i]=e.useState(""),[u,h]=e.useState(!1),[m,x]=e.useState(!1),[p,g]=e.useState(!1),[b,f]=e.useState(!1),[w,y]=e.useState(!1),[v,j]=e.useState(!1),[N,k]=e.useState(!1),[S,C]=e.useState(""),[E,A]=e.useState(!1),[T,I]=e.useState(""),[P,q]=e.useState(!1),[R,M]=e.useState(!1),[D,L]=e.useState(!1),[F,$]=e.useState({x:0,y:0}),[O,B]=e.useState("forward"),{register:_}=Br(),{isDark:z}=mt(),W=qe();e.useEffect(()=>(y(!0),va(Na),document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden",()=>{document.body.style.overflow="",document.documentElement.style.overflow=""}),[]),e.useEffect(()=>{const e=e=>{$({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),()=>window.removeEventListener("mousemove",e)},[]),e.useEffect(()=>{const e=e=>{v&&!e.target.closest(".dropdown-container")&&j(!1),N&&!e.target.closest(".school-dropdown-container")&&k(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[v,N]);const H=["Harvard University","Stanford University","Massachusetts Institute of Technology (MIT)","University of Cambridge","University of Oxford","Yale University","Princeton University","Columbia University","University of Chicago","University of Pennsylvania","California Institute of Technology (Caltech)","University of California, Berkeley","University of California, Los Angeles (UCLA)","New York University (NYU)","University of Michigan","University of Texas at Austin","University of Washington","Cornell University","Duke University","Northwestern University","Johns Hopkins University","Carnegie Mellon University","University of Southern California (USC)","University of Virginia","University of North Carolina at Chapel Hill","Boston University","University of Illinois at Urbana-Champaign","Georgia Institute of Technology","University of Wisconsin-Madison","Pennsylvania State University","Ohio State University","University of Florida","University of Minnesota","Purdue University","Texas A&M University","University of Maryland","University of Colorado Boulder","Arizona State University","University of California, San Diego (UCSD)","University of California, Davis","University of California, Irvine","University of California, Santa Barbara","Rutgers University","Indiana University","University of Pittsburgh","University of Georgia","University of Connecticut","University of Delaware","University of Massachusetts Amherst","University of Vermont","University of New Hampshire","University of Maine","University of Toronto","McGill University","University of British Columbia","University of Melbourne","University of Sydney","University of Tokyo","Peking University","Tsinghua University","National University of Singapore","University of Hong Kong","Seoul National University","Lincoln High School","Washington High School","Jefferson High School","Roosevelt High School","Kennedy High School","Madison High School","Central High School","East High School","West High School","North High School","South High School","Memorial High School","Park High School","Lake High School","Hill High School","Valley High School","Ridge High School","Creek High School","Spring High School","Oak High School","Pine High School","Maple High School","Cedar High School","Elm High School","St. Mary's School","St. John's School","St. Paul's School","St. Joseph's School","St. Francis School","St. Anthony's School","St. Patrick's School","St. Michael's School","St. Thomas School","St. Andrew's School","St. Luke's School","St. Mark's School","Community College of Philadelphia","Miami Dade College","Lone Star College","Houston Community College","City College of San Francisco","Santa Monica College","Pasadena City College","Orange Coast College","Diablo Valley College","De Anza College","Foothill College","Online School","Homeschool","International School","Charter School"].sort(),G=S?H.filter(e=>e.toLowerCase().includes(S.toLowerCase())):H,V=e=>{a({...r,[e.target.name]:e.target.value}),"email"===e.target.name&&(x(!1),f(!1)),n&&i("")},Y=e=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e),Q=async e=>{const t=e.target.value.trim();if(t){if(!Y(t))return i("Please enter a valid email address (e.g., user@example.com)"),void x(!1);g(!0),i("");try{const e=o(dt,"users"),s=l(e,c("email","==",t.toLowerCase().trim())),r=await d(s);f(!0),r.empty?(x(!1),i("")):(x(!0),i("This email is already registered. Please use a different email or sign in."))}catch(s){console.error("Error checking email:",s),f(!0),x(!1),i("Unable to check email availability. Please try again or continue with registration.")}finally{g(!1)}}},J=["Elementary School","Middle School","High School","College/University","Graduate School","Other"],K=["Mathematics","Physics","Chemistry","Biology","English","History","Geography","Computer Science","Programming","Art","Music","Physical Education","Psychology","Economics","Business","Languages"],X=async()=>{try{h(!0);const t=Math.floor(1e5+9e5*Math.random()).toString();if(!r.email||!r.email.includes("@"))return void i("Invalid email address");const s={}.VITE_API_BASE_URL||"http://localhost:3003/api";try{console.log(" Attempting to send email via Neo Email (backend)...");const e=await fetch(`${s}/send-verification-email`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.email,code:t})}),a=await e.json();if(a.success)return console.log(" Email sent successfully via Neo Email"),q(!0),sessionStorage.setItem("verification_code",t),void i("");throw new Error(a.error||"Backend email failed")}catch(e){console.warn(" Neo Email failed, falling back to EmailJS:",e)}const a={to_email:r.email,to_name:r.name,verification_code:t,from_name:"Studiply",user_email:r.email,user_name:r.name};console.log(" Sending email via EmailJS (fallback)...");200===(await ja(ka,Sa,a,Na)).status?(console.log(" Email sent successfully via EmailJS"),q(!0),sessionStorage.setItem("verification_code",t),i("")):i("Failed to send verification email. Please try again.")}catch(t){console.error("EmailJS error:",t);const e=Math.floor(1e5+9e5*Math.random()).toString();t.text&&t.text.includes("template ID not found")?(console.log("EmailJS Template ID not found, using test mode"),alert(`EmailJS Template Error - Test Mode: Verification code is ${e}\n\nPlease check your EmailJS template ID in the dashboard.`)):t.text&&t.text.includes("Public Key is invalid")?(console.log("EmailJS Public Key invalid, using test mode"),alert(`EmailJS Key Error - Test Mode: Verification code is ${e}\n\nPlease check your EmailJS Public Key.`)):t.text&&t.text.includes("recipients address is empty")?(console.log("EmailJS recipients address is empty, using test mode"),alert(`EmailJS Recipient Error - Test Mode: Verification code is ${e}\n\nPlease check your EmailJS template configuration.\n\nEmail: ${r.email}`)):t.text&&t.text.includes("Invalid email address")?(console.log("Invalid email address, using test mode"),alert(`EmailJS Invalid Email - Test Mode: Verification code is ${e}\n\nPlease enter a valid email address.`)):(console.log("EmailJS failed, falling back to test mode"),alert(`EmailJS Error - Test Mode: Verification code is ${e}\n\nError: ${t.text||t.message}`)),q(!0),sessionStorage.setItem("verification_code",e),i("")}finally{h(!1)}},Z=async()=>{if(T&&6===T.length){h(!0);try{const t=sessionStorage.getItem("verification_code");if(T===t){A(!0),sessionStorage.removeItem("verification_code"),i("");try{const e=await _({name:r.name.trim(),email:r.email.trim().toLowerCase(),password:r.password.trim(),school:r.school,grade:r.grade,phone:r.phone,location:r.location,bio:r.bio,subjects:r.subjects});e.success?W("/"):(i(e.error||"Registration failed. Please try again."),A(!1))}catch(e){console.error("Registration error:",e),i("Registration failed. Please try again."),A(!1)}}else i("Invalid verification code. Please try again.")}catch(t){i("Verification failed. Please try again.")}finally{h(!1)}}else i("Please enter a 6-digit verification code")},ee=()=>{X(),alert("Verification code has been resent to your email")},te=[{number:1,title:"Basic Info",description:"Name, email and password"},{number:2,title:"School Info",description:"School and grade level"},{number:3,title:"Contact Info",description:"Phone and location (optional)"},{number:4,title:"Profile Info",description:"Bio and subjects (optional)"},{number:5,title:"Email Verification",description:"Verify your email address"}],se="forward"===O?"step-enter-right":"step-enter-left",re=(t-1)/(te.length-1)*100;return U.jsxs("div",{className:"fixed inset-0 h-screen w-screen overflow-hidden "+(z?"bg-gradient-to-br from-[#08051a] via-[#120b2c] to-[#1c1142] text-white":"bg-gradient-to-br from-[#f4f2ff] via-[#f9f0ff] to-[#ffe9f5] text-slate-900"),style:{paddingTop:"64px"},children:[U.jsx("style",{children:"\n        @keyframes floatSlow {\n          0%, 100% { transform: translateY(0px); }\n          50% { transform: translateY(-10px); }\n        }\n        @keyframes slideInLeft {\n          from { opacity: 0; transform: translateX(-40px); }\n          to { opacity: 1; transform: translateX(0); }\n        }\n        @keyframes slideInRight {\n          from { opacity: 0; transform: translateX(40px); }\n          to { opacity: 1; transform: translateX(0); }\n        }\n        .step-enter-left {\n          animation: slideInLeft 0.55s ease-out both;\n        }\n        .step-enter-right {\n          animation: slideInRight 0.55s ease-out both;\n        }\n        .input-focus-effect {\n          transition: all 0.3s ease;\n        }\n        .input-focus-effect:focus {\n          transform: translateY(-2px);\n          box-shadow: 0 18px 38px -20px rgba(99, 102, 241, 0.55);\n        }\n        .wave-panel-left {\n          position: relative;\n          overflow: hidden;\n          isolation: isolate;\n        }\n        .wave-panel-left::before,\n        .wave-panel-left::after {\n          content: '';\n          position: absolute;\n          right: -140px;\n          width: 260px;\n          height: 260px;\n          background: var(--panel-overlay, rgba(255,255,255,0.9));\n          border-radius: 50%;\n          opacity: 0.9;\n          filter: blur(0.5px);\n        }\n        .wave-panel-left::before { top: -120px; }\n        .wave-panel-left::after { bottom: -120px; }\n        .wave-panel-left .glow-accent {\n          position: absolute;\n          inset: 0;\n          background: radial-gradient(circle at 30% 35%, rgba(255,255,255,0.25), transparent 60%),\n                      radial-gradient(circle at 70% 70%, rgba(255,255,255,0.18), transparent 55%);\n          opacity: 0.85;\n        }\n        .floating-node {\n          animation: floatSlow 7s ease-in-out infinite;\n        }\n      "}),U.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[[...Array(20)].map((e,t)=>U.jsx("span",{className:"floating-node absolute rounded-full "+(z?"bg-white/10":"bg-purple-200/40"),style:{width:4*Math.random()+2+"px",height:4*Math.random()+2+"px",top:100*Math.random()+"%",left:100*Math.random()+"%",animationDelay:6*Math.random()+"s"}},t)),U.jsx("div",{className:"absolute left-[-120px] top-[-140px] h-[440px] w-[440px] rounded-full blur-[120px] opacity-45",style:{background:"radial-gradient(circle, rgba(129,140,248,0.55) 0%, rgba(99,102,241,0.3) 60%, transparent 75%)"}}),U.jsx("div",{className:"absolute right-[-180px] bottom-[-120px] h-[460px] w-[460px] rounded-full blur-[140px] opacity-40",style:{background:"radial-gradient(circle, rgba(236,72,153,0.48) 0%, rgba(79,70,229,0.28) 60%, transparent 80%)"}})]}),U.jsx("div",{className:"relative z-10 flex h-full w-full items-center justify-center px-4 py-4 overflow-hidden",children:U.jsx("div",{className:"w-full max-w-5xl flex-shrink-0 max-h-[calc(100vh-96px)]",children:U.jsxs("div",{className:"grid overflow-hidden rounded-[28px] border shadow-[0_40px_120px_-40px_rgba(79,70,229,0.4)] backdrop-blur-2xl md:grid-cols-[0.7fr_1.3fr] w-full min-h-[540px] max-h-[calc(100vh-96px)] "+(z?"border-white/10 bg-white/5":"border-white/70 bg-white/60"),children:[U.jsxs("div",{className:"wave-panel-left info-panel-enter relative hidden md:flex items-center justify-center bg-gradient-to-br from-[#5f48ff] via-[#7c3aed] to-[#ec4899] min-h-[540px]",style:{"--panel-overlay":z?"rgba(12,16,32,0.92)":"#ffffff"},children:[U.jsx("div",{className:"glow-accent"}),U.jsxs("div",{className:"relative z-10 mx-auto flex max-w-sm flex-col gap-4 px-8 py-8 text-white",children:[U.jsx("span",{className:"inline-flex w-max items-center gap-2 rounded-full border border-white/45 bg-white/10 px-3 py-1 text-[10px] font-semibold uppercase tracking-[0.35em]",children:"Plan ahead"}),U.jsx("h2",{className:"text-2xl font-bold leading-tight",children:"Shape the Quest Academy experience in just five guided steps."}),U.jsx("p",{className:"text-xs text-white/85",children:"Craft quests, invite tutors, and unlock collaborative learning areas tailored to your skills."}),U.jsx("ul",{className:"space-y-2 text-xs text-white/90",children:["Create quests with multiple formats and difficulty levels","Invite mentors to review and approve community submissions","Unlock rewards as you build your personalised learning path"].map(e=>U.jsxs("li",{className:"flex items-start gap-2.5",children:[U.jsx("span",{className:"mt-[2px] rounded-full bg-white/15 p-1",children:U.jsx(Ot,{className:"h-3.5 w-3.5"})}),U.jsx("span",{children:e})]},e))}),U.jsxs(st,{to:"/login",className:"cta-button mt-2 inline-flex items-center justify-center gap-2 rounded-full bg-white/90 px-5 py-2.5 text-sm font-semibold text-purple-600 shadow-lg transition hover:-translate-y-1 hover:bg-white",children:["Back to login",U.jsx(yt,{className:"h-4 w-4"})]})]})]}),U.jsx("div",{className:"form-panel-enter relative flex flex-col gap-5 p-6 sm:p-8 overflow-y-auto "+(z?"bg-slate-950/85 text-white":"bg-white text-slate-900"),children:U.jsxs("div",{className:"space-y-3",children:[U.jsxs("div",{className:"flex flex-col gap-6",children:[U.jsxs("div",{children:[U.jsxs("p",{className:"text-[10px] font-semibold uppercase tracking-[0.35em] text-purple-500 mb-2",children:["Step ",t," of ",te.length]}),U.jsx("h1",{className:"text-2xl font-bold sm:text-3xl mb-2",children:"Create your Studiply account"}),U.jsx("p",{className:"text-xs leading-relaxed "+(z?"text-white/70":"text-slate-500"),children:"Tell us a little bit about you so we can match you with the right quests, mentors, and missions."})]}),U.jsx("div",{className:"w-full",children:U.jsxs("div",{className:"relative",children:[U.jsx("div",{className:"absolute left-0 right-0 top-6 h-0.5 rounded-full "+(z?"bg-white/10":"bg-slate-200")}),U.jsx("div",{className:"absolute left-0 top-6 h-0.5 rounded-full transition-all duration-500 ease-out",style:{width:`${Math.min(Math.max(re,0),100)}%`,background:"linear-gradient(90deg, #8b5cf6 0%, #ec4899 100%)"}}),U.jsx("div",{className:"relative flex justify-between items-start",children:te.map((e,s)=>{const r=t===e.number,a=t>e.number;return e.number,U.jsxs("div",{className:"flex flex-col items-center gap-2 flex-1 max-w-[20%]",children:[U.jsxs("div",{className:"relative",children:[U.jsx("span",{className:"flex h-12 w-12 items-center justify-center rounded-full text-sm font-bold transition-all duration-300 relative z-10 "+(a?"bg-gradient-to-br from-emerald-500 to-teal-500 text-white shadow-lg shadow-emerald-500/40":r?"bg-gradient-to-br from-purple-600 to-pink-500 text-white shadow-xl shadow-purple-500/50 scale-110 ring-4 ring-purple-500/20":z?"bg-slate-700/50 border-2 border-slate-600 text-slate-400":"bg-slate-100 border-2 border-slate-300 text-slate-400"),children:a?U.jsx(Ot,{className:"h-5 w-5"}):U.jsx("span",{className:r?"text-white":"",children:e.number})}),r&&U.jsx("span",{className:"absolute inset-0 rounded-full bg-purple-500/30 animate-ping"})]}),U.jsx("span",{className:"text-[10px] font-medium uppercase tracking-wider text-center leading-tight "+(r?z?"text-purple-300 font-semibold":"text-purple-600 font-semibold":a?z?"text-emerald-400":"text-emerald-600":z?"text-white/50":"text-slate-400"),children:e.title})]},e.number)})})]})})]}),U.jsx("div",{className:`${se}`,children:(()=>{switch(t){case 1:return U.jsxs("div",{className:"space-y-3",children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-xs font-semibold mb-1.5 "+(z?"text-white/90":"text-slate-700"),children:"Full Name"}),U.jsxs("div",{className:"relative group",children:[U.jsx("input",{name:"name",type:"text",className:"w-full px-4 py-2.5 pl-11 rounded-xl border transition-all input-focus-effect text-sm "+(z?"bg-white/5 border-white/10 text-white placeholder:text-white/40 focus:border-purple-400/60 focus:ring-4 focus:ring-purple-500/20":"bg-white/90 border-slate-200 text-slate-900 placeholder:text-slate-400 focus:border-purple-400 focus:ring-4 focus:ring-purple-500/20"),placeholder:"Enter your full name",value:r.name,onChange:V,disabled:u,required:!0}),U.jsx(Nr,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 "+(z?"text-white/60":"text-slate-400")})]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-xs font-semibold mb-1.5 "+(z?"text-white/90":"text-slate-700"),children:"Email Address"}),U.jsxs("div",{className:"relative group",children:[U.jsx("input",{name:"email",type:"email",className:"w-full px-4 py-2.5 pl-11 pr-11 rounded-xl border transition-all input-focus-effect text-sm "+(m?z?"bg-white/5 border-red-400/60 text-white placeholder:text-white/40 focus:border-red-400/60 focus:ring-4 focus:ring-red-500/20":"bg-white/90 border-red-300 text-slate-900 placeholder:text-slate-400 focus:border-red-400 focus:ring-4 focus:ring-red-500/20":p?z?"bg-white/5 border-purple-400/60 text-white placeholder:text-white/40 focus:border-purple-400/60 focus:ring-4 focus:ring-purple-500/20":"bg-white/90 border-purple-300 text-slate-900 placeholder:text-slate-400 focus:border-purple-400 focus:ring-4 focus:ring-purple-500/20":z?"bg-white/5 border-white/10 text-white placeholder:text-white/40 focus:border-purple-400/60 focus:ring-4 focus:ring-purple-500/20":"bg-white/90 border-slate-200 text-slate-900 placeholder:text-slate-400 focus:border-purple-400 focus:ring-4 focus:ring-purple-500/20"),placeholder:"Enter your email address",value:r.email,onChange:V,onBlur:Q,disabled:u||p,required:!0}),U.jsx(Is,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 "+(z?"text-white/60":"text-slate-400")}),p&&U.jsx(Es,{className:"absolute right-3.5 top-1/2 -translate-y-1/2 w-4 h-4 animate-spin "+(z?"text-purple-400":"text-purple-600")}),!p&&b&&r.email&&Y(r.email)&&(m?U.jsx(qr,{className:"absolute right-3.5 top-1/2 -translate-y-1/2 w-4 h-4 "+(z?"text-red-400":"text-red-500")}):U.jsx(Ut,{className:"absolute right-3.5 top-1/2 -translate-y-1/2 w-4 h-4 "+(z?"text-emerald-400":"text-emerald-500")}))]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-xs font-semibold mb-1.5 "+(z?"text-white/90":"text-slate-700"),children:"Password"}),U.jsxs("div",{className:"relative group",children:[U.jsx("input",{name:"password",type:"password",className:"w-full px-4 py-2.5 pl-11 rounded-xl border transition-all input-focus-effect text-sm "+(z?"bg-white/5 border-white/10 text-white placeholder:text-white/40 focus:border-purple-400/60 focus:ring-4 focus:ring-purple-500/20":"bg-white/90 border-slate-200 text-slate-900 placeholder:text-slate-400 focus:border-purple-400 focus:ring-4 focus:ring-purple-500/20"),placeholder:"Create a strong password",value:r.password,onChange:V,disabled:u,required:!0}),U.jsx(Ts,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 "+(z?"text-white/60":"text-slate-400")})]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-xs font-semibold mb-1.5 "+(z?"text-white/90":"text-slate-700"),children:"Confirm Password"}),U.jsxs("div",{className:"relative group",children:[U.jsx("input",{name:"confirmPassword",type:"password",className:"w-full px-4 py-2.5 pl-11 rounded-xl border transition-all input-focus-effect text-sm "+(z?"bg-white/5 border-white/10 text-white placeholder:text-white/40 focus:border-purple-400/60 focus:ring-4 focus:ring-purple-500/20":"bg-white/90 border-slate-200 text-slate-900 placeholder:text-slate-400 focus:border-purple-400 focus:ring-4 focus:ring-purple-500/20"),placeholder:"Confirm your password",value:r.confirmPassword,onChange:V,disabled:u,required:!0}),U.jsx(Ot,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 "+(z?"text-white/60":"text-slate-400")})]})]})]});case 2:return U.jsxs("div",{className:"space-y-3",children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-xs font-semibold mb-1.5 "+(z?"text-white/90":"text-slate-700"),children:"School/Institution"}),U.jsxs("div",{className:"relative school-dropdown-container",children:[U.jsxs("div",{className:"relative",children:[U.jsx("input",{type:"text",className:"w-full rounded-lg border text-sm px-10 py-2 transition-all "+(z?"bg-slate-900/70 border-slate-600 text-white placeholder:text-slate-400 focus:border-purple-400 focus:ring-2 focus:ring-purple-400/40":"bg-white border-slate-300 text-slate-800 placeholder:text-slate-400 focus:border-purple-400 focus:ring-2 focus:ring-purple-300/40"),placeholder:"Search for your school...",value:N?S:r.school,onChange:e=>{N?C(e.target.value):a(t=>({...t,school:e.target.value}))},onFocus:()=>{k(!0),C("")},disabled:u,required:!0}),U.jsx(Pt,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 "+(z?"text-white/60":"text-slate-400")}),U.jsx("svg",{className:`absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 transition-transform duration-200 ${z?"text-white/60":"text-slate-400"} ${N?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:U.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),N&&U.jsxs("div",{className:"mt-2 rounded-lg border shadow-xl z-20 max-h-56 overflow-hidden "+(z?"bg-slate-900 border-slate-700":"bg-white border-slate-300"),children:[U.jsx("div",{className:"p-2 border-b "+(z?"border-slate-700":"border-slate-200"),children:U.jsxs("div",{className:"relative",children:[U.jsx(er,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),U.jsx("input",{type:"text",className:"w-full pl-9 pr-3 py-2 rounded-md border text-sm "+(z?"bg-slate-800 border-slate-600 text-white placeholder:text-slate-400 focus:border-purple-400 focus:outline-none":"bg-white border-slate-200 text-slate-800 placeholder:text-slate-400 focus:border-purple-400 focus:outline-none"),placeholder:"Search schools...",value:S,onChange:e=>C(e.target.value),autoFocus:!0})]})}),U.jsx("div",{className:`max-h-40 overflow-y-auto ${z?"divide-slate-700":"divide-slate-200"} divide-y`,children:G.length>0?G.map(e=>U.jsxs("button",{type:"button",className:"w-full px-3 py-2.5 text-left text-sm transition-colors flex items-center justify-between "+(r.school===e?z?"bg-purple-600 text-white":"bg-purple-100 text-purple-700":z?"text-white hover:bg-slate-800":"text-slate-700 hover:bg-slate-50"),onClick:()=>{a(t=>({...t,school:e})),k(!1),C("")},onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),a(t=>({...t,school:e})),k(!1),C(""))},role:"option","aria-selected":r.school===e,children:[U.jsx("span",{children:e}),r.school===e&&U.jsx(Ot,{className:"w-4 h-4 flex-shrink-0 "+(z?"text-white":"text-purple-600")})]},e)):U.jsx("div",{className:"px-4 py-4 text-center text-sm "+(z?"text-slate-400":"text-slate-500"),children:"No schools found"})}),S&&!G.some(e=>e.toLowerCase()===S.toLowerCase())&&U.jsx("div",{className:"p-2 border-t "+(z?"border-slate-700 bg-slate-900":"border-slate-200 bg-white"),children:U.jsxs("button",{type:"button",className:"w-full px-3 py-2 rounded-md text-sm font-medium transition-colors "+(z?"bg-slate-800 text-white hover:bg-slate-700":"bg-slate-50 text-slate-700 hover:bg-slate-100"),onClick:()=>{a(e=>({...e,school:S})),k(!1),C("")},children:['Use "',S,'" as school name']})})]})]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-xs font-semibold mb-1.5 "+(z?"text-white/90":"text-slate-700"),children:"Grade Level"}),U.jsxs("div",{className:"relative dropdown-container",children:[U.jsxs("button",{type:"button",className:"w-full px-4 py-2 text-left flex items-center justify-between rounded-lg border text-sm transition-all "+(z?"bg-slate-900/70 border-slate-600 text-white focus:border-purple-400 focus:ring-2 focus:ring-purple-400/30":"bg-white border-slate-300 text-slate-800 focus:border-purple-400 focus:ring-2 focus:ring-purple-300/40"),onClick:()=>j(!v),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),j(!v))},disabled:u,"aria-expanded":v,"aria-haspopup":"listbox",children:[U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx(Pt,{className:"w-4 h-4 "+(z?"text-white/60":"text-slate-400")}),U.jsx("span",{className:""+(r.grade?z?"text-white":"text-slate-800":z?"text-white/50":"text-slate-400"),children:r.grade||"Select your grade level"})]}),U.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${z?"text-white/60":"text-slate-400"} ${v?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:U.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),v&&U.jsx("div",{className:"mt-2 rounded-lg border shadow-xl z-20 max-h-44 overflow-y-auto "+(z?"bg-slate-900 border-slate-700":"bg-white border-slate-300"),role:"listbox",children:U.jsx("div",{className:`py-1 ${z?"divide-slate-700":"divide-slate-200"} divide-y`,children:J.map(e=>U.jsxs("button",{type:"button",className:"w-full px-3 py-2.5 text-left text-sm transition-colors flex items-center justify-between "+(r.grade===e?z?"bg-purple-600 text-white":"bg-purple-100 text-purple-700":z?"text-white hover:bg-slate-800":"text-slate-700 hover:bg-slate-50"),onClick:()=>{a(t=>({...t,grade:e})),j(!1)},onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),a(t=>({...t,grade:e})),j(!1))},role:"option","aria-selected":r.grade===e,children:[U.jsx("span",{children:e}),r.grade===e&&U.jsx(Ot,{className:"w-4 h-4 flex-shrink-0 "+(z?"text-white":"text-purple-600")})]},e))})})]})]})]});case 3:return U.jsxs("div",{className:"space-y-3",children:[U.jsxs("div",{children:[U.jsxs("label",{className:"block text-xs font-semibold mb-1.5 "+(z?"text-white/90":"text-slate-700"),children:["Phone Number ",r.phone&&R&&U.jsx("span",{className:"text-xs font-normal text-green-500 ml-2",children:" Verified"})]}),U.jsxs("div",{className:"relative group",children:[U.jsx("input",{name:"phone",type:"tel",className:"w-full px-4 py-2.5 pl-11 rounded-xl border transition-all input-focus-effect text-sm "+(z?"bg-white/5 border-white/10 text-white placeholder:text-white/40 focus:border-purple-400/60 focus:ring-4 focus:ring-purple-500/20":"bg-white/90 border-slate-200 text-slate-900 placeholder:text-slate-400 focus:border-purple-400 focus:ring-4 focus:ring-purple-500/20"),placeholder:"Enter your phone number (e.g., +1234567890)",value:r.phone,onChange:V,onBlur:e=>{e.target.value.trim()&&!R&&L(!0)},disabled:u}),U.jsx(Gs,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 "+(z?"text-white/60":"text-slate-400")})]}),r.phone&&!R&&U.jsx("button",{type:"button",onClick:()=>L(!0),className:"mt-2 text-sm font-medium transition-all "+(z?"text-purple-400 hover:text-purple-300":"text-purple-600 hover:text-purple-700"),children:"Verify phone number"})]}),U.jsxs("div",{children:[U.jsxs("label",{className:"block text-xs font-semibold mb-1.5 "+(z?"text-white/90":"text-slate-700"),children:["Location ",U.jsx("span",{className:"text-xs font-normal opacity-70",children:"(Optional)"})]}),U.jsxs("div",{className:"relative group",children:[U.jsx("input",{name:"location",type:"text",className:"w-full px-4 py-2.5 pl-11 rounded-xl border transition-all input-focus-effect text-sm "+(z?"bg-white/5 border-white/10 text-white placeholder:text-white/40 focus:border-purple-400/60 focus:ring-4 focus:ring-purple-500/20":"bg-white/90 border-slate-200 text-slate-900 placeholder:text-slate-400 focus:border-purple-400 focus:ring-4 focus:ring-purple-500/20"),placeholder:"Enter your city, state",value:r.location,onChange:V,disabled:u}),U.jsx(Ps,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 "+(z?"text-white/60":"text-slate-400")})]})]})]});case 4:return U.jsxs("div",{className:"space-y-3",children:[U.jsxs("div",{children:[U.jsxs("label",{className:"block text-xs font-semibold mb-1.5 "+(z?"text-white/90":"text-slate-700"),children:["Bio ",U.jsx("span",{className:"text-xs font-normal opacity-70",children:"(Optional)"})]}),U.jsx("textarea",{name:"bio",rows:3,className:"w-full px-4 py-3 rounded-xl border transition-all resize-none "+(z?"bg-white/5 border-white/10 text-white placeholder:text-white/40 focus:border-purple-400/50 focus:ring-2 focus:ring-purple-500/30":"bg-white border-slate-200 text-slate-900 placeholder:text-slate-400 focus:border-purple-300 focus:ring-2 focus:ring-purple-500/20"),placeholder:"Tell us a bit about yourself and your interests",value:r.bio,onChange:V,disabled:u})]}),U.jsxs("div",{children:[U.jsxs("label",{className:"block text-xs font-semibold mb-1.5 "+(z?"text-white/90":"text-slate-700"),children:["Subjects of Interest ",U.jsx("span",{className:"text-xs font-normal opacity-70",children:"(Optional)"})]}),U.jsx("div",{className:"grid grid-cols-2 gap-3 max-h-48 overflow-y-auto border rounded-2xl p-4 "+(z?"border-white/20 bg-white/5":"border-slate-200 bg-slate-50"),children:K.map(e=>U.jsxs("label",{className:"flex items-center gap-3 text-sm group cursor-pointer",children:[U.jsxs("div",{className:"relative",children:[U.jsx("input",{type:"checkbox",checked:r.subjects.includes(e),onChange:()=>(e=>{a(t=>({...t,subjects:t.subjects.includes(e)?t.subjects.filter(t=>t!==e):[...t.subjects,e]}))})(e),disabled:u,className:"sr-only"}),U.jsx("div",{className:"w-5 h-5 border-2 rounded transition-all duration-200 flex items-center justify-center "+(r.subjects.includes(e)?"bg-gradient-to-r from-purple-500 to-pink-500 border-purple-400":z?"bg-white/10 border-white/30 group-hover:bg-white/20":"bg-white border-slate-300 group-hover:bg-slate-100"),children:r.subjects.includes(e)&&U.jsx(Ot,{className:"w-3 h-3 text-white"})})]}),U.jsx("span",{className:(z?"text-white/80 group-hover:text-white":"text-slate-700 group-hover:text-slate-900")+" transition-colors duration-200",children:e})]},e))}),r.subjects.length>0&&U.jsxs("div",{className:"mt-3",children:[U.jsx("p",{className:"text-xs mb-2 "+(z?"text-white/70":"text-slate-600"),children:"Selected:"}),U.jsx("div",{className:"flex flex-wrap gap-2",children:r.subjects.map(e=>U.jsx("span",{className:"px-3 py-1 text-xs rounded-full border "+(z?"bg-gradient-to-r from-purple-500/30 to-pink-500/30 text-white/90 border-white/20":"bg-gradient-to-r from-purple-100 to-pink-100 text-purple-700 border-purple-200"),children:e},e))})]})]})]});case 5:return U.jsxs("div",{className:"space-y-6",children:[U.jsxs("div",{className:"text-center space-y-4",children:[U.jsx("div",{className:"w-16 h-16 mx-auto bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 rounded-full flex items-center justify-center shadow-lg",children:U.jsx(Is,{className:"w-8 h-8 text-white"})}),U.jsx("h3",{className:"text-2xl font-bold "+(z?"text-white":"text-slate-900"),children:"Verify Your Email"}),U.jsxs("p",{className:z?"text-white/70":"text-slate-600",children:["We've sent a verification code to ",U.jsx("span",{className:"font-semibold "+(z?"text-purple-300":"text-purple-600"),children:r.email})]})]}),U.jsxs("div",{className:"space-y-4",children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(z?"text-white/90":"text-slate-700"),children:"Enter 6-digit verification code"}),U.jsx("input",{type:"text",maxLength:"6",value:T,onChange:e=>I(e.target.value.replace(/\D/g,"")),className:"w-full px-4 py-3.5 rounded-xl border text-center text-lg font-mono tracking-widest transition-all input-focus-effect "+(z?"bg-white/5 border-white/10 text-white placeholder:text-white/40 focus:border-purple-400/60 focus:ring-4 focus:ring-purple-500/20":"bg-white/90 border-slate-200 text-slate-900 placeholder:text-slate-400 focus:border-purple-400 focus:ring-4 focus:ring-purple-500/20"),placeholder:"123456",disabled:u})]}),n&&U.jsx("div",{className:"p-3 rounded-lg text-sm border "+(z?"bg-red-500/20 border-red-400/30 text-red-300":"bg-red-50 border-red-200 text-red-700"),children:n}),U.jsxs("div",{className:"space-y-3",children:[U.jsx("button",{onClick:Z,disabled:u||!T||6!==T.length,className:"w-full py-3.5 px-6 rounded-xl font-semibold shadow-lg transition-all duration-300 hover:-translate-y-0.5 hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none "+(z?"bg-gradient-to-r from-purple-500 via-pink-500 to-blue-500 text-white hover:from-purple-600 hover:via-pink-600 hover:to-blue-600":"bg-gradient-to-r from-blue-500 to-purple-600 text-white hover:from-blue-600 hover:to-purple-700"),children:u?E?"Creating account...":"Verifying...":"Verify Email & Create Account"}),U.jsx("button",{onClick:ee,className:"w-full font-medium py-2 transition-colors duration-200 "+(z?"text-white/70 hover:text-white":"text-slate-600 hover:text-slate-900"),children:"Resend verification code"})]})]}),E&&U.jsx("div",{className:"p-4 rounded-lg text-center border "+(z?"bg-emerald-500/20 border-emerald-400/30 text-emerald-300":"bg-emerald-50 border-emerald-200 text-emerald-700"),children:U.jsxs("div",{className:"flex items-center justify-center gap-2",children:[U.jsx(Ot,{className:"w-5 h-5"}),U.jsx("span",{className:"font-medium",children:"Email verified successfully!"})]})})]});default:return null}})()}),U.jsxs("div",{className:"flex flex-col gap-3 border-t pt-4 "+(z?"border-white/10":"border-slate-200"),children:[U.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[t>1?U.jsxs("button",{type:"button",onClick:()=>{i(""),B("backward"),s(t-1)},disabled:u,className:"inline-flex items-center gap-2 rounded-full border px-6 py-3 text-sm font-semibold transition hover:-translate-y-1 hover:shadow-md "+(z?"border-white/20 bg-white/10 text-white hover:bg-white/15":"border-slate-200 bg-white text-slate-700 hover:bg-slate-50"),children:[U.jsx(yt,{className:"h-4 w-4 rotate-180"}),"Back"]}):U.jsx("span",{className:"hidden sm:block"}),t<5?U.jsxs("button",{type:"button",onClick:()=>{(e=>{switch(e){case 1:return r.name&&r.email&&r.password&&r.confirmPassword&&r.password===r.confirmPassword&&!m;case 2:return r.school&&r.grade;case 3:case 4:return!0;default:return!1}})(t)?(i(""),B("forward"),4===t?(s(5),X()):s(t+1)):i("Please fill in all required fields")},disabled:u,className:"cta-button inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-[#6366f1] via-[#8b5cf6] to-[#ec4899] px-8 py-3 text-sm font-semibold text-white shadow-lg transition hover:-translate-y-1 hover:shadow-2xl "+(v||N?"pointer-events-none opacity-60":""),children:["Continue",U.jsx(yt,{className:"h-4 w-4"})]}):U.jsx("span",{className:"hidden sm:block"})]}),U.jsxs("p",{className:`text-center text-sm ${z?"text-white/60":"text-slate-500"} sm:hidden`,children:["Already registered?"," ",U.jsx(st,{to:"/login",className:"font-semibold text-purple-500 hover:text-purple-600 hover:underline",children:"Sign in here"})]})]})]})})]})})}),U.jsx(Ta,{isOpen:D,onClose:()=>L(!1),phoneNumber:r.phone,onVerified:()=>{M(!0),L(!1)}})]})},Pa=e=>{if(!e)return new Date;try{if(e instanceof Date)return e;if(e.toDate&&"function"==typeof e.toDate)return e.toDate();if(e.seconds&&"number"==typeof e.seconds)return new Date(1e3*e.seconds);if("number"==typeof e)return new Date(e);if("string"==typeof e){const t=new Date(e);if(!isNaN(t.getTime()))return t}const t=new Date(e);return isNaN(t.getTime())?new Date:t}catch(t){return console.error("Error converting timestamp to date:",t,"Original timestamp:",e),new Date}},qa=e=>{if(!e)return 0;try{if(e instanceof Date)return e.getTime();if(e.toMillis&&"function"==typeof e.toMillis)return e.toMillis();if(e.seconds&&"number"==typeof e.seconds)return 1e3*e.seconds;if("number"==typeof e)return e;return Pa(e).getTime()}catch(t){return console.error("Error converting timestamp to millis:",t,"Original timestamp:",e),0}},Ra=(e,t={})=>{const s={year:"numeric",month:"short",day:"numeric",...t};try{const t=Pa(e);return!t||isNaN(t.getTime())?"Unknown":t.toLocaleDateString("en-US",s)}catch(r){return console.error("Error formatting timestamp:",r,"Original timestamp:",e),"Unknown"}},Ma=async()=>{var e,t,s,r,a,n;try{const i=o(dt,"users"),u=l(i,c("isTutor","==",!0)),h=await d(u),m=[];for(const o of h.docs){const i=o.data(),l=await Da(o.id),c=i.subjects&&i.subjects.length>0?i.subjects:(null==(e=i.tutorProfile)?void 0:e.specialties)||[];m.push({id:o.id,name:i.name,email:i.email,school:i.school,grade:i.grade,bio:i.bio,subjects:c,tutorProfile:i.tutorProfile||{},stats:l,location:i.location||"Online",isAvailable:!1!==(null==(t=i.tutorProfile)?void 0:t.isAvailable),specialties:(null==(s=i.tutorProfile)?void 0:s.specialties)||c,description:(null==(r=i.tutorProfile)?void 0:r.description)||i.bio||`${i.name} is available to help with your studies.`,experience:(null==(a=i.tutorProfile)?void 0:a.experience)||"Student",rating:l.averageRating||0,totalSessions:l.totalSessions||0,responseTime:(null==(n=i.tutorProfile)?void 0:n.responseTime)||"Usually responds within a few hours",avatar:i.avatar||null})}return m.sort((e,t)=>t.rating-e.rating),{success:!0,tutors:m}}catch(i){return console.error("Error getting all tutors:",i),{success:!1,tutors:[],error:"Failed to load tutors"}}},Da=async e=>{try{console.log(" Getting tutor stats for user:",e);const t=u(dt,"tutorStats",e),[s,r,a]=await Promise.all([m(t),d(l(o(dt,"sessions"),c("tutorId","==",e))),d(l(o(dt,"ratings"),c("tutorId","==",e)))]),n=r.size;let i=0;r.forEach(e=>{"completed"===(e.data()||{}).status&&(i+=1)});const h=a.size;let x=0;a.forEach(e=>{const t=e.data()||{};x+=Number(t.rating)||0});const p=h>0?x/h:0;if(s.exists()){const t=s.data();console.log(" Tutor stats found (with live aggregation):",{userId:e,stored:t,aggregated:{totalSessions:n,completedSessions:i,ratingCount:h,totalRating:x,averageRating:p}})}else console.log(" No tutor stats found for user:",e," using live aggregation only");return{totalSessions:n,completedSessions:i,ratingCount:h,totalRating:x,averageRating:p,totalEarnings:s.exists()&&s.data().totalEarnings||0}}catch(t){return console.error("Error getting tutor stats:",t),{totalSessions:0,completedSessions:0,ratingCount:0,totalRating:0,averageRating:0,totalEarnings:0}}},La=async(e,t,s)=>{const r=o(dt,e),a=l(r,c(t,"==",s)),n=await d(a);if(n.empty)return 0;const i=[];let u=w(dt),h=0;return n.docs.forEach((e,t)=>{u.delete(e.ref),h+=1,h%400==0&&(i.push(u.commit()),u=w(dt))}),h%400!=0&&i.push(u.commit()),await Promise.all(i),n.size},Fa=async(e,t)=>{try{const s=u(dt,"users",e);return await x(s,{isTutor:!0,tutorProfile:{isAvailable:!1!==t.isAvailable,specialties:t.specialties||[],description:t.description||"",experience:t.experience||"Student",responseTime:t.responseTime||"Usually responds within a few hours",updatedAt:p()},updatedAt:p()}),{success:!0,message:"Tutor profile updated successfully"}}catch(s){return console.error("Error setting user as tutor:",s),{success:!1,error:s.message}}},Ua=async(e,t)=>{try{const s=o(dt,"tutoringSessions"),r=l(s,c("studentId","==",e),c("tutorId","==",t),c("status","in",["pending","accepted"])),a=await d(r);return{success:!0,hasExistingRequest:!a.empty,existingSession:a.empty?null:a.docs[0].data()}}catch(s){return console.error("Error checking existing request:",s),{success:!1,hasExistingRequest:!1,error:s.message}}},$a=async e=>{try{const s=u(dt,"users",e),[r,a,n]=await Promise.all([La("sessions","tutorId",e),La("tutoringSessions","tutorId",e),La("ratings","tutorId",e)]);let i=!1;try{await f(u(dt,"tutorStats",e)),i=!0}catch(t){console.warn(" Unable to delete tutor stats for user:",e,t)}return await x(s,{isTutor:!1,tutorProfile:null,updatedAt:p()}),{success:!0,message:"Tutor status removed successfully",removedSessions:r+a,removedLegacySessions:a,removedRatings:n,removedStats:i}}catch(s){return console.error("Error removing tutor status:",s),{success:!1,error:s.message}}},Oa=Object.freeze(Object.defineProperty({__proto__:null,checkExistingRequest:Ua,createTutorProfile:async(e,t)=>{try{const s=u(dt,"users",e),r=parseFloat(t.hourlyRate)||15;await x(s,{isTutor:!0,subjects:[t.subjects],tutorProfile:{subjects:[t.subjects],experience:t.experience,description:t.description,availability:t.availability,hourlyRate:r,isAvailable:!0,createdAt:p(),updatedAt:p()},updatedAt:p()});const a=u(dt,"tutorStats",e);return await h(a,{totalSessions:0,totalRating:0,ratingCount:0,totalEarnings:0,pendingEarnings:0,completedSessions:0,createdAt:p(),updatedAt:p()}),{success:!0,message:"Tutor profile created successfully"}}catch(s){return console.error("Error creating tutor profile:",s),{success:!1,error:s.message}}},createTutoringSession:async(e,t,s)=>{try{const r=o(dt,"tutoringSessions");return{success:!0,sessionId:(await b(r,{studentId:e,tutorId:t,subject:s.subject,description:s.description,preferredTime:s.preferredTime,duration:s.duration||60,status:"pending",createdAt:p(),updatedAt:p()})).id,message:"Tutoring session request sent successfully"}}catch(r){return console.error("Error creating tutoring session:",r),{success:!1,error:r.message}}},getAllTutors:Ma,getTutorStats:Da,getUserTutoringSessions:async e=>{try{const t=o(dt,"tutoringSessions"),s=l(t,c("studentId","==",e)),r=l(t,c("tutorId","==",e)),[a,n]=await Promise.all([d(s),d(r)]),i=[];for(const e of a.docs){const t=e.data(),s=await m(u(dt,"users",t.tutorId));i.push({id:e.id,...t,type:"student",tutor:s.exists()?s.data():null})}for(const e of n.docs){const t=e.data(),s=await m(u(dt,"users",t.studentId));i.push({id:e.id,...t,type:"tutor",student:s.exists()?s.data():null})}return i.sort((e,t)=>{const s=Pa(e.createdAt).getTime();return Pa(t.createdAt).getTime()-s}),{success:!0,sessions:i}}catch(t){return console.error("Error getting tutoring sessions:",t),{success:!1,sessions:[],error:t.message}}},removeUserAsTutor:$a,searchTutors:async(e={})=>{try{const t=await Ma();if(!t.success)return t;let s=t.tutors;if(e.subject&&"all"!==e.subject){const t=e.subject.toLowerCase();s=s.filter(e=>{if(!e.subjects||0===e.subjects.length)return!1;return[...e.subjects||[],...e.specialties||[]].some(e=>{const s=e.toLowerCase();return s===t||s.includes(t)||t.includes(s)})})}if(e.searchQuery){const t=e.searchQuery.toLowerCase();s=s.filter(e=>e.name.toLowerCase().includes(t)||e.specialties.some(e=>e.toLowerCase().includes(t))||e.description.toLowerCase().includes(t))}return e.minRating&&(s=s.filter(t=>t.rating>=e.minRating)),e.availableOnly&&(s=s.filter(e=>e.isAvailable)),{success:!0,tutors:s}}catch(t){return console.error("Error searching tutors:",t),{success:!1,tutors:[],error:t.message}}},setUserAsTutor:Fa,updateTutoringSessionStatus:async(e,t,s)=>{try{const s=u(dt,"sessions",e);return await x(s,{status:t,updatedAt:p(),tutorActionAt:p()}),{success:!0,message:`Session ${t} successfully`}}catch(r){return console.error("Error updating session status:",r),{success:!1,error:r.message}}}},Symbol.toStringTag,{value:"Module"})),Ba=async(e,t,s,r,a={})=>{try{const n=o(dt,"notifications");return await b(n,{userId:e,type:t,title:s,message:r,read:!1,createdAt:p(),...a}),{success:!0}}catch(To){return console.error("createNotification error:",To),{success:!1,error:To.message}}},_a=(e,t)=>{const s=o(dt,"notifications"),r=l(s,c("userId","==",e),c("read","==",!1));return g(r,e=>{t(e.size)})},za=(e,t,s=20)=>{const r=o(dt,"notifications"),a=l(r,c("userId","==",e)),n=g(a,e=>{const r=e.docs.map(e=>({id:e.id,...e.data()}));r.sort((e,t)=>{const s=qa(e.createdAt);return qa(t.createdAt)-s}),t(r.slice(0,s))},e=>{console.error("subscribeNotifications error:",e),t([])});return()=>{n&&n()}},Wa=async e=>{try{const t=o(dt,"notifications"),s=l(t,c("userId","==",e),c("read","==",!1)),r=await d(s),a=[];return r.forEach(e=>a.push(x(u(dt,"notifications",e.id),{read:!0}))),await Promise.all(a),{success:!0}}catch(To){return console.error("markAllNotificationsRead error:",To),{success:!1,error:To.message}}},Ha=Object.freeze(Object.defineProperty({__proto__:null,createNotification:Ba,markAllNotificationsRead:Wa,subscribeNotifications:za,subscribeUnreadCount:_a},Symbol.toStringTag,{value:"Module"})),Ga=async e=>{const t=[];for(const s of e.docs){const e=s.data(),r=await m(u(dt,"users",e.studentId)),a=r.exists()?r.data():{name:"Unknown",email:"",avatar:null};t.push({id:s.id,...e,student:{id:e.studentId,name:a.name,email:a.email,avatar:a.avatar||null}})}return t},Va=async(e,t={})=>{try{console.log(" startSession :",{sessionId:e,additionalData:t});const s=u(dt,"sessions",e),r=await m(s);if(!r.exists())return console.error(" Session does not exist:",e),{success:!1,error:"Session not found"};const a=r.data();if(console.log(" :",a),"accepted"!==a.status&&"active"!==a.status)return console.error(" Session status is not accepted or active:",a.status),{success:!1,error:"Session can start only after tutor accepts"};const n={status:"active",startedAt:p(),updatedAt:p(),...t};return console.log(" :",n),await x(s,n),console.log(" :",e),{success:!0,message:"Session started successfully"}}catch(s){return console.error("Error starting session:",s),{success:!1,error:"Failed to start session"}}},Ya={}.VITE_API_BASE_URL||"http://localhost:3003/api",Qa=async(e,t,s="DE")=>{try{console.log(" Creating Stripe Connect account...",{tutorId:e,email:t,country:s});const r=await fetch(`${Ya}/stripe-connect/create-account`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tutorId:e,email:t,country:s})}),a=await r.json();return console.log(" Create account result:",a),a}catch(r){return console.error("Error creating Stripe Connect account:",r),{success:!1,error:"Network error. Please try again."}}},Ja=async e=>{try{console.log(" Checking Stripe Connect status...",{tutorId:e});const t=await fetch(`${Ya}/stripe-connect/status/${e}`),s=await t.json();return console.log(" Connect status result:",s),s}catch(t){return console.error("Error getting Stripe Connect status:",t),{success:!1,error:"Network error. Please try again."}}},Ka=({user:t,onClose:s,onSuccess:r})=>{const{showSuccess:a,showError:n}=Hr(),{reloadUser:i}=Br(),[o,l]=e.useState(!1),[c,d]=e.useState(1),[u,h]=e.useState({isAvailable:!0,specialties:[],description:"",experience:"Student",responseTime:"Usually responds within a few hours"}),m=e=>{const{name:t,value:s,type:r,checked:a}=e.target;h(e=>({...e,[t]:"checkbox"===r?a:s}))};return U.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:U.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[U.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100",children:[U.jsxs("div",{children:[U.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Become a Tutor"}),U.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Step ",c," of 2"]})]}),U.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors p-2 hover:bg-gray-100 rounded-full",children:U.jsx(Rr,{className:"w-5 h-5"})})]}),U.jsxs("div",{className:"px-6 pt-4",children:[U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx("div",{className:"flex-1 h-2 rounded-full "+(c>=1?"bg-purple-500":"bg-gray-200")}),U.jsx("div",{className:"flex-1 h-2 rounded-full "+(c>=2?"bg-purple-500":"bg-gray-200")})]}),U.jsxs("div",{className:"flex justify-between mt-2 text-xs text-gray-500",children:[U.jsx("span",{className:1===c?"text-purple-600 font-semibold":"",children:"Profile Info"}),U.jsx("span",{className:2===c?"text-purple-600 font-semibold":"",children:"Bank Account"})]})]}),1===c&&U.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),null==t?void 0:t.id)if(0!==u.specialties.length){l(!0);try{const e=await Fa(null==t?void 0:t.id,u);e.success?d(2):n(`Failed to setup tutor profile: ${e.error}`)}catch(s){n("An error occurred while setting up your tutor profile"),console.error("Error setting up tutor profile:",s)}finally{l(!1)}}else n("Please select at least one subject you can teach")},className:"p-6 space-y-6",children:[U.jsx("div",{className:"bg-purple-50 rounded-xl p-4",children:U.jsxs("label",{className:"flex items-center space-x-3",children:[U.jsx("input",{type:"checkbox",name:"isAvailable",checked:u.isAvailable,onChange:m,className:"rounded border-gray-300 text-purple-600 shadow-sm focus:border-purple-300 focus:ring focus:ring-purple-200 focus:ring-opacity-50 w-5 h-5"}),U.jsxs("div",{children:[U.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Available for tutoring"}),U.jsx("p",{className:"text-xs text-gray-500",children:"Students can request sessions from you"})]})]})}),U.jsxs("div",{children:[U.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[U.jsx(Nr,{className:"w-4 h-4 inline mr-2"}),"Experience Level"]}),U.jsx("select",{name:"experience",value:u.experience,onChange:m,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-gray-50",children:["Student","Recent Graduate","Graduate Student","Professional","Teacher/Professor"].map(e=>U.jsx("option",{value:e,children:e},e))})]}),U.jsxs("div",{children:[U.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[U.jsx(Pt,{className:"w-4 h-4 inline mr-2"}),"Subjects You Can Teach ",U.jsx("span",{className:"text-red-500",children:"*"})]}),U.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 max-h-40 overflow-y-auto border border-gray-200 rounded-xl p-4 bg-gray-50",children:["Mathematics","Science","Physics","Chemistry","Biology","English","Literature","Writing","History","Geography","Art","Music","Programming","Computer Science","Economics","Psychology","Philosophy","Languages","Other"].map(e=>U.jsxs("label",{className:"flex items-center space-x-2 text-sm cursor-pointer hover:bg-white p-1 rounded",children:[U.jsx("input",{type:"checkbox",checked:u.specialties.includes(e),onChange:()=>{return t=e,void h(e=>({...e,specialties:e.specialties.includes(t)?e.specialties.filter(e=>e!==t):[...e.specialties,t]}));var t},className:"rounded border-gray-300 text-purple-600 shadow-sm focus:border-purple-300 focus:ring focus:ring-purple-200 focus:ring-opacity-50"}),U.jsx("span",{className:"text-gray-700",children:e})]},e))}),0===u.specialties.length&&U.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Please select at least one subject"})]}),U.jsxs("div",{children:[U.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[U.jsx(Ht,{className:"w-4 h-4 inline mr-2"}),"Response Time"]}),U.jsx("select",{name:"responseTime",value:u.responseTime,onChange:m,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-gray-50",children:["Usually responds within a few hours","Usually responds within a day","Usually responds within a few days"].map(e=>U.jsx("option",{value:e,children:e},e))})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"About You"}),U.jsx("textarea",{name:"description",value:u.description,onChange:m,placeholder:"Tell students about your teaching style, experience, and what makes you a great tutor...",rows:3,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-gray-50"})]}),U.jsxs("div",{className:"flex space-x-4 pt-4 border-t border-gray-100",children:[U.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-3 border border-gray-200 rounded-xl text-gray-700 hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),U.jsx("button",{type:"submit",disabled:o||0===u.specialties.length,className:"flex-1 px-4 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl hover:from-purple-600 hover:to-pink-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center font-semibold shadow-lg shadow-purple-500/30",children:o?U.jsxs(U.Fragment,{children:[U.jsx(As,{className:"w-5 h-5 animate-spin mr-2"}),"Saving..."]}):U.jsxs(U.Fragment,{children:["Next: Bank Setup",U.jsx(yt,{className:"w-5 h-5 ml-2"})]})})]})]}),2===c&&U.jsxs("div",{className:"p-6 space-y-6",children:[U.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3",children:[U.jsx($t,{className:"w-6 h-6 text-green-500 flex-shrink-0 mt-0.5"}),U.jsxs("div",{children:[U.jsx("p",{className:"font-semibold text-green-800",children:"Profile Created!"}),U.jsx("p",{className:"text-sm text-green-600",children:"Now let's set up your bank account to receive payments."})]})]}),U.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-100",children:[U.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[U.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl",children:U.jsx(Mt,{className:"w-8 h-8 text-white"})}),U.jsxs("div",{children:[U.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Connect Your Bank Account"}),U.jsx("p",{className:"text-sm text-gray-600",children:"Required to receive payments from students"})]})]}),U.jsx("div",{className:"space-y-3 mb-6",children:["Receive payments directly to your bank account","Automatic payouts after each completed session","Secure processing powered by Stripe","View detailed earnings and payout history"].map((e,t)=>U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx($t,{className:"w-5 h-5 text-green-500 flex-shrink-0"}),U.jsx("span",{className:"text-sm text-gray-700",children:e})]},t))}),U.jsxs("div",{className:"flex items-start gap-3 bg-white/70 rounded-lg p-3",children:[U.jsx(rr,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),U.jsx("p",{className:"text-xs text-gray-600",children:"Your bank details are securely handled by Stripe and never stored on our servers. Stripe is trusted by millions of businesses worldwide."})]})]}),U.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4",children:U.jsxs("p",{className:"text-sm text-orange-700",children:[U.jsx("strong",{children:"Important:"})," Without connecting your bank account, you won't be able to accept tutoring sessions."]})}),U.jsxs("div",{className:"space-y-3",children:[U.jsx("button",{onClick:async()=>{if((null==t?void 0:t.id)&&(null==t?void 0:t.email)){l(!0);try{const e=await Qa(t.id,t.email);if(e.success)if(e.isVerified){a("Bank account already verified! Your tutor profile is now complete.");const e={...t,isTutor:!0};localStorage.setItem("simpleUser",JSON.stringify(e)),i(),r&&r(),s()}else e.onboardingUrl&&(a("Redirecting to Stripe to complete bank setup..."),localStorage.setItem("tutorSetupPending","true"),window.location.href=e.onboardingUrl);else n(e.error||"Failed to connect bank account")}catch(e){n("An error occurred while connecting bank account"),console.error("Error connecting bank:",e)}finally{l(!1)}}else n("User information not available")},disabled:o,className:"w-full py-4 px-6 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl hover:from-purple-600 hover:to-pink-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center font-bold shadow-lg shadow-purple-500/30",children:o?U.jsxs(U.Fragment,{children:[U.jsx(As,{className:"w-5 h-5 animate-spin mr-2"}),"Connecting..."]}):U.jsxs(U.Fragment,{children:[U.jsx(Kt,{className:"w-5 h-5 mr-2"}),"Connect Bank Account",U.jsx(ns,{className:"w-4 h-4 ml-2"})]})}),U.jsxs("div",{className:"flex gap-3",children:[U.jsxs("button",{onClick:()=>d(1),disabled:o,className:"flex-1 py-3 px-4 border border-gray-200 rounded-xl text-gray-700 hover:bg-gray-50 transition-colors font-medium flex items-center justify-center",children:[U.jsx(wt,{className:"w-4 h-4 mr-2"}),"Back"]}),U.jsx("button",{onClick:()=>{a("Tutor profile created! Note: You must connect your bank account before accepting sessions.");const e={...t,isTutor:!0};localStorage.setItem("simpleUser",JSON.stringify(e)),i(),r&&r(),s()},disabled:o,className:"flex-1 py-3 px-4 border border-gray-200 rounded-xl text-gray-500 hover:bg-gray-50 transition-colors text-sm",children:"Skip for now"})]}),U.jsx("p",{className:"text-xs text-center text-gray-400",children:"You can connect your bank account later from your dashboard, but you won't be able to accept sessions until it's verified."})]})]})]})})},Xa=({tutor:t,isOpen:s,onClose:r,onSubmit:a})=>{const[n,i]=e.useState({subject:"",description:"",preferredTime:"",duration:60}),[o,l]=e.useState(""),[c,d]=e.useState(""),[u,h]=e.useState(!1),m=e=>{const{name:t,value:s}=e.target;i(e=>({...e,[t]:s}))},[x,p]=e.useState(s),[g,b]=e.useState(!1);return e.useEffect(()=>{if(!s){b(!1);const e=setTimeout(()=>p(!1),250);return()=>clearTimeout(e)}p(!0),requestAnimationFrame(()=>b(!0))},[s]),x?U.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[U.jsx("style",{children:"\n        .hide-scrollbar::-webkit-scrollbar { width: 0; height: 0; }\n        .hide-scrollbar { scrollbar-width: none; }\n      "}),U.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity duration-400 ease-out "+(g?"opacity-100":"opacity-0"),onClick:r}),U.jsx("div",{className:"relative w-full max-w-3xl transform transition-all duration-400 ease-[cubic-bezier(0.16,1,0.3,1)] will-change-transform will-change-opacity "+(g?"translate-y-0 opacity-100 scale-100":"translate-y-8 opacity-0 scale-[0.96]"),children:U.jsxs("div",{className:"rounded-[28px] overflow-hidden shadow-2xl border border-white/15 bg-white/90 backdrop-blur-xl",children:[U.jsxs("div",{className:"relative px-6 py-5 bg-gradient-to-r from-purple-500 to-pink-500 text-white flex items-center justify-between",children:[U.jsx("h2",{className:"text-xl font-semibold",children:"Request Tutoring Session"}),U.jsx("button",{onClick:r,className:"rounded-full p-2 hover:bg-white/20 transition","aria-label":"Close request session",children:U.jsx(Rr,{className:"w-5 h-5"})})]}),U.jsxs("div",{className:`p-6 space-y-6 transition-opacity duration-500 ${g?"opacity-100":"opacity-0"} max-h-[70vh] overflow-y-auto`,children:[U.jsxs("div",{className:"relative overflow-hidden flex items-center justify-between bg-white/80 border border-white/40 rounded-2xl p-4 shadow-sm",children:[U.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[U.jsx("div",{className:"absolute -top-10 -right-10 w-28 h-28 rounded-full bg-gradient-to-br from-blue-500/10 to-purple-500/10"}),U.jsx("div",{className:"absolute -bottom-10 -left-10 w-24 h-24 rounded-full bg-gradient-to-tr from-purple-500/10 to-pink-500/10"})]}),U.jsxs("div",{className:"flex items-center space-x-3",children:[U.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold shadow",children:t.name.charAt(0).toUpperCase()}),U.jsxs("div",{children:[U.jsx("h3",{className:"font-semibold text-gray-900",children:t.name}),U.jsx("p",{className:"text-xs text-gray-600",children:t.subjects.length>0?t.subjects.join(", "):"General Help"})]})]}),U.jsxs("div",{className:"text-right",children:[U.jsx("div",{className:"px-3 py-1 rounded-lg bg-blue-50 text-blue-700 font-bold shadow-inner inline-block",children:t.hourlyRate||"$20/hour"}),U.jsx("div",{className:"text-[10px] text-gray-500 mt-1",children:"per hour"})]})]}),U.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),n.subject&&n.description&&n.preferredTime){h(!0);try{await a(n),r()}catch(t){console.error("Error submitting session request:",t)}finally{h(!1)}}},className:"space-y-4",children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Subject"}),U.jsxs("div",{className:"bg-white/80 border border-white/50 rounded-2xl p-4",children:[U.jsx("div",{className:"hide-scrollbar grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-44 overflow-y-auto pr-1",children:["Italian Language","English Language","Spanish Language","French Language","German Language","Mandarin Chinese","Business & Entrepreneurship","Philosophy","Mathematics","Computer Science","Chemistry","Biology","History","Geography","Programming","Art","Music","Physical Education","Psychology","Economics"].map(e=>{const t=n.subject===e;return U.jsx("button",{type:"button",onClick:()=>i(t=>({...t,subject:e})),className:`px-3 py-2 rounded-xl text-sm font-medium transition-all border ${t?"bg-gradient-to-r from-purple-500 to-pink-500 text-white border-transparent shadow":"bg-white text-gray-700 border-white/60 hover:border-purple-300 hover:bg-purple-50"}\n                        `,children:e},e)})}),""===n.subject&&U.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Please select one subject."})]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"What do you need help with?"}),U.jsxs("div",{className:"relative group rounded-xl bg-white/75 border border-gray-200 focus-within:bg-white focus-within:border-transparent focus-within:ring-2 focus-within:ring-blue-500/60 transition-all",children:[U.jsx(Ds,{className:"w-4 h-4 text-gray-400 absolute left-3 top-3 pointer-events-none group-focus-within:text-blue-500"}),U.jsx("textarea",{name:"description",value:n.description,onChange:m,placeholder:"Please describe what you need help with in detail...",rows:4,className:"w-full pl-10 pr-3 py-3 rounded-xl bg-transparent outline-none placeholder:text-gray-400 resize-y min-h-[112px]",required:!0})]})]}),U.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[U.jsxs("div",{className:"md:col-span-1",children:[U.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Date"}),U.jsxs("div",{className:"relative group rounded-xl bg-white/80 border border-white/60 focus-within:bg-white focus-within:border-transparent focus-within:ring-2 focus-within:ring-purple-500/60 transition-all",children:[U.jsx(Ht,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none group-focus-within:text-purple-500"}),U.jsx("input",{type:"date",value:o,onChange:e=>{const t=e.target.value;l(t),t&&c&&i(e=>({...e,preferredTime:`${t}T${c}`}))},className:"w-full pl-10 pr-3 py-3 rounded-xl bg-transparent outline-none placeholder:text-gray-400",required:!0})]})]}),U.jsxs("div",{className:"md:col-span-1",children:[U.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Time"}),U.jsxs("div",{className:"relative group rounded-xl bg-white/80 border border-white/60 focus-within:bg-white focus-within:border-transparent focus-within:ring-2 focus-within:ring-purple-500/60 transition-all",children:[U.jsx(Ht,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none group-focus-within:text-purple-500"}),U.jsx("input",{type:"time",value:c,onChange:e=>{const t=e.target.value;d(t),o&&t&&i(e=>({...e,preferredTime:`${o}T${t}`}))},className:"w-full pl-10 pr-3 py-3 rounded-xl bg-transparent outline-none placeholder:text-gray-400",required:!0})]})]}),U.jsxs("div",{className:"md:col-span-1",children:[U.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Session Duration (minutes)"}),U.jsxs("div",{className:"relative group rounded-xl bg-white/75 border border-gray-200 focus-within:bg-white focus-within:border-transparent focus-within:ring-2 focus-within:ring-blue-500/60 transition-all",children:[U.jsx(ss,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none group-focus-within:text-blue-500"}),U.jsxs("select",{name:"duration",value:n.duration,onChange:m,className:"w-full pl-10 pr-8 py-3 rounded-xl bg-transparent outline-none appearance-none",children:[U.jsx("option",{value:30,children:"30 minutes"}),U.jsx("option",{value:60,children:"1 hour"}),U.jsx("option",{value:90,children:"1.5 hours"}),U.jsx("option",{value:120,children:"2 hours"})]}),U.jsx("svg",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 group-focus-within:text-blue-500",viewBox:"0 0 20 20",fill:"currentColor",children:U.jsx("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z",clipRule:"evenodd"})})]})]})]}),U.jsxs("div",{className:"flex space-x-3 pt-2",children:[U.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-3 rounded-xl border border-gray-300 text-gray-700 bg-white/70 hover:bg-gray-50 active:scale-[0.99] transition shadow-sm",children:"Cancel"}),U.jsxs("button",{type:"submit",disabled:u||!n.subject||!n.description||!n.preferredTime,className:"group relative overflow-hidden flex-1 px-4 py-3 rounded-xl text-white bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl active:scale-[0.99] transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:[U.jsx("span",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity bg-white/10"}),u?U.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):U.jsx(tr,{className:"w-4 h-4 mr-2"}),u?"Sending...":"Send Request"]})]})]})]})]})})]}):null},Za=({user:e,size:t="md",showOnlineStatus:s=!1,className:r="",onClick:a=null,...n})=>{if(!e)return U.jsx("div",{className:`bg-gradient-to-r from-gray-400 to-gray-600 rounded-full flex items-center justify-center text-white font-bold ${en(t)} ${r}`,...n,children:U.jsx("span",{children:"U"})});const i=en(t),o=(e=>{if(!e)return"U";const t=e.trim().split(" ");return t.length>=2?(t[0][0]+t[1][0]).toUpperCase():e.charAt(0).toUpperCase()})(e.name),l=(e=>{if(!e)return"from-gray-400 to-gray-600";const t=["from-blue-500 to-blue-600","from-purple-500 to-purple-600","from-green-500 to-green-600","from-orange-500 to-orange-600","from-pink-500 to-pink-600","from-indigo-500 to-indigo-600","from-teal-500 to-teal-600","from-red-500 to-red-600","from-yellow-500 to-yellow-600","from-cyan-500 to-cyan-600"];let s=0;for(let r=0;r<e.length;r++)s=e.charCodeAt(r)+((s<<5)-s);return t[Math.abs(s)%t.length]})(e.name),c=e.avatar&&""!==e.avatar.trim();return U.jsxs("div",{className:"relative",children:[U.jsx("div",{className:`${i} ${c?"bg-gradient-to-r from-gray-400 to-gray-600":`bg-gradient-to-r ${l}`} rounded-full flex items-center justify-center text-white font-bold overflow-hidden cursor-pointer ${r}`,style:c?{backgroundImage:`url(${e.avatar})`,backgroundSize:"cover",backgroundPosition:"center"}:{},onClick:a,...n,children:!c&&U.jsx("span",{className:"select-none",children:o})}),s&&(()=>{const s=void 0!==e._computedOnline?e._computedOnline:Ur(e);return U.jsx("div",{className:`absolute -bottom-1 -right-1 ${tn(t)} rounded-full border-2 border-white shadow-lg ${s?"bg-green-500":"bg-gray-400"}`})})()]})},en=e=>{switch(e){case"xs":return"w-6 h-6 text-xs";case"sm":return"w-8 h-8 text-sm";case"md":default:return"w-10 h-10 text-base";case"lg":return"w-12 h-12 text-lg";case"xl":return"w-16 h-16 text-xl";case"2xl":return"w-20 h-20 text-2xl";case"3xl":return"w-32 h-32 text-3xl"}},tn=e=>{switch(e){case"xs":return"w-2 h-2";case"sm":case"md":default:return"w-3 h-3";case"lg":return"w-4 h-4";case"xl":return"w-5 h-5";case"2xl":return"w-6 h-6";case"3xl":return"w-8 h-8"}},sn=({isOpen:e,onClose:t,tutor:s})=>{var r,a,n,i,o,l,c,d,u,h,m,x;return e&&s?U.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:U.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[U.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-2xl",children:U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Tutor Profile"}),U.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:U.jsx(Rr,{className:"w-6 h-6 text-gray-500"})})]})}),U.jsxs("div",{className:"p-6",children:[U.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start space-y-4 md:space-y-0 md:space-x-6 mb-8",children:[U.jsxs("div",{className:"relative",children:[U.jsx(Za,{user:s,size:"xl",className:"w-24 h-24"}),U.jsx("div",{className:"absolute -bottom-2 -right-2 w-8 h-8 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center shadow-lg",children:U.jsx("div",{className:"w-3 h-3 bg-white rounded-full"})})]}),U.jsxs("div",{className:"text-center md:text-left flex-1",children:[U.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:s.name}),U.jsx("p",{className:"text-gray-600 mb-4",children:s.email}),U.jsxs("div",{className:"flex items-center justify-center md:justify-start space-x-2 mb-4",children:[U.jsx("div",{className:"flex items-center",children:[...Array(5)].map((e,t)=>U.jsx(or,{className:"w-5 h-5 "+(t<Math.floor(s.rating||0)?"text-yellow-400 fill-current":"text-gray-300")},t))}),U.jsx("span",{className:"text-lg font-bold text-gray-900",children:s.rating?s.rating.toFixed(1):"No ratings yet"}),(null==(r=s.stats)?void 0:r.totalSessions)>0&&U.jsxs("span",{className:"text-sm text-gray-500",children:["(",s.stats.totalSessions," sessions)"]})]}),U.jsxs("div",{className:"grid grid-cols-2 gap-4 max-w-md mx-auto md:mx-0",children:[U.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-3 text-center",children:[U.jsx("div",{className:"text-2xl font-bold text-blue-600",children:(null==(a=s.stats)?void 0:a.totalSessions)||0}),U.jsx("div",{className:"text-xs text-blue-700 font-medium",children:"Sessions"})]}),U.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-3 text-center",children:[U.jsx("div",{className:"text-2xl font-bold text-green-600",children:"Studiply Pass"}),U.jsx("div",{className:"text-xs text-green-700 font-medium",children:"Service"})]})]})]})]}),U.jsxs("div",{className:"space-y-6",children:[U.jsxs("div",{children:[U.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center",children:[U.jsx(Pt,{className:"w-5 h-5 mr-2 text-blue-600"}),"Subjects"]}),U.jsx("div",{className:"flex flex-wrap gap-2",children:(null==(i=null==(n=s.tutorProfile)?void 0:n.subjects)?void 0:i.map((e,t)=>U.jsx("span",{className:"px-3 py-1 bg-gradient-to-r from-blue-100 to-purple-100 text-blue-800 rounded-full text-sm font-medium",children:e},t)))||U.jsx("span",{className:"text-gray-500 text-sm",children:"No subjects specified"})})]}),(null==(o=s.tutorProfile)?void 0:o.experience)&&U.jsxs("div",{children:[U.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center",children:[U.jsx(Nr,{className:"w-5 h-5 mr-2 text-purple-600"}),"Experience"]}),U.jsx("p",{className:"text-gray-700 bg-gradient-to-r from-purple-50 to-pink-50 p-4 rounded-xl",children:s.tutorProfile.experience})]}),(null==(l=s.tutorProfile)?void 0:l.description)&&U.jsxs("div",{children:[U.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center",children:[U.jsx(Ms,{className:"w-5 h-5 mr-2 text-green-600"}),"About Me"]}),U.jsx("p",{className:"text-gray-700 bg-gradient-to-r from-green-50 to-blue-50 p-4 rounded-xl leading-relaxed",children:s.tutorProfile.description})]}),(null==(c=s.tutorProfile)?void 0:c.availability)&&U.jsxs("div",{children:[U.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center",children:[U.jsx(Lt,{className:"w-5 h-5 mr-2 text-orange-600"}),"Availability"]}),U.jsx("p",{className:"text-gray-700 bg-gradient-to-r from-orange-50 to-yellow-50 p-4 rounded-xl",children:s.tutorProfile.availability})]}),U.jsxs("div",{children:[U.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center",children:[U.jsx(Ht,{className:"w-5 h-5 mr-2 text-indigo-600"}),"Statistics"]}),U.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[U.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-xl p-4 text-center",children:[U.jsx("div",{className:"text-xl font-bold text-indigo-600",children:(null==(d=s.stats)?void 0:d.totalSessions)||0}),U.jsx("div",{className:"text-xs text-indigo-700 font-medium",children:"Total Sessions"})]}),U.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-xl p-4 text-center",children:[U.jsx("div",{className:"text-xl font-bold text-yellow-600",children:(null==(u=s.stats)?void 0:u.ratingCount)||0}),U.jsx("div",{className:"text-xs text-yellow-700 font-medium",children:"Reviews"})]}),U.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-pink-100 rounded-xl p-4 text-center",children:[U.jsx("div",{className:"text-xl font-bold text-pink-600",children:(null==(m=null==(h=s.stats)?void 0:h.averageRating)?void 0:m.toFixed(1))||"0.0"}),U.jsx("div",{className:"text-xs text-pink-700 font-medium",children:"Avg Rating"})]}),U.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-emerald-100 rounded-xl p-4 text-center",children:[U.jsx("div",{className:"text-xl font-bold text-emerald-600",children:(null==(x=s.stats)?void 0:x.completedSessions)||0}),U.jsx("div",{className:"text-xs text-emerald-700 font-medium",children:"Completed"})]})]})]})]}),U.jsxs("div",{className:"flex space-x-4 mt-8 pt-6 border-t border-gray-200",children:[U.jsx("button",{onClick:t,className:"flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-xl font-semibold hover:bg-gray-50 transition-colors",children:"Close"}),U.jsx("button",{onClick:()=>{t()},className:"flex-1 bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 transform hover:scale-105",children:"Request Session"})]})]})]})}):null},rn=async(e,t)=>{try{const s=u(dt,"tutorStats",e);(await m(s)).exists()?await x(s,{totalRating:v(t),ratingCount:v(1),updatedAt:p()}):await h(s,{totalRating:t,ratingCount:1,totalSessions:0,totalEarnings:0,completedSessions:0,createdAt:p(),updatedAt:p()})}catch(s){console.error("Error updating tutor rating stats:",s)}},an=async e=>{try{const t=u(dt,"tutorStats",e),s=await m(t);if(s.exists()){const e=s.data();return{success:!0,totalRating:e.totalRating||0,ratingCount:e.ratingCount||0,averageRating:e.ratingCount>0?e.totalRating/e.ratingCount:0,totalSessions:e.totalSessions||0}}return{success:!0,totalRating:0,ratingCount:0,averageRating:0,totalSessions:0}}catch(t){return console.error("Error getting tutor rating stats:",t),{success:!1,error:t.message}}},nn=({tutorId:t,tutorName:s})=>{const[r,a]=e.useState([]),[n,i]=e.useState({averageRating:0,totalReviews:0}),[c,u]=e.useState(!0),[h,x]=e.useState(!1),p=e.useCallback(async()=>{try{u(!0),console.log(" Loading reviews for tutor:",t);const e=await an(t);console.log(" Stats result:",e),e.success&&(i({averageRating:e.averageRating||0,totalReviews:e.ratingCount||0}),console.log(" Stats loaded:",{averageRating:e.averageRating||0,totalReviews:e.ratingCount||0}));const s=await(async(e,t=10)=>{try{const r=o(dt,"ratings"),a=l(r),n=await d(a),i=[];for(const t of n.docs){const r=t.data();if(r.tutorId!==e)continue;let a="Student";try{console.log(" Fetching student info for:",r.studentId);const e=await m(t(dt,"users",r.studentId));if(e.exists()){const t=e.data(),s={name:t.name,email:t.email,isTutor:t.isTutor,bio:t.bio,school:t.school,grade:t.grade};console.log(" Student data:",{id:r.studentId,name:s.name,email:s.email,isTutor:s.isTutor}),a=s.name||"Student"}}catch(s){console.error(" Error fetching student info for",r.studentId,":",s),console.error(" Student data that caused error:",r),a="Student"}i.push({id:t.id,sessionId:r.sessionId,studentId:r.studentId,studentName:a,rating:r.rating,review:r.review,createdAt:r.createdAt})}return i.sort((e,t)=>{const s=qa(e.createdAt);return qa(t.createdAt)-s}),{success:!0,ratings:i.slice(0,t)}}catch(s){return console.error("Error getting tutor ratings:",s),{success:!1,ratings:[],error:s.message}}})(t,h?20:3);console.log(" Reviews result:",s),s.success?(console.log(" Reviews loaded:",s.ratings.length,"reviews"),console.log(" Reviews data:",s.ratings),a(s.ratings)):console.error(" Failed to load reviews:",s.error)}catch(e){console.error(" Error loading reviews:",e)}finally{u(!1)}},[t,h]);e.useEffect(()=>{p()},[p]);const g=e=>{try{return e&&Ra(e)||"Recently"}catch(t){return console.error("Error formatting date:",t,"Original timestamp:",e),"Recently"}},b=e=>Array.from({length:5},(t,s)=>U.jsx(or,{className:"w-4 h-4 "+(s<e?"text-yellow-400 fill-current":"text-gray-300")},s));return c?U.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:U.jsxs("div",{className:"animate-pulse",children:[U.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),U.jsxs("div",{className:"space-y-3",children:[U.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),U.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"}),U.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]})}):0===n.totalReviews?U.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:U.jsxs("div",{className:"text-center py-8",children:[U.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:U.jsx(or,{className:"w-8 h-8 text-gray-400"})}),U.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Reviews Yet"}),U.jsx("p",{className:"text-gray-600",children:"This tutor hasn't received any reviews yet. Be the first to share your experience!"})]})}):U.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[U.jsxs("div",{className:"flex items-center justify-between mb-6",children:[U.jsxs("div",{className:"flex items-center space-x-4",children:[U.jsxs("div",{className:"flex items-center space-x-2",children:[U.jsx("div",{className:"flex items-center",children:b(Math.round(n.averageRating))}),U.jsx("span",{className:"text-2xl font-bold text-gray-900",children:n.averageRating.toFixed(1)})]}),U.jsxs("div",{className:"text-gray-600",children:[U.jsx("span",{className:"font-medium",children:n.totalReviews})," review",1!==n.totalReviews?"s":""]})]}),n.totalReviews>3&&U.jsx("button",{onClick:()=>x(!h),className:"text-blue-600 hover:text-blue-700 font-medium text-sm",children:h?"Show Less":`View All ${n.totalReviews} Reviews`})]}),U.jsx("div",{className:"space-y-4",children:0===r.length?U.jsxs("div",{className:"text-center py-8",children:[U.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:U.jsx(Ds,{className:"w-8 h-8 text-gray-400"})}),U.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Reviews Found"}),U.jsxs("p",{className:"text-gray-600",children:["We found ",n.totalReviews," review",1!==n.totalReviews?"s":""," in our database, but couldn't load the details."]}),U.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"This might be a temporary issue. Please try again later."})]}):r.map(e=>U.jsxs("div",{className:"border-b border-gray-100 pb-4 last:border-b-0 last:pb-0",children:[U.jsx("div",{className:"flex items-start justify-between mb-2",children:U.jsxs("div",{className:"flex items-center space-x-3",children:[U.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:U.jsx(Nr,{className:"w-4 h-4 text-white"})}),U.jsxs("div",{children:[U.jsxs("div",{className:"flex items-center space-x-2",children:[U.jsx("span",{className:"font-medium text-gray-900",children:e.studentName||"Student"}),U.jsx("div",{className:"flex items-center",children:b(e.rating)})]}),U.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[U.jsx(Lt,{className:"w-3 h-3"}),U.jsx("span",{children:g(e.createdAt)})]})]})]})}),e.review&&U.jsx("div",{className:"mt-3 pl-11",children:U.jsxs("div",{className:"flex items-start space-x-2",children:[U.jsx(Ds,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),U.jsx("p",{className:"text-gray-700 leading-relaxed",children:e.review})]})})]},e.id))}),!h&&n.totalReviews>3&&U.jsx("div",{className:"mt-6 text-center",children:U.jsx("button",{onClick:()=>x(!0),className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-2 rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-200 font-medium",children:"Show More Reviews"})})]})},on=({isOpen:e,onClose:t,tutor:s})=>e&&s?U.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4 py-6",children:[U.jsx("div",{className:"absolute inset-0 bg-black/45 backdrop-blur-sm",onClick:t}),U.jsxs("div",{className:"relative w-full max-w-3xl rounded-[28px] border border-white/15 bg-white/90 shadow-2xl backdrop-blur-xl overflow-hidden",children:[U.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 px-6 py-5 text-white flex items-center justify-between",children:[U.jsxs("div",{children:[U.jsxs("h2",{className:"text-xl font-semibold leading-tight",children:[s.name,"'s Reviews"]}),U.jsx("p",{className:"text-sm text-white/80",children:"What students are saying"})]}),U.jsx("button",{onClick:t,className:"rounded-full p-2 hover:bg-white/20 transition-colors","aria-label":"Close reviews",children:U.jsx(Rr,{className:"h-5 w-5"})})]}),U.jsx("div",{className:"max-h-[70vh] overflow-y-auto p-6 bg-white/80",children:U.jsx(nn,{tutorId:s.id,tutorName:s.name})})]})]}):null,ln=(e=0)=>{const t=Math.max(0,Math.floor(e)),s=Math.floor(t/3600),r=Math.floor(t%3600/60),a=t%60;return s>0?`${s.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`:`${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},cn=({sessionData:t,onClose:s})=>{const{user:r}=Br(),a={}.VITE_AGORA_APP_ID||"demo_app_id_for_testing",n=`meeting-${(null==t?void 0:t.meetingCode)||"default"}`,[i,o]=e.useState("idle"),[l,c]=e.useState([]),[d,u]=e.useState(!1),[h,m]=e.useState(!0),[x,p]=e.useState("good"),[g,b]=e.useState(""),[f,w]=e.useState(0),[y,v]=e.useState(!1),[j,N]=e.useState(!1),[k,S]=e.useState(null),[E,A]=e.useState(0),T=e.useRef(new Map),I=e.useRef(new Set),[P,q]=e.useState(!1),R=e.useRef(null),M=e.useRef(null),D=e.useRef(null),L=e.useRef([]),F=e.useRef(null),$=e.useRef(null),O=e.useRef(null),B=e.useRef(!1);e.useEffect(()=>(t&&"demo_app_id_for_testing"!==a?_():"demo_app_id_for_testing"===a&&(b("Agora App ID not configured, please check environment variables"),o("error")),()=>{J()}),[t,a]);const _=async()=>{try{if(o("permission-request"),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Your browser does not support camera and microphone functionality");(await navigator.mediaDevices.getUserMedia({video:!0,audio:!0})).getTracks().forEach(e=>e.stop()),N(!0),o("idle"),setTimeout(()=>{z()},500)}catch(e){console.error(" :",e);let t="Permission request failed";"NotAllowedError"===e.name?t="Camera and microphone permissions were denied. Please click the camera icon in your browser address bar and allow permissions, then try again.":"NotFoundError"===e.name?t="Camera or microphone device not found. Please check device connection.":"NotReadableError"===e.name?t="Camera or microphone is being used by another application. Please close other applications and try again.":"OverconstrainedError"===e.name?t="Camera does not support the required video format. Please try using a different device.":"NotSupportedError"===e.name?t="Your browser does not support video calling functionality. Please use a modern browser.":e.message.includes("not support")&&(t="Your browser does not support camera and microphone functionality"),b(t),o("error")}};e.useEffect(()=>{const e=()=>{if(L.current&&L.current.length>1){const e=L.current[1];e&&M.current&&(console.log(" :",{videoTrack:e,element:M.current,hasSrcObject:!!M.current.srcObject,isEnabled:e.enabled}),e.play(M.current),M.current.muted=!0,M.current.autoplay=!0,M.current.playsInline=!0,console.log(" "))}};e();const t=setInterval(e,2e3);return()=>clearInterval(t)},[L.current]),e.useEffect(()=>{const e=()=>{D.current?(q(!0),console.log(" :",{element:D.current,id:D.current.id,className:D.current.className,tagName:D.current.tagName})):(q(!1),console.log(" ..."))};e();const t=new MutationObserver(t=>{t.forEach(t=>{"childList"===t.type&&t.addedNodes.forEach(t=>{var s,r;if(t.nodeType===Node.ELEMENT_NODE){("remote-video"===t.id||(null==(s=t.querySelector)?void 0:s.call(t,"#remote-video"))||"VIDEO"===t.tagName&&"remote"===(null==(r=t.getAttribute)?void 0:r.call(t,"data-video-type")))&&(console.log(" :",t),setTimeout(e,100))}})}),e()});t.observe(document.body,{childList:!0,subtree:!0,attributes:!0});const s=setInterval(e,1e3);return()=>{t.disconnect(),clearInterval(s)}},[]),e.useEffect(()=>{var e;console.log(" :",{totalUsers:l.length,clientUid:null==(e=R.current)?void 0:e.uid,users:l.map(e=>{var t,s,r,a;return{uid:e.uid,userName:e.userName,userRole:e.userRole,hasAudio:!!e.audioTrack,hasVideo:!!e.videoTrack,isOwnUser:e.uid===(null==(t=R.current)?void 0:t.uid),uidComparison:{strict:e.uid===(null==(s=R.current)?void 0:s.uid),string:String(e.uid)===String(null==(r=R.current)?void 0:r.uid),loose:e.uid==(null==(a=R.current)?void 0:a.uid)}}})});const t=l.map(e=>e.uid),s=[...new Set(t)];t.length!==s.length&&console.error("  UID:",{total:t.length,unique:s.length,duplicates:t.filter((e,s)=>t.indexOf(e)!==s)})},[l]),e.useEffect(()=>{if("connected"===i&&!k){const e=Date.now();S(e),A(0)}},[i,k]),e.useEffect(()=>{var e;if(!k){const t=null==(e=R.current)?void 0:e.uid;if(l.some(e=>void 0!==(null==e?void 0:e.uid)&&void 0!==t&&(e.uid!==t&&String(e.uid)!==String(t)))){const e=Date.now();S(e),A(0)}else O.current&&(clearInterval(O.current),O.current=null);return}return O.current&&clearInterval(O.current),O.current=setInterval(()=>{A(Math.floor((Date.now()-k)/1e3))},1e3),()=>{O.current&&(clearInterval(O.current),O.current=null)}},[k,l]);const z=async()=>{var e,s;try{O.current&&(clearInterval(O.current),O.current=null),S(null),A(0),console.log(" ..."),console.log(" :",{sessionId:null==t?void 0:t.id,meetingCode:null==t?void 0:t.meetingCode,channelName:n,appId:a,user:null==r?void 0:r.name,userRole:null==r?void 0:r.role,tutor:null==(e=null==t?void 0:t.tutor)?void 0:e.name,student:null==(s=null==t?void 0:t.student)?void 0:s.name}),o("connecting"),c([]),T.current.clear(),I.current.clear(),console.log(" UID  UID "),setTimeout(()=>{console.log(" :",l.length),l.length>0&&(console.log(" "),c([]),T.current.clear(),I.current.clear())},100);const i=console.error;console.error=(...e)=>{const t=e.join(" ");t.includes("statscollector")||t.includes("ERR_ADDRESS_UNREACHABLE")||t.includes("net::ERR_ADDRESS_UNREACHABLE")?console.log("  Agora :",t):i.apply(console,e)},b(""),w(0),await J();const d=C.createClient({mode:"rtc",codec:"vp8"});R.current=d,console.log(" Agora "),W(d),await H(),await G(d),V()}catch(i){console.error(" :",i),Y(i)}},W=e=>{e.on("user-joined",e=>{console.log(" :",e.uid),console.log(" :",{channelName:n,currentUser:null==e?void 0:e.name,agoraUid:e.uid,callStatus:i}),p("good")}),e.on("user-left",e=>{console.log(" :",e.uid),c(t=>t.filter(t=>t.uid!==e.uid)),l.length<=1&&o("waiting")}),e.on("user-joined",s=>{var r,a,n,d;console.log(" :",s.uid),console.log(" :",i,":",l.length),s.uid!==e.uid&&String(s.uid)!==String(e.uid)?(console.log(" :",s.uid,{userUid:s.uid,clientUid:e.uid,sessionData:{tutorUid:null==(r=null==t?void 0:t.tutor)?void 0:r.uid,studentUid:null==(a=null==t?void 0:t.student)?void 0:a.uid,tutorName:null==(n=null==t?void 0:t.tutor)?void 0:n.name,studentName:null==(d=null==t?void 0:t.student)?void 0:d.name},remoteUsersCount:l.length}),c(e=>{var r,a,n,i,o;return e.find(e=>e.uid===s.uid)?(console.log(" :",s.uid),e.map(e=>e.uid===s.uid?{...e,joined:!0}:e)):(console.log(" :",s.uid),[...e,{uid:s.uid,userName:s.uid===(null==(r=null==t?void 0:t.tutor)?void 0:r.uid)?null==(a=null==t?void 0:t.tutor)?void 0:a.name:s.uid===(null==(n=null==t?void 0:t.student)?void 0:n.uid)?null==(i=null==t?void 0:t.student)?void 0:i.name:` ${s.uid}`,userRole:s.uid===(null==(o=null==t?void 0:t.tutor)?void 0:o.uid)?"tutor":"student",audioTrack:null,videoTrack:null,joined:!0}])}),"waiting"===i&&(o("connected"),console.log(" waiting -> connected"))):console.log(" ")}),e.on("user-published",async(s,r)=>{if(console.log(" :",s.uid,r),s.uid===e.uid||String(s.uid)===String(e.uid))return void console.log(" ");if(l.some(e=>e.uid===s.uid)||(console.log("  user-joined :",s.uid),c(e=>{var r,a,n,i,o;return e.find(e=>e.uid===s.uid)?e:[...e,{uid:s.uid,userName:s.uid===(null==(r=null==t?void 0:t.tutor)?void 0:r.uid)?null==(a=null==t?void 0:t.tutor)?void 0:a.name:s.uid===(null==(n=null==t?void 0:t.student)?void 0:n.uid)?null==(i=null==t?void 0:t.student)?void 0:i.name:` ${s.uid}`,userRole:s.uid===(null==(o=null==t?void 0:t.tutor)?void 0:o.uid)?"tutor":"student",audioTrack:null,videoTrack:null,joined:!0}]})),console.log(" :",s.uid,r),s.uid!==e.uid)try{if(await e.subscribe(s,r),console.log(" :",s.uid,r),"video"===r&&s.videoTrack){const e=async(t=1)=>{if(D.current)try{s.videoTrack.play(D.current),console.log(" :",s.uid,{videoTrack:s.videoTrack,remoteVideoElement:D.current,elementId:D.current.id,attempt:t}),D.current.autoplay=!0,D.current.playsInline=!0,D.current.muted=!1,D.current.setAttribute("data-video-type","remote")}catch(r){console.error(" :",r,s.uid,"attempt:",t),t<5&&(console.log(`  (${t}/5):`,s.uid),setTimeout(()=>e(t+1),500*t))}else console.log(" remoteVideoRef.current :",t),t<10&&setTimeout(()=>e(t+1),300*t)};e()}c(e=>{var a,n,i,o,l;return e.find(e=>e.uid===s.uid)?e.map(e=>e.uid===s.uid?{...e,[`${r}Track`]:s[`${r}Track`]}:e):[...e,{uid:s.uid,userName:s.uid===(null==(a=null==t?void 0:t.tutor)?void 0:a.uid)?null==(n=null==t?void 0:t.tutor)?void 0:n.name:s.uid===(null==(i=null==t?void 0:t.student)?void 0:i.uid)?null==(o=null==t?void 0:t.student)?void 0:o.name:` ${s.uid}`,userRole:s.uid===(null==(l=null==t?void 0:t.tutor)?void 0:l.uid)?"tutor":"student",[`${r}Track`]:s[`${r}Track`]}]}),"waiting"===i&&(o("connected"),console.log(" waiting -> connected")),"audio"===r&&(s.audioTrack.play(),console.log(" :",s.uid))}catch(a){console.error(" :",a)}else console.log(" ")}),e.on("user-left",e=>{console.log(" :",e.uid),c(t=>t.filter(t=>t.uid!==e.uid)),l.length<=1&&(o("waiting"),console.log(" connected -> waiting ()"))}),e.on("user-unpublished",(e,t)=>{console.log(" :",e.uid,t),"video"===t&&e.videoTrack&&e.videoTrack.stop(),"audio"===t&&e.audioTrack&&e.audioTrack.stop()}),e.on("connection-state-change",(e,t)=>{switch(console.log(` : ${t} -> ${e}`),e){case"CONNECTING":p("connecting");break;case"CONNECTED":p("good"),"connecting"===i&&o("waiting");break;case"DISCONNECTING":p("poor"),console.log(" "),c([]);break;case"DISCONNECTED":p("poor"),Q();break;case"RECONNECTING":p("connecting"),v(!0)}}),e.on("network-quality",e=>{0===e.uplinkNetworkQuality||1===e.uplinkNetworkQuality?p("good"):(e.uplinkNetworkQuality,p("poor"))})},H=async()=>{try{if(console.log(" ..."),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("");const[e,t]=await C.createMicrophoneAndCameraTracks({microphoneId:void 0,cameraId:void 0},{cameraId:void 0,width:640,height:480,frameRate:15});L.current=[e,t],M.current?(t.play(M.current),console.log(" :",{element:M.current,videoTrack:t,isEnabled:t.enabled,muted:t.muted,elementSrc:M.current.srcObject}),M.current.muted=!0,M.current.autoplay=!0,M.current.playsInline=!0,M.current.setAttribute("data-video-type","local"),M.current.style.backgroundColor="transparent"):console.error(" localVideoRef.current "),console.log(" ")}catch(e){console.error(" :",e);let t="";throw"PERMISSION_DENIED"===e.code||e.message.includes("Permission denied")?t="":e.message.includes("NotAllowedError")?t="":e.message.includes("NotFoundError")?t="":e.message.includes("NotReadableError")?t="":e.message.includes("OverconstrainedError")?t="":e.message.includes("NotSupportedError")?t="":e.message.includes("")&&(t=""),b(t),e}},G=async e=>{var s,i,l,c;try{console.log(` : ${n}`),console.log(" :",{channelName:n,appId:a,userRole:null==r?void 0:r.role,userName:null==r?void 0:r.name,meetingCode:null==t?void 0:t.meetingCode});const u=Math.abs(parseInt((null==(s=null==r?void 0:r.uid)?void 0:s.replace(/[^0-9]/g,""))||"0",10))%1e9;console.log(" UID :",{userUid:null==r?void 0:r.uid,generatedUid:u,userName:null==r?void 0:r.name,userRole:null==r?void 0:r.role});try{await e.join(a,n,null,u)}catch(d){if(!((null==(i=d.message)?void 0:i.includes("statscollector"))||(null==(l=d.message)?void 0:l.includes("ERR_ADDRESS_UNREACHABLE"))||(null==(c=d.message)?void 0:c.includes("net::ERR_ADDRESS_UNREACHABLE"))))throw d;console.log("  Agora :",d.message)}await e.publish(L.current),console.log(" "),console.log(" :",{channelName:n,localTracks:L.current.length,audioTrack:L.current[0]?"":"",videoTrack:L.current[1]?"":""}),o("waiting")}catch(u){throw console.error(" :",u),u}},V=()=>{F.current=setTimeout(()=>{"connecting"!==i&&"waiting"!==i||(console.warn(" "),Y(new Error("")))},3e4)},Y=e=>{console.error(" :",e),b(e.message||""),f<3?(w(e=>e+1),v(!0),$.current=setTimeout(()=>{console.log(`  (${f+1}/3)...`),z()},2e3*(f+1))):(o("error"),v(!1))},Q=()=>{"connected"===i&&(o("disconnected"),v(!0),setTimeout(()=>{f<3&&z()},3e3))},J=()=>{if(console.log(" ..."),F.current&&(clearTimeout(F.current),F.current=null),$.current&&(clearTimeout($.current),$.current=null),O.current&&(clearInterval(O.current),O.current=null),L.current.forEach(e=>{e.stop(),e.close()}),L.current=[],M.current&&(M.current.srcObject=null),D.current&&(D.current.srcObject=null),o(e=>"idle"===e?e:"idle"),c([]),v(!1),w(0),p("good"),R.current){const e=R.current;R.current=null;(async()=>{var t,s,r;try{await e.leave(),console.log(" ")}catch(a){(null==(t=a.message)?void 0:t.includes("statscollector"))||(null==(s=a.message)?void 0:s.includes("ERR_ADDRESS_UNREACHABLE"))||(null==(r=a.message)?void 0:r.includes("net::ERR_ADDRESS_UNREACHABLE"))?console.log("  Agora :",a.message):console.error(" :",a)}})().catch(e=>{console.error(" :",e)})}else console.log(" ")},K=()=>{w(0),b(""),z()};return"permission-request"===i?U.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50",children:U.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl text-center max-w-md",children:[U.jsx("div",{className:"text-blue-500 text-4xl mb-4",children:""}),U.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Camera and Microphone Permission Required"}),U.jsx("p",{className:"text-gray-600 mb-6",children:'To make video calls, we need access to your camera and microphone. Please click "Allow" in the browser permission request popup.'}),U.jsx("div",{className:"text-sm text-gray-500 mb-4",children:" If the permission request doesn't pop up, please check the camera icon in your browser address bar"}),U.jsx("button",{onClick:_,className:"bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors mr-3",children:"Retry Permission Request"}),U.jsx("button",{onClick:s,className:"bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})}):"error"===i?U.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50",children:U.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl text-center max-w-md",children:[U.jsx("div",{className:"text-red-500 text-4xl mb-4",children:""}),U.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:""}),U.jsx("p",{className:"text-gray-600 mb-6",children:g}),U.jsxs("div",{className:"flex space-x-4",children:[U.jsx("button",{onClick:K,className:"flex-1 bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition-colors",children:""}),U.jsx("button",{onClick:s,className:"flex-1 bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors",children:""})]})]})}):U.jsx("div",{className:"fixed inset-0 bg-gray-900 flex items-center justify-center z-50 p-4",children:U.jsxs("div",{className:"relative w-full h-full max-w-6xl max-h-[90vh] bg-gray-800 rounded-lg shadow-2xl flex flex-col overflow-hidden",children:[U.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-700 text-white",children:[U.jsxs("div",{className:"flex items-center space-x-4",children:[U.jsx("h2",{className:"text-xl font-semibold",children:(null==t?void 0:t.subject)||""}),(()=>{const e={connecting:{icon:U.jsx(Pr,{className:"w-4 h-4 animate-pulse"}),text:"Connecting...",color:"text-yellow-600"},waiting:{icon:U.jsx(kr,{className:"w-4 h-4 animate-pulse"}),text:"Waiting for other users to join...",color:"text-blue-600"},connected:{icon:U.jsx(Pr,{className:"w-4 h-4"}),text:"Connected",color:"text-green-600"},disconnected:{icon:U.jsx(Ir,{className:"w-4 h-4"}),text:"Disconnected",color:"text-red-600"},error:{icon:U.jsx(Ir,{className:"w-4 h-4"}),text:"Connection Failed",color:"text-red-600"}},t=e[i]||e.connecting;return U.jsxs("div",{className:`flex items-center space-x-2 ${t.color}`,children:[t.icon,U.jsx("span",{className:"text-sm font-medium",children:t.text}),y&&U.jsx("span",{className:"text-xs text-gray-500",children:"(...)"})]})})(),k&&U.jsxs("div",{className:"px-2 py-1 rounded bg-black/40 text-xs font-mono text-gray-100",children:["Call Time: ",ln(E)]}),U.jsxs("div",{className:"text-xs text-gray-300",children:[": ",n," | : ",(null==r?void 0:r.name)||"Unknown"]})]}),U.jsx("button",{onClick:s,className:"text-gray-300 hover:text-white transition-colors",children:U.jsx(Rr,{size:24})})]}),U.jsx("div",{className:"flex-1 flex flex-col gap-4 p-4 min-h-0",children:U.jsx("div",{className:"relative bg-gray-700 rounded-lg overflow-hidden flex-1 min-h-0",children:(()=>{const e=l.filter(e=>{var t;const s=null==(t=R.current)?void 0:t.uid,r=e.uid!==s&&String(e.uid)!==String(s)&&e.uid!=s&&Math.abs(e.uid-s)>=1,a=!!e.videoTrack;return console.log(" :",{uid:e.uid,clientUid:s,isNotSelf:r,hasVideoTrack:a,userName:e.userName,userRole:e.userRole,uidType:typeof e.uid,clientUidType:typeof s,strictEqual:e.uid===s,looseEqual:e.uid==s,stringEqual:String(e.uid)===String(s),numericDiff:Math.abs(e.uid-s),willShow:r&&a}),r&&a}),t=e.length>0;return console.log(" :",{remoteUsersLength:l.length,realRemoteUsersLength:e.length,callStatus:i,hasRealRemoteUsers:t,allRemoteUsers:l.map(e=>{var t,s;return{uid:e.uid,userName:e.userName,userRole:e.userRole,hasVideoTrack:!!e.videoTrack,clientUid:null==(t=R.current)?void 0:t.uid,isNotSelf:e.uid!==(null==(s=R.current)?void 0:s.uid)}}),realRemoteUsers:e.map(e=>({uid:e.uid,userName:e.userName,userRole:e.userRole}))}),t?(console.log("  - :",e.length,{realRemoteUsers:e.map(e=>({uid:e.uid,userName:e.userName,userRole:e.userRole}))}),!0):(console.log("  - ",{reason:"noRealRemoteUsers",remoteUsersCount:l.length,realRemoteUsersCount:e.length,callStatus:i}),!1)})()?U.jsxs(U.Fragment,{children:[U.jsx("video",{ref:D,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover","data-video-type":"remote",id:"remote-video"}),l.map((e,t)=>U.jsxs("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded",children:[e.userName||` ${e.uid}`,e.userRole&&` (${e.userRole})`]},e.uid)),U.jsxs("div",{className:"absolute bottom-4 right-4 w-32 h-24 bg-gray-800 rounded-lg overflow-hidden shadow-lg border-2 border-white",children:[U.jsx("video",{ref:M,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover","data-video-type":"local",id:"local-video",style:{transform:"scaleX(-1)",backgroundColor:h?"transparent":"#374151"}}),!h&&U.jsx("div",{className:"absolute inset-0 bg-gray-700 bg-opacity-80 flex items-center justify-center",children:U.jsx(Sr,{size:20,className:"text-gray-400"})}),U.jsxs("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-70 text-white text-xs px-1 py-0.5 rounded",children:["You ",d&&"(Muted)"]})]})]}):U.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-gray-400 relative",children:[U.jsx(kr,{size:64,className:"mb-4"}),U.jsx("p",{className:"text-lg",children:"waiting"===i?"Waiting for other users to join...":"No other users"}),U.jsxs("p",{className:"text-sm mt-2",children:["Channel: ",n]}),U.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Your identity: ",(null==r?void 0:r.name)||"Unknown User"]}),U.jsxs("div",{className:"mt-4 flex items-center space-x-4 text-xs",children:[U.jsxs("div",{className:"flex items-center space-x-1",children:[d?U.jsx(Ls,{className:"w-4 h-4 text-red-400"}):U.jsx(Fs,{className:"w-4 h-4 text-green-400"}),U.jsx("span",{children:d?"Muted":"Microphone On"})]}),U.jsxs("div",{className:"flex items-center space-x-1",children:[h?U.jsx(Cr,{className:"w-4 h-4 text-green-400"}):U.jsx(Sr,{className:"w-4 h-4 text-red-400"}),U.jsx("span",{children:h?"Camera On":"Camera Off"})]})]}),U.jsxs("div",{className:"absolute bottom-4 right-4 w-32 h-24 bg-gray-800 rounded-lg overflow-hidden shadow-lg border-2 border-white",children:[U.jsx("video",{ref:M,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover","data-video-type":"local",id:"local-video-waiting",style:{transform:"scaleX(-1)",backgroundColor:h?"transparent":"#374151"}}),!h&&U.jsx("div",{className:"absolute inset-0 bg-gray-700 bg-opacity-80 flex items-center justify-center",children:U.jsx(Sr,{size:20,className:"text-gray-400"})}),U.jsxs("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-70 text-white text-xs px-1 py-0.5 rounded",children:["You ",d&&"(Muted)"]})]})]})})}),U.jsxs("div",{className:"flex justify-center items-center p-4 bg-gray-700 space-x-4",children:[U.jsx("button",{onClick:()=>{if(L.current[0]){const e=!d;L.current[0].setEnabled(e),u(e),console.log(" Microphone toggled:",{from:d,to:e})}},className:"p-3 rounded-full transition-colors "+(d?"bg-red-500 hover:bg-red-600 text-white":"bg-gray-600 hover:bg-gray-500 text-white"),children:d?U.jsx(Ls,{size:24}):U.jsx(Fs,{size:24})}),U.jsx("button",{onClick:()=>{if(L.current[1]){const e=!h;L.current[1].setEnabled(e),m(e),console.log(" Video toggled:",{from:h,to:e})}},className:"p-3 rounded-full transition-colors "+(h?"bg-gray-600 hover:bg-gray-500 text-white":"bg-red-500 hover:bg-red-600 text-white"),children:h?U.jsx(Cr,{size:24}):U.jsx(Sr,{size:24})}),U.jsx("button",{onClick:async()=>{var e,r;if(B.current)return void console.log(" endCall already called, skipping...");B.current=!0,console.log(" endCall started"),O.current&&(clearInterval(O.current),O.current=null);const a=k?Math.floor((Date.now()-k)/1e3):E,n=Math.max(a,0);if(A(n),null==t?void 0:t.id)try{const{doc:s,updateDoc:a,serverTimestamp:o}=await ia(()=>import("./firebase-48788c29.js").then(e=>e.v),[]),{db:l}=await ia(()=>Promise.resolve().then(()=>ut),void 0),c=s(l,"sessions",t.id);await a(c,{status:"completed",completedAt:o(),updatedAt:o(),callDurationSeconds:n,callDurationFormatted:ln(n)}),console.log(" Session marked as completed:",t.id);const d=t.studentId||(null==(e=t.student)?void 0:e.id),u=t.tutorId||(null==(r=t.tutor)?void 0:r.id);if(console.log(" Invoice creation check:",{safeDuration:n,studentId:d,tutorId:u,sessionDataKeys:Object.keys(t),hasStudent:!!t.student,hasTutor:!!t.tutor}),n>=60&&d&&u)try{const{createInvoice:e}=await ia(()=>Promise.resolve().then(()=>wn),void 0),s=Math.ceil(n/60),r=await e(t.id,d,u,s,t.subject||"Tutoring Session");r.success?console.log(" Invoice created successfully:",r.invoiceId):console.error(" Failed to create invoice:",r.error)}catch(i){console.error(" Error creating invoice:",i)}else console.warn(" Invoice not created:",{reason:n<60?"Duration too short":"Missing studentId or tutorId",safeDuration:n,studentId:d,tutorId:u})}catch(o){console.error(" Failed to update session status:",o)}s()},className:"p-3 rounded-full bg-red-600 hover:bg-red-700 text-white transition-colors",children:U.jsx(Hs,{size:24})})]})]})})},dn={}.VITE_API_BASE_URL||"http://localhost:3003/api",un=async e=>{try{const t=Intl.DateTimeFormat().resolvedOptions().timeZone||"UTC",s=await fetch(`${dn}/limits/${e}?timezone=${encodeURIComponent(t)}`,{method:"GET",headers:{"Content-Type":"application/json"}}),r=await s.json();return r.success?{success:!0,limits:r.limits,usage:r.usage,remaining:r.remaining,hasStudiplyPass:r.hasStudiplyPass,date:r.date,timezone:r.timezone}:{success:!1,error:r.error||"Failed to get user limits"}}catch(t){return console.error("Error getting user limits:",t),{success:!1,error:"Network error. Please try again."}}},hn=async(e,t)=>{try{const s=await un(e);if(!s.success)return{success:!1,canPerform:!1,error:s.error};const{remaining:r,hasStudiplyPass:a}=s;if("sessionRequest"===t){return{success:!0,canPerform:a||r.sessionRequests>0,remaining:r.sessionRequests,hasStudiplyPass:a}}if("videoCall"===t){return{success:!0,canPerform:r.videoCalls>0,remaining:r.videoCalls,hasStudiplyPass:a}}return{success:!1,canPerform:!1,error:"Invalid action type"}}catch(s){return console.error("Error checking limit:",s),{success:!1,canPerform:!1,error:"Network error. Please try again."}}},mn=async(e,t)=>{try{const s=Intl.DateTimeFormat().resolvedOptions().timeZone||"UTC",r=await fetch(`${dn}/limits/${e}/increment?timezone=${encodeURIComponent(s)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:t})}),a=await r.json();return a.success?(window.dispatchEvent(new Event("limits-refresh")),localStorage.setItem("limits-refresh",Date.now().toString()),{success:!0,usage:a.usage,remaining:a.remaining,hasStudiplyPass:a.hasStudiplyPass}):{success:!1,error:a.error||"Failed to increment usage",limit:a.limit}}catch(s){return console.error("Error incrementing usage:",s),{success:!1,error:"Network error. Please try again."}}},xn=()=>{const{user:t}=Br(),{isDark:s}=mt(),[r,a]=e.useState(null),[n,i]=e.useState(!1),[o,l]=e.useState(!1),[c,d]=e.useState({x:0,y:0}),[u,h]=e.useState(!1),[m,x]=e.useState({x:0,y:0}),[p,g]=e.useState(!1),b=e.useRef(null),f=e.useRef(null);e.useEffect(()=>{if(!(null==t?void 0:t.id))return;un(t.id).then(e=>{e.success&&(a(e),y(e))});const e=((e,t)=>{let s=null,r=null;const a=async()=>{const s=await un(e);s.success&&JSON.stringify(s)!==JSON.stringify(r)&&(r=s,t(s))};return a(),s=setInterval(a,5e3),()=>{s&&(clearInterval(s),s=null)}})(t.id,e=>{e.success&&(a(e),y(e))}),s=async()=>{const e=await(async e=>await un(e))(t.id);e.success&&(a(e),y(e))},r=e=>{"limits-refresh"===e.key&&e.newValue&&(s(),localStorage.removeItem("limits-refresh"))};return window.addEventListener("storage",r),window.addEventListener("limits-refresh",s),()=>{e&&e(),window.removeEventListener("storage",r),window.removeEventListener("limits-refresh",s)}},[null==t?void 0:t.id]),e.useEffect(()=>{const e=localStorage.getItem("limits-indicator-position");if(e)try{const t=JSON.parse(e);d(t)}catch(To){console.error("Error parsing saved position:",To),d({x:0,y:0})}else setTimeout(()=>{if(f.current&&b.current){const e=f.current.getBoundingClientRect(),t=b.current.getBoundingClientRect(),s=e.width-t.width-16;d({x:s,y:16})}},100)},[]);const w=e=>{if(!b.current||!f.current)return;e.preventDefault(),e.stopPropagation(),b.current.getBoundingClientRect();const t=f.current.getBoundingClientRect(),s=e.clientX-t.left-c.x,r=e.clientY-t.top-c.y;x({x:s,y:r}),h(!0),i(!1)};e.useEffect(()=>{if(!u)return;let e=null,t=0;const s=s=>{f.current&&b.current&&(e&&cancelAnimationFrame(e),e=requestAnimationFrame(()=>{const e=f.current.getBoundingClientRect(),r=b.current.getBoundingClientRect();let a=s.clientX-e.left-m.x,n=s.clientY-e.top-m.y;const i=e.width-r.width,o=e.height-r.height;a=Math.max(0,Math.min(a,i)),n=Math.max(0,Math.min(n,o));const l={x:a,y:n};d(l);const c=Date.now();c-t>200&&(localStorage.setItem("limits-indicator-position",JSON.stringify(l)),t=c)}))},r=()=>{if(e&&cancelAnimationFrame(e),h(!1),f.current&&b.current){const e=f.current.getBoundingClientRect(),t=b.current.getBoundingClientRect(),s=Math.max(0,Math.min(c.x,e.width-t.width)),r=Math.max(0,Math.min(c.y,e.height-t.height));localStorage.setItem("limits-indicator-position",JSON.stringify({x:s,y:r}))}};return document.addEventListener("mousemove",s,{passive:!0}),document.addEventListener("mouseup",r),()=>{e&&cancelAnimationFrame(e),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",r)}},[u,m]);const y=e=>{const{remaining:t,hasStudiplyPass:s}=e,r=!s&&1===t.sessionRequests,a=1===t.videoCalls;l(r||a)};if(!t||!r)return null;const{remaining:v,hasStudiplyPass:j}=r,N=(()=>{const e=j?ws:v.sessionRequests,t=v.videoCalls;return 0===e||0===t?{color:"red",bgColor:s?"bg-red-500/20":"bg-red-50",borderColor:s?"border-red-500/50":"border-red-200",textColor:"text-red-600",icon:At,status:"Exhausted"}:1===e||1===t?{color:"yellow",bgColor:s?"bg-yellow-500/20":"bg-yellow-50",borderColor:s?"border-yellow-500/50":"border-yellow-200",textColor:"text-yellow-600",icon:Et,status:"Low"}:{color:"green",bgColor:s?"bg-green-500/20":"bg-green-50",borderColor:s?"border-green-500/50":"border-green-200",textColor:"text-green-600",icon:j&&e===ws?ws:Ct,status:"Good"}})(),k=N.icon;return U.jsx("div",{ref:f,className:"absolute inset-0 pointer-events-none z-50",children:U.jsxs("div",{ref:b,className:"absolute transition-none "+(u?"cursor-grabbing":"cursor-grab"),style:{left:`${c.x}px`,top:`${c.y}px`,pointerEvents:"auto",willChange:u?"transform":"auto"},onMouseDown:w,onMouseEnter:()=>{g(!0)},onMouseLeave:()=>{g(!1),n&&i(!1)},onClick:e=>{u||(e.stopPropagation(),i(!n),n||g(!0))},children:[U.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 rounded-2xl border-2 shadow-xl transition-all duration-300 ${N.bgColor} ${N.borderColor} ${p||n||u?"opacity-100":"opacity-40 hover:opacity-100"}`,children:[U.jsx("div",{className:"flex-shrink-0 cursor-grab active:cursor-grabbing select-none",onMouseDown:e=>{e.stopPropagation(),w(e)},style:{userSelect:"none"},children:U.jsx(gs,{className:"w-4 h-4 "+(s?"text-slate-400":"text-slate-500")})}),U.jsx("div",{className:"flex-shrink-0",children:U.jsx(k,{className:`w-6 h-6 ${N.textColor}`})}),U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsxs("div",{className:"flex items-center gap-1.5",children:[U.jsx(Ds,{className:"w-4 h-4 "+(s?"text-slate-300":"text-slate-600")}),U.jsx("span",{className:`text-base font-bold ${N.textColor}`,children:j&&v.sessionRequests===ws?"":v.sessionRequests}),U.jsxs("span",{className:"text-xs "+(s?"text-slate-400":"text-slate-500"),children:["/",j?"":"3"]})]}),U.jsxs("div",{className:"flex items-center gap-1.5",children:[U.jsx(Cr,{className:"w-4 h-4 "+(s?"text-slate-300":"text-slate-600")}),U.jsx("span",{className:`text-base font-bold ${N.textColor}`,children:v.videoCalls}),U.jsxs("span",{className:"text-xs "+(s?"text-slate-400":"text-slate-500"),children:["/",j?"3":"1"]})]})]}),o&&U.jsx(bt,{className:`w-5 h-5 ${N.textColor} flex-shrink-0`}),n&&U.jsx("button",{onClick:e=>{e.stopPropagation(),i(!1)},className:"flex-shrink-0 p-1 rounded-lg "+(s?"hover:bg-white/10":"hover:bg-slate-100"),children:U.jsx(Rr,{className:"w-4 h-4 "+(s?"text-slate-400":"text-slate-500")})})]}),n&&!u&&U.jsxs("div",{className:`absolute top-full left-0 mt-3 w-96 rounded-2xl border-2 shadow-2xl p-6 transition-opacity duration-300 ${s?"bg-slate-800 border-slate-600":"bg-white border-slate-300"} opacity-100`,onMouseEnter:()=>{g(!0)},onMouseLeave:()=>{g(!1),i(!1)},children:[U.jsxs("div",{className:"flex items-center justify-between mb-6",children:[U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx("div",{className:`p-2 rounded-xl ${N.bgColor}`,children:U.jsx(k,{className:`w-6 h-6 ${N.textColor}`})}),U.jsxs("div",{children:[U.jsx("h3",{className:"text-xl font-bold "+(s?"text-white":"text-slate-900"),children:"Daily Limits"}),U.jsxs("p",{className:"text-sm "+(s?"text-slate-400":"text-slate-500"),children:[N.status,"  ",j?"Pro Account":"Free Account"]})]})]}),j&&U.jsx("span",{className:"px-3 py-1 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs font-semibold",children:"Pro"})]}),U.jsxs("div",{className:"space-y-4 mb-6",children:[U.jsxs("div",{className:"p-4 rounded-xl border-2 "+(s?"bg-slate-700/50 border-slate-600":"bg-slate-50 border-slate-200"),children:[U.jsxs("div",{className:"flex items-center justify-between mb-3",children:[U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx(Ds,{className:"w-5 h-5 "+(s?"text-blue-400":"text-blue-600")}),U.jsx("span",{className:"font-semibold "+(s?"text-white":"text-slate-900"),children:"Session Requests"})]}),U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx("span",{className:`text-lg font-bold ${N.textColor}`,children:j&&v.sessionRequests===ws?"":v.sessionRequests}),U.jsxs("span",{className:"text-sm "+(s?"text-slate-400":"text-slate-500"),children:["/ ",j?"":"3"]})]})]}),!j&&U.jsx("div",{className:"h-2.5 rounded-full overflow-hidden "+(s?"bg-slate-600":"bg-slate-200"),children:U.jsx("div",{className:"h-full transition-all "+(0===v.sessionRequests?"bg-red-500":1===v.sessionRequests?"bg-yellow-500":"bg-green-500"),style:{width:v.sessionRequests/3*100+"%"}})})]}),U.jsxs("div",{className:"p-4 rounded-xl border-2 "+(s?"bg-slate-700/50 border-slate-600":"bg-slate-50 border-slate-200"),children:[U.jsxs("div",{className:"flex items-center justify-between mb-3",children:[U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx(Cr,{className:"w-5 h-5 "+(s?"text-purple-400":"text-purple-600")}),U.jsx("span",{className:"font-semibold "+(s?"text-white":"text-slate-900"),children:"Video Calls"})]}),U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx("span",{className:`text-lg font-bold ${N.textColor}`,children:v.videoCalls}),U.jsxs("span",{className:"text-sm "+(s?"text-slate-400":"text-slate-500"),children:["/ ",j?"3":"1"]})]})]}),U.jsx("div",{className:"h-2.5 rounded-full overflow-hidden "+(s?"bg-slate-600":"bg-slate-200"),children:U.jsx("div",{className:"h-full transition-all "+(0===v.videoCalls?"bg-red-500":1===v.videoCalls?"bg-yellow-500":"bg-green-500"),style:{width:v.videoCalls/(j?3:1)*100+"%"}})})]})]}),o&&U.jsxs("div",{className:"mb-4 p-4 rounded-xl border-2 flex items-start gap-3 "+(s?"bg-yellow-500/20 border-yellow-500/40":"bg-yellow-50 border-yellow-300"),children:[U.jsx(bt,{className:"w-5 h-5 flex-shrink-0 mt-0.5 "+(s?"text-yellow-400":"text-yellow-600")}),U.jsxs("div",{children:[U.jsx("p",{className:"font-semibold mb-1 "+(s?"text-yellow-300":"text-yellow-800"),children:"Last Attempt Remaining!"}),U.jsx("p",{className:"text-sm "+(s?"text-yellow-200/80":"text-yellow-700"),children:"You're on your last attempt. Consider upgrading to Pro for unlimited access."})]})]}),!j&&U.jsx("div",{className:"pt-4 border-t-2 "+(s?"border-slate-700":"border-slate-200"),children:U.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-gradient-to-r from-purple-500/10 to-pink-500/10 border border-purple-500/20",children:[U.jsx(Mr,{className:"w-5 h-5 "+(s?"text-purple-400":"text-purple-600")}),U.jsxs("div",{className:"flex-1",children:[U.jsx("p",{className:"text-sm font-semibold "+(s?"text-white":"text-slate-900"),children:"Upgrade to Pro"}),U.jsx("p",{className:"text-xs "+(s?"text-slate-400":"text-slate-600"),children:"Get unlimited session requests"})]})]})})]})]})})},pn=async e=>{try{let s;console.log(" Fetching invoices for student:",e);try{const t=l(o(dt,"invoices"),c("studentId","==",e),y("createdAt","desc"));s=await d(t)}catch(t){console.warn(" Index not available, falling back to unsorted query:",t.message);const r=l(o(dt,"invoices"),c("studentId","==",e));s=await d(r)}const r=s.docs.map(e=>({id:e.id,...e.data()}));return r.sort((e,t)=>{var s,r,a,n,i,o;const l=(null==(r=null==(s=e.createdAt)?void 0:s.toMillis)?void 0:r.call(s))||1e3*(null==(a=e.createdAt)?void 0:a.seconds)||0;return((null==(i=null==(n=t.createdAt)?void 0:n.toMillis)?void 0:i.call(n))||1e3*(null==(o=t.createdAt)?void 0:o.seconds)||0)-l}),console.log(" Found",r.length,"invoices for student"),{success:!0,invoices:r}}catch(s){return console.error("Error getting student invoices:",s),{success:!1,invoices:[],error:s.message}}},gn=async e=>{try{let s;console.log(" Checking unpaid invoices for student:",e);try{const t=l(o(dt,"invoices"),c("studentId","==",e),c("status","==","pending"));s=await d(t)}catch(t){console.warn(" Index not available, falling back to filter:",t.message);const s=l(o(dt,"invoices"),c("studentId","==",e)),r=(await d(s)).docs.filter(e=>"pending"===e.data().status);return console.log(" Found",r.length,"unpaid invoices"),{success:!0,hasUnpaid:r.length>0,unpaidCount:r.length,unpaidInvoices:r.map(e=>({id:e.id,...e.data()}))}}return console.log(" Found",s.size,"unpaid invoices"),{success:!0,hasUnpaid:!s.empty,unpaidCount:s.size,unpaidInvoices:s.docs.map(e=>({id:e.id,...e.data()}))}}catch(s){return console.error("Error checking unpaid invoices:",s),{success:!1,hasUnpaid:!1,error:s.message}}},bn=async(e,t)=>{try{console.log(" Marking invoice as paid:",e);const s=u(dt,"invoices",e),r=await m(s);if(!r.exists())return console.error(" Invoice not found:",e),{success:!1,error:"Invoice not found"};const a=r.data();console.log(" Invoice data:",a),await x(s,{status:"paid",paidAt:p(),stripeSessionId:t||"manual",updatedAt:p()}),console.log(" Invoice status updated to paid");const n=u(dt,"tutorStats",a.tutorId),i=await m(n);if(i.exists()){const e=i.data();await x(n,{totalEarnings:(e.totalEarnings||0)+(a.tutorEarnings||0),pendingEarnings:Math.max(0,(e.pendingEarnings||0)-(a.tutorEarnings||0)),completedSessions:(e.completedSessions||0)+1,updatedAt:p()}),console.log(" Tutor stats updated")}else await h(n,{totalEarnings:a.tutorEarnings||0,pendingEarnings:0,totalSessions:1,totalRating:0,ratingCount:0,completedSessions:1,createdAt:p(),updatedAt:p()}),console.log(" Tutor stats created");return console.log(" Invoice marked as paid:",e),{success:!0}}catch(s){return console.error(" Error marking invoice as paid:",s),{success:!1,error:s.message}}},fn=async e=>{try{console.log(" Loading wallet for tutor:",e);const s=u(dt,"tutorStats",e),r=await m(s);let a={totalEarnings:0,pendingEarnings:0,completedSessions:0};if(r.exists()){const e=r.data();console.log(" Tutor stats from DB:",e),a={totalEarnings:e.totalEarnings||0,pendingEarnings:e.pendingEarnings||0,completedSessions:e.completedSessions||0}}else console.log(" No tutor stats found, will calculate from invoices");let n=[];try{const t=l(o(dt,"invoices"),c("tutorId","==",e));n=(await d(t)).docs.map(e=>({id:e.id,...e.data()})),console.log(" Found",n.length,"total invoices for tutor")}catch(t){console.error("Error querying invoices:",t)}const i=n.filter(e=>"paid"===e.status),h=n.filter(e=>"pending"===e.status);console.log(" Paid invoices:",i.length),console.log(" Pending invoices:",h.length),i.sort((e,t)=>{var s,r,a,n,i,o;const l=(null==(r=null==(s=e.paidAt)?void 0:s.toMillis)?void 0:r.call(s))||1e3*(null==(a=e.paidAt)?void 0:a.seconds)||0;return((null==(i=null==(n=t.paidAt)?void 0:n.toMillis)?void 0:i.call(n))||1e3*(null==(o=t.paidAt)?void 0:o.seconds)||0)-l});let x=a.totalEarnings;0===x&&i.length>0&&(x=i.reduce((e,t)=>e+(t.tutorEarnings||0),0),console.log(" Calculated total earnings from invoices:",x));const p={totalEarnings:x,pendingEarnings:h.reduce((e,t)=>e+(t.tutorEarnings||0),0),completedSessions:a.completedSessions||i.length,recentPayments:i.slice(0,5),pendingInvoices:h};return console.log(" Final wallet data:",p),{success:!0,wallet:p}}catch(s){return console.error("Error getting tutor wallet:",s),{success:!1,wallet:{totalEarnings:0,pendingEarnings:0,completedSessions:0,recentPayments:[],pendingInvoices:[]},error:s.message}}},wn=Object.freeze(Object.defineProperty({__proto__:null,createInvoice:async(e,t,s,r,a)=>{var n;try{if(console.log(" Creating invoice...",{sessionId:e,studentId:t,tutorId:s,durationMinutes:r,subject:a}),!e||!t||!s)return console.error(" Missing required parameters:",{sessionId:e,studentId:t,tutorId:s}),{success:!1,error:"Missing required parameters: sessionId, studentId, or tutorId"};if(!r||r<=0)return console.error(" Invalid duration:",r),{success:!1,error:"Invalid duration"};try{const t=l(o(dt,"invoices"),c("sessionId","==",e)),s=await d(t);if(!s.empty){const e=s.docs[0];return console.log(" Invoice already exists for this session:",e.id),{success:!0,invoiceId:e.id,invoice:{id:e.id,...e.data()},alreadyExists:!0}}}catch(i){console.warn(" Could not check for existing invoice:",i.message)}const h=await m(u(dt,"users",s));if(!h.exists())return console.error(" Tutor not found:",s),{success:!1,error:"Tutor not found"};const x=h.data(),g=(null==(n=x.tutorProfile)?void 0:n.hourlyRate)||15;console.log(" Tutor hourly rate:",g);const f=parseFloat((g*(r/60)).toFixed(2)),w=parseFloat((.2*f).toFixed(2)),y=parseFloat((f-w).toFixed(2)),v=await m(u(dt,"users",t)),j=v.exists()?v.data().name:"Unknown",N={sessionId:e,studentId:t,tutorId:s,studentName:j,tutorName:x.name||"Unknown",subject:a||"Tutoring Session",durationMinutes:r,hourlyRate:g,subtotal:f,platformFee:w,platformFeeRate:.2,tutorEarnings:y,status:"pending",createdAt:p(),updatedAt:p()};console.log(" Invoice data:",N);const k=await b(o(dt,"invoices"),N);return console.log(" Invoice created successfully:",k.id),{success:!0,invoiceId:k.id,invoice:{id:k.id,subtotal:f,platformFee:w,tutorEarnings:y}}}catch(h){return console.error(" Error creating invoice:",h),{success:!1,error:h.message}}},forceMarkInvoiceAsPaid:async e=>bn(e,"force_paid_"+Date.now()),getInvoice:async e=>{try{const t=u(dt,"invoices",e),s=await m(t);return s.exists()?{success:!0,invoice:{id:s.id,...s.data()}}:{success:!1,error:"Invoice not found"}}catch(t){return console.error("Error getting invoice:",t),{success:!1,error:t.message}}},getStudentInvoices:pn,getTutorInvoices:async e=>{try{let s;console.log(" Fetching invoices for tutor:",e);try{const t=l(o(dt,"invoices"),c("tutorId","==",e),y("createdAt","desc"));s=await d(t)}catch(t){console.warn(" Index not available, falling back to unsorted query:",t.message);const r=l(o(dt,"invoices"),c("tutorId","==",e));s=await d(r)}const r=s.docs.map(e=>({id:e.id,...e.data()}));return r.sort((e,t)=>{var s,r,a,n,i,o;const l=(null==(r=null==(s=e.createdAt)?void 0:s.toMillis)?void 0:r.call(s))||1e3*(null==(a=e.createdAt)?void 0:a.seconds)||0;return((null==(i=null==(n=t.createdAt)?void 0:n.toMillis)?void 0:i.call(n))||1e3*(null==(o=t.createdAt)?void 0:o.seconds)||0)-l}),console.log(" Found",r.length,"invoices for tutor"),{success:!0,invoices:r}}catch(s){return console.error("Error getting tutor invoices:",s),{success:!1,invoices:[],error:s.message}}},getTutorWallet:fn,hasUnpaidInvoices:gn,markInvoiceAsPaid:bn},Symbol.toStringTag,{value:"Module"})),yn=()=>{const{user:t}=Br(),{theme:s,isDark:r}=mt(),{showSuccess:a,showError:n}=Hr(),i=qe(),[l,c]=e.useState(""),[d,h]=e.useState("all"),[x,f]=e.useState([]),[w,y]=e.useState([]),[v,j]=e.useState(!0),[N,k]=e.useState(!1),[S,C]=e.useState({minRating:0,maxPrice:100,availableOnly:!0}),[E,A]=e.useState(!1),[T,I]=e.useState(!1),[P,q]=e.useState(!1),[R,M]=e.useState(!1),[D,L]=e.useState(null),[F,$]=e.useState(!1),[O,B]=e.useState({}),[_,z]=e.useState(!1),[W,H]=e.useState(null),[G,V]=e.useState({hasUnpaid:!1,unpaidCount:0});e.useEffect(()=>{Q(),J(),Y()},[t]);const Y=async()=>{if(null==t?void 0:t.id)try{const e=await gn(t.id);e.success&&V({hasUnpaid:e.hasUnpaid,unpaidCount:e.unpaidCount})}catch(e){console.error("Error checking unpaid invoices:",e)}};e.useEffect(()=>{let e=null;const s=()=>{if(e&&"function"==typeof e)try{console.log(" Cleaning up tutor list listener"),e()}catch(t){console.error("Error cleaning up tutor list listener:",t)}};if(!(null==t?void 0:t.id))return s;console.log(" Setting up real-time tutor list listener");const r=o(dt,"users");return e=g(r,e=>{const s=[];e.forEach(e=>{var r,a,n,i;try{const o=e.data();if(o&&o.isTutor&&o.tutorProfile&&e.id!==(null==t?void 0:t.id)){const t=Ur(o),l=o.subjects&&o.subjects.length>0?o.subjects:(null==(r=o.tutorProfile)?void 0:r.specialties)||[];s.push({id:e.id,name:o.name||"Unknown",email:o.email||"",school:o.school||"",grade:o.grade||"",bio:o.bio||"",avatar:o.avatar||"",tutorProfile:o.tutorProfile||{},subjects:l,specialties:(null==(a=o.tutorProfile)?void 0:a.specialties)||[],description:(null==(n=o.tutorProfile)?void 0:n.description)||"",isAvailable:(null==(i=o.tutorProfile)?void 0:i.isAvailable)||!1,isOnline:t,stats:{totalSessions:0,completedSessions:0,averageRating:0,ratingCount:0}})}}catch(o){console.error(" Error processing user data:",o,"Doc ID:",e.id)}}),f(s),j(!1)},e=>{console.error(" Error listening to tutors:",e),j(!1)}),s},[null==t?void 0:t.id]),e.useEffect(()=>{(null==t?void 0:t.id)&&Q()},[null==t?void 0:t.isTutor]),e.useEffect(()=>{w.length>0&&(null==t?void 0:t.id)&&K()},[w,t]),e.useEffect(()=>{const e=setTimeout(()=>{X()},300);return()=>clearTimeout(e)},[l,d,S,x,null==t?void 0:t.id]);const Q=async()=>{try{j(!0),console.log(" Loading tutors with fresh data...");const e=await Ma();if(e.success){let s=e.tutors;console.log(" All tutors with stats:",e.tutors.map(e=>{var t,s,r;return{id:e.id,name:e.name,rating:e.rating,stats:e.stats,averageRating:null==(t=e.stats)?void 0:t.averageRating,totalRating:null==(s=e.stats)?void 0:s.totalRating,ratingCount:null==(r=e.stats)?void 0:r.ratingCount}}));const r=e.tutors.filter(e=>{var t;return e.rating>0||(null==(t=e.stats)?void 0:t.ratingCount)>0});if(console.log(" Tutors with ratings:",r.length,r.map(e=>{var t,s;return{id:e.id,name:e.name,rating:e.rating,ratingCount:null==(t=e.stats)?void 0:t.ratingCount,totalRating:null==(s=e.stats)?void 0:s.totalRating}})),console.log("Current user:",null==t?void 0:t.id,null==t?void 0:t.name,"isTutor:",null==t?void 0:t.isTutor),null==t?void 0:t.isTutor){const r=s.length;s=e.tutors.filter(e=>e.id!==(null==t?void 0:t.id)),console.log(`Filtered out self: ${r} -> ${s.length} tutors`)}f(s)}else console.error("Failed to load tutors:",e.error),f([])}catch(e){console.error("Error loading tutors:",e),f([])}finally{j(!1)}},J=()=>{console.log("Checking user tutor status:",t),(null==t?void 0:t.isTutor)?($(!0),console.log("User is a tutor")):($(!1),console.log("User is not a tutor"))},K=async()=>{var e;if(!(null==t?void 0:t.id))return;const s={};for(const a of w)try{const r=await Ua(null==t?void 0:t.id,a.id);r.success&&(s[a.id]={hasRequest:r.hasExistingRequest,status:(null==(e=r.existingSession)?void 0:e.status)||null})}catch(r){console.error(`Error checking request status for tutor ${a.id}:`,r),s[a.id]={hasRequest:!1,status:null}}B(s)},X=async()=>{try{let e=[...x];if((null==t?void 0:t.isTutor)&&(e=e.filter(e=>e.id!==(null==t?void 0:t.id))),d&&"all"!==d){const t=d.toLowerCase();e=e.filter(e=>{if(!e.subjects||0===e.subjects.length)return!1;return[...e.subjects||[],...e.specialties||[]].some(e=>{const s=e.toLowerCase();return s===t||s.includes(t)||t.includes(s)})})}if(l){const t=l.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||(e.specialties||[]).some(e=>e.toLowerCase().includes(t))||(e.description||"").toLowerCase().includes(t))}S.minRating&&(e=e.filter(e=>(e.rating||0)>=S.minRating)),S.availableOnly&&(e=e.filter(e=>e.isAvailable)),y(e)}catch(e){console.error("Error searching tutors:",e)}},Z=[{id:"all",name:"All Subjects",icon:Pt},{id:"math",name:"Mathematics",icon:Dt},{id:"science",name:"Science",icon:jt},{id:"physics",name:"Physics",icon:jt},{id:"chemistry",name:"Chemistry",icon:jt},{id:"biology",name:"Biology",icon:jt},{id:"english",name:"English",icon:xs},{id:"history",name:"History",icon:Pt},{id:"art",name:"Art",icon:Bs},{id:"music",name:"Music",icon:Os},{id:"programming",name:"Programming",icon:Vt}];return v?U.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center relative overflow-hidden",children:[U.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[U.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"}),U.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"}),U.jsx("div",{className:"absolute top-40 left-40 w-60 h-60 bg-pink-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"})]}),U.jsxs("div",{className:"relative z-10 text-center",children:[U.jsxs("div",{className:"relative",children:[U.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-400 to-blue-500 rounded-2xl blur-lg opacity-30"}),U.jsx("div",{className:"relative w-20 h-20 bg-gradient-to-r from-purple-500 to-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-2xl",children:U.jsx(er,{className:"w-10 h-10 text-white animate-pulse"})})]}),U.jsx("h3",{className:"text-2xl font-bold text-white mb-3",children:"Loading Tutors"}),U.jsx("p",{className:"text-white/70 text-lg",children:"Finding the best tutors for you..."})]})]}):U.jsx("div",{className:"min-h-screen relative overflow-hidden "+(r?"bg-gradient-to-br from-[#12092b] via-[#180d3d] to-[#090617] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:U.jsxs("div",{className:"relative w-full h-full",children:[U.jsx(xn,{}),U.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[U.jsx("div",{className:"absolute -top-32 left-1/2 w-80 h-80 -translate-x-1/2 rounded-full bg-purple-500/30 blur-3xl"}),U.jsx("div",{className:"absolute bottom-10 right-10 w-72 h-72 rounded-full bg-pink-400/20 blur-3xl"}),U.jsx("div",{className:"absolute top-1/2 left-10 w-60 h-60 rounded-full bg-blue-400/20 blur-3xl"})]}),U.jsxs("div",{className:"relative z-10 mx-auto flex w-full max-w-7xl flex-col gap-10 px-6 py-14",children:[U.jsxs("section",{className:"grid gap-8 lg:grid-cols-[minmax(0,58%)_minmax(0,42%)]",children:[U.jsxs("div",{className:"rounded-[32px] border px-8 py-9 shadow-2xl backdrop-blur-xl "+(r?"border-white/10 bg-gradient-to-br from-white/10 via-white/5 to-transparent/40":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-purple-500/10 px-3.5 py-2 text-xs font-semibold text-purple-500",children:[U.jsx(er,{className:"h-4 w-4"})," Find your mentor"]}),U.jsx("h1",{className:"mt-4 text-3xl font-black tracking-tight md:text-4xl",children:"Discover experienced tutors tailored to your learning goals"}),U.jsx("p",{className:"mt-3 max-w-xl text-sm md:text-base "+(r?"text-white/70":"text-slate-600"),children:"Browse curated student mentors, view their expertise, and request personalised sessions. Switch realms, adjust filters, and see real-time availability to craft your ideal study plan."}),U.jsxs("div",{className:"mt-6 grid gap-4 sm:grid-cols-2",children:[U.jsxs("div",{className:"rounded-3xl border px-4 py-4 "+(r?"border-white/10 bg-white/6":"border-slate-200 bg-white"),children:[U.jsx("p",{className:"text-xs uppercase tracking-wide text-purple-400",children:"1-on-1 Sessions"}),U.jsx("p",{className:"mt-1 text-sm font-semibold "+(r?"text-white":"text-slate-800"),children:"Tailored learning experiences"})]}),U.jsxs("div",{className:"rounded-3xl border px-4 py-4 "+(r?"border-white/10 bg-white/6":"border-slate-200 bg-white"),children:[U.jsx("p",{className:"text-xs uppercase tracking-wide text-purple-400",children:"Diverse mentors"}),U.jsx("p",{className:"mt-1 text-sm font-semibold "+(r?"text-white":"text-slate-800"),children:"Language, STEM, humanities & business experts"})]})]})]}),U.jsx("div",{className:"rounded-[32px] border px-6 py-6 shadow-lg backdrop-blur-xl "+(r?"border-white/12 bg-gradient-to-br from-white/12 via-white/6 to-transparent/30":"border-white/70 bg-white"),children:U.jsxs("div",{className:"space-y-4",children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-xs font-semibold uppercase tracking-wide mb-2 "+(r?"text-white/70":"text-slate-600"),children:"Search mentors"}),U.jsxs("div",{className:"relative",children:[U.jsx("input",{type:"text",placeholder:"Search tutors, subjects, or specialties",className:"w-full rounded-2xl border px-4 py-3 text-sm transition-colors "+(r?"border-white/10 bg-white/10 text-white placeholder-white/50 focus:border-purple-400":"border-slate-200 bg-white text-slate-800 focus:border-purple-400"),value:l,onChange:e=>c(e.target.value)}),U.jsx(er,{className:"absolute right-4 top-1/2 h-4 w-4 -translate-y-1/2 text-purple-400"})]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-xs font-semibold uppercase tracking-wide mb-2 "+(r?"text-white/70":"text-slate-600"),children:"Subject focus"}),U.jsx("select",{className:"w-full rounded-2xl border px-4 py-3 text-sm transition-colors "+(r?"border-white/10 bg-white/10 text-white focus:border-purple-400":"border-slate-200 bg-white text-slate-800 focus:border-purple-400"),value:d,onChange:e=>h(e.target.value),children:Z.map(e=>U.jsx("option",{value:e.id,className:r?"bg-slate-900 text-white":"",children:e.name},e.id))})]}),U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide "+(r?"text-white/60":"text-slate-600"),children:"Advanced filters"}),U.jsxs("button",{onClick:()=>k(!N),className:"text-sm font-semibold text-purple-500 hover:text-purple-400 transition-colors",children:[N?"Hide":"Show"," filters"]})]}),N&&U.jsxs("div",{className:"rounded-2xl border px-4 py-4 space-y-4 "+(r?"border-white/10 bg-white/6":"border-slate-200 bg-white"),children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-xs font-semibold uppercase tracking-wide mb-2 "+(r?"text-white/60":"text-slate-600"),children:"Minimum rating"}),U.jsxs("select",{className:"w-full rounded-2xl border px-3 py-2 text-sm "+(r?"border-white/10 bg-white/8 text-white":"border-slate-200 bg-white text-slate-800"),value:S.minRating,onChange:e=>C({...S,minRating:parseFloat(e.target.value)}),children:[U.jsx("option",{value:0,children:"Any rating"}),U.jsx("option",{value:3,children:"3+ stars"}),U.jsx("option",{value:4,children:"4+ stars"}),U.jsx("option",{value:4.5,children:"4.5+ stars"})]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-xs font-semibold uppercase tracking-wide mb-2 "+(r?"text-white/60":"text-slate-600"),children:"Max price"}),U.jsxs("select",{className:"w-full rounded-2xl border px-3 py-2 text-sm "+(r?"border-white/10 bg-white/8 text-white":"border-slate-200 bg-white text-slate-800"),value:S.maxPrice,onChange:e=>C({...S,maxPrice:parseInt(e.target.value)}),children:[U.jsx("option",{value:100,children:"Any price"}),U.jsx("option",{value:20,children:"Under $20/hour"}),U.jsx("option",{value:30,children:"Under $30/hour"}),U.jsx("option",{value:50,children:"Under $50/hour"})]})]}),U.jsxs("label",{className:"flex items-center gap-3 text-sm font-medium",children:[U.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-purple-400 text-purple-500 focus:ring-purple-200",checked:S.availableOnly,onChange:e=>C({...S,availableOnly:e.target.checked})}),U.jsx("span",{className:r?"text-white/70":"text-slate-600",children:"Available tutors only"})]})]})]})})]}),U.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[U.jsxs("div",{className:"rounded-3xl border px-5 py-5 shadow-lg backdrop-blur "+(r?"border-white/12 bg-gradient-to-br from-white/10 via-white/4 to-transparent/40":"border-white/70 bg-white"),children:[U.jsx("div",{className:"text-xs uppercase tracking-wide text-purple-400",children:"Available mentors"}),U.jsx("div",{className:"mt-2 text-3xl font-bold "+(r?"text-white drop-shadow-[0_0_12px_rgba(255,255,255,0.25)]":"text-slate-900"),children:w.length}),U.jsx("p",{className:"mt-1 text-xs "+(r?"text-white/60":"text-slate-500"),children:"Ready for sessions"})]}),U.jsxs("div",{className:"rounded-3xl border px-5 py-5 shadow-lg backdrop-blur "+(r?"border-white/12 bg-gradient-to-br from-white/10 via-white/4 to-transparent/40":"border-white/70 bg-white"),children:[U.jsx("div",{className:"text-xs uppercase tracking-wide text-purple-400",children:"Total experience"}),U.jsx("div",{className:"mt-2 text-3xl font-bold "+(r?"text-white":"text-slate-900"),children:w.reduce((e,t)=>{var s;return e+((null==(s=t.stats)?void 0:s.totalSessions)||0)},0)}),U.jsx("p",{className:"mt-1 text-xs "+(r?"text-white/60":"text-slate-500"),children:"Sessions completed"})]}),U.jsxs("div",{className:"rounded-3xl border px-5 py-5 shadow-lg backdrop-blur "+(r?"border-white/12 bg-gradient-to-br from-white/10 via-white/4 to-transparent/40":"border-white/70 bg-white"),children:[U.jsx("div",{className:"text-xs uppercase tracking-wide text-purple-400",children:"Average rating"}),U.jsx("div",{className:"mt-2 text-3xl font-bold "+(r?"text-white":"text-slate-900"),children:(()=>{const e=w.filter(e=>e.rating>0);return e.length>0?`${(e.reduce((e,t)=>e+t.rating,0)/e.length).toFixed(1)}/5`:"No ratings yet"})()}),U.jsx("p",{className:"mt-1 text-xs "+(r?"text-white/60":"text-slate-500"),children:"Based on student feedback"})]}),U.jsxs("div",{className:"rounded-3xl border px-5 py-5 shadow-lg backdrop-blur "+(r?"border-white/12 bg-gradient-to-br from-white/10 via-white/4 to-transparent/40":"border-white/70 bg-white"),children:[U.jsx("div",{className:"text-xs uppercase tracking-wide text-purple-400",children:"Currently online"}),U.jsx("div",{className:"mt-2 text-3xl font-bold "+(r?"text-white drop-shadow-[0_0_12px_rgba(255,255,255,0.25)]":"text-slate-900"),children:w.filter(e=>e.isAvailable).length}),U.jsx("p",{className:"mt-1 text-xs "+(r?"text-white/60":"text-slate-500"),children:"Available now"})]})]}),w.length>0?U.jsx("section",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-2 2xl:grid-cols-3 gap-6",children:w.map(e=>{var s;(e=>{const t=Z.find(t=>t.name===e);t&&t.icon})(e.subjects&&e.subjects[0]||"General");const a=(e=>{const t=O[e.id];if(!(null==t?void 0:t.hasRequest))return{text:"Request Session",disabled:!1,className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors text-sm flex items-center justify-center"};const s={pending:{text:"Request Pending...",disabled:!0,className:"flex-1 bg-yellow-500 text-white py-2 px-4 rounded-lg cursor-not-allowed text-sm flex items-center justify-center"},accepted:{text:"Start Session",disabled:!1,className:"flex-1 bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 transition-colors text-sm flex items-center justify-center"},declined:{text:"Request Declined",disabled:!0,className:"flex-1 bg-red-500 text-white py-2 px-4 rounded-lg cursor-not-allowed text-sm flex items-center justify-center"}};return s[t.status]||s.pending})(e),o=O[e.id],l="accepted"===(null==o?void 0:o.status);return U.jsxs("div",{className:"rounded-[28px] border px-6 py-6 backdrop-blur-xl transition-transform hover:-translate-y-1 hover:shadow-2xl "+(r?"border-white/12 bg-gradient-to-br from-white/10 via-white/4 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx(Za,{user:e,size:"xl",className:"shadow-lg"}),U.jsxs("div",{children:[U.jsx("h3",{className:"text-lg font-semibold "+(r?"text-white":"text-slate-900"),children:e.name}),U.jsx("div",{className:"mt-1 inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-semibold "+(e.isOnline?e.isAvailable?"bg-green-500/10 text-green-500":"bg-slate-500/10 text-slate-400":"bg-gray-500/10 text-gray-500"),children:e.isOnline?e.isAvailable?"Available":"Busy":"Offline"})]})]}),U.jsx("div",{className:"rounded-full px-3 py-1 text-xs font-semibold "+(r?"bg-white/10 text-white/80":"bg-purple-50 text-purple-600"),children:"Studiply Pass"})]}),U.jsx("p",{className:"mt-4 text-sm leading-relaxed "+(r?"text-white/80":"text-slate-600"),children:e.description}),U.jsx("div",{className:"mt-5 flex flex-wrap gap-2",children:(e.subjects&&e.subjects.length>0?e.subjects:e.specialties||[]).slice(0,3).map((e,t)=>U.jsx("span",{className:"rounded-full px-3 py-1 text-xs font-medium "+(r?"bg-white/10 text-white/70":"bg-slate-100 text-slate-700"),children:e},t))}),U.jsxs("div",{className:"mt-5 flex items-center justify-between text-sm",children:[U.jsxs("div",{className:"flex items-center gap-2 "+(r?"text-white/70":"text-slate-600"),children:[U.jsx(Ht,{className:"h-4 w-4"}),U.jsx("span",{children:(null==(s=e.tutorProfile)?void 0:s.responseTime)||"Responds within a day"})]}),U.jsxs("div",{className:"flex items-center gap-2 "+(r?"text-white/80":"text-slate-600"),children:[U.jsx(or,{className:"h-4 w-4 text-yellow-400"}),U.jsx("span",{children:e.rating?e.rating.toFixed(1):"New tutor"})]})]}),U.jsxs("div",{className:"mt-6 flex items-center gap-3",children:[U.jsxs("button",{onClick:()=>i(`/chat-tutor/${e.id}`,{state:{from:"tutoring"}}),className:"rounded-2xl px-4 py-3 text-sm font-semibold transition-all bg-gradient-to-r from-indigo-500 to-purple-500 text-white shadow-lg shadow-indigo-500/30 hover:-translate-y-0.5",children:[U.jsx(Ms,{className:"h-4 w-4 inline-block mr-2"}),"Chat"]}),U.jsx("button",{onClick:()=>{l?(async e=>{const s=await hn(null==t?void 0:t.id,"videoCall");if(!s.success||!s.canPerform)return void n(s.error||"Daily video call limit reached. Please upgrade to Pro for more calls.",5e3,"Limit Reached");const r=await mn(null==t?void 0:t.id,"videoCall");if(window.dispatchEvent(new Event("limits-refresh")),!r.success)return void n(r.error||"Failed to start video call. Limit may have been reached.",5e3,"Error");H({subject:"Tutoring Session",tutor:e,student:t}),z(!0)})(e):a.disabled||(e=>{if(!t)return void n("Please log in to request a tutoring session",5e3,"Login Required");if(G.hasUnpaid)return n(`You have ${G.unpaidCount} unpaid invoice(s). Please pay your outstanding invoices before requesting new sessions.`,6e3,"Payment Required"),void i("/student-dashboard?tab=invoices");const s=O[e.id];if(null==s?void 0:s.hasRequest)return void n(`You already have a ${{pending:"Request Pending",accepted:"Request Accepted",declined:"Request Declined"}[s.status]||"request"} with this tutor`,5e3,"Request Exists");L(e),I(!0)})(e)},disabled:a.disabled,className:"flex-1 rounded-2xl px-4 py-3 text-sm font-semibold transition-all "+(l?"bg-gradient-to-r from-blue-500 to-cyan-500 text-white shadow-lg shadow-blue-500/30":a.disabled?"bg-slate-600/30 text-slate-400 cursor-not-allowed":"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg shadow-purple-500/30 hover:-translate-y-0.5"),children:l?"Join session":a.text}),U.jsx("button",{onClick:()=>{L(e),M(!0)},className:"rounded-2xl px-4 py-3 text-sm font-semibold "+(r?"bg-white/10 text-white hover:bg-white/15":"bg-slate-100 text-slate-700 hover:bg-slate-200"),children:"Reviews"})]})]},e.id)})}):U.jsxs("section",{className:"rounded-[32px] border px-8 py-16 text-center backdrop-blur-xl "+(r?"border-white/10 bg-white/6":"border-white/70 bg-white"),children:[U.jsx("div",{className:"text-5xl mb-4",children:""}),U.jsx("h3",{className:"text-2xl font-semibold mb-2 "+(r?"text-white":"text-slate-800"),children:"No tutors found"}),U.jsx("p",{className:r?"text-white/60":"text-slate-600",children:"Try adjusting your search or filters to discover more mentors."}),U.jsx("button",{onClick:()=>{c(""),h("all"),C({minRating:0,maxPrice:100,availableOnly:!0})},className:"mt-6 rounded-2xl bg-gradient-to-r from-purple-500 to-pink-500 px-5 py-3 text-sm font-semibold text-white shadow-lg shadow-purple-500/30",children:"Reset filters"})]})]}),E&&U.jsx(Ka,{user:t,onClose:()=>A(!1),onSuccess:()=>{Q(),J()}}),T&&D&&U.jsx(Xa,{tutor:D,isOpen:T,onClose:()=>{I(!1),L(null)},onSubmit:async e=>{try{const s=await hn(null==t?void 0:t.id,"sessionRequest");if(!s.success||!s.canPerform)return void n(s.error||"Daily session request limit reached. Please upgrade to Pro for unlimited requests.",5e3,"Limit Reached");console.log("Submitting session request with data:",{studentId:null==t?void 0:t.id,tutorId:D.id,subject:e.subject,scheduledTime:e.preferredTime,message:e.description});const r=await(async(e,t,s,r,a="")=>{try{console.log("requestSession called with:",{studentId:e,tutorId:t,subject:s,scheduledTime:r,message:a});const n=o(dt,"sessions");let i=null;if(r){const e=r instanceof Date?r:new Date(r);isNaN(e.getTime())||(i=e.toISOString())}const l={studentId:e,tutorId:t,subject:s,preferredTime:i,message:a,duration:60,status:"pending",createdAt:p(),updatedAt:p()};console.log("Session data to be saved:",l);const c=await b(n,l);console.log("Session created successfully with ID:",c.id);let d="Student";try{const t=await m(u(dt,"users",e));if(t.exists()){const e=t.data();d=(null==e?void 0:e.name)||"Student"}}catch(To){}return await Ba(t,"info","New session request",`${d} requested a ${s} session`,{sessionId:c.id,role:"tutor",status:"pending",fromName:d,subject:s}),{success:!0,sessionId:c.id,message:"Session request sent successfully"}}catch(n){return console.error("Error requesting session:",n),console.error("Error details:",{code:n.code,message:n.message,stack:n.stack}),{success:!1,error:`Failed to send session request: ${n.message}`}}})(null==t?void 0:t.id,D.id,e.subject,e.preferredTime||null,e.description);if(console.log("Session request result:",r),r.success){await mn(null==t?void 0:t.id,"sessionRequest");window.dispatchEvent(new Event("limits-refresh")),a("Tutoring session request sent successfully! Check your Student Dashboard to track the status.",5e3,"Request Sent"),B(e=>({...e,[D.id]:{hasRequest:!0,status:"pending"}}))}else n(`Failed to send request: ${r.error}`,5e3,"Request Failed")}catch(s){n("An error occurred while sending the request",5e3,"Error"),console.error("Error requesting session:",s)}}}),P&&D&&U.jsx(sn,{tutor:D,isOpen:P,onClose:()=>{q(!1),L(null)}}),R&&D&&U.jsx(on,{tutor:D,isOpen:R,onClose:()=>{M(!1),L(null)}}),_&&W&&U.jsx(cn,{isOpen:_,onClose:()=>{z(!1),H(null)},sessionData:W,user:t})]})})},vn=async e=>{try{if(!e)return console.error("getFriendRequests: userId is required"),{success:!1,requests:[],error:"User ID is required"};const t=o(dt,"friendRequests"),s=l(t,c("toUserId","==",e)),r=await d(s),a=[];for(const e of r.docs){const t=e.data();if("pending"===t.status){const s=await m(u(dt,"users",t.fromUserId));if(s.exists()){const r=s.data();a.push({id:e.id,...t,fromUser:{id:t.fromUserId,name:r.name,email:r.email,school:r.school,grade:r.grade,avatar:r.avatar||null}})}}}return a.sort((e,t)=>{const s=Pa(e.createdAt).getTime();return Pa(t.createdAt).getTime()-s}),{success:!0,requests:a}}catch(t){return console.error("Error getting friend requests:",t),{success:!1,requests:[],error:"Failed to get friend requests"}}},jn=async e=>{try{if(!e)return console.error("getFriendsList: userId is required"),{success:!1,friends:[],error:"User ID is required"};const t=await m(u(dt,"users",e));if(!t.exists())return{success:!1,friends:[],error:"User not found"};const s=t.data().friends||[];if(0===s.length)return{success:!0,friends:[]};const r=[];for(const e of s){const t=await m(u(dt,"users",e));if(t.exists()){const s=t.data();r.push({id:e,name:s.name,email:s.email,school:s.school,grade:s.grade,bio:s.bio,subjects:s.subjects||[],avatar:s.avatar||null,lastSeen:s.lastSeen||null,isOnline:s.isOnline||!1})}}return{success:!0,friends:r}}catch(t){return console.error("Error getting friends list:",t),{success:!1,friends:[],error:"Failed to get friends list"}}},Nn=async e=>{try{const t=await m(u(dt,"users",e));if(!t.exists())return{success:!1,error:"Friend not found"};const s=t.data();return{success:!0,friend:{id:e,name:s.name,email:s.email,school:s.school,grade:s.grade,bio:s.bio,subjects:s.subjects||[],avatar:s.avatar||null,lastSeen:s.lastSeen||null,isOnline:s.isOnline||!1}}}catch(t){return console.error("Error getting friend by ID:",t),{success:!1,error:"Failed to get friend information"}}},kn=async(e,t,s,r="friend")=>{try{const a=o(dt,"messages"),n={senderId:e,receiverId:t,message:s.trim(),timestamp:p(),read:!1,chatType:r};return{success:!0,messageId:(await b(a,n)).id,message:"Message sent successfully"}}catch(a){return console.error("Error sending message:",a),{success:!1,error:"Failed to send message"}}},Sn=(e,t,s,r="friend")=>{const a=o(dt,"messages"),n=l(a,c("senderId","==",e),c("receiverId","==",t),c("chatType","==",r)),i=l(a,c("senderId","==",t),c("receiverId","==",e),c("chatType","==",r));let d,u,h=[];const m=()=>{h.sort((e,t)=>Pa(e.timestamp).getTime()-Pa(t.timestamp).getTime()),s({success:!0,messages:h})};return d=g(n,s=>{const r=[];s.forEach(e=>{const t=e.data();r.push({id:e.id,senderId:t.senderId,receiverId:t.receiverId,message:t.message,timestamp:t.timestamp,read:t.read})}),h=h.filter(s=>!(s.senderId===e&&s.receiverId===t)),h.push(...r),m()},e=>{console.error("Error listening to messages (direction 1):",e)}),u=g(i,s=>{const r=[];s.forEach(e=>{const t=e.data();r.push({id:e.id,senderId:t.senderId,receiverId:t.receiverId,message:t.message,timestamp:t.timestamp,read:t.read})}),h=h.filter(s=>!(s.senderId===t&&s.receiverId===e)),h.push(...r),m()},e=>{console.error("Error listening to messages (direction 2):",e)}),()=>{d&&d(),u&&u()}},Cn=e=>{if(!e)return"Unknown time";const t=new Date,s=Pa(e);return s.toDateString()===t.toDateString()?s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):s.toLocaleDateString([],{month:"short",day:"numeric"})},En=(e,t,s="friend")=>{const r=o(dt,"messages"),a=l(r,c("receiverId","==",e),c("chatType","==",s)),n=l(r,c("senderId","==",e),c("chatType","==",s));let i,u;const h=async()=>{const r=await(async(e,t="friend")=>{try{const s=o(dt,"messages"),r=l(s,c("receiverId","==",e),c("chatType","==",t)),a=l(s,c("senderId","==",e),c("chatType","==",t)),[n,i]=await Promise.all([d(r),d(a)]),u=new Set;n.forEach(e=>{const t=e.data();u.add(t.senderId)}),i.forEach(e=>{const t=e.data();u.add(t.receiverId)});const h=[];for(const e of u){const t=[];n.forEach(s=>{const r=s.data();r.senderId===e&&t.push({id:s.id,message:r.message,timestamp:r.timestamp,senderId:r.senderId,receiverId:r.receiverId})}),i.forEach(s=>{const r=s.data();r.receiverId===e&&t.push({id:s.id,message:r.message,timestamp:r.timestamp,senderId:r.senderId,receiverId:r.receiverId})}),t.sort((e,t)=>{const s=Pa(e.timestamp).getTime();return Pa(t.timestamp).getTime()-s});const s=t[0];h.push({userId:e,latestMessage:(null==s?void 0:s.message)||"",latestMessageTime:(null==s?void 0:s.timestamp)||null,unreadCount:0})}return h.sort((e,t)=>{const s=Pa(e.latestMessageTime).getTime();return Pa(t.latestMessageTime).getTime()-s}),{success:!0,chatList:h}}catch(s){return console.error("Error getting chat list:",s),{success:!1,chatList:[],error:"Failed to get chat list"}}})(e,s);r.success&&t(r)};return i=g(a,()=>{h()},e=>{console.error("Error listening to chat list (receiver):",e)}),u=g(n,()=>{h()},e=>{console.error("Error listening to chat list (sender):",e)}),h(),()=>{i&&i(),u&&u()}},An=(e,t)=>{if(!e)return console.warn("subscribeUnreadTutorMessagesCount: userId is required"),()=>{};try{const s=o(dt,"messages"),r=l(s,c("receiverId","==",e),c("read","==",!1),c("chatType","==","tutor"));return g(r,async e=>{let s=0;const r=e.docs.map(async e=>{const t=e.data();try{const e=await m(u(dt,"users",t.senderId));if(e.exists()){!0===e.data().isTutor&&s++}}catch(r){console.error("Error verifying sender:",r)}});await Promise.all(r),t(s)},e=>{console.error("Error listening to unread tutor messages count:",e),t(0)})}catch(s){return console.error("Error setting up unread tutor messages count listener:",s),()=>{}}},Tn=(e,t)=>{if(!e)return console.warn("subscribeUnreadStudentMessagesCount: tutorId is required"),()=>{};try{const s=o(dt,"messages"),r=l(s,c("receiverId","==",e),c("read","==",!1),c("chatType","==","tutor"));return g(r,async e=>{let s=0;const r=e.docs.map(async e=>{const t=e.data();try{const e=await m(u(dt,"users",t.senderId));if(e.exists()){!0!==e.data().isTutor&&s++}}catch(r){console.error("Error verifying sender:",r)}});await Promise.all(r),t(s)},e=>{console.error("Error listening to unread student messages count:",e),t(0)})}catch(s){return console.error("Error setting up unread student messages count listener:",s),()=>{}}},In=async(e,t)=>{try{const s=o(dt,"messages"),r=l(s,c("receiverId","==",e),c("senderId","==",t),c("read","==",!1),c("chatType","==","friend"));return{success:!0,count:(await d(r)).size}}catch(s){return console.error("Error getting unread messages from friend:",s),{success:!1,count:0,error:"Failed to get unread messages from friend"}}},Pn=()=>{const{user:t}=Br(),{theme:s,isDark:r}=mt(),a=qe(),[n,i]=e.useState("friends"),[h,m]=e.useState([]),[f,w]=e.useState([]),[y,v]=e.useState(!0),[k,S]=e.useState(!1),[C,E]=e.useState(""),[A,T]=e.useState(!1),[I,P]=e.useState(""),[q,R]=e.useState(!1),[M,D]=e.useState(null),[L,F]=e.useState(!1),[$,O]=e.useState(0),[B,_]=e.useState({}),z=[{id:"friends",label:"Friends",count:h.length},{id:"requests",label:"Requests",count:f.length},{id:"add",label:"Add Friend",count:0}];e.useEffect(()=>{(null==t?void 0:t.id)&&W()},[null==t?void 0:t.id]),e.useEffect(()=>{(async()=>{if(null==t?void 0:t.id)try{const e=await(async e=>{try{const t=o(dt,"messages"),s=l(t,c("receiverId","==",e),c("read","==",!1),c("chatType","==","friend"));return{success:!0,count:(await d(s)).size}}catch(t){return console.error("Error getting unread friend messages count:",t),{success:!1,count:0,error:"Failed to get unread friend messages count"}}})(t.id);if(e.success&&(O(e.count),e.count>0&&h.length>0)){const e={};for(const s of h){const r=await In(t.id,s.id);r.success&&r.count>0&&(e[s.id]=r.count)}_(e)}}catch(e){console.error("Error checking unread messages:",e)}})()},[null==t?void 0:t.id,h.length]),e.useEffect(()=>{},[null==t?void 0:t.id]),e.useEffect(()=>{if(!h.length)return;console.log(" Setting up presence listeners for friends:",h.length);const e=[];return h.forEach(t=>{const s=u(dt,"users",t.id),r=g(s,e=>{if(e.exists()){const s=e.data(),r=Ur(s);m(e=>e.map(e=>e.id===t.id?{...e,lastSeen:s.lastSeen||null,isOnline:s.isOnline||!1,_computedOnline:r}:e))}});e.push(r)}),()=>{console.log(" Cleaning up presence listeners"),e.forEach(e=>e())}},[h.length]),e.useEffect(()=>{if(!h.length)return;const e=setInterval(()=>{m(e=>e.map(e=>{const t=Ur(e);return{...e,_computedOnline:t}}))},3e3);return()=>{clearInterval(e)}},[h.length]);const W=async()=>{if(null==t?void 0:t.id){v(!0);try{const[e,s]=await Promise.all([jn(t.id),vn(t.id)]);e.success&&m(e.friends),s.success&&w(s.requests)}catch(e){console.error("Error loading data:",e)}finally{v(!1)}}else console.log("User not loaded yet, skipping data load")},H=async(e,s)=>{if(null==t?void 0:t.id){S(!0);try{const r=await(async(e,t,s)=>{try{const r=u(dt,"friendRequests",e);await x(r,{status:"accepted",updatedAt:p()});const a=u(dt,"users",t),n=u(dt,"users",s);return await x(a,{friends:j(s),updatedAt:p()}),await x(n,{friends:j(t),updatedAt:p()}),{success:!0,message:"Friend request accepted"}}catch(r){return console.error("Error accepting friend request:",r),{success:!1,error:"Failed to accept friend request"}}})(e,t.id,s);r.success&&await W()}catch(r){console.error("Error accepting friend request:",r)}finally{S(!1)}}else console.error("User not logged in")},G=async e=>{S(!0);try{const t=await(async e=>{try{const t=u(dt,"friendRequests",e);return await x(t,{status:"declined",updatedAt:p()}),{success:!0,message:"Friend request declined"}}catch(t){return console.error("Error declining friend request:",t),{success:!1,error:"Failed to decline friend request"}}})(e);t.success&&await W()}catch(t){console.error("Error declining friend request:",t)}finally{S(!1)}},V=()=>{F(!0),setTimeout(()=>{R(!1),D(null),F(!1)},500)};return y?U.jsx("div",{className:"min-h-screen flex items-center justify-center "+(r?"bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900":"bg-gradient-to-br from-blue-50 via-white to-purple-50"),children:U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-4 animate-pulse",children:U.jsx(kr,{className:"w-8 h-8 text-white"})}),U.jsx("p",{className:"text-lg "+(r?"text-gray-300":"text-gray-600"),children:"Loading friends..."})]})}):U.jsxs(U.Fragment,{children:[U.jsx("style",{children:"\n        @keyframes fadeIn {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n        @keyframes fadeOut {\n          from { opacity: 1; }\n          to { opacity: 0; }\n        }\n        @keyframes modalEnter {\n          from {\n            opacity: 0;\n            transform: scale(0.7) translateY(30px);\n          }\n          to {\n            opacity: 1;\n            transform: scale(1) translateY(0);\n          }\n        }\n        @keyframes modalExit {\n          from {\n            opacity: 1;\n            transform: scale(1) translateY(0);\n          }\n          to {\n            opacity: 0;\n            transform: scale(0.8) translateY(-20px);\n          }\n        }\n        @keyframes slideInDown {\n          from {\n            opacity: 0;\n            transform: translateY(-30px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        @keyframes slideOutUp {\n          from {\n            opacity: 1;\n            transform: translateY(0);\n          }\n          to {\n            opacity: 0;\n            transform: translateY(-20px);\n          }\n        }\n        .hide-scrollbar::-webkit-scrollbar { width: 0; height: 0; }\n        .hide-scrollbar { scrollbar-width: none; }\n      "}),U.jsxs("div",{className:"min-h-screen relative overflow-hidden "+(r?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:[U.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[U.jsx("div",{className:"absolute -top-28 left-1/2 h-96 w-96 -translate-x-1/2 rounded-full bg-purple-500/25 blur-3xl"}),U.jsx("div",{className:"absolute top-1/3 right-6 h-72 w-72 rounded-full bg-pink-400/20 blur-[120px]"}),U.jsx("div",{className:"absolute bottom-10 left-10 h-64 w-64 rounded-full bg-indigo-400/20 blur-[140px]"})]}),U.jsxs("div",{className:"relative z-10 mx-auto flex w-full max-w-6xl flex-col gap-10 px-6 py-14 hide-scrollbar",children:[U.jsx("section",{className:"rounded-[32px] border px-8 py-9 shadow-2xl backdrop-blur-xl "+(r?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:U.jsxs("div",{className:"flex flex-col gap-6 md:flex-row md:items-center md:justify-between",children:[U.jsxs("div",{children:[U.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-purple-500/10 px-3.5 py-2 text-xs font-semibold text-purple-400",children:[U.jsx(kr,{className:"h-4 w-4"})," Build your learning squad"]}),U.jsx("h1",{className:"mt-4 text-3xl font-black tracking-tight md:text-4xl",children:"Stay connected with classmates and mentors"}),U.jsx("p",{className:"mt-3 max-w-xl text-sm md:text-base "+(r?"text-white/70":"text-slate-600"),children:"Send requests, accept invitations, and jump into conversations  all inside a single, calming hub."})]}),U.jsxs("div",{className:"grid w-full max-w-xs grid-cols-2 gap-3 text-center text-sm md:max-w-sm",children:[U.jsxs("div",{className:"rounded-2xl border px-4 py-4 "+(r?"border-white/12 bg-white/8":"border-slate-200 bg-white"),children:[U.jsx("p",{className:"text-[12px] uppercase tracking-wide text-purple-400",children:"Friends"}),U.jsx("p",{className:"mt-1 text-xl font-semibold "+(r?"text-white":"text-slate-900"),children:h.length})]}),U.jsxs("div",{className:"rounded-2xl border px-4 py-4 "+(r?"border-white/12 bg-white/8":"border-slate-200 bg-white"),children:[U.jsx("p",{className:"text-[12px] uppercase tracking-wide text-purple-400",children:"Requests"}),U.jsx("p",{className:"mt-1 text-xl font-semibold "+(r?"text-white":"text-slate-900"),children:f.length})]})]})]})}),U.jsx("nav",{className:"rounded-[28px] border p-2 backdrop-blur-xl shadow-xl "+(r?"border-white/12 bg-white/6":"border-white/70 bg-white"),children:U.jsx("div",{className:"grid gap-2 sm:grid-cols-3",children:z.map(e=>U.jsxs("button",{onClick:()=>i(e.id),className:"flex items-center justify-between rounded-2xl px-6 py-4 text-sm font-semibold transition "+(n===e.id?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg shadow-purple-500/30":r?"text-white/70 hover:text-white hover:bg-white/10":"text-slate-600 hover:text-slate-900 hover:bg-slate-50"),children:[U.jsx("span",{children:e.label}),e.count>0&&U.jsx("span",{className:"ml-3 rounded-full px-2 py-1 text-[11px] font-bold "+(n===e.id?"bg-white/20 text-white":r?"bg-white/10 text-white/80":"bg-slate-200 text-slate-700"),children:e.count})]},e.id))})}),"friends"===n&&U.jsxs("section",{className:"rounded-[32px] border px-8 py-8 shadow-2xl backdrop-blur-xl "+(r?"border-white/12 bg-white/6":"border-white/70 bg-white"),children:[$>0&&U.jsx("div",{className:"mb-6 rounded-2xl border px-6 py-4 shadow-lg backdrop-blur-xl "+(r?"border-purple-500/30 bg-gradient-to-r from-purple-500/20 to-pink-500/20":"border-purple-200 bg-gradient-to-r from-purple-50 to-pink-50"),children:U.jsx("div",{className:"flex items-center justify-between",children:U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx(Ms,{className:"h-5 w-5 "+(r?"text-purple-300":"text-purple-600")}),U.jsxs("div",{children:[U.jsxs("p",{className:"font-semibold "+(r?"text-white":"text-slate-900"),children:["You have ",$," unread message",$>1?"s":""," from your friends"]}),U.jsx("p",{className:"text-sm mt-0.5 "+(r?"text-white/70":"text-slate-600"),children:'Click on a friend\'s "Chat" button below to view messages'})]})]})})}),h.length>0?U.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-3",children:h.map(e=>U.jsxs("div",{className:"group relative overflow-hidden rounded-3xl border px-6 py-6 shadow-lg transition hover:shadow-2xl "+(r?"border-white/12 bg-gradient-to-br from-white/10 via-white/5 to-transparent/35":"border-slate-200 bg-white"),children:[U.jsx("div",{className:"absolute -top-16 right-0 h-32 w-32 rounded-full bg-purple-500/10 blur-2xl transition group-hover:bg-purple-500/20"}),U.jsx("div",{className:"absolute -bottom-14 left-0 h-28 w-28 rounded-full bg-pink-400/10 blur-2xl transition group-hover:bg-pink-400/20"}),U.jsxs("div",{className:"relative z-10 flex flex-col gap-5",children:[U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx(Za,{user:e,size:"xl",showOnlineStatus:!0,className:"shadow-lg ring-2 ring-purple-400/30"}),U.jsxs("div",{children:[U.jsx("h3",{className:"text-xl font-bold "+(r?"text-white drop-shadow-[0_0_10px_rgba(255,255,255,0.3)]":"text-slate-900"),children:e.name}),U.jsx("p",{className:""+(r?"text-white/60":"text-slate-500"),children:e.school||"Student"})]})]}),U.jsx("button",{className:"rounded-xl p-2 transition "+(r?"text-white/50 hover:bg-white/10 hover:text-white":"text-slate-400 hover:bg-slate-100"),children:U.jsx($s,{className:"h-5 w-5"})})]}),U.jsxs("div",{className:"space-y-3",children:[U.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[U.jsx("div",{className:"flex h-7 w-7 items-center justify-center rounded-xl bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-sm",children:U.jsx(Nr,{className:"h-3.5 w-3.5"})}),U.jsxs("span",{className:""+(r?"text-white/70":"text-slate-600"),children:["Grade: ",e.grade||"Not specified"]})]}),e.subjects&&e.subjects.length>0&&U.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.subjects.slice(0,3).map((e,t)=>U.jsx("span",{className:"rounded-full border px-3 py-1 text-xs font-medium "+(r?"border-white/20 bg-white/10 text-white/80":"border-slate-200 bg-slate-50 text-slate-700"),children:e},t)),e.subjects.length>3&&U.jsxs("span",{className:"rounded-full border px-3 py-1 text-xs font-medium "+(r?"border-white/20 bg-white/5 text-white/70":"border-slate-200 bg-slate-100 text-slate-600"),children:["+",e.subjects.length-3," more"]})]})]}),U.jsxs("div",{className:"flex gap-3",children:[U.jsx("button",{onClick:()=>a(`/chat-friend/${e.id}`,{state:{from:"friends"}}),className:"flex-1 rounded-2xl bg-gradient-to-r from-purple-500 to-pink-500 py-3 text-sm font-semibold text-white shadow-lg shadow-purple-500/30 transition hover:-translate-y-0.5 hover:shadow-xl relative",children:U.jsxs("div",{className:"flex items-center justify-center gap-2",children:[U.jsx(Ms,{className:"h-4 w-4"}),"Chat",B[e.id]>0&&U.jsx("span",{className:"absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-[10px] font-bold text-white shadow-lg",children:B[e.id]>99?"99+":B[e.id]})]})}),U.jsx("button",{onClick:()=>(e=>{D(e),R(!0),F(!1)})(e),className:"rounded-2xl border px-4 py-3 transition "+(r?"border-red-400/40 text-red-300 hover:border-red-400/70 hover:bg-red-500/10":"border-red-200 text-red-600 hover:border-red-300 hover:bg-red-50"),children:U.jsx(pr,{className:"h-5 w-5"})})]})]})]},e.id))}):U.jsxs("div",{className:"flex flex-col items-center rounded-[28px] border px-10 py-16 text-center "+(r?"border-white/12 bg-white/6":"border-slate-200 bg-white"),children:[U.jsx("div",{className:"flex h-20 w-20 items-center justify-center rounded-3xl bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg",children:U.jsx(kr,{className:"h-10 w-10"})}),U.jsx("h3",{className:"mt-6 text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:"No friends yet"}),U.jsx("p",{className:"mt-3 max-w-sm text-sm "+(r?"text-white/60":"text-slate-500"),children:"Start connecting with other students by sending friendly invitations."}),U.jsx("button",{onClick:()=>i("add"),className:"mt-6 rounded-2xl bg-gradient-to-r from-purple-500 to-pink-500 px-6 py-3 text-sm font-semibold text-white shadow-lg shadow-purple-500/30 transition hover:-translate-y-0.5 hover:shadow-xl",children:U.jsxs("div",{className:"flex items-center justify-center gap-2",children:[U.jsx(vr,{className:"h-4 w-4"}),"Add friends"]})})]})]}),"requests"===n&&U.jsx("section",{className:"rounded-[32px] border px-8 py-8 shadow-2xl backdrop-blur-xl "+(r?"border-white/12 bg-white/6":"border-white/70 bg-white"),children:f.length>0?U.jsx("div",{className:"space-y-6",children:f.map(e=>U.jsxs("div",{className:"group relative overflow-hidden rounded-3xl border px-6 py-6 shadow-lg transition hover:shadow-2xl "+(r?"border-white/12 bg-gradient-to-br from-white/10 via-white/5 to-transparent/35":"border-slate-200 bg-white"),children:[U.jsx("div",{className:"absolute -top-16 right-0 h-28 w-28 rounded-full bg-green-400/10 blur-2xl transition group-hover:bg-green-400/20"}),U.jsx("div",{className:"absolute -bottom-16 left-0 h-28 w-28 rounded-full bg-blue-500/10 blur-2xl transition group-hover:bg-blue-500/20"}),U.jsxs("div",{className:"relative z-10 flex flex-col gap-5 md:flex-row md:items-center md:justify-between",children:[U.jsxs("div",{className:"flex items-center gap-5",children:[U.jsx(Za,{user:e.fromUser,size:"xl",className:"shadow-lg ring-2 ring-green-400/30"}),U.jsxs("div",{children:[U.jsx("h3",{className:"text-xl font-bold "+(r?"text-white":"text-slate-900"),children:e.fromUser.name}),U.jsx("p",{className:""+(r?"text-white/70":"text-slate-600"),children:e.fromUser.email}),U.jsxs("p",{className:"text-sm "+(r?"text-white/50":"text-slate-500"),children:[e.fromUser.school,"  ",e.fromUser.grade]})]})]}),U.jsxs("div",{className:"flex flex-col gap-3 md:flex-row",children:[U.jsx("button",{onClick:()=>H(e.id,e.fromUserId),disabled:k,className:"rounded-2xl bg-gradient-to-r from-green-500 to-emerald-500 px-6 py-3 text-sm font-semibold text-white shadow-lg shadow-emerald-500/30 transition hover:-translate-y-0.5 hover:shadow-xl disabled:cursor-not-allowed disabled:opacity-60",children:U.jsxs("div",{className:"flex items-center justify-center gap-2",children:[U.jsx(Ot,{className:"h-4 w-4"}),"Accept"]})}),U.jsx("button",{onClick:()=>G(e.id),disabled:k,className:"rounded-2xl border px-6 py-3 text-sm font-semibold transition hover:-translate-y-0.5 disabled:cursor-not-allowed disabled:opacity-60 "+(r?"border-white/15 text-white/80 hover:bg-white/10 hover:text-white":"border-slate-200 text-slate-600 hover:bg-slate-100"),children:U.jsxs("div",{className:"flex items-center justify-center gap-2",children:[U.jsx(Rr,{className:"h-4 w-4"}),"Decline"]})})]})]})]},e.id))}):U.jsxs("div",{className:"flex flex-col items-center rounded-[28px] border px-10 py-16 text-center "+(r?"border-white/12 bg-white/6":"border-slate-200 bg-white"),children:[U.jsx("div",{className:"flex h-20 w-20 items-center justify-center rounded-3xl bg-gradient-to-r from-green-500 to-teal-500 text-white shadow-lg",children:U.jsx(vr,{className:"h-10 w-10"})}),U.jsx("h3",{className:"mt-6 text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:"No pending requests"}),U.jsx("p",{className:"mt-3 max-w-sm text-sm "+(r?"text-white/60":"text-slate-500"),children:"When someone sends you a friend request it will appear right here."})]})}),"add"===n&&U.jsx("section",{className:"mx-auto w-full max-w-2xl",children:U.jsxs("div",{className:"overflow-hidden rounded-[32px] border shadow-2xl backdrop-blur-xl "+(r?"border-white/12 bg-white/6":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 px-8 py-10 text-white",children:[U.jsxs("div",{className:"absolute inset-0 opacity-20",children:[U.jsx("div",{className:"absolute -top-20 left-10 h-32 w-32 rounded-full bg-white blur-3xl"}),U.jsx("div",{className:"absolute bottom-0 right-0 h-28 w-28 rounded-full bg-white/70 blur-2xl"})]}),U.jsxs("div",{className:"relative z-10 text-center",children:[U.jsx("div",{className:"mx-auto flex h-20 w-20 items-center justify-center rounded-3xl bg-white/15 backdrop-blur-sm",children:U.jsx(vr,{className:"h-10 w-10"})}),U.jsx("h3",{className:"mt-4 text-2xl font-bold",children:"Add a friend"}),U.jsx("p",{className:"mt-2 text-sm text-white/80",children:"Send an invitation using their Studiply email address."})]})]}),U.jsxs("div",{className:"space-y-6 px-8 py-8",children:[U.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),null==t?void 0:t.id){T(!0),P("");try{const e=await(async(e,t)=>{try{if(!e)return console.error("sendFriendRequest: fromUserId is required"),{success:!1,error:"User ID is required"};if(!t)return console.error("sendFriendRequest: toUserEmail is required"),{success:!1,error:"Email is required"};const s=o(dt,"users"),r=l(s,c("email","==",t.toLowerCase().trim())),a=await d(r);if(a.empty)return{success:!1,error:"User not found with this email address"};const n=a.docs[0],i=n.id,u=n.data();if(i===e)return{success:!1,error:"You cannot send a friend request to yourself"};if(u.friends&&u.friends.includes(e))return{success:!1,error:"You are already friends with this user"};const h=o(dt,"friendRequests"),m=l(h,c("fromUserId","==",e),c("toUserId","==",i));if((await d(m)).docs.some(e=>"pending"===e.data().status))return{success:!1,error:"Friend request already sent"};const x={fromUserId:e,toUserId:i,toUserEmail:t.toLowerCase().trim(),status:"pending",createdAt:p(),updatedAt:p()};return{success:!0,requestId:(await b(h,x)).id,message:`Friend request sent to ${u.name}`}}catch(s){return console.error("Error sending friend request:",s),{success:!1,error:"Failed to send friend request"}}})(t.id,C);e.success?(P(e.message),E("")):P(e.error||"Failed to send friend request")}catch(s){console.error("Error sending friend request:",s),P("An error occurred while sending the friend request")}finally{T(!1)}}else P("Please log in to add friends")},className:"space-y-6",children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold "+(r?"text-white/80":"text-slate-600"),children:"Friend's email address"}),U.jsxs("div",{className:"relative mt-2",children:[U.jsx(Is,{className:"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-purple-400"}),U.jsx("input",{type:"email",value:C,onChange:e=>E(e.target.value),placeholder:"Enter email",className:"w-full rounded-2xl border px-12 py-4 text-base transition focus:ring-2 focus:ring-purple-500 focus:outline-none "+(r?"border-white/15 bg-white/5 text-white placeholder-white/40":"border-slate-200 bg-white text-slate-900 placeholder-slate-400"),required:!0})]})]}),I&&U.jsx("div",{className:"rounded-2xl border px-4 py-4 text-sm font-medium "+(r?"border-purple-400/40 bg-purple-500/10 text-purple-200":"border-purple-200 bg-purple-50 text-purple-700"),children:I}),U.jsx("button",{type:"submit",disabled:A||!C.trim(),className:"w-full rounded-2xl bg-gradient-to-r from-purple-500 to-pink-500 py-4 text-sm font-semibold text-white shadow-lg shadow-purple-500/30 transition hover:-translate-y-0.5 hover:shadow-xl disabled:cursor-not-allowed disabled:opacity-60 disabled:hover:translate-y-0",children:A?U.jsxs("div",{className:"flex items-center justify-center gap-3",children:[U.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-white/40 border-t-white"}),"Sending..."]}):U.jsxs("div",{className:"flex items-center justify-center gap-2",children:[U.jsx(vr,{className:"h-4 w-4"}),"Send friend request"]})})]}),U.jsxs("div",{className:"rounded-2xl border px-6 py-6 text-sm "+(r?"border-white/12 bg-white/5 text-white/70":"border-slate-200 bg-slate-50 text-slate-600"),children:[U.jsxs("h4",{className:"flex items-center gap-2 text-sm font-semibold text-purple-400",children:[U.jsx(kr,{className:"h-4 w-4"})," How it works"]}),U.jsxs("ul",{className:"mt-3 space-y-2",children:[U.jsx("li",{children:"Ask your friend for the email they used to register."}),U.jsx("li",{children:"Send the invite and wait for them to accept."}),U.jsx("li",{children:"Once connected you can start chatting right away."})]})]})]})]})})]})]}),q&&M&&U.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 transition-all duration-500 "+(L?"opacity-0":"opacity-100"),onClick:V,style:{animation:L?"fadeOut 0.5s ease-in-out":"fadeIn 0.5s ease-in-out"},children:U.jsxs("div",{className:`w-full max-w-md overflow-hidden rounded-[28px] border shadow-2xl transition-all duration-500 ${r?"border-white/12 bg-gradient-to-br from-white/15 via-white/8 to-transparent/35 text-white":"border-white/70 bg-white text-slate-900"} ${L?"scale-95 opacity-0 translate-y-6":"scale-100 opacity-100 translate-y-0"}`,onClick:e=>e.stopPropagation(),style:{animation:L?"modalExit 0.45s ease-in-out":"modalEnter 0.45s ease-in-out"},children:[U.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-r from-red-500 via-orange-500 to-amber-500 px-6 py-6 text-white",children:[U.jsx("div",{className:"absolute inset-0 opacity-20",children:U.jsx("div",{className:"absolute -top-16 left-14 h-28 w-28 rounded-full bg-white blur-3xl"})}),U.jsxs("div",{className:"relative z-10 flex items-center gap-3",children:[U.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-white/20",children:U.jsx(pr,{className:"h-6 w-6"})}),U.jsxs("div",{children:[U.jsx("h3",{className:"text-lg font-semibold",children:"Remove friend"}),U.jsx("p",{className:"text-sm text-white/80",children:"This action cannot be undone."})]})]})]}),U.jsxs("div",{className:"space-y-6 px-6 py-6",children:[U.jsxs("div",{className:"rounded-2xl border px-4 py-4 "+(r?"border-white/12 bg-white/5 text-white/80":"border-red-100 bg-red-50 text-red-600"),children:[U.jsxs("p",{className:"text-sm",children:["Are you sure you want to remove ",U.jsx("span",{className:"font-semibold",children:M.name})," from your friends list?"]}),U.jsx("p",{className:"mt-2 text-xs opacity-70",children:"You will lose chat history and both accounts will no longer be connected."})]}),U.jsxs("div",{className:"flex gap-3",children:[U.jsx("button",{onClick:V,className:"flex-1 rounded-2xl border px-4 py-3 text-sm font-semibold transition "+(r?"border-white/15 text-white/80 hover:bg-white/10 hover:text-white":"border-slate-200 text-slate-600 hover:bg-slate-100"),children:"Cancel"}),U.jsx("button",{onClick:async()=>{if(M&&(null==t?void 0:t.id))try{(await(async(e,t)=>{try{const s=u(dt,"users",e),r=u(dt,"users",t);return await x(s,{friends:N(t),updatedAt:p()}),await x(r,{friends:N(e),updatedAt:p()}),{success:!0,message:"Friend removed successfully"}}catch(s){return console.error("Error removing friend:",s),{success:!1,error:"Failed to remove friend"}}})(t.id,M.id)).success&&(await W(),V())}catch(e){console.error("Error removing friend:",e)}},className:"flex-1 rounded-2xl bg-gradient-to-r from-red-500 to-orange-500 px-4 py-3 text-sm font-semibold text-white shadow-lg shadow-red-500/30 transition hover:-translate-y-0.5 hover:shadow-xl",children:"Remove friend"})]})]})]})})]})},qn=async(e,t)=>{try{const s=u(dt,"users",e),r={};return void 0!==t.name&&(r.name=t.name),void 0!==t.phone&&(r.phone=t.phone),void 0!==t.school&&(r.school=t.school),void 0!==t.grade&&(r.grade=t.grade),void 0!==t.bio&&(r.bio=t.bio),void 0!==t.subjects&&(r.subjects=t.subjects),void 0!==t.location&&(r.location=t.location),void 0!==t.avatar&&(r.avatar=t.avatar),r.updatedAt=new Date,await x(s,r),console.log("User profile updated successfully"),{success:!0,message:"Profile updated successfully"}}catch(s){return console.error("Error updating user profile:",s),{success:!1,error:s.message}}},Rn=({chatType:t="friend"})=>{var s;const{friendId:r,tutorId:a}=Re(),n=qe(),i=Ie(),{user:o}=Br(),{isDark:l}=mt(),[c,d]=e.useState(null),[h,x]=e.useState([]),[p,b]=e.useState(""),f=null==(s=i.state)?void 0:s.from,w="tutor"===t?a:r,y={tutoring:{path:"/tutoring",label:"Back to tutoring"},friends:{path:"/friends",label:"Back to friends"},"student-dashboard":{path:"/student-dashboard",label:"Back to dashboard"},"tutor-dashboard":{path:"/tutor-dashboard",label:"Back to dashboard"}}[f]||("tutor"===t?{path:"/student-dashboard",label:"Back to dashboard"}:{path:"/friends",label:"Back to friends"}),[v,j]=e.useState(!0),[N,k]=e.useState(!1),S=e.useRef(null),C=e.useRef(null);e.useEffect(()=>(w&&(null==o?void 0:o.id)&&E(),()=>{C.current&&C.current()}),[w,o]),e.useEffect(()=>{if(!w)return;const e=u(dt,"users",w),t=g(e,e=>{if(e.exists()){const t=e.data();d(e=>({...e,lastSeen:t.lastSeen||null,isOnline:t.isOnline||!1}))}});return()=>{t()}},[w]);e.useEffect(()=>{var e;null==(e=S.current)||e.scrollIntoView({behavior:"smooth"})},[h]);const E=async()=>{try{if(j(!0),"friend"===t){const e=await Nn(w);if(e.success)return d(e.friend),C.current=Sn(null==o?void 0:o.id,w,e=>{e.success&&x(e.messages)}),void j(!1)}try{const e=await m(u(dt,"users",w));if(e.exists()){const t=e.data();d({id:w,name:t.name||"User",email:t.email||"",avatar:t.avatar||null,lastSeen:t.lastSeen||null,isOnline:t.isOnline||!1})}else d({id:w,name:"Unknown User",email:"unknown@example.com"})}catch(e){console.error("Error getting user from users collection:",e),d({id:w,name:"Unknown User",email:"unknown@example.com"})}C.current=Sn(null==o?void 0:o.id,w,e=>{e.success&&x(e.messages)})}catch(e){console.error("Error loading chat data:",e)}finally{j(!1)}},A=async()=>{if(p.trim()&&!N)try{k(!0);const e=await kn(null==o?void 0:o.id,w,p.trim());e.success?b(""):console.error("Failed to send message:",e.error)}catch(e){console.error("Error sending message:",e)}finally{k(!1)}};return v?U.jsx("div",{className:"min-h-screen flex items-center justify-center "+(l?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-3xl bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-2xl shadow-purple-500/30",children:U.jsx(Ms,{className:"h-9 w-9 animate-pulse"})}),U.jsx("h3",{className:"text-lg font-semibold",children:"Loading chat"}),U.jsx("p",{className:"mt-2 text-sm "+(l?"text-white/60":"text-slate-500"),children:"Preparing your conversation..."})]})}):U.jsxs("div",{className:"min-h-screen relative overflow-x-hidden "+(l?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:[U.jsx("style",{children:"\n        .hide-scrollbar::-webkit-scrollbar { width: 0; height: 0; }\n        .hide-scrollbar { scrollbar-width: none; }\n      "}),U.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[U.jsx("div",{className:"absolute -top-32 left-1/2 h-96 w-96 -translate-x-1/2 rounded-full bg-purple-500/25 blur-3xl"}),U.jsx("div",{className:"absolute top-0 right-4 h-72 w-72 rounded-full bg-pink-400/20 blur-[120px]"}),U.jsx("div",{className:"absolute bottom-8 left-10 h-64 w-64 rounded-full bg-indigo-400/20 blur-[140px]"})]}),U.jsx("div",{className:"relative z-10 mx-auto flex w-full max-w-[1320px] flex-col px-8 pb-16 pt-24",children:U.jsxs("div",{className:"w-full overflow-hidden rounded-[32px] border shadow-2xl backdrop-blur-xl flex flex-col "+(l?"border-white/12 bg-gradient-to-br from-white/10 via-white/4 to-transparent/35":"border-white/70 bg-white"),style:{height:"calc(100vh - 160px)"},children:[U.jsxs("div",{className:"flex items-center justify-between border-b px-6 py-6 "+(l?"border-white/10 bg-white/5":"border-slate-200 bg-slate-50"),children:[U.jsxs("div",{className:"flex items-center gap-5",children:[U.jsxs("button",{onClick:()=>n(y.path),className:"flex items-center gap-2 rounded-2xl px-4 py-2 text-sm font-semibold transition "+(l?"bg-white/10 text-white/80 hover:bg-white/15 hover:text-white":"bg-white text-slate-600 hover:text-slate-900 shadow-sm"),children:[U.jsx(wt,{className:"h-4 w-4"}),y.label]}),U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx("div",{className:"relative",children:U.jsx(Za,{user:c,size:"lg",showOnlineStatus:!0,className:"shadow-lg ring-2 ring-purple-400/40"})}),U.jsxs("div",{children:[U.jsx("h2",{className:"text-xl font-semibold "+(l?"text-white":"text-slate-900"),children:(null==c?void 0:c.name)||"Friend"}),U.jsx("p",{className:"text-sm font-medium "+(Ur(c)?l?"text-green-300":"text-green-600":l?"text-gray-400":"text-gray-500"),children:Ur(c)?"Online now":"Offline now"})]})]})]}),U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx("button",{className:"rounded-2xl p-3 transition "+(l?"bg-white/5 text-white/70 hover:bg-white/10 hover:text-white":"bg-white text-slate-500 hover:text-slate-800 shadow-sm"),children:U.jsx(Gs,{className:"h-5 w-5"})}),U.jsx("button",{className:"rounded-2xl p-3 transition "+(l?"bg-white/5 text-white/70 hover:bg-white/10 hover:text-white":"bg-white text-slate-500 hover:text-slate-800 shadow-sm"),children:U.jsx(Cr,{className:"h-5 w-5"})}),U.jsx("button",{className:"rounded-2xl p-3 transition "+(l?"bg-white/5 text-white/70 hover:bg-white/10 hover:text-white":"bg-white text-slate-500 hover:text-slate-800 shadow-sm"),children:U.jsx($s,{className:"h-5 w-5"})})]})]}),U.jsx("div",{className:`flex-1 px-6 py-6 ${l?"bg-white/5 text-white":"bg-white text-slate-900"} flex flex-col`,style:{minHeight:"0"},children:U.jsx("div",{className:"flex-1 overflow-y-auto pr-2 hide-scrollbar",children:U.jsxs("div",{className:"space-y-4",children:[h.length>0?h.map((e,t)=>{const s=e.senderId===(null==o?void 0:o.id),r=!s&&(0===t||h[t-1].senderId!==e.senderId);return U.jsxs("div",{className:"flex items-start gap-3 "+(s?"justify-end":"justify-start"),children:[!s&&U.jsxs("div",{className:"flex flex-col items-center gap-1 text-xs text-white/60",children:[U.jsx(Za,{user:c,size:"sm",className:"h-9 w-9"}),r&&U.jsx("span",{className:""+(l?"text-white/70":"text-slate-500"),children:(null==c?void 0:c.name)||"Friend"})]}),U.jsxs("div",{className:"flex max-w-xs flex-col gap-1 sm:max-w-md",children:[U.jsx("div",{className:`rounded-2xl px-5 py-3 text-sm leading-relaxed ${s?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg shadow-purple-500/30":l?"bg-white/10 text-white":"bg-slate-100 text-slate-800"} ${s?"rounded-br-md":"rounded-bl-md"}`,children:e.message}),U.jsx("p",{className:"px-2 text-[11px] "+(s?"text-right text-white/60":l?"text-white/50":"text-slate-500"),children:Cn(e.timestamp)})]}),s&&U.jsx(Za,{user:o,size:"sm",className:"h-9 w-9"})]},e.id)}):U.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[U.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-2xl bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg",children:U.jsx(Nr,{className:"h-8 w-8"})}),U.jsx("h3",{className:"mt-4 text-lg font-semibold",children:"No messages yet"}),U.jsxs("p",{className:"mt-2 text-sm "+(l?"text-white/60":"text-slate-500"),children:["Start the conversation with ",(null==c?void 0:c.name)||"your friend","."]})]}),U.jsx("div",{ref:S})]})})}),U.jsx("div",{className:"border-t px-6 py-5 "+(l?"border-white/10 bg-white/5":"border-slate-200 bg-white"),children:U.jsx("form",{onSubmit:async e=>{e.preventDefault(),await A()},className:"flex items-stretch",children:U.jsx("div",{className:"flex-1",children:U.jsx("textarea",{value:p,onChange:e=>b(e.target.value),onKeyDown:async e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),await A())},placeholder:`Message ${(null==c?void 0:c.name)||"your friend"}...`,className:"w-full resize-none rounded-2xl border px-5 py-4 text-sm transition focus:ring-2 focus:ring-purple-500 focus:outline-none hide-scrollbar "+(l?"border-white/15 bg-white/5 text-white placeholder-white/40":"border-slate-200 bg-white text-slate-900 placeholder-slate-400"),rows:1,disabled:N,style:{minHeight:"52px"}})})})})]})})]})},Mn=()=>{var t,s;const{isDark:r}=mt(),a=qe(),[n,i]=e.useState(!1),[o,l]=e.useState(1500),[c,d]=e.useState(null),[u,h]=e.useState("pomodoro"),[m,x]=e.useState(!1),[p,g]=e.useState(!1),[b,f]=e.useState(!1),[w,y]=e.useState([]),[v,j]=e.useState([{name:"Block All Websites",icon:"",blocked:!1,isSpecial:!0},{name:"Facebook",icon:"",blocked:!0},{name:"Instagram",icon:"",blocked:!0},{name:"TikTok",icon:"",blocked:!0},{name:"YouTube",icon:"",blocked:!1},{name:"Twitter",icon:"",blocked:!0},{name:"X",icon:"",blocked:!0},{name:"Snapchat",icon:"",blocked:!0}]),[N,k]=e.useState(!1),[S,C]=e.useState(0),[E,A]=e.useState(null),[T,I]=e.useState(!1),[P,q]=e.useState(!1),[R,M]=e.useState(!0),[D,L]=e.useState(!1),[F,$]=e.useState(!0);e.useEffect(()=>{(()=>{const e=navigator.userAgent.toLowerCase(),t=/chrome/.test(e)&&!/edg|opr|brave/.test(e);M(t),t||console.log(" Focus Mode is only available in Chrome browser")})()},[]);const O=[{id:"pomodoro",name:"Pomodoro",duration:25,color:"bg-red-500"},{id:"short-break",name:"Short Break",duration:5,color:"bg-green-500"},{id:"long-break",name:"Long Break",duration:15,color:"bg-blue-500"},{id:"deep-work",name:"Deep Work",duration:90,color:"bg-purple-500"}],B=()=>{try{localStorage.removeItem("studiply_focus_session")}catch(e){console.error("Failed to clear session from localStorage:",e)}};e.useEffect(()=>{const e=()=>{if(n&&document.hidden){C(e=>e+1),A((new Date).toISOString()),k(!0);const e={active:!0,startTime:c,pageHiddenCount:S+1,lastHiddenTime:(new Date).toISOString(),sessionType:u};localStorage.setItem("studiply_focus_mode",JSON.stringify(e))}else n&&!document.hidden&&k(!1)};document.addEventListener("visibilitychange",e);const t=()=>{n&&(C(e=>e+1),A((new Date).toISOString()),k(!0))},s=()=>{n&&k(!1)};return window.addEventListener("blur",t),window.addEventListener("focus",s),()=>{document.removeEventListener("visibilitychange",e),window.removeEventListener("blur",t),window.removeEventListener("focus",s)}},[n,S,c,u]),e.useEffect(()=>{(()=>{try{const e=localStorage.getItem("studiply_focus_mode");if(e){const t=JSON.parse(e);if(t.active&&(i(!0),d(t.startTime),C(t.pageHiddenCount||0),A(t.lastHiddenTime),h(t.sessionType||"pomodoro"),l(t.timeLeft||1500),t.lastHiddenTime)){Date.now()-new Date(t.lastHiddenTime).getTime()<5e3&&k(!0)}}}catch(e){console.error("Failed to check focus mode status:",e)}})()},[]),e.useEffect(()=>{if(n&&m){const e=e=>(e.preventDefault(),e.returnValue="Focus session is in progress. Are you sure you want to leave?","Focus session is in progress. Are you sure you want to leave?"),t=()=>{document.hidden&&n&&m&&alert("Focus session is in progress. Please return to this page.")};return window.addEventListener("beforeunload",e),document.addEventListener("visibilitychange",t),()=>{window.removeEventListener("beforeunload",e),document.removeEventListener("visibilitychange",t)}}},[n,m]),e.useEffect(()=>{if(!b){const e=(()=>{try{const e=localStorage.getItem("studiply_focus_session");return e?JSON.parse(e):null}catch(e){return console.error("Failed to load session from localStorage:",e),null}})(),t=(()=>{try{const e=localStorage.getItem("studiply_focus_history");return e?JSON.parse(e):[]}catch(e){return console.error("Failed to load history from localStorage:",e),[]}})();e&&(l(e.timeLeft),i(e.isActive),d(e.startTime),h(e.sessionType),x(e.focusLockEnabled)),y(t),f(!0)}},[b]),e.useEffect(()=>(()=>{const e=e=>{if(e.origin!==window.location.origin)return;const{type:t,data:s}=e.data;"STUDIPLY_EXTENSION_READY"===t?(I(!0),q(!0),console.log(" Extension ready and active")):"STUDIPLY_EXTENSION_STATUS"===t?(I(!0),q(s.active),console.log("Extension status:",s)):"STUDIPLY_EXTENSION_LOADED"===t&&(I(!0),console.log("Extension detected and loaded"))};window.addEventListener("message",e),window.postMessage({type:"STUDIPLY_GET_EXTENSION_STATUS",timestamp:Date.now()},window.location.origin);const t=setTimeout(()=>{const e=localStorage.getItem("studiply_extension_status");if(e)try{const t=JSON.parse(e);I(!0),q(t.active||!1),console.log("Extension detected via localStorage")}catch(To){console.log("Extension not detected")}},3e3);return()=>{window.removeEventListener("message",e),clearTimeout(t)}})(),[]),e.useEffect(()=>{if(b){const e={timeLeft:o,isActive:n,startTime:c,sessionType:u,focusLockEnabled:m};localStorage.setItem("studiply_focus_session",JSON.stringify(e))}},[o,n,c,u,m,b]),e.useEffect(()=>{let e=null;return n&&o>0?e=setInterval(()=>{l(e=>{var t,s;const r=e-1;if(0===r){const e={id:Date.now(),type:(null==(t=O.find(e=>e.id===u))?void 0:t.name)||"Pomodoro",duration:(null==(s=O.find(e=>e.id===u))?void 0:s.duration)||25,startTime:c,endTime:(new Date).toISOString()},r=[...w,e];y(r),localStorage.setItem("studiply_focus_history",JSON.stringify(r)),i(!1),d(null),B(),"Notification"in window&&"granted"===Notification.permission&&new Notification("Focus Session Completed!",{body:"Great job! Your focus session is complete.",icon:"/favicon.ico"})}return r})},1e3):n||0===o||clearInterval(e),()=>clearInterval(e)},[n,o,c,u,O,w]),e.useEffect(()=>{if(c){const e={timeLeft:o,isActive:n,startTime:c,sessionType:u,focusLockEnabled:m};localStorage.setItem("studiply_focus_session",JSON.stringify(e))}},[o,n,c,u,m]);const _=()=>{const e=O.find(e=>e.id===u);if(e){const t=(new Date).toISOString();l(60*e.duration),i(!0),d(t),g(!1),C(0),A(null),k(!1);const s={active:!0,startTime:t,pageHiddenCount:0,lastHiddenTime:null,sessionType:u,timeLeft:60*e.duration};localStorage.setItem("studiply_focus_mode",JSON.stringify(s)),console.log(" Extension installed:",T),console.log(" Extension active:",P);const r=v.find(e=>"Block All Websites"===e.name&&e.blocked)?["*"]:v.filter(e=>e.blocked&&!e.isSpecial).map(e=>({Facebook:"facebook.com",Instagram:"instagram.com",TikTok:"tiktok.com",YouTube:"youtube.com",Twitter:"twitter.com",X:"x.com",Snapchat:"snapchat.com"}[e.name]||e.name.toLowerCase()+".com"));console.log(" Sending focus start message with blocked sites:",r,"startTime:",t),window.postMessage({type:"STUDIPLY_FOCUS_START",data:{sessionType:u,duration:e.duration,startTime:t,blockedSites:r}},window.location.origin)}},z=()=>{i(!1),d(null),q(!1);const e=O.find(e=>e.id===u);e&&l(60*e.duration),B(),C(0),A(null),k(!1),localStorage.removeItem("studiply_focus_mode"),console.log(" Sending focus stop message"),window.postMessage({type:"STUDIPLY_FOCUS_STOP"},window.location.origin)};return U.jsxs("div",{className:"min-h-screen relative overflow-hidden "+(r?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:[U.jsx("style",{children:"\n        .hide-scrollbar::-webkit-scrollbar { width: 0; height: 0; }\n        .hide-scrollbar { scrollbar-width: none; }\n      "}),U.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[U.jsx("div",{className:"absolute -top-32 left-1/2 h-96 w-96 -translate-x-1/2 rounded-full bg-purple-500/25 blur-3xl"}),U.jsx("div",{className:"absolute top-28 right-0 h-72 w-72 rounded-full bg-pink-400/20 blur-[140px]"}),U.jsx("div",{className:"absolute bottom-0 left-10 h-64 w-64 rounded-full bg-indigo-400/20 blur-[160px]"})]}),U.jsxs("div",{className:"relative z-10 mx-auto flex w-full max-w-6xl flex-col gap-10 px-6 pt-14 pb-8",children:[F&&U.jsx("section",{className:"rounded-[28px] border px-6 py-5 shadow-2xl backdrop-blur-xl transition "+(r?"border-white/12 bg-white/8":"border-white/70 bg-white"),children:U.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[U.jsxs("div",{className:"flex items-start gap-3",children:[U.jsx("div",{className:"rounded-2xl p-3 "+(r?"bg-blue-500/20":"bg-blue-100"),children:U.jsx(ft,{className:"h-5 w-5 "+(r?"text-blue-300":"text-blue-700")})}),U.jsxs("div",{children:[U.jsx("p",{className:"text-base font-semibold "+(r?"text-white":"text-slate-900"),children:"Boost your focus with the Studiply Chrome extension"}),U.jsx("p",{className:(r?"text-white/70":"text-slate-600")+" text-sm",children:"Block distracting websites automatically when the timer starts."})]})]}),U.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[U.jsx("button",{onClick:()=>window.open("https://youtu.be/ZzDNIslGPKo","_blank"),className:"rounded-xl px-4 py-2 text-sm font-semibold transition "+(r?"bg-red-500 text-white hover:bg-red-600":"bg-red-600 text-white hover:bg-red-700"),children:" Watch Tutorial"}),U.jsx("button",{onClick:()=>L(!0),className:"rounded-xl px-4 py-2 text-sm font-semibold transition "+(r?"bg-blue-500 text-white hover:bg-blue-600":"bg-blue-600 text-white hover:bg-blue-700"),children:" Download"}),U.jsx("button",{onClick:()=>$(!1),className:"rounded-full p-2 transition "+(r?"text-white/60 hover:bg-white/10 hover:text-white":"text-slate-500 hover:bg-slate-200 hover:text-slate-700"),children:U.jsx(ir,{className:"h-4 w-4"})})]})]})}),U.jsx("section",{className:"rounded-[32px] border px-8 py-10 text-center shadow-2xl backdrop-blur-xl "+(r?"border-white/12 bg-white/6":"border-white/70 bg-white"),children:U.jsxs("div",{className:"mx-auto flex max-w-2xl flex-col items-center gap-4",children:[U.jsx("div",{className:"inline-flex items-center justify-center rounded-full px-4 py-2 text-xs font-semibold tracking-wide "+(r?"bg-white/10 text-white/60":"bg-slate-100 text-slate-600"),children:"Focus smarter, not harder"}),U.jsx("h1",{className:"text-4xl font-black tracking-tight "+(r?"bg-gradient-to-r from-purple-300 to-blue-300 bg-clip-text text-transparent":"bg-gradient-to-r from-purple-700 to-blue-700 bg-clip-text text-transparent"),children:"Stay in the zone with Studiply Focus Mode"}),U.jsx("p",{className:(r?"text-white/70":"text-slate-600")+" text-base",children:"Lock in, block distractions, and celebrate every deep work win."})]})}),!R&&U.jsx("section",{className:"rounded-[32px] border px-8 py-10 shadow-2xl backdrop-blur-xl "+(r?"border-white/12 bg-white/6":"border-white/70 bg-white"),children:U.jsx("div",{className:"rounded-[28px] border px-6 py-6 "+(r?"border-red-400/30 bg-gradient-to-r from-red-500/15 to-orange-500/15":"border-red-200 bg-gradient-to-r from-red-100 to-orange-100"),children:U.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[U.jsxs("div",{className:"flex items-start gap-4",children:[U.jsx("div",{className:"flex h-14 w-14 items-center justify-center rounded-2xl bg-gradient-to-r from-red-500 to-orange-500",children:U.jsx(ft,{className:"h-7 w-7 text-white"})}),U.jsxs("div",{children:[U.jsx("h2",{className:"text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:"Chrome required"}),U.jsx("p",{className:(r?"text-white/70":"text-slate-600")+" mt-2 text-sm",children:"Our blocking extension currently supports Google Chrome only."}),U.jsxs("div",{className:"mt-4 rounded-2xl px-4 py-4 "+(r?"bg-white/10":"bg-white"),children:[U.jsx("h3",{className:"text-sm font-semibold "+(r?"text-white":"text-slate-900"),children:"Why only Chrome?"}),U.jsxs("ul",{className:(r?"text-white/60":"text-slate-500")+" mt-2 space-y-1 text-sm",children:[U.jsx("li",{children:" Chromes extension APIs offer reliable site blocking."}),U.jsx("li",{children:" Alternative Chromium browsers limit required permissions."}),U.jsx("li",{children:" Safari and Firefox use incompatible extension models."})]})]})]})]}),U.jsxs("a",{href:"https://www.google.com/chrome/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 self-start rounded-2xl px-5 py-3 text-sm font-semibold transition "+(r?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg shadow-blue-500/40 hover:shadow-blue-500/60":"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg shadow-blue-300/30 hover:shadow-blue-300/50"),children:["Download Chrome",U.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:U.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})})}),U.jsxs("div",{className:"grid gap-8 lg:grid-cols-[minmax(0,55%)_minmax(0,45%)]",children:[U.jsx("section",{className:"rounded-[32px] border shadow-2xl backdrop-blur-xl overflow-hidden "+(r?"border-white/12 bg-transparent":"border-white/70 bg-transparent"),children:U.jsx("div",{className:"h-full bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 p-8 text-white",children:U.jsxs("div",{className:"flex flex-col gap-8 lg:flex-row lg:items-center lg:justify-between",children:[U.jsxs("div",{className:"flex flex-1 flex-col items-center gap-4 text-center lg:items-start lg:text-left",children:[U.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/20 px-4 py-1 text-xs font-semibold uppercase tracking-wide",children:[U.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-300"})," Current session"]}),U.jsx("div",{className:"font-mono text-7xl font-bold drop-shadow-lg leading-none",children:(e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`})(o)}),U.jsx("p",{className:"text-lg font-medium opacity-90",children:null==(t=O.find(e=>e.id===u))?void 0:t.name}),U.jsx("div",{className:"flex flex-wrap justify-center gap-3 lg:justify-start",children:n?U.jsxs(U.Fragment,{children:[U.jsxs("button",{onClick:()=>{i(!1)},className:"flex items-center gap-2 rounded-2xl bg-white/15 px-5 py-3 text-sm font-semibold transition hover:bg-white/25",children:[U.jsx(zs,{className:"h-5 w-5"})," Pause"]}),U.jsxs("button",{onClick:z,className:"flex items-center gap-2 rounded-2xl bg-gradient-to-r from-rose-500 to-pink-500 px-5 py-3 text-sm font-semibold shadow-lg shadow-rose-500/40 transition hover:shadow-rose-500/60",children:[U.jsx(ir,{className:"h-5 w-5"})," Stop"]})]}):U.jsxs("button",{onClick:()=>{m?g(!0):_()},disabled:!R,className:"flex items-center gap-2 rounded-2xl bg-white/20 px-6 py-3 text-sm font-semibold shadow-lg shadow-purple-900/30 transition hover:bg-white/30 hover:shadow-purple-900/40 "+(R?"text-white":"cursor-not-allowed text-white/60"),children:[U.jsx(Vs,{className:"h-5 w-5"})," Start session"]})}),U.jsx("div",{className:"flex flex-wrap justify-center gap-2 pt-2 lg:justify-start",children:O.map(e=>U.jsx("button",{onClick:()=>{h(e.id),n||l(60*e.duration)},className:"rounded-full px-4 py-2 text-xs font-semibold transition "+(u===e.id?"bg-white/30 text-white shadow-sm":"bg-white/10 text-white/70 hover:bg-white/20"),children:e.name},e.id))})]}),U.jsxs("div",{className:"grid w-full grid-cols-2 gap-4 lg:max-w-sm",children:[U.jsxs("div",{className:"rounded-2xl border border-white/20 bg-white/10 px-4 py-3",children:[U.jsx("p",{className:"text-[11px] uppercase tracking-wide text-white/70",children:"Duration"}),U.jsxs("p",{className:"mt-2 text-lg font-semibold text-white",children:[null==(s=O.find(e=>e.id===u))?void 0:s.duration," min"]})]}),U.jsxs("div",{className:"rounded-2xl border border-white/20 bg-white/10 px-4 py-3",children:[U.jsx("p",{className:"text-[11px] uppercase tracking-wide text-white/70",children:"Progress"}),U.jsxs("p",{className:"mt-2 text-lg font-semibold text-white",children:[w.length," completed"]})]}),U.jsxs("div",{className:"rounded-2xl border border-white/20 bg-white/10 px-4 py-3",children:[U.jsx("p",{className:"text-[11px] uppercase tracking-wide text-white/70",children:"Focus streak"}),U.jsxs("p",{className:"mt-2 text-lg font-semibold text-white",children:[w.slice(-3).length," today"]})]}),U.jsxs("div",{className:"rounded-2xl border border-white/20 bg-white/10 px-4 py-3",children:[U.jsx("p",{className:"text-[11px] uppercase tracking-wide text-white/70",children:"Chrome status"}),U.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 rounded-full bg-black/20 px-3 py-1 text-xs font-semibold text-white/80",children:[U.jsx("span",{className:"h-2 w-2 rounded-full "+(T?"bg-emerald-300 animate-pulse":"bg-rose-300 animate-pulse")}),T?P?"Extension active":"Extension ready":"Extension missing"]})]}),U.jsxs("div",{className:"col-span-2 rounded-2xl border border-white/20 bg-black/20 px-4 py-4 text-xs text-white/75",children:["Focus Lock ",m?"enabled. We will warn you before you leave this tab.":"disabled. Turn it on to keep yourself anchored to this session.",U.jsxs("button",{onClick:()=>{x(!m)},className:"mt-3 inline-flex items-center gap-2 rounded-full border border-white/25 px-4 py-1.5 text-xs font-semibold transition hover:bg-white/15 "+(m?"text-emerald-200":"text-white"),children:[m?U.jsx(Ts,{className:"h-3.5 w-3.5"}):U.jsx(wr,{className:"h-3.5 w-3.5"}),m?"Disable lock":"Enable lock"]})]})]})]})})}),U.jsx("section",{className:"rounded-[28px] border shadow-2xl backdrop-blur-xl "+(r?"border-white/12 bg-white/6":"border-white/70 bg-white"),children:U.jsxs("div",{className:"flex flex-col gap-6",children:[U.jsxs("div",{className:"rounded-[24px] border border-white/10 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 p-6 text-white shadow-lg",children:[U.jsxs("div",{className:"flex items-center justify-between gap-4",children:[U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-xl bg-white/15",children:U.jsx(sr,{className:"h-6 w-6"})}),U.jsxs("div",{children:[U.jsx("h3",{className:"text-lg font-bold",children:"Blocked sites"}),U.jsx("p",{className:"text-xs text-white/80",children:"Flip a switch to silence distractions."})]})]}),U.jsxs("div",{className:"rounded-full border border-white/20 px-3 py-1 text-[11px] font-semibold text-white/80",children:[v.filter(e=>e.blocked).length," blocked"]})]}),U.jsx("p",{className:"mt-4 rounded-2xl border border-white/10 bg-white/10 px-4 py-3 text-xs text-white/80",children:"Toggle Block All Websites to mute every distracting domain instantly, or curate the list below to keep essentials available."})]}),U.jsx("div",{className:"rounded-[24px] border p-4 "+(r?"border-white/12 bg-white/8":"border-slate-200 bg-white"),children:U.jsx("div",{className:"hide-scrollbar -m-1 max-h-[360px] overflow-y-auto p-1",children:U.jsx("div",{className:"grid gap-3 sm:grid-cols-2",children:v.map((e,t)=>U.jsxs("div",{className:"flex items-center justify-between rounded-2xl border px-4 py-3 text-sm transition "+(r?"border-white/10 bg-white/6":"border-slate-200 bg-slate-50"),children:[U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx("span",{className:"text-2xl",children:e.icon}),U.jsxs("div",{children:[U.jsx("p",{className:"font-semibold "+(r?"text-white":"text-slate-900"),children:e.name}),U.jsx("p",{className:"text-xs font-semibold "+(e.blocked?"text-rose-400":"text-sky-500"),children:e.blocked?"Blocked":"Allowed"})]})]}),U.jsx("button",{onClick:()=>{return t=e.name,void j(e=>e.map(s=>{if(s.name===t){if(s.isSpecial){const e=!s.blocked;return{...s,blocked:e}}return{...s,blocked:!s.blocked}}if("Block All Websites"===t){const t=e.find(e=>"Block All Websites"===e.name);if(t&&!t.blocked)return{...s,blocked:!0};if(t&&t.blocked)return s}return s}));var t},className:"relative inline-flex h-6 w-11 items-center rounded-full transition "+(e.blocked?"bg-gradient-to-r from-rose-500 to-pink-500":"bg-gradient-to-r from-sky-400 to-indigo-500"),children:U.jsx("span",{className:"inline-block h-5 w-5 transform rounded-full bg-white transition "+(e.blocked?"translate-x-5":"translate-x-1")})})]},t))})})})]})})]}),U.jsx("section",{className:"rounded-[28px] border px-8 py-8 shadow-2xl backdrop-blur-xl "+(r?"border-white/12 bg-white/6":"border-white/70 bg-white"),children:U.jsxs("div",{className:"flex flex-col gap-6",children:[U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-xl bg-gradient-to-r from-emerald-500 to-teal-500 text-white",children:U.jsx(St,{className:"h-6 w-6"})}),U.jsxs("div",{children:[U.jsx("h2",{className:"text-xl font-bold "+(r?"text-white":"text-slate-900"),children:"Latest sessions"}),U.jsx("p",{className:(r?"text-white/60":"text-slate-600")+" text-xs",children:"Celebrate wins, keep the momentum."})]})]}),w.length>0?U.jsx("div",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-3",children:w.slice(-6).reverse().map(e=>{return U.jsx("div",{className:"rounded-2xl border px-4 py-3 text-sm transition "+(r?"border-emerald-400/30 bg-emerald-500/10":"border-emerald-200 bg-emerald-50"),children:U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsxs("div",{children:[U.jsxs("p",{className:"font-semibold "+(r?"text-white":"text-slate-900"),children:[e.type," session"]}),U.jsxs("p",{className:(r?"text-white/70":"text-slate-500")+" text-xs",children:[e.duration," minutes  ",(t=e.startTime,("string"==typeof t?new Date(t):t).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}))]})]}),U.jsx("span",{className:"rounded-full bg-emerald-400/20 px-3 py-1 text-[11px] font-semibold text-emerald-200",children:"Done"})]})},e.id);var t})}):U.jsx("div",{className:"rounded-2xl border px-6 py-10 text-center text-sm "+(r?"border-white/10 bg-white/6 text-white/60":"border-slate-200 bg-slate-50 text-slate-500"),children:"No focus sessions logged yetstart one and your streak will appear here."})]})})]}),N&&U.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:U.jsxs("div",{className:"relative max-w-md w-full rounded-3xl shadow-2xl border overflow-hidden "+(r?"bg-gradient-to-br from-slate-800 to-slate-900 border-white/20":"bg-gradient-to-br from-white to-gray-50 border-gray-200"),children:[U.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-500/20 to-red-500/20 rounded-3xl blur-xl"}),U.jsxs("div",{className:"relative p-8 text-center",children:[U.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-orange-500 to-red-500 rounded-full flex items-center justify-center mx-auto mb-6 shadow-2xl",children:U.jsx(ft,{className:"w-10 h-10 text-white animate-pulse"})}),U.jsx("h2",{className:"text-2xl font-bold mb-4 "+(r?"text-white":"text-gray-900"),children:"Stay Focused! "}),U.jsxs("p",{className:"text-lg mb-6 "+(r?"text-white/80":"text-gray-600"),children:["You're in focus mode! You've left this page ",U.jsx("span",{className:"font-bold text-orange-500",children:S})," time",S>1?"s":"","."]}),U.jsxs("div",{className:"p-4 rounded-2xl mb-6 "+(r?"bg-white/10 border border-white/20":"bg-gray-100 border border-gray-200"),children:[U.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"Focus Session Progress"}),U.jsxs("div",{className:"text-2xl font-bold "+(r?"text-white":"text-gray-900"),children:[Math.floor((1500-o)/60),":",(1500-o)%60<10?"0":"",(1500-o)%60]}),U.jsx("div",{className:"text-sm text-gray-500",children:"of 25:00 completed"})]}),U.jsxs("div",{className:"flex space-x-3",children:[U.jsx("button",{onClick:()=>k(!1),className:"flex-1 py-3 px-6 rounded-xl font-semibold transition-all duration-200 "+(r?"bg-white/20 text-white hover:bg-white/30 border border-white/30":"bg-gray-200 text-gray-800 hover:bg-gray-300 border border-gray-300"),children:"Continue Focus"}),U.jsx("button",{onClick:z,className:"flex-1 py-3 px-6 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl font-semibold hover:from-red-600 hover:to-red-700 transition-all duration-200 shadow-lg hover:shadow-xl",children:"End Session"})]})]})]})}),D&&U.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:U.jsxs("div",{className:"relative backdrop-blur-sm rounded-3xl shadow-2xl border max-w-2xl w-full max-h-[90vh] overflow-y-auto "+(r?"bg-white/10 border-white/20":"bg-white/95 border-white/20"),children:[U.jsx("button",{onClick:()=>L(!1),className:"absolute top-4 right-4 p-2 rounded-full transition-all duration-200 hover:scale-110 "+(r?"bg-white/10 hover:bg-white/20 text-white/70 hover:text-white":"bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-gray-800"),children:U.jsx(ir,{className:"w-5 h-5"})}),U.jsxs("div",{className:"p-8",children:[U.jsxs("div",{className:"text-center mb-6",children:[U.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full mb-4 "+(r?"bg-blue-500/20":"bg-blue-100"),children:U.jsx(ft,{className:"w-8 h-8 "+(r?"text-blue-400":"text-blue-600")})}),U.jsx("h2",{className:"text-2xl font-bold mb-2 "+(r?"text-white":"text-gray-900"),children:"Chrome Extension Required"}),U.jsx("p",{className:"text-base "+(r?"text-white/70":"text-gray-600"),children:"In Studiply focus mode you can block websites when starting the timer, only if you've downloaded our chrome extension. If you don't know how to download our extension watch the video."})]}),U.jsxs("div",{className:"mb-6",children:[U.jsx("h3",{className:"text-lg font-semibold mb-3 "+(r?"text-white":"text-gray-900"),children:" Extension Installation Tutorial"}),U.jsxs("div",{className:"rounded-xl p-6 text-center "+(r?"bg-black/20 border border-white/10":"bg-gray-100 border border-gray-200"),children:[U.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full mb-4 "+(r?"bg-red-500/20":"bg-red-100"),children:U.jsx(Vs,{className:"w-8 h-8 "+(r?"text-red-400":"text-red-600")})}),U.jsx("p",{className:"text-sm mb-4 "+(r?"text-white/70":"text-gray-600"),children:"Watch our step-by-step tutorial to learn how to install and use the Studiply Focus Extension"}),U.jsx("button",{onClick:()=>{window.open("https://youtu.be/ZzDNIslGPKo","_blank")},className:"px-4 py-2 rounded-lg font-medium transition-all duration-200 "+(r?"bg-red-500 hover:bg-red-600 text-white":"bg-red-600 hover:bg-red-700 text-white"),children:" Watch Tutorial"})]})]}),U.jsxs("div",{className:"p-4 rounded-xl mb-6 "+(r?"bg-white/5":"bg-gray-50"),children:[U.jsx("h3",{className:"text-lg font-semibold mb-3 "+(r?"text-white":"text-gray-900"),children:" What the Extension Does:"}),U.jsxs("ul",{className:"space-y-2 text-sm "+(r?"text-white/80":"text-gray-700"),children:[U.jsxs("li",{className:"flex items-start gap-2",children:[U.jsx("span",{className:"text-green-500 mt-1",children:""}),U.jsx("span",{children:"Blocks distracting websites during focus sessions"})]}),U.jsxs("li",{className:"flex items-start gap-2",children:[U.jsx("span",{className:"text-green-500 mt-1",children:""}),U.jsx("span",{children:"Works automatically when you start a timer"})]}),U.jsxs("li",{className:"flex items-start gap-2",children:[U.jsx("span",{className:"text-green-500 mt-1",children:""}),U.jsx("span",{children:"Shows motivational messages when blocked"})]}),U.jsxs("li",{className:"flex items-start gap-2",children:[U.jsx("span",{className:"text-green-500 mt-1",children:""}),U.jsx("span",{children:"Tracks your productivity and focus time"})]})]})]}),U.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[U.jsx("button",{onClick:()=>{L(!1),a("/extension-download")},className:"flex-1 px-6 py-3 rounded-xl font-semibold transition-all duration-200 transform hover:scale-105 "+(r?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-2xl shadow-blue-500/30 hover:shadow-blue-500/50":"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-2xl shadow-blue-300/30 hover:shadow-blue-300/50"),children:" Download Extension"}),U.jsx("button",{onClick:()=>L(!1),className:"px-6 py-3 rounded-xl font-semibold transition-all duration-200 "+(r?"bg-white/10 hover:bg-white/20 text-white border border-white/20":"bg-gray-100 hover:bg-gray-200 text-gray-700 border border-gray-200"),children:"Maybe Later"})]})]})]})})]})},Dn=(e,t,s,r)=>{let a=e,n=t;if(a<=s&&n<=r)return{width:a,height:n};const i=s/a,o=r/n,l=Math.min(i,o);return{width:Math.floor(a*l),height:Math.floor(n*l)}},Ln=e=>3*e.length/4/1024,Fn=({isOpen:s,onClose:r,onConfirm:a,title:n="Remove Tutor Status",message:i="Are you sure you want to remove your tutor status? This will permanently delete your tutor profile, and students will no longer be able to request courses from you. This action cannot be undone.",confirmText:o="Confirm Removal",cancelText:l="Cancel",loading:c=!1,userName:d="TESTING ACCOUNT"})=>{const[u,h]=e.useState(!1);e.useEffect(()=>{const e=e=>{"Escape"===e.key&&m()};return s&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[s]);const m=()=>{h(!0),setTimeout(()=>{r(),h(!1)},500)};if(!s)return null;const x=U.jsxs("div",{children:[U.jsx("style",{children:"\n        @keyframes fadeIn {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n        @keyframes fadeOut {\n          from { opacity: 1; }\n          to { opacity: 0; }\n        }\n        @keyframes modalEnter {\n          from { \n            opacity: 0;\n            transform: scale(0.7) translateY(30px);\n          }\n          to { \n            opacity: 1;\n            transform: scale(1) translateY(0);\n          }\n        }\n        @keyframes modalExit {\n          from { \n            opacity: 1;\n            transform: scale(1) translateY(0);\n          }\n          to { \n            opacity: 0;\n            transform: scale(0.8) translateY(-20px);\n          }\n        }\n        @keyframes slideInDown {\n          from { \n            opacity: 0;\n            transform: translateY(-30px);\n          }\n          to { \n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        @keyframes slideOutUp {\n          from { \n            opacity: 1;\n            transform: translateY(0);\n          }\n          to { \n            opacity: 0;\n            transform: translateY(-20px);\n          }\n        }\n      "}),U.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 transition-all duration-500 "+(u?"opacity-0":"opacity-100"),onClick:m,style:{animation:u?"fadeOut 0.5s ease-in-out":"fadeIn 0.5s ease-in-out",position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh"},children:U.jsx("div",{className:"flex items-center justify-center w-full h-full p-4",style:{minHeight:"100vh",width:"100%"},children:U.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-md w-full border border-white/20 overflow-hidden transition-all duration-500 "+(u?"opacity-0 scale-95 translate-y-8":"opacity-100 scale-100 translate-y-0"),onClick:e=>e.stopPropagation(),style:{animation:u?"modalExit 0.5s ease-in-out":"modalEnter 0.5s ease-in-out"},children:[U.jsx("div",{className:"bg-gradient-to-r from-red-500 to-orange-500 p-6 text-white",children:U.jsxs("div",{className:"flex items-center space-x-3 transition-all duration-500 "+(u?"opacity-0 translate-y-4":"opacity-100 translate-y-0"),style:{animation:u?"slideOutUp 0.3s ease-in-out 0.1s":"slideInDown 0.5s ease-out 0.1s"},children:[U.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center animate-pulse",children:U.jsx(pr,{className:"w-6 h-6 text-white animate-bounce"})}),U.jsxs("div",{children:[U.jsx("h3",{className:"text-xl font-bold",children:"Remove Tutor Status"}),U.jsx("p",{className:"text-white/90",children:"This action cannot be undone"})]})]})}),U.jsxs("div",{className:"p-6",children:[U.jsxs("div",{className:"flex items-center space-x-4 mb-6 transition-all duration-500 "+(u?"opacity-0 translate-y-4":"opacity-100 translate-y-0"),style:{animation:u?"slideOutUp 0.3s ease-in-out 0.15s":"slideInDown 0.5s ease-out 0.2s"},children:[U.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center",children:U.jsx(kr,{className:"w-6 h-6 text-white"})}),U.jsxs("div",{children:[U.jsx("p",{className:"text-gray-900 font-medium",children:"Are you sure you want to remove your tutor status?"}),U.jsx("p",{className:"text-lg font-bold text-gray-900",children:d}),U.jsx("p",{className:"text-sm text-gray-600",children:"This will permanently delete your tutor profile"})]})]}),U.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 border border-orange-200 rounded-xl p-4 mb-6 transition-all duration-500 "+(u?"opacity-0 translate-y-4":"opacity-100 translate-y-0"),style:{animation:u?"slideOutUp 0.3s ease-in-out 0.2s":"slideInDown 0.5s ease-out 0.3s"},children:U.jsxs("div",{className:"flex items-start space-x-3",children:[U.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-orange-500 to-red-500 rounded-lg flex items-center justify-center flex-shrink-0 animate-pulse",children:U.jsx(Rr,{className:"w-4 h-4 text-white animate-ping"})}),U.jsxs("div",{className:"text-orange-800",children:[U.jsx("p",{className:"font-medium",children:"Warning"}),U.jsx("p",{className:"text-sm",children:"Students will no longer be able to request courses from you, and you will lose all tutor privileges."})]})]})}),U.jsxs("div",{className:"flex space-x-3 transition-all duration-500 "+(u?"opacity-0 translate-y-4":"opacity-100 translate-y-0"),style:{animation:u?"slideOutUp 0.3s ease-in-out 0.25s":"slideInDown 0.5s ease-out 0.4s"},children:[U.jsx("button",{onClick:m,disabled:c,className:"flex-1 px-6 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-xl transition-all duration-200 font-medium transform hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed",style:{transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"},children:l}),U.jsxs("button",{onClick:async()=>{h(!0),await a()},disabled:c,className:"flex-1 bg-gradient-to-r from-red-500 to-red-600 text-white py-3 px-6 rounded-xl hover:from-red-600 hover:to-red-700 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",style:{transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"},children:[c?U.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}):U.jsx(pr,{className:"w-4 h-4"}),U.jsx("span",{children:o})]})]})]})]})})})]});return t.createPortal(x,document.body)},Un=({user:t,onSuccess:s})=>{const{reloadUser:r}=Br(),{showSuccess:a,showError:n}=Hr(),[i,o]=e.useState(!1),[l,c]=e.useState(!1);return U.jsxs("div",{className:"space-y-6",children:[U.jsxs("div",{className:"flex items-center space-x-4",children:[U.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-red-500 to-orange-500 rounded-xl flex items-center justify-center",children:U.jsx(pr,{className:"w-6 h-6 text-white"})}),U.jsxs("div",{children:[U.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Remove Tutor Status"}),U.jsx("p",{className:"text-gray-600",children:"Stop being a tutor and remove your tutor profile"})]})]}),U.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 border border-orange-200 rounded-2xl p-6",children:U.jsxs("div",{className:"flex items-start space-x-4",children:[U.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-orange-500 to-red-500 rounded-xl flex items-center justify-center flex-shrink-0",children:U.jsx(ft,{className:"w-5 h-5 text-white"})}),U.jsxs("div",{className:"text-orange-800",children:[U.jsx("p",{className:"font-semibold text-lg mb-2",children:"Warning"}),U.jsx("p",{className:"leading-relaxed",children:"This will permanently remove your tutor profile and you won't appear in the tutor list anymore. Students won't be able to request sessions from you."})]})]})}),U.jsx("button",{onClick:async()=>{(null==t?void 0:t.id)?c(!0):n("","")},disabled:i,className:"w-full bg-gradient-to-r from-red-500 to-red-600 text-white py-4 px-6 rounded-2xl hover:from-red-600 hover:to-red-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-3 font-semibold text-lg shadow-lg hover:shadow-xl transform hover:scale-[1.02] disabled:hover:scale-100",children:i?U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),U.jsx("span",{children:"Removing..."})]}):U.jsxs(U.Fragment,{children:[U.jsx(pr,{className:"w-5 h-5"}),U.jsx("span",{children:"Remove Tutor Status"})]})}),U.jsx(Fn,{isOpen:l,onClose:()=>c(!1),onConfirm:async()=>{o(!0);try{const e=await $a(null==t?void 0:t.id);if(e.success){c(!1),a("","");const e={...t,isTutor:!1};localStorage.setItem("simpleUser",JSON.stringify(e)),r(),s&&s()}else n(`: ${e.error}`,"")}catch(e){n("",""),console.error("Error removing tutor status:",e)}finally{o(!1)}},title:"Remove Tutor Status",message:"Are you sure you want to remove your tutor status? This will permanently delete your tutor profile, and students will no longer be able to request courses from you. This action cannot be undone.",confirmText:"Confirm Removal",cancelText:"Cancel",loading:i,userName:(null==t?void 0:t.name)||"User"})]})},$n=[{code:"IT",name:"Italy",flag:"",prefix:"+39"},{code:"US",name:"United States",flag:"",prefix:"+1"},{code:"GB",name:"United Kingdom",flag:"",prefix:"+44"},{code:"FR",name:"France",flag:"",prefix:"+33"},{code:"DE",name:"Germany",flag:"",prefix:"+49"},{code:"ES",name:"Spain",flag:"",prefix:"+34"},{code:"CA",name:"Canada",flag:"",prefix:"+1"},{code:"AU",name:"Australia",flag:"",prefix:"+61"},{code:"JP",name:"Japan",flag:"",prefix:"+81"},{code:"CN",name:"China",flag:"",prefix:"+86"},{code:"IN",name:"India",flag:"",prefix:"+91"},{code:"BR",name:"Brazil",flag:"",prefix:"+55"},{code:"MX",name:"Mexico",flag:"",prefix:"+52"},{code:"RU",name:"Russia",flag:"",prefix:"+7"},{code:"KR",name:"South Korea",flag:"",prefix:"+82"},{code:"NL",name:"Netherlands",flag:"",prefix:"+31"},{code:"BE",name:"Belgium",flag:"",prefix:"+32"},{code:"CH",name:"Switzerland",flag:"",prefix:"+41"},{code:"AT",name:"Austria",flag:"",prefix:"+43"},{code:"SE",name:"Sweden",flag:"",prefix:"+46"},{code:"NO",name:"Norway",flag:"",prefix:"+47"},{code:"DK",name:"Denmark",flag:"",prefix:"+45"},{code:"FI",name:"Finland",flag:"",prefix:"+358"},{code:"PL",name:"Poland",flag:"",prefix:"+48"},{code:"CZ",name:"Czech Republic",flag:"",prefix:"+420"},{code:"HU",name:"Hungary",flag:"",prefix:"+36"},{code:"PT",name:"Portugal",flag:"",prefix:"+351"},{code:"GR",name:"Greece",flag:"",prefix:"+30"},{code:"TR",name:"Turkey",flag:"",prefix:"+90"},{code:"SA",name:"Saudi Arabia",flag:"",prefix:"+966"},{code:"AE",name:"United Arab Emirates",flag:"",prefix:"+971"},{code:"SG",name:"Singapore",flag:"",prefix:"+65"},{code:"HK",name:"Hong Kong",flag:"",prefix:"+852"},{code:"TW",name:"Taiwan",flag:"",prefix:"+886"},{code:"TH",name:"Thailand",flag:"",prefix:"+66"},{code:"MY",name:"Malaysia",flag:"",prefix:"+60"},{code:"ID",name:"Indonesia",flag:"",prefix:"+62"},{code:"PH",name:"Philippines",flag:"",prefix:"+63"},{code:"VN",name:"Vietnam",flag:"",prefix:"+84"},{code:"ZA",name:"South Africa",flag:"",prefix:"+27"},{code:"EG",name:"Egypt",flag:"",prefix:"+20"},{code:"NG",name:"Nigeria",flag:"",prefix:"+234"},{code:"KE",name:"Kenya",flag:"",prefix:"+254"},{code:"AR",name:"Argentina",flag:"",prefix:"+54"},{code:"CL",name:"Chile",flag:"",prefix:"+56"},{code:"CO",name:"Colombia",flag:"",prefix:"+57"},{code:"PE",name:"Peru",flag:"",prefix:"+51"},{code:"VE",name:"Venezuela",flag:"",prefix:"+58"},{code:"NZ",name:"New Zealand",flag:"",prefix:"+64"},{code:"IL",name:"Israel",flag:"",prefix:"+972"},{code:"IR",name:"Iran",flag:"",prefix:"+98"},{code:"PK",name:"Pakistan",flag:"",prefix:"+92"},{code:"BD",name:"Bangladesh",flag:"",prefix:"+880"},{code:"LK",name:"Sri Lanka",flag:"",prefix:"+94"},{code:"NP",name:"Nepal",flag:"",prefix:"+977"}],On=({selectedCountry:t,onCountrySelect:s,className:r=""})=>{const{isDark:a}=mt(),[n,i]=e.useState(!1),[o,l]=e.useState(""),c=e.useRef(null);e.useEffect(()=>{const e=e=>{c.current&&!c.current.contains(e.target)&&(i(!1),l(""))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const d=$n.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())||e.code.toLowerCase().includes(o.toLowerCase())||e.prefix.includes(o));return U.jsxs("div",{className:`relative ${r}`,ref:c,children:[U.jsxs("button",{type:"button",onClick:()=>i(!n),className:"flex items-center space-x-2 px-3 py-2 border rounded-l-xl transition-all "+(a?"border-white/20 bg-white/5 hover:bg-white/10 text-white focus:ring-2 focus:ring-purple-500/30 focus:border-purple-400/50":"border-gray-300 bg-white hover:bg-gray-50 text-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"),children:[U.jsx("span",{className:"text-lg",children:t.flag}),U.jsx("span",{className:"text-sm font-medium "+(a?"text-white":"text-gray-700"),children:t.prefix}),U.jsx(Bt,{className:`w-4 h-4 transition-transform ${a?"text-white/70":"text-gray-500"} ${n?"rotate-180":""}`})]}),n&&U.jsxs("div",{className:"absolute top-full left-0 mt-1 w-80 border rounded-xl shadow-xl z-50 max-h-64 overflow-hidden "+(a?"bg-slate-800 border-white/20":"bg-white border-gray-300"),children:[U.jsx("div",{className:"p-3 border-b "+(a?"border-white/10":"border-gray-200"),children:U.jsx("input",{type:"text",placeholder:"Search countries...",value:o,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 text-sm transition-all "+(a?"border-white/20 bg-white/5 text-white placeholder:text-white/40 focus:ring-purple-500/30 focus:border-purple-400/50":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"),autoFocus:!0})}),U.jsxs("div",{className:"max-h-48 overflow-y-auto",children:[d.map(e=>U.jsxs("button",{type:"button",onClick:()=>(e=>{s(e),i(!1),l("")})(e),className:"w-full flex items-center space-x-3 px-4 py-3 text-left transition-colors "+(t.code===e.code?a?"bg-purple-500/20":"bg-blue-50":a?"hover:bg-white/10":"hover:bg-gray-50"),children:[U.jsx("span",{className:"text-lg",children:e.flag}),U.jsxs("div",{className:"flex-1",children:[U.jsx("div",{className:"text-sm font-medium "+(a?"text-white":"text-gray-900"),children:e.name}),U.jsx("div",{className:"text-xs "+(a?"text-white/60":"text-gray-500"),children:e.code})]}),U.jsx("span",{className:"text-sm font-mono "+(a?"text-white/80":"text-gray-600"),children:e.prefix})]},e.code)),0===d.length&&U.jsx("div",{className:"px-4 py-3 text-sm text-center "+(a?"text-white/60":"text-gray-500"),children:"No countries found"})]})]})]})},Bn=({value:t,onChange:s,placeholder:r="Phone number",className:a=""})=>{const{isDark:n}=mt(),[i,o]=e.useState({code:"IT",name:"Italy",flag:"",prefix:"+39"}),[l,c]=e.useState("");e.useEffect(()=>{if(t){const e=[{code:"IT",name:"Italy",flag:"",prefix:"+39"},{code:"US",name:"United States",flag:"",prefix:"+1"},{code:"GB",name:"United Kingdom",flag:"",prefix:"+44"},{code:"FR",name:"France",flag:"",prefix:"+33"},{code:"DE",name:"Germany",flag:"",prefix:"+49"},{code:"ES",name:"Spain",flag:"",prefix:"+34"},{code:"CA",name:"Canada",flag:"",prefix:"+1"},{code:"AU",name:"Australia",flag:"",prefix:"+61"},{code:"JP",name:"Japan",flag:"",prefix:"+81"},{code:"CN",name:"China",flag:"",prefix:"+86"},{code:"IN",name:"India",flag:"",prefix:"+91"},{code:"BR",name:"Brazil",flag:"",prefix:"+55"},{code:"MX",name:"Mexico",flag:"",prefix:"+52"},{code:"RU",name:"Russia",flag:"",prefix:"+7"},{code:"KR",name:"South Korea",flag:"",prefix:"+82"},{code:"NL",name:"Netherlands",flag:"",prefix:"+31"},{code:"BE",name:"Belgium",flag:"",prefix:"+32"},{code:"CH",name:"Switzerland",flag:"",prefix:"+41"},{code:"AT",name:"Austria",flag:"",prefix:"+43"},{code:"SE",name:"Sweden",flag:"",prefix:"+46"},{code:"NO",name:"Norway",flag:"",prefix:"+47"},{code:"DK",name:"Denmark",flag:"",prefix:"+45"},{code:"FI",name:"Finland",flag:"",prefix:"+358"},{code:"PL",name:"Poland",flag:"",prefix:"+48"},{code:"CZ",name:"Czech Republic",flag:"",prefix:"+420"},{code:"HU",name:"Hungary",flag:"",prefix:"+36"},{code:"PT",name:"Portugal",flag:"",prefix:"+351"},{code:"GR",name:"Greece",flag:"",prefix:"+30"},{code:"TR",name:"Turkey",flag:"",prefix:"+90"},{code:"SA",name:"Saudi Arabia",flag:"",prefix:"+966"},{code:"AE",name:"United Arab Emirates",flag:"",prefix:"+971"},{code:"SG",name:"Singapore",flag:"",prefix:"+65"},{code:"HK",name:"Hong Kong",flag:"",prefix:"+852"},{code:"TW",name:"Taiwan",flag:"",prefix:"+886"},{code:"TH",name:"Thailand",flag:"",prefix:"+66"},{code:"MY",name:"Malaysia",flag:"",prefix:"+60"},{code:"ID",name:"Indonesia",flag:"",prefix:"+62"},{code:"PH",name:"Philippines",flag:"",prefix:"+63"},{code:"VN",name:"Vietnam",flag:"",prefix:"+84"},{code:"ZA",name:"South Africa",flag:"",prefix:"+27"},{code:"EG",name:"Egypt",flag:"",prefix:"+20"},{code:"NG",name:"Nigeria",flag:"",prefix:"+234"},{code:"KE",name:"Kenya",flag:"",prefix:"+254"},{code:"AR",name:"Argentina",flag:"",prefix:"+54"},{code:"CL",name:"Chile",flag:"",prefix:"+56"},{code:"CO",name:"Colombia",flag:"",prefix:"+57"},{code:"PE",name:"Peru",flag:"",prefix:"+51"},{code:"VE",name:"Venezuela",flag:"",prefix:"+58"},{code:"NZ",name:"New Zealand",flag:"",prefix:"+64"},{code:"IL",name:"Israel",flag:"",prefix:"+972"},{code:"IR",name:"Iran",flag:"",prefix:"+98"},{code:"PK",name:"Pakistan",flag:"",prefix:"+92"},{code:"BD",name:"Bangladesh",flag:"",prefix:"+880"},{code:"LK",name:"Sri Lanka",flag:"",prefix:"+94"},{code:"NP",name:"Nepal",flag:"",prefix:"+977"}],s=e.find(e=>t.startsWith(e.prefix));if(s)o(s),c(t.replace(s.prefix,"").trim());else{const s=t.match(/^(\+\d{1,4})\s*(.*)/);if(s){const r=s[1],a=s[2],n=e.find(e=>e.prefix===r);n?(o(n),c(a)):c(t)}else c(t)}}},[t]);return U.jsxs("div",{className:`flex ${a}`,children:[U.jsx(On,{selectedCountry:i,onCountrySelect:e=>{o(e);const t=e.prefix+" "+l;s(t)}}),U.jsx("input",{type:"tel",value:l,onChange:e=>{const t=e.target.value;c(t);const r=i.prefix+" "+t;s(r)},placeholder:r,className:"flex-1 border-l-0 rounded-r-xl px-4 py-3 transition-all "+(n?"border-white/20 bg-white/5 text-white placeholder:text-white/40 focus:border-purple-400/50 focus:ring-2 focus:ring-purple-500/30 focus:bg-white/10":"border-gray-200 bg-white text-slate-900 placeholder:text-slate-400 focus:border-purple-300 focus:ring-2 focus:ring-purple-500/20 focus:bg-purple-50")})]})},_n=()=>{const{user:t,updateUser:s}=Br(),{isDark:r}=mt(),{showSuccess:a,showError:n}=Hr(),[i,h]=e.useState(!1),[m,x]=e.useState(!1),[p,g]=e.useState({name:"",email:"",phone:"",school:"",grade:"",bio:"",subjects:[],location:""}),[b,w]=e.useState(null),[y,v]=e.useState(!1),j=e.useRef(null),[N,k]=e.useState(!1),[S,C]=e.useState(!1),[E,A]=e.useState(!1),[T,I]=e.useState(!1),[P,q]=e.useState("");e.useEffect(()=>{(null==t?void 0:t.avatar)?w(t.avatar):w(null)},[null==t?void 0:t.avatar]),e.useEffect(()=>{t&&(g({name:t.name||"",email:t.email||"",phone:t.phone||"",school:t.school||"",grade:t.grade||"",bio:t.bio||"",subjects:t.subjects||[],location:t.location||""}),q(t.phone||""))},[t]),e.useEffect(()=>{t&&!i&&(g({name:t.name||"",email:t.email||"",phone:t.phone||"",school:t.school||"",grade:t.grade||"",bio:t.bio||"",subjects:t.subjects||[],location:t.location||""}),q(t.phone||""),I(!1))},[t,i]);const R=(e,t)=>{g(s=>({...s,[e]:t})),"phone"===e&&t!==P&&t.trim()&&I(!0)},M=()=>{var e;null==(e=j.current)||e.click()};return t?U.jsxs("div",{className:"min-h-screen relative overflow-hidden "+(r?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:[U.jsx("style",{children:"\n        .hide-scrollbar::-webkit-scrollbar { width: 0; height: 0; }\n        .hide-scrollbar { scrollbar-width: none; }\n      "}),U.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[U.jsx("div",{className:"absolute -top-36 left-1/2 h-96 w-96 -translate-x-1/2 rounded-full bg-purple-500/30 blur-3xl animate-pulse"}),U.jsx("div",{className:"absolute top-1/2 right-12 h-80 w-80 rounded-full bg-pink-400/25 blur-[120px] animate-pulse",style:{animationDelay:"1s"}}),U.jsx("div",{className:"absolute bottom-10 left-10 h-72 w-72 rounded-full bg-blue-400/20 blur-[120px] animate-pulse",style:{animationDelay:"2s"}}),U.jsx("div",{className:"absolute top-1/4 left-1/4 h-64 w-64 rounded-full bg-indigo-400/15 blur-[100px] animate-pulse",style:{animationDelay:"0.5s"}})]}),U.jsxs("div",{className:"relative z-10 mx-auto flex w-full max-w-6xl flex-col gap-10 px-6 py-14 hide-scrollbar",children:[U.jsxs("section",{className:"rounded-[32px] border px-8 py-9 shadow-2xl backdrop-blur-xl "+(r?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-purple-500/10 px-3.5 py-2 text-xs font-semibold text-purple-500 mb-4",children:[U.jsx(Nr,{className:"h-4 w-4"})," Your profile"]}),U.jsx("h1",{className:"text-3xl md:text-4xl font-black tracking-tight mb-2 "+(r?"bg-gradient-to-r from-purple-300 via-pink-300 to-blue-300 bg-clip-text text-transparent":"bg-gradient-to-r from-purple-700 via-pink-600 to-blue-700 bg-clip-text text-transparent"),children:"My Profile"}),U.jsx("p",{className:"text-sm md:text-base "+(r?"text-white/70":"text-slate-600"),children:"Manage your account and view your progress"})]}),U.jsx("section",{className:"rounded-[32px] border px-8 py-9 shadow-2xl backdrop-blur-xl "+(r?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:U.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-8",children:[U.jsxs("div",{className:"relative group",children:[U.jsx("div",{className:"cursor-pointer group-hover:scale-105 transition-transform duration-300",onClick:M,children:U.jsx(Za,{user:{...t,avatar:t.avatar||b},size:"3xl",className:"border-4 shadow-2xl "+(r?"border-white/30":"border-purple-200")})}),U.jsx("button",{onClick:M,disabled:y,className:"absolute bottom-2 right-2 w-10 h-10 rounded-full shadow-lg flex items-center justify-center transition-all duration-200 hover:scale-110 disabled:opacity-50 disabled:cursor-not-allowed "+(r?"bg-white/90 backdrop-blur-sm hover:bg-white":"bg-white hover:bg-purple-50"),children:y?U.jsx("div",{className:"w-4 h-4 border-2 rounded-full animate-spin "+(r?"border-blue-600 border-t-transparent":"border-purple-600 border-t-transparent")}):U.jsx(Ft,{className:"w-5 h-5 "+(r?"text-gray-700":"text-purple-700")})}),(t.avatar||b)&&U.jsx("button",{onClick:e=>{e.stopPropagation(),(async()=>{try{if(v(!0),(await qn(null==t?void 0:t.id,{avatar:null})).success){const e={...t,avatar:null};s(e),w(null),j.current&&(j.current.value=""),a("Avatar removed",4e3,"Success")}else n("Failed to remove avatar",5e3,"Error")}catch(e){console.error("Error removing avatar:",e),n("Failed to remove avatar",5e3,"Error")}finally{v(!1)}})()},disabled:y,className:"absolute top-2 right-2 w-8 h-8 bg-red-500/90 backdrop-blur-sm rounded-full shadow-lg flex items-center justify-center hover:bg-red-600 transition-all duration-200 hover:scale-110 disabled:opacity-50 disabled:cursor-not-allowed",children:y?U.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}):U.jsx(Rr,{className:"w-4 h-4 text-white"})}),U.jsx("input",{ref:j,type:"file",accept:"image/*",onChange:async e=>{const r=e.target.files[0];if(r)try{v(!0);const e=((e,t={})=>{const{maxSizeMB:s=10,allowedTypes:r=["image/jpeg","image/png","image/gif","image/webp"]}=t,a={valid:!0,errors:[]};r.includes(e.type)||(a.valid=!1,a.errors.push(`: ${r.join(", ")}`));const n=1024*s*1024;return e.size>n&&(a.valid=!1,a.errors.push(` ${s}MB`)),a})(r,{maxSizeMB:10,allowedTypes:["image/jpeg","image/png","image/gif","image/webp"]});if(!e.valid)return void n(e.errors.join(", "));(e=>{e.name,e.size,Math.round(e.size/1024),Math.round(e.size/1048576*100),e.type,e.lastModified})(r);const i=await((e,t={})=>{const{maxWidth:s=400,maxHeight:r=400,quality:a=.8,maxSizeKB:n=500}=t;return new Promise((t,i)=>{const o=document.createElement("canvas"),l=o.getContext("2d"),c=new Image;c.onload=()=>{try{let{width:e,height:i}=Dn(c.width,c.height,s,r);o.width=e,o.height=i,l.drawImage(c,0,0,e,i);let d=o.toDataURL("image/jpeg",a),u=a;for(;Ln(d)>n&&u>.1;)u-=.1,d=o.toDataURL("image/jpeg",u);for(;Ln(d)>n&&e>100&&i>100;)e=Math.floor(.9*e),i=Math.floor(.9*i),o.width=e,o.height=i,l.drawImage(c,0,0,e,i),d=o.toDataURL("image/jpeg",Math.max(u,.3));t(d)}catch(e){i(e)}},c.onerror=()=>{i(new Error("Failed to load image"))};const d=new FileReader;d.onload=e=>{c.src=e.target.result},d.onerror=()=>{i(new Error("Failed to read file"))},d.readAsDataURL(e)})})(r,{maxWidth:400,maxHeight:400,quality:.8,maxSizeKB:500}),o=Math.round(3*i.length/4/1024);w(i);if((await qn(null==t?void 0:t.id,{avatar:i})).success){const e={...t,avatar:i};s(e),a(`Avatar updated successfully! Compressed size: ${o}KB`,4e3,"Success")}else n("Failed to save avatar",5e3,"Error"),w(null)}catch(i){console.error("Error uploading avatar:",i),n(`Avatar upload failed: ${i.message}`,5e3,"Error"),w(null)}finally{v(!1)}},className:"hidden"})]}),U.jsxs("div",{className:"flex-1 text-center md:text-left",children:[i?U.jsx("input",{type:"text",value:p.name,onChange:e=>R("name",e.target.value),className:"w-full mb-3 rounded-xl px-4 py-3 text-2xl font-bold transition-all "+(r?"bg-white/10 border-2 border-white/20 text-white placeholder-white/70 focus:border-purple-400/50 focus:ring-2 focus:ring-purple-500/30":"bg-white border-2 border-slate-200 text-slate-900 placeholder-slate-400 focus:border-purple-300 focus:ring-2 focus:ring-purple-500/20"),placeholder:"Your Name"}):U.jsx("h1",{className:"text-3xl md:text-4xl font-black mb-3 "+(r?"bg-gradient-to-r from-purple-300 via-pink-300 to-blue-300 bg-clip-text text-transparent":"bg-gradient-to-r from-purple-700 via-pink-600 to-blue-700 bg-clip-text text-transparent"),children:t.name||"User Name"}),i?U.jsx("input",{type:"text",value:p.grade,onChange:e=>R("grade",e.target.value),placeholder:"Grade/Level",className:"w-full rounded-xl px-4 py-2 text-lg transition-all "+(r?"bg-white/10 border-2 border-white/20 text-white placeholder-white/60 focus:border-purple-400/50 focus:ring-2 focus:ring-purple-500/30":"bg-white border-2 border-slate-200 text-slate-900 placeholder-slate-400 focus:border-purple-300 focus:ring-2 focus:ring-purple-500/20")}):U.jsx("p",{className:"text-xl mb-4 "+(r?"text-white/80":"text-slate-600"),children:t.grade||"Student"}),U.jsx("p",{className:"text-sm mb-6 "+(r?"text-white/60":"text-slate-500"),children:"Click on avatar to upload a new photo"}),U.jsx("div",{className:"flex flex-wrap gap-3 justify-center md:justify-start",children:i?U.jsxs(U.Fragment,{children:[U.jsxs("button",{onClick:async()=>{try{if(x(!0),T&&p.phone&&p.phone.trim())return n("Please verify your phone number before saving",5e3,"Verification Required"),A(!0),void x(!1);const e=(e=>{const t=[];(!e.name||e.name.trim().length<2)&&t.push("Name must be at least 2 characters long"),e.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)&&t.push("Invalid email format"),e.phone&&e.phone.trim()&&(/^\+\d{1,4}\s?\d{6,14}$/.test(e.phone.replace(/\s+/g," "))||t.push("Invalid phone number format"));return e.subjects&&Array.isArray(e.subjects)&&(e.subjects.filter(e=>e&&e.trim().length>0),e.subjects.length>10&&t.push("Maximum 10 subjects allowed")),e.bio&&e.bio.length>500&&t.push("Bio must be less than 500 characters"),{isValid:0===t.length,errors:t}})(p);if(!e.isValid)return void n(e.errors.join(", "));const r=await qn(null==t?void 0:t.id,p);if(r.success){const e={...t,...p,email:t.email,phoneVerified:!T&&t.phoneVerified};s(e),a("Profile updated successfully!",4e3,"Success"),h(!1),I(!1),q(p.phone)}else n(r.error||"Failed to update profile",5e3,"Error")}catch(e){console.error("Error saving profile:",e),n("An unexpected error occurred while saving your profile",5e3,"Error")}finally{x(!1)}},disabled:m,className:"inline-flex items-center gap-2 rounded-2xl px-6 py-3 text-sm font-semibold shadow-lg transition hover:-translate-y-0.5 hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed "+(r?"bg-gradient-to-r from-purple-500 via-pink-500 to-blue-500 text-white hover:from-purple-600 hover:via-pink-600 hover:to-blue-600":"bg-gradient-to-r from-blue-500 to-purple-500 text-white hover:from-blue-600 hover:to-purple-600"),children:[U.jsx(Zs,{className:"h-5 w-5"}),m?"Saving...":"Save Changes"]}),U.jsxs("button",{onClick:()=>h(!1),className:"inline-flex items-center gap-2 rounded-2xl px-6 py-3 text-sm font-semibold transition hover:-translate-y-0.5 "+(r?"bg-white/10 text-white border border-white/20 hover:bg-white/15 hover:border-white/30":"border border-slate-200 bg-white text-slate-700 hover:bg-slate-50 hover:border-slate-300"),children:[U.jsx(Rr,{className:"h-5 w-5"}),"Cancel"]})]}):U.jsxs(U.Fragment,{children:[U.jsxs("button",{onClick:()=>h(!0),className:"inline-flex items-center gap-2 rounded-2xl px-6 py-3 text-sm font-semibold shadow-lg transition hover:-translate-y-0.5 hover:shadow-xl "+(r?"bg-white/10 text-white border border-white/20 hover:bg-white/15 hover:border-white/30":"bg-gradient-to-r from-blue-500 to-purple-500 text-white hover:from-blue-600 hover:to-purple-600"),children:[U.jsx(Ws,{className:"h-5 w-5"}),"Edit Profile"]}),U.jsxs("button",{onClick:()=>k(!0),className:"inline-flex items-center gap-2 rounded-2xl px-6 py-3 text-sm font-semibold bg-red-500/80 text-white border border-red-400/50 hover:bg-red-600 transition hover:-translate-y-0.5 shadow-lg hover:shadow-xl",children:[U.jsx(Rr,{className:"h-5 w-5"}),"Delete Account"]})]})})]})]})}),U.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[U.jsxs("section",{className:"rounded-[32px] border px-8 py-9 shadow-2xl backdrop-blur-xl "+(r?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[U.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 via-purple-500 to-blue-600 text-white shadow-lg",children:U.jsx(Nr,{className:"h-6 w-6"})}),U.jsx("h2",{className:"text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:"Contact Information"})]}),U.jsxs("div",{className:"space-y-5",children:[U.jsxs("div",{children:[U.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[U.jsx(Is,{className:"h-4 w-4 "+(r?"text-blue-400":"text-blue-600")}),U.jsx("span",{className:"text-sm font-semibold "+(r?"text-white/90":"text-slate-700"),children:"Email Address"}),U.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+(r?"text-blue-400 bg-blue-500/20":"text-blue-600 bg-blue-50"),children:"Read-only"})]}),U.jsx("div",{className:"rounded-xl p-4 border "+(r?"border-white/10 bg-white/5":"border-slate-200 bg-slate-50"),children:U.jsx("span",{className:"font-medium "+(r?"text-white":"text-slate-900"),children:t.email})})]}),U.jsxs("div",{children:[U.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[U.jsx(Gs,{className:"h-4 w-4 "+(r?"text-green-400":"text-green-600")}),U.jsxs("span",{className:"text-sm font-semibold "+(r?"text-white/90":"text-slate-700"),children:["Phone Number",(null==t?void 0:t.phoneVerified)&&U.jsx("span",{className:"ml-2 text-xs text-green-500",children:" Verified"}),T&&U.jsx("span",{className:"ml-2 text-xs text-orange-500",children:" Needs verification"})]})]}),i?U.jsxs("div",{className:"space-y-2",children:[U.jsx(Bn,{value:p.phone,onChange:e=>R("phone",e),placeholder:"Enter your phone number"}),T&&p.phone&&U.jsx("button",{type:"button",onClick:()=>A(!0),className:"text-sm font-medium transition-all "+(r?"text-purple-400 hover:text-purple-300":"text-purple-600 hover:text-purple-700"),children:"Verify phone number"})]}):U.jsx("div",{className:"rounded-xl p-4 border "+(r?"border-white/10 bg-white/5":"border-slate-200 bg-slate-50"),children:U.jsx("span",{className:"font-medium "+(r?"text-white":"text-slate-900"),children:t.phone||"Not provided"})})]}),U.jsxs("div",{children:[U.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[U.jsx(Ps,{className:"h-4 w-4 "+(r?"text-purple-400":"text-purple-600")}),U.jsx("span",{className:"text-sm font-semibold "+(r?"text-white/90":"text-slate-700"),children:"Location"})]}),i?U.jsx("input",{type:"text",value:p.location,onChange:e=>R("location",e.target.value),placeholder:"Enter your location",className:"w-full rounded-xl px-4 py-3 transition-all "+(r?"bg-white/10 border-2 border-white/20 text-white placeholder-white/40 focus:border-purple-400/50 focus:ring-2 focus:ring-purple-500/30":"bg-white border-2 border-slate-200 text-slate-900 placeholder-slate-400 focus:border-purple-300 focus:ring-2 focus:ring-purple-500/20")}):U.jsx("div",{className:"rounded-xl p-4 border "+(r?"border-white/10 bg-white/5":"border-slate-200 bg-slate-50"),children:U.jsx("span",{className:"font-medium "+(r?"text-white":"text-slate-900"),children:t.location||"Not provided"})})]}),U.jsxs("div",{children:[U.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[U.jsx(Pt,{className:"h-4 w-4 "+(r?"text-indigo-400":"text-indigo-600")}),U.jsx("span",{className:"text-sm font-semibold "+(r?"text-white/90":"text-slate-700"),children:"School"})]}),i?U.jsx("input",{type:"text",value:p.school,onChange:e=>R("school",e.target.value),placeholder:"Enter your school name",className:"w-full rounded-xl px-4 py-3 transition-all "+(r?"bg-white/10 border-2 border-white/20 text-white placeholder-white/40 focus:border-indigo-400/50 focus:ring-2 focus:ring-indigo-500/30":"bg-white border-2 border-slate-200 text-slate-900 placeholder-slate-400 focus:border-indigo-300 focus:ring-2 focus:ring-indigo-500/20")}):U.jsx("div",{className:"rounded-xl p-4 border "+(r?"border-white/10 bg-white/5":"border-slate-200 bg-slate-50"),children:U.jsx("span",{className:"font-medium "+(r?"text-white":"text-slate-900"),children:t.school||"Not provided"})})]})]})]}),U.jsxs("section",{className:"rounded-[32px] border px-8 py-9 shadow-2xl backdrop-blur-xl "+(r?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[U.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-orange-500 via-red-500 to-orange-600 text-white shadow-lg",children:U.jsx(sr,{className:"h-6 w-6"})}),U.jsx("h2",{className:"text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:"Additional Information"})]}),U.jsxs("div",{className:"space-y-5",children:[U.jsxs("div",{children:[U.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[U.jsx(Ws,{className:"h-4 w-4 "+(r?"text-orange-400":"text-orange-600")}),U.jsx("span",{className:"text-sm font-semibold "+(r?"text-white/90":"text-slate-700"),children:"Bio"})]}),i?U.jsx("textarea",{value:p.bio,onChange:e=>R("bio",e.target.value),placeholder:"Tell us about yourself...",rows:4,className:"w-full rounded-xl px-4 py-3 resize-none transition-all "+(r?"bg-white/10 border-2 border-white/20 text-white placeholder-white/40 focus:border-orange-400/50 focus:ring-2 focus:ring-orange-500/30":"bg-white border-2 border-slate-200 text-slate-900 placeholder-slate-400 focus:border-orange-300 focus:ring-2 focus:ring-orange-500/20")}):U.jsx("div",{className:"rounded-xl p-4 border min-h-[100px] "+(r?"border-white/10 bg-white/5":"border-slate-200 bg-slate-50"),children:U.jsx("span",{className:"font-medium leading-relaxed "+(r?"text-white":"text-slate-900"),children:t.bio||"No bio provided"})})]}),U.jsxs("div",{children:[U.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[U.jsx(Pt,{className:"h-4 w-4 "+(r?"text-teal-400":"text-teal-600")}),U.jsx("span",{className:"text-sm font-semibold "+(r?"text-white/90":"text-slate-700"),children:"Subjects"})]}),i?U.jsxs("div",{className:"space-y-4",children:[U.jsx("div",{className:"rounded-2xl border p-4 max-h-64 overflow-y-auto "+(r?"border-white/10 bg-white/5":"border-slate-200 bg-white"),children:U.jsx("div",{className:"grid grid-cols-2 gap-3",children:["Mathematics","Physics","Chemistry","Biology","English","History","Geography","Computer Science","Programming","Art","Music","Physical Education","Psychology","Economics","Business","Languages"].map(e=>U.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer group",children:[U.jsx("input",{type:"checkbox",checked:p.subjects.includes(e),onChange:()=>(e=>{const t=p.subjects.includes(e)?p.subjects.filter(t=>t!==e):[...p.subjects,e];g(e=>({...e,subjects:t}))})(e),className:"sr-only"}),U.jsx("div",{className:"w-5 h-5 border-2 rounded transition-all flex items-center justify-center "+(p.subjects.includes(e)?"bg-gradient-to-r from-blue-500 to-purple-500 border-blue-400":r?"bg-white/10 border-white/30 group-hover:bg-blue-500/20":"bg-white border-slate-300 group-hover:bg-blue-50"),children:p.subjects.includes(e)&&U.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:U.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),U.jsx("span",{className:""+(r?"text-white/80":"text-slate-700"),children:e})]},e))})}),p.subjects.length>0&&U.jsxs("div",{className:"rounded-xl p-4 border "+(r?"border-blue-400/30 bg-blue-500/20":"border-blue-200 bg-blue-50"),children:[U.jsx("p",{className:"text-sm font-medium mb-2 "+(r?"text-blue-300":"text-blue-800"),children:"Selected Subjects:"}),U.jsx("div",{className:"flex flex-wrap gap-2",children:p.subjects.map(e=>U.jsx("span",{className:"px-3 py-1 bg-gradient-to-r from-blue-500 to-purple-500 text-white text-sm rounded-full shadow-sm",children:e},e))})]})]}):U.jsx("div",{className:"rounded-xl p-4 border min-h-[60px] "+(r?"border-blue-400/30 bg-blue-500/20":"border-blue-100 bg-blue-50"),children:t.subjects&&t.subjects.length>0?U.jsx("div",{className:"flex flex-wrap gap-2",children:t.subjects.map((e,t)=>U.jsx("span",{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-4 py-2 rounded-full text-sm font-medium shadow-sm",children:e},t))}):U.jsx("span",{className:"text-sm "+(r?"text-white/60":"text-slate-500"),children:"No subjects selected"})})]})]})]})]}),(null==t?void 0:t.isTutor)&&U.jsxs("section",{className:"rounded-[32px] border px-8 py-9 shadow-2xl backdrop-blur-xl "+(r?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[U.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-red-500 via-orange-500 to-red-600 text-white shadow-lg",children:U.jsx(sr,{className:"h-6 w-6"})}),U.jsx("h2",{className:"text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:"Tutor Settings"})]}),U.jsx("div",{className:"rounded-xl p-6 border "+(r?"border-white/10 bg-white/5":"border-slate-200 bg-slate-50"),children:U.jsx(Un,{user:t,onSuccess:()=>{t.isTutor=!1,localStorage.setItem("simpleUser",JSON.stringify(t)),window.location.reload()}})})]})]}),N&&U.jsx(Fn,{isOpen:N,onClose:()=>k(!1),onConfirm:async()=>{try{C(!0);const e=await(async e=>{try{const t=o(dt,"sessions"),s=l(t,c("studentId","==",e)),r=l(t,c("tutorId","==",e)),[a,n]=await Promise.all([d(s),d(r)]),i=[];return a.forEach(e=>i.push(f(u(dt,"sessions",e.id)))),n.forEach(e=>i.push(f(u(dt,"sessions",e.id)))),await Promise.all(i),await f(u(dt,"users",e)),{success:!0}}catch(t){return console.error("Error deleting user account:",t),{success:!1,error:t.message}}})(null==t?void 0:t.id);e.success?(a("Account deleted successfully",4e3,"Success"),localStorage.removeItem("simpleUser"),window.location.href="/"):n(e.error||"Failed to delete account",5e3,"Error")}finally{C(!1)}},title:"Delete Account",message:"This action will permanently delete your account and all related sessions. This cannot be undone.",confirmText:S?"Deleting...":"Delete",cancelText:"Cancel",loading:S,userName:(null==t?void 0:t.name)||"User"}),U.jsx(Ta,{isOpen:E,onClose:()=>A(!1),phoneNumber:p.phone,onVerified:()=>{I(!1),q(p.phone),A(!1),a("Phone number verified! You can now save your profile.",3e3,"Success")}})]}):U.jsx("div",{className:"min-h-screen flex items-center justify-center "+(r?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b]":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100"),children:U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg bg-gradient-to-r from-blue-500 to-purple-600",children:U.jsx(Nr,{className:"w-8 h-8 text-white animate-pulse"})}),U.jsx("h3",{className:"text-lg font-semibold mb-2 "+(r?"text-white":"text-slate-900"),children:"Loading Profile"}),U.jsx("p",{className:"text-sm "+(r?"text-white/70":"text-slate-600"),children:"Loading your information..."})]})})},zn=async(e,t)=>{try{const s=Math.floor(1e5+9e5*Math.random()).toString(),r={code:s,sessionId:e.id,subject:e.subject,creator:{id:t.id,name:t.name,role:t.role||"tutor"},participants:[{id:t.id,name:t.name,role:t.role||"tutor",joinedAt:(new Date).toISOString()}],status:"active",createdAt:p(),startedAt:p(),channelName:`meeting-${s}`,metadata:{sessionType:e.type||"tutoring",expectedParticipants:e.student?[e.student.id]:[],maxParticipants:10}},a=u(dt,"meetings",s);return await h(a,r),console.log(" :",s),{success:!0,meetingCode:s,meetingData:r}}catch(s){return console.error(" :",s),{success:!1,error:s.message}}},Wn=({isOpen:t,onClose:s,currentProfile:r})=>{const{showSuccess:a,showError:n}=Hr(),{user:i,reloadUser:o}=Br(),[l,c]=e.useState(!1),[d,h]=e.useState({isAvailable:!0,specialties:[],description:"",experience:"Student",responseTime:"Usually responds within a few hours"});e.useEffect(()=>{r&&t&&h({isAvailable:!1!==r.isAvailable,specialties:r.specialties||[],description:r.description||"",experience:r.experience||"Student",responseTime:r.responseTime||"Usually responds within a few hours"})},[r,t]);const m=e=>{const{name:t,value:s,type:r,checked:a}=e.target;h(e=>({...e,[t]:"checkbox"===r?a:s}))};return t?U.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:U.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[U.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[U.jsxs("div",{className:"flex items-center space-x-3",children:[U.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center",children:U.jsx(Nr,{className:"w-5 h-5 text-white"})}),U.jsxs("div",{children:[U.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Edit Tutor Profile"}),U.jsx("p",{className:"text-sm text-gray-600",children:"Update your tutoring information"})]})]}),U.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:U.jsx(Rr,{className:"w-5 h-5 text-gray-500"})})]}),U.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),null==i?void 0:i.id)if(0!==d.specialties.length)if(d.description.trim())try{c(!0);const e=u(dt,"users",i.id);await x(e,{tutorProfile:{isAvailable:d.isAvailable,specialties:d.specialties,description:d.description.trim(),experience:d.experience,responseTime:d.responseTime,updatedAt:p()},subjects:d.specialties,updatedAt:p()});const t={...i,tutorProfile:{...i.tutorProfile,isAvailable:d.isAvailable,specialties:d.specialties,description:d.description.trim(),experience:d.experience,responseTime:d.responseTime,updatedAt:new Date},subjects:d.specialties};localStorage.setItem("simpleUser",JSON.stringify(t)),o(),a("Tutor profile updated successfully!","Profile Updated"),s()}catch(t){console.error("Error updating tutor profile:",t),n(`Failed to update profile: ${t.message}`,"Update Failed")}finally{c(!1)}else n("Please provide a description","Validation Error");else n("Please select at least one specialty","Validation Error");else n("User not found","Error")},className:"p-6 space-y-6",children:[U.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-4 border border-green-100",children:[U.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[U.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg flex items-center justify-center",children:U.jsx(bt,{className:"w-4 h-4 text-white"})}),U.jsx("span",{className:"font-semibold text-gray-900",children:"Availability"})]}),U.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[U.jsx("input",{type:"checkbox",name:"isAvailable",checked:d.isAvailable,onChange:m,className:"w-5 h-5 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500 focus:ring-2"}),U.jsx("span",{className:"text-gray-700",children:"I'm available for tutoring sessions"})]})]}),U.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-4 border border-blue-100",children:[U.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[U.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg flex items-center justify-center",children:U.jsx(Pt,{className:"w-4 h-4 text-white"})}),U.jsx("span",{className:"font-semibold text-gray-900",children:"Specialties *"})]}),U.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:["Mathematics","Science","Physics","Chemistry","Biology","English","Literature","Writing","History","Geography","Art","Music","Programming","Computer Science","Economics","Psychology","Philosophy","Languages","Other"].map(e=>U.jsxs("label",{className:"flex items-center space-x-2 p-3 rounded-lg border-2 cursor-pointer transition-all "+(d.specialties.includes(e)?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300 text-gray-700"),children:[U.jsx("input",{type:"checkbox",checked:d.specialties.includes(e),onChange:()=>{return t=e,void h(e=>({...e,specialties:e.specialties.includes(t)?e.specialties.filter(e=>e!==t):[...e.specialties,t]}));var t},className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}),U.jsx("span",{className:"text-sm font-medium",children:e})]},e))}),0===d.specialties.length&&U.jsx("p",{className:"text-red-500 text-sm mt-2",children:"Please select at least one specialty"})]}),U.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-4 border border-purple-100",children:[U.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[U.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:U.jsx(Nr,{className:"w-4 h-4 text-white"})}),U.jsx("span",{className:"font-semibold text-gray-900",children:"Description *"})]}),U.jsx("textarea",{name:"description",value:d.description,onChange:m,placeholder:"Tell students about your teaching style, experience, and what makes you a great tutor...",className:"w-full p-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none text-gray-900 placeholder:text-gray-400 bg-white",rows:4,required:!0}),U.jsxs("p",{className:"text-gray-500 text-sm mt-2",children:[d.description.length,"/500 characters"]})]}),U.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 rounded-xl p-4 border border-orange-100",children:[U.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[U.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-orange-500 to-red-500 rounded-lg flex items-center justify-center",children:U.jsx(or,{className:"w-4 h-4 text-white"})}),U.jsx("span",{className:"font-semibold text-gray-900",children:"Experience Level"})]}),U.jsx("select",{name:"experience",value:d.experience,onChange:m,className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-transparent text-gray-900 bg-white",children:["Student","Recent Graduate","Graduate Student","Professional","Teacher/Professor"].map(e=>U.jsx("option",{value:e,children:e},e))})]}),U.jsxs("div",{className:"bg-gradient-to-r from-cyan-50 to-blue-50 rounded-xl p-4 border border-cyan-100",children:[U.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[U.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-lg flex items-center justify-center",children:U.jsx(Ht,{className:"w-4 h-4 text-white"})}),U.jsx("span",{className:"font-semibold text-gray-900",children:"Response Time"})]}),U.jsx("select",{name:"responseTime",value:d.responseTime,onChange:m,className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-gray-900 bg-white",children:["Usually responds within a few hours","Usually responds within a day","Usually responds within a few days"].map(e=>U.jsx("option",{value:e,children:e},e))})]}),U.jsxs("div",{className:"flex space-x-4 pt-4 border-t border-gray-200",children:[U.jsx("button",{type:"button",onClick:s,className:"flex-1 py-3 px-6 border-2 border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),U.jsx("button",{type:"submit",disabled:l||0===d.specialties.length||!d.description.trim(),className:"flex-1 py-3 px-6 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl hover:from-blue-600 hover:to-purple-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center space-x-2",children:l?U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),U.jsx("span",{children:"Updating..."})]}):U.jsxs(U.Fragment,{children:[U.jsx(Zs,{className:"w-4 h-4"}),U.jsx("span",{children:"Update Profile"})]})})]})]})]})}):null},Hn=({tutorId:t})=>{const{isDark:s}=mt(),[r,a]=e.useState({totalEarnings:0,pendingEarnings:0,completedSessions:0,recentPayments:[],pendingInvoices:[]}),[n,i]=e.useState(!0),[o,l]=e.useState(!1),[c,d]=e.useState(!1),u=e.useCallback(async(e=!1)=>{if(t){e?d(!0):i(!0);try{console.log(" Loading wallet for tutor:",t);const e=await fn(t);console.log(" Wallet result:",e),e.success&&(a(e.wallet),l(!0),setTimeout(()=>l(!1),1e3))}catch(s){console.error("Error loading wallet:",s)}finally{i(!1),d(!1)}}},[t]);e.useEffect(()=>{u()},[u]);const h=e=>{if(!e)return"N/A";try{return(e.toDate?e.toDate():new Date(e)).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return"N/A"}};return n?U.jsx("div",{className:"rounded-[28px] border p-6 backdrop-blur-xl "+(s?"border-white/10 bg-gradient-to-br from-white/10 to-white/5":"border-white/70 bg-white"),children:U.jsx("div",{className:"flex items-center justify-center py-8",children:U.jsx("div",{className:"w-8 h-8 border-3 border-purple-500 border-t-transparent rounded-full animate-spin"})})}):U.jsxs("div",{className:"rounded-[28px] border overflow-hidden backdrop-blur-xl "+(s?"border-white/10 bg-gradient-to-br from-emerald-900/30 via-teal-900/20 to-cyan-900/30":"border-emerald-100 bg-gradient-to-br from-emerald-50 via-teal-50 to-cyan-50"),children:[U.jsxs("div",{className:"relative p-6 overflow-hidden",children:[U.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[U.jsx("div",{className:`absolute -top-20 -right-20 w-40 h-40 rounded-full blur-3xl transition-all duration-1000 ${o?"scale-150 opacity-60":"scale-100 opacity-30"} ${s?"bg-emerald-500":"bg-emerald-300"}`}),U.jsx("div",{className:`absolute -bottom-10 -left-10 w-32 h-32 rounded-full blur-2xl transition-all duration-1000 delay-100 ${o?"scale-125 opacity-50":"scale-100 opacity-25"} ${s?"bg-teal-500":"bg-teal-300"}`}),U.jsx("div",{className:"absolute inset-0 pointer-events-none",children:[...Array(5)].map((e,t)=>U.jsx("div",{className:"absolute animate-bounce "+(s?"text-yellow-400/20":"text-yellow-500/30"),style:{left:15+18*t+"%",top:10+t%3*25+"%",animationDelay:.2*t+"s",animationDuration:2+.3*t+"s"},children:U.jsx(Yt,{className:"w-4 h-4"})},t))})]}),U.jsxs("div",{className:"relative flex items-center justify-between mb-6",children:[U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsxs("div",{className:"relative p-4 rounded-2xl shadow-lg "+(s?"bg-gradient-to-br from-emerald-500 to-teal-600":"bg-gradient-to-br from-emerald-400 to-teal-500"),children:[U.jsx(Tr,{className:"w-8 h-8 text-white"}),U.jsx(nr,{className:"absolute -top-1 -right-1 w-4 h-4 text-yellow-300 "+(o?"animate-ping":"")})]}),U.jsxs("div",{children:[U.jsx("h3",{className:"text-lg font-bold "+(s?"text-white":"text-slate-900"),children:"My Wallet"}),U.jsx("p",{className:"text-sm "+(s?"text-white/60":"text-slate-500"),children:"Your tutoring earnings"})]})]}),U.jsx("button",{onClick:()=>{u(!0)},disabled:c,className:"p-2 rounded-xl transition-all "+(c?"opacity-50 cursor-not-allowed":s?"hover:bg-white/10 text-white/60 hover:text-white":"hover:bg-slate-100 text-slate-400 hover:text-slate-600"),title:"Refresh wallet",children:U.jsx(Js,{className:"w-5 h-5 "+(c?"animate-spin":"")})})]}),U.jsxs("div",{className:"relative",children:[U.jsx("div",{className:"text-sm font-medium mb-1 "+(s?"text-emerald-300":"text-emerald-600"),children:"Total Earned"}),U.jsxs("div",{className:"flex items-baseline gap-2 "+(o?"animate-pulse":""),children:[U.jsxs("span",{className:"text-4xl font-black tracking-tight "+(s?"text-white drop-shadow-[0_0_15px_rgba(16,185,129,0.5)]":"text-slate-900"),children:["",r.totalEarnings.toFixed(2)]}),r.totalEarnings>0&&U.jsxs("span",{className:"flex items-center gap-1 text-emerald-500 text-sm font-semibold",children:[U.jsx(br,{className:"w-4 h-4"}),"Active"]})]})]})]}),U.jsxs("div",{className:"grid grid-cols-2 gap-3 px-6 py-4 "+(s?"bg-white/5":"bg-white/50"),children:[U.jsxs("div",{className:"rounded-xl p-4 "+(s?"bg-white/5":"bg-white"),children:[U.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[U.jsx(Ht,{className:"w-4 h-4 "+(s?"text-orange-400":"text-orange-500")}),U.jsx("span",{className:"text-xs font-medium "+(s?"text-white/60":"text-slate-500"),children:"Pending"})]}),U.jsxs("p",{className:"text-xl font-bold "+(s?"text-orange-400":"text-orange-600"),children:["",r.pendingEarnings.toFixed(2)]})]}),U.jsxs("div",{className:"rounded-xl p-4 "+(s?"bg-white/5":"bg-white"),children:[U.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[U.jsx(kr,{className:"w-4 h-4 "+(s?"text-purple-400":"text-purple-500")}),U.jsx("span",{className:"text-xs font-medium "+(s?"text-white/60":"text-slate-500"),children:"Sessions"})]}),U.jsx("p",{className:"text-xl font-bold "+(s?"text-purple-400":"text-purple-600"),children:r.completedSessions})]})]}),U.jsxs("div",{className:"px-6 py-4",children:[U.jsx("h4",{className:"text-sm font-semibold mb-3 "+(s?"text-white/80":"text-slate-700"),children:"Recent Payments"}),r.recentPayments.length>0?U.jsx("div",{className:"space-y-2",children:r.recentPayments.slice(0,3).map((e,t)=>{var r;return U.jsxs("div",{className:"flex items-center justify-between rounded-xl p-3 transition-all hover:scale-[1.02] "+(s?"bg-white/5 hover:bg-white/10":"bg-slate-50 hover:bg-slate-100"),style:{animationDelay:.1*t+"s"},children:[U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx("div",{className:"p-2 rounded-lg "+(s?"bg-emerald-500/20":"bg-emerald-100"),children:U.jsx($t,{className:"w-4 h-4 text-emerald-500"})}),U.jsxs("div",{children:[U.jsx("p",{className:"text-sm font-medium "+(s?"text-white":"text-slate-900"),children:e.studentName}),U.jsxs("p",{className:"text-xs "+(s?"text-white/50":"text-slate-500"),children:[e.subject,"  ",h(e.paidAt)]})]})]}),U.jsxs("span",{className:"text-sm font-bold "+(s?"text-emerald-400":"text-emerald-600"),children:["+",null==(r=e.tutorEarnings)?void 0:r.toFixed(2)]})]},e.id)})}):U.jsxs("div",{className:"rounded-xl p-4 text-center "+(s?"bg-white/5":"bg-slate-50"),children:[U.jsx(kt,{className:"w-8 h-8 mx-auto mb-2 "+(s?"text-white/30":"text-slate-300")}),U.jsx("p",{className:"text-sm "+(s?"text-white/50":"text-slate-500"),children:"No payments yet"})]})]}),r.pendingInvoices.length>0&&U.jsx("div",{className:"mx-6 mb-6 rounded-xl p-4 "+(s?"bg-gradient-to-r from-orange-500/20 to-amber-500/20 border border-orange-500/30":"bg-gradient-to-r from-orange-50 to-amber-50 border border-orange-200"),children:U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx("div",{className:"p-2 rounded-lg "+(s?"bg-orange-500/30":"bg-orange-100"),children:U.jsx(Ht,{className:"w-5 h-5 text-orange-500"})}),U.jsxs("div",{className:"flex-1",children:[U.jsxs("p",{className:"text-sm font-semibold "+(s?"text-orange-300":"text-orange-700"),children:[r.pendingInvoices.length," Pending Invoice",r.pendingInvoices.length>1?"s":""]}),U.jsx("p",{className:"text-xs "+(s?"text-orange-300/70":"text-orange-600"),children:"Waiting for student payments"})]}),U.jsxs("div",{className:"text-lg font-bold "+(s?"text-orange-400":"text-orange-600"),children:["",r.pendingInvoices.reduce((e,t)=>e+(t.tutorEarnings||0),0).toFixed(2)]})]})}),U.jsx("div",{className:"px-6 pb-6",children:U.jsx("div",{className:"rounded-xl p-3 text-center "+(s?"bg-white/5":"bg-slate-50"),children:U.jsx("p",{className:"text-xs "+(s?"text-white/40":"text-slate-400"),children:" 20% platform fee is already deducted from displayed earnings"})})})]})},Gn=()=>{const{user:t}=Br(),{isDark:s}=mt(),{showSuccess:r,showError:a}=Hr(),n=qe(),[i,h]=e.useState([]),[b,f]=e.useState(!0),[w,v]=e.useState("requests"),[j,N]=e.useState([]),[k,S]=e.useState(!1),[C,E]=e.useState(0),[A,T]=e.useState([]),[I,P]=e.useState(!1),[q,R]=e.useState(!1),[M,D]=e.useState(null),[L,F]=e.useState(!1),[$,O]=e.useState(1);e.useEffect(()=>{let e=null;const s=()=>{if(e&&"function"==typeof e)try{e()}catch(t){console.error("Error cleaning up sessions listener:",t)}};if(!(null==t?void 0:t.id))return s;if(!t.isTutor)return a("Your tutor profile has been removed. You no longer have access to the tutor dashboard.","Access Revoked"),s;f(!0);const r=o(dt,"sessions"),n=l(r,c("tutorId","==",null==t?void 0:t.id));return e=g(n,async e=>{const t=[];for(const s of e.docs){const e=s.data();let r={id:e.studentId,name:"Unknown",email:"",avatar:null};try{const t=await m(u(dt,"users",e.studentId));if(t.exists()){const s=t.data();r={id:e.studentId,name:s.name||"Unknown",email:s.email||"",avatar:s.avatar||null}}}catch(To){}t.push({id:s.id,...e,student:r})}t.sort((e,t)=>{const s=qa(e.createdAt);return qa(t.createdAt)-s}),h(t),f(!1)}),s},[null==t?void 0:t.id,null==t?void 0:t.isTutor]),e.useEffect(()=>{if(!(null==t?void 0:t.id)||!(null==t?void 0:t.isTutor))return;const e=Tn(t.id,async e=>{if(E(e),e>0)try{const e=await(async e=>{try{const t=o(dt,"messages"),s=l(t,c("receiverId","==",e),c("read","==",!1),c("chatType","==","tutor")),r=await d(s),a=new Set,n=r.docs.map(async e=>{const t=e.data();try{const e=await m(u(dt,"users",t.senderId));e.exists()&&!0!==e.data().isTutor&&a.add(t.senderId)}catch(s){console.error("Error verifying sender:",s)}});return await Promise.all(n),{success:!0,studentIds:Array.from(a)}}catch(t){return console.error("Error getting unread students list:",t),{success:!1,studentIds:[],error:"Failed to get unread students list"}}})(t.id);if(e.success&&e.studentIds.length>0){const t=e.studentIds.map(async e=>{try{const t=await m(u(dt,"users",e));if(t.exists())return{id:e,name:t.data().name||"Student"}}catch(t){console.error("Error getting student info:",t)}return null}),s=(await Promise.all(t)).filter(Boolean);T(s)}else T([])}catch(s){console.error("Error getting unread students list:",s)}else T([])});return()=>{e&&e()}},[null==t?void 0:t.id,null==t?void 0:t.isTutor]);const B=async()=>{try{f(!0),console.log("Loading sessions for tutor:",null==t?void 0:t.id);const e=await(async e=>{try{const s=o(dt,"sessions");let r;try{r=l(s,c("tutorId","==",e),y("createdAt","desc"));const t=await d(r);return{success:!0,sessions:await Ga(t)}}catch(t){if(((null==t?void 0:t.message)||"").includes("requires an index")){const t=l(s,c("tutorId","==",e)),r=await d(t),a=await Ga(r);return a.sort((e,t)=>{const s=qa(e.createdAt);return qa(t.createdAt)-s}),{success:!0,sessions:a}}throw t}}catch(s){return console.error("Error getting tutor sessions:",s),{success:!1,sessions:[],error:"Failed to get sessions"}}})(null==t?void 0:t.id);console.log("Sessions result:",e),e.success?(h(e.sessions),console.log("Loaded sessions:",e.sessions.length)):(console.error("Failed to load sessions:",e.error),a(`Failed to load tutoring sessions: ${e.error}`,5e3,"Error"))}catch(e){console.error("Error loading sessions:",e),a(`Error loading tutoring sessions: ${e.message}`,5e3,"Error")}finally{f(!1)}},_=async e=>{try{const s=await(async(e,t)=>{try{if(t){const e=await m(u(dt,"users",t));if(e.exists()){const s=e.data();if(!s.stripeConnectAccountId||"verified"!==s.stripeConnectStatus)return console.log(" Tutor has not set up bank account:",t),{success:!1,error:"Please set up your bank account before accepting sessions. Go to your dashboard to connect your bank account.",needsBankSetup:!0}}}const s=u(dt,"sessions",e);await x(s,{status:"accepted",acceptedAt:p(),updatedAt:p()});const r=(await m(s)).data();let a="Tutor";try{const e=await m(u(dt,"users",r.tutorId));if(e.exists()){const t=e.data();a=(null==t?void 0:t.name)||"Tutor"}}catch(To){}return await Ba(r.studentId,"success","Session accepted",`${a} accepted your ${r.subject} session`,{sessionId:e,role:"student",status:"accepted",fromName:a,subject:r.subject}),{success:!0,message:"Session request accepted"}}catch(s){return console.error("Error accepting session request:",s),{success:!1,error:"Failed to accept session request"}}})(e,null==t?void 0:t.id);s.success?(r("Session accepted successfully!",4e3,"Success"),B()):s.needsBankSetup?a('Please set up your bank account first to accept sessions. Scroll down to "Bank Account Setup".',8e3,"Bank Account Required"):a(`Failed to accept session: ${s.error}`,5e3,"Error")}catch(s){a("Failed to accept session",5e3,"Error"),console.error("Error accepting session:",s)}},z=async e=>{try{const t=await(async(e,t="")=>{try{const s=u(dt,"sessions",e);await x(s,{status:"rejected",rejectionReason:t,rejectedAt:p(),updatedAt:p()});const r=(await m(s)).data();let a="Tutor";try{const e=await m(u(dt,"users",r.tutorId));if(e.exists()){const t=e.data();a=(null==t?void 0:t.name)||"Tutor"}}catch(To){}return await Ba(r.studentId,"error","Session declined",`${a} declined your ${r.subject} session`,{sessionId:e,role:"student",status:"rejected",fromName:a,subject:r.subject}),{success:!0,message:"Session request rejected"}}catch(s){return console.error("Error rejecting session request:",s),{success:!1,error:"Failed to reject session request"}}})(e);t.success?(r("Session declined",4e3,"Success"),B()):a(`Failed to decline session: ${t.error}`,5e3,"Error")}catch(t){a("Failed to decline session",5e3,"Error"),console.error("Error declining session:",t)}},W=e=>{switch(e){case"pending":return U.jsx(Ht,{className:"w-4 h-4"});case"accepted":return U.jsx($t,{className:"w-4 h-4"});case"active":return U.jsx(Vs,{className:"w-4 h-4"});case"completed":return U.jsx(or,{className:"w-4 h-4"});case"cancelled":return U.jsx(qr,{className:"w-4 h-4"});default:return U.jsx(bt,{className:"w-4 h-4"})}},H=e=>{if(!e)return"Flexible";try{const t=Pa(e);return isNaN(t.getTime())?"Flexible":`${t.toLocaleDateString()} ${t.toLocaleTimeString()}`}catch(t){return console.error("Error formatting time:",t),"Flexible"}},G=e=>{if(!e)return"Unknown";try{const t=Pa(e);return t.toLocaleDateString()+" "+t.toLocaleTimeString()}catch(t){return console.error("Error formatting date:",t),"Unknown"}};if(e.useEffect(()=>{let e=null;const s=()=>{if(e&&"function"==typeof e)try{e()}catch(t){console.error("Error cleaning up chat list listener:",t)}};return(null==t?void 0:t.id)&&"chat"===w?(S(!0),e=En(t.id,async e=>{if(e.success){const t=await Promise.all(e.chatList.map(async e=>{try{const t=await m(u(dt,"users",e.userId));if(t.exists()){const s=t.data();return{...e,user:{id:e.userId,name:s.name||"Unknown",email:s.email||"",avatar:s.avatar||null}}}return{...e,user:{id:e.userId,name:"Unknown",email:"",avatar:null}}}catch(t){return console.error("Error getting user info:",t),{...e,user:{id:e.userId,name:"Unknown",email:"",avatar:null}}}}));N(t)}S(!1)},"tutor"),s):(N([]),S(!1),s)},[null==t?void 0:t.id,w]),b)return U.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center",children:U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center mx-auto mb-4 shadow-lg",children:U.jsx(Pt,{className:"w-8 h-8 text-white animate-pulse"})}),U.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Loading Dashboard"}),U.jsx("p",{className:"text-gray-600 text-sm",children:"Loading your tutoring sessions..."})]})});const V=i.filter(e=>"pending"===e.status),Y=i.filter(e=>"accepted"===e.status||"active"===e.status),Q=i.filter(e=>"active"===e.status),J=i.filter(e=>"completed"===e.status),K=Math.ceil(J.length/4),X=4*($-1),Z=X+4,ee=J.slice(X,Z),te=[{id:"pending",title:"Pending requests",value:V.length,description:"Awaiting your response",iconGradient:"from-yellow-400 via-orange-400 to-pink-500",accent:"text-yellow-300",icon:Ht},{id:"accepted",title:"Accepted / active",value:Y.length,description:"Ready to host",iconGradient:"from-emerald-400 via-teal-400 to-emerald-600",accent:"text-emerald-200",icon:$t},{id:"live",title:"Live now",value:Q.length,description:"Sessions in progress",iconGradient:"from-blue-400 via-indigo-400 to-purple-500",accent:"text-blue-200",icon:Vs},{id:"rating",title:"Rating",value:(null==t?void 0:t.rating)?Number(t.rating).toFixed(1):"N/A",description:"Student feedback score",iconGradient:"from-purple-400 via-pink-400 to-rose-500",accent:"text-purple-200",icon:or}],se=[{id:"requests",name:"Pending Requests",count:V.length},{id:"accepted",name:"Accepted Sessions",count:Y.length},{id:"completed",name:"Completed Sessions",count:J.length},{id:"chat",name:"Chat",count:j.length}],re=e=>{var n,i,o;return U.jsxs("div",{className:"group backdrop-blur-sm rounded-2xl shadow-lg border p-6 hover:shadow-2xl transition-all duration-300 hover:scale-[1.02] overflow-hidden relative "+(s?"bg-white/10 border-white/20":"bg-white/80 border-white/20"),children:[U.jsxs("div",{className:"absolute inset-0 opacity-5",children:[U.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-gray-400 to-gray-600 rounded-full -translate-y-10 translate-x-10"}),U.jsx("div",{className:"absolute bottom-0 left-0 w-16 h-16 bg-gradient-to-br from-gray-400 to-gray-600 rounded-full translate-y-8 -translate-x-8"})]}),U.jsxs("div",{className:"relative z-10",children:[U.jsxs("div",{className:"flex items-start justify-between mb-6",children:[U.jsxs("div",{className:"flex items-center space-x-4",children:[U.jsx(Za,{user:e.student,size:"xl",className:"group-hover:scale-110 transition-transform duration-300"}),U.jsxs("div",{children:[U.jsx("h3",{className:"font-bold text-lg "+(s?"text-white":"text-gray-900"),children:(null==(n=e.student)?void 0:n.name)||"Unknown Student"}),U.jsx("p",{className:""+(s?"text-gray-300":"text-gray-600"),children:(null==(i=e.student)?void 0:i.email)||"No email"})]})]}),U.jsxs("div",{className:"flex items-center space-x-2 px-4 py-2 rounded-xl text-sm font-medium shadow-lg "+("pending"===e.status?"bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-800 border border-yellow-200":"accepted"===e.status?"bg-gradient-to-r from-green-100 to-emerald-100 text-green-800 border border-green-200":"active"===e.status?"bg-gradient-to-r from-blue-100 to-cyan-100 text-blue-800 border border-blue-200":"completed"===e.status?"bg-gradient-to-r from-purple-100 to-indigo-100 text-purple-800 border border-purple-200":"bg-gradient-to-r from-gray-100 to-gray-200 text-gray-800 border border-gray-300"),children:[W(e.status),U.jsx("span",{className:"capitalize font-bold",children:e.status})]})]}),U.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[U.jsxs("div",{className:"rounded-xl p-4 border "+(s?"bg-white/10 border-white/20":"bg-gradient-to-r from-blue-50 to-purple-50 border-blue-100"),children:[U.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[U.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg flex items-center justify-center",children:U.jsx(Pt,{className:"w-4 h-4 text-white"})}),U.jsx("span",{className:"text-sm font-medium "+(s?"text-gray-300":"text-gray-700"),children:"Subject"})]}),U.jsx("span",{className:"font-bold "+(s?"text-white":"text-gray-900"),children:e.subject})]}),U.jsxs("div",{className:"rounded-xl p-4 border "+(s?"bg-white/10 border-white/20":"bg-gradient-to-r from-green-50 to-emerald-50 border-green-100"),children:[U.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[U.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg flex items-center justify-center",children:U.jsx(Lt,{className:"w-4 h-4 text-white"})}),U.jsx("span",{className:"text-sm font-medium "+(s?"text-gray-300":"text-gray-700"),children:"Time"})]}),U.jsx("span",{className:"font-bold "+(s?"text-white":"text-gray-900"),children:H(e.preferredTime)})]}),U.jsxs("div",{className:"rounded-xl p-4 border "+(s?"bg-white/10 border-white/20":"bg-gradient-to-r from-purple-50 to-pink-50 border-purple-100"),children:[U.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[U.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:U.jsx(Ht,{className:"w-4 h-4 text-white"})}),U.jsx("span",{className:"text-sm font-medium "+(s?"text-gray-300":"text-gray-700"),children:"Duration"})]}),U.jsx("span",{className:"font-bold "+(s?"text-white":"text-gray-900"),children:(o=e.duration,`${Number.isFinite(o)?o:60} min`)})]})]}),e.description&&U.jsx("div",{className:"mb-6 rounded-xl p-4 border "+(s?"bg-white/10 border-white/20":"bg-gradient-to-r from-gray-50 to-blue-50 border-gray-100"),children:U.jsxs("p",{className:""+(s?"text-gray-300":"text-gray-700"),children:[U.jsx("span",{className:"font-bold "+(s?"text-white":"text-gray-900"),children:"Request:"})," ",e.description]})}),U.jsxs("div",{className:"text-sm mb-6 font-medium "+(s?"text-gray-400":"text-gray-500"),children:["Requested on: ",G(e.createdAt)]}),"pending"===e.status&&U.jsxs("div",{className:"flex space-x-3",children:[U.jsxs("button",{onClick:()=>_(e.id),className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-500 text-white py-3 px-6 rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all duration-200 flex items-center justify-center font-bold shadow-lg hover:shadow-xl hover:scale-105 transform",children:[U.jsx($t,{className:"w-5 h-5 mr-2"}),"Accept"]}),U.jsxs("button",{onClick:()=>z(e.id),className:"flex-1 bg-gradient-to-r from-red-500 to-pink-500 text-white py-3 px-6 rounded-xl hover:from-red-600 hover:to-pink-600 transition-all duration-200 flex items-center justify-center font-bold shadow-lg hover:shadow-xl hover:scale-105 transform",children:[U.jsx(qr,{className:"w-5 h-5 mr-2"}),"Decline"]}),U.jsx("button",{className:"px-4 py-3 border-2 border-gray-300 rounded-xl hover:bg-gray-50 transition-all duration-200 hover:scale-105 transform",children:U.jsx(os,{className:"w-5 h-5"})})]}),("accepted"===e.status||"active"===e.status)&&U.jsxs("div",{className:"flex space-x-3",children:[U.jsxs("button",{onClick:()=>(async e=>{var s;try{console.log(" Tutor ..."),console.log(" :",{sessionId:e.id,sessionStatus:e.status,tutorId:null==t?void 0:t.id,studentId:null==(s=e.student)?void 0:s.id});const o={id:e.id,subject:e.subject||"Tutoring Session",type:"tutoring",tutor:t,student:e.student},l=await zn(o,t);if(l.success){console.log(" :",l.meetingCode),console.log(" :",l.meetingData),console.log(" ...");try{const{doc:t,updateDoc:s,serverTimestamp:r}=await ia(()=>import("./firebase-48788c29.js").then(e=>e.v),[]),{db:a}=await ia(()=>Promise.resolve().then(()=>ut),void 0),n=t(a,"sessions",e.id);await s(n,{status:"active",meetingCode:l.meetingCode,startedAt:r(),updatedAt:r()}),console.log(" :",l.meetingCode)}catch(n){console.error(" :",n)}const s=await Va(e.id,{meetingCode:l.meetingCode});if(console.log(" :",s),s.success){console.log(" ");try{const{createNotification:s}=await ia(()=>Promise.resolve().then(()=>Ha),void 0);await s(e.student.id,"success","Meeting Created",`The tutor has created a meeting, code: ${l.meetingCode}`,{sessionId:e.id,role:"student",status:"active",fromName:t.name,subject:e.subject,meetingCode:l.meetingCode}),console.log(" ")}catch(i){console.error(" :",i)}h(t=>t.map(t=>t.id===e.id?{...t,status:"active",meetingCode:l.meetingCode}:t))}else console.error(" :",s.error);D({...o,meetingCode:l.meetingCode,meetingData:l.meetingData}),R(!0),r(`Meeting created! Code: ${l.meetingCode}`,5e3,"Success")}else console.error(" :",l.error),a(`Failed to create meeting: ${l.error}`,5e3,"Error")}catch(o){console.error(" :",o),a("An error occurred while creating the meeting",5e3,"Error")}})(e),className:"flex-1 bg-gradient-to-r from-blue-500 to-purple-500 text-white py-3 px-6 rounded-xl hover:from-blue-600 hover:to-purple-600 transition-all duration-200 flex items-center justify-center font-bold shadow-lg hover:shadow-xl hover:scale-105 transform",children:[U.jsx(Cr,{className:"w-5 h-5 mr-2"}),"active"===e.status?"Join Meeting":"Create Meeting"]}),U.jsx("button",{className:"px-4 py-3 border-2 border-gray-300 rounded-xl hover:bg-gray-50 transition-all duration-200 hover:scale-105 transform",children:U.jsx(os,{className:"w-5 h-5"})})]}),"completed"===e.status&&U.jsxs("div",{className:"flex space-x-3",children:[U.jsxs("button",{className:"flex-1 py-3 px-6 rounded-xl transition-all duration-200 flex items-center justify-center font-bold shadow-lg hover:shadow-xl hover:scale-105 transform bg-gradient-to-r from-green-500 to-emerald-500 text-white hover:from-green-600 hover:to-emerald-600",children:[U.jsx($t,{className:"w-5 h-5 mr-2"}),"Session Completed"]}),U.jsx("button",{className:"px-4 py-3 border-2 border-gray-300 rounded-xl hover:bg-gray-50 transition-all duration-200 hover:scale-105 transform",children:U.jsx(os,{className:"w-5 h-5"})})]})]})]},e.id)};return U.jsxs("div",{className:"min-h-screen relative overflow-hidden "+(s?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:[U.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:s?U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"absolute -top-36 left-1/2 h-80 w-80 -translate-x-1/2 rounded-full bg-purple-500/30 blur-3xl"}),U.jsx("div",{className:"absolute top-1/3 right-10 h-72 w-72 rounded-full bg-pink-500/20 blur-[140px]"}),U.jsx("div",{className:"absolute bottom-12 left-6 h-64 w-64 rounded-full bg-indigo-400/25 blur-[140px]"}),U.jsx("div",{className:"absolute bottom-0 right-1/4 h-40 w-40 rounded-full bg-blue-500/20 blur-[120px]"})]}):U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"absolute -top-24 left-1/3 h-64 w-64 rounded-full bg-purple-300/40 blur-3xl"}),U.jsx("div",{className:"absolute top-1/2 right-0 h-60 w-60 rounded-full bg-pink-300/35 blur-[140px]"}),U.jsx("div",{className:"absolute bottom-12 left-10 h-56 w-56 rounded-full bg-blue-300/35 blur-[140px]"}),U.jsx("div",{className:"absolute bottom-0 right-1/4 h-36 w-36 rounded-full bg-indigo-300/30 blur-[120px]"})]})}),U.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[U.jsx("section",{className:"mb-12 rounded-[32px] border shadow-2xl backdrop-blur-xl "+(s?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:U.jsxs("div",{className:"flex flex-col gap-8 px-8 py-10 lg:flex-row lg:items-center lg:justify-between",children:[U.jsxs("div",{className:"flex-1 text-center lg:text-left",children:[U.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-blue-500/15 to-purple-500/15 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-blue-400",children:[U.jsx(or,{className:"h-4 w-4"})," Tutor Control Center"]}),U.jsx("h1",{className:"mt-4 text-4xl font-black tracking-tight lg:text-5xl "+(s?"bg-gradient-to-r from-blue-200 via-purple-200 to-pink-200 bg-clip-text text-transparent":"bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent"),children:"Manage sessions, meet students, grow impact"}),U.jsx("p",{className:"mt-4 max-w-2xl text-base lg:text-lg "+(s?"text-white/70":"text-slate-600"),children:"Keep track of upcoming lessons, respond to new requests, and launch meetings instantly from one streamlined hub."}),U.jsxs("div",{className:"mt-6 flex flex-wrap justify-center gap-3 lg:justify-start",children:[U.jsxs("button",{onClick:()=>F(!0),className:"inline-flex items-center gap-2 rounded-2xl px-5 py-3 text-sm font-semibold shadow-lg transition hover:-translate-y-0.5 hover:shadow-xl "+(s?"bg-white/15 text-white border border-white/20 hover:bg-white/25":"bg-gradient-to-r from-blue-500 to-purple-500 text-white hover:from-blue-600 hover:to-purple-600"),children:[U.jsx(Ws,{className:"h-5 w-5"}),"Edit tutor profile"]}),U.jsxs("button",{onClick:()=>v("accepted"),className:"inline-flex items-center gap-2 rounded-2xl px-5 py-3 text-sm font-semibold transition hover:-translate-y-0.5 "+(s?"bg-white/5 text-white hover:bg-white/10":"border border-slate-200 bg-white text-slate-700 hover:bg-slate-50"),children:[U.jsx(Cr,{className:"h-5 w-5"}),"Jump to sessions"]})]})]}),U.jsxs("div",{className:"grid w-full max-w-xl grid-cols-2 gap-4",children:[U.jsxs("div",{className:"rounded-2xl border px-4 py-5 text-left "+(s?"border-white/10 bg-white/8 text-white":"border-blue-100 bg-blue-50 text-blue-600"),children:[U.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide opacity-80",children:"Pending requests"}),U.jsx("p",{className:"mt-2 text-3xl font-bold",children:V.length}),U.jsx("p",{className:"text-xs opacity-70",children:"Awaiting your response"})]}),U.jsxs("div",{className:"rounded-2xl border px-4 py-5 text-left "+(s?"border-white/10 bg-white/8 text-white":"border-emerald-100 bg-emerald-50 text-emerald-600"),children:[U.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide opacity-80",children:"Accepted / Active"}),U.jsx("p",{className:"mt-2 text-3xl font-bold",children:Y.length}),U.jsx("p",{className:"text-xs opacity-70",children:"Ready to host"})]}),U.jsxs("div",{className:"rounded-2xl border px-4 py-5 text-left "+(s?"border-white/10 bg-white/8 text-white":"border-purple-100 bg-purple-50 text-purple-600"),children:[U.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide opacity-80",children:"Active now"}),U.jsx("p",{className:"mt-2 text-3xl font-bold",children:Q.length}),U.jsx("p",{className:"text-xs opacity-70",children:"Live lessons in progress"})]}),U.jsxs("div",{className:"rounded-2xl border px-4 py-5 text-left "+(s?"border-white/10 bg-white/8 text-white":"border-amber-100 bg-amber-50 text-amber-600"),children:[U.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide opacity-80",children:"Completed"}),U.jsx("p",{className:"mt-2 text-3xl font-bold",children:J.length}),U.jsx("p",{className:"text-xs opacity-70",children:"Great work so far"})]})]})]})}),U.jsxs("div",{className:"mb-12 grid gap-6 lg:grid-cols-3",children:[U.jsx("div",{className:"lg:col-span-1",children:U.jsx(Hn,{tutorId:null==t?void 0:t.id})}),U.jsxs("div",{className:"lg:col-span-2 rounded-[28px] border p-6 backdrop-blur-xl "+(s?"border-white/10 bg-white/5":"border-white/70 bg-white"),children:[U.jsx("div",{className:"flex items-center justify-between mb-4",children:U.jsx("h3",{className:"text-lg font-bold "+(s?"text-white":"text-slate-900"),children:"Quick Stats"})}),U.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[U.jsxs("div",{className:"rounded-xl p-4 "+(s?"bg-gradient-to-br from-blue-500/20 to-cyan-500/10":"bg-gradient-to-br from-blue-50 to-cyan-50"),children:[U.jsx("p",{className:"text-sm font-medium "+(s?"text-blue-300":"text-blue-600"),children:"Total Sessions"}),U.jsx("p",{className:"text-2xl font-bold mt-1 "+(s?"text-white":"text-slate-900"),children:i.length})]}),U.jsxs("div",{className:"rounded-xl p-4 "+(s?"bg-gradient-to-br from-purple-500/20 to-pink-500/10":"bg-gradient-to-br from-purple-50 to-pink-50"),children:[U.jsx("p",{className:"text-sm font-medium "+(s?"text-purple-300":"text-purple-600"),children:"Completion Rate"}),U.jsxs("p",{className:"text-2xl font-bold mt-1 "+(s?"text-white":"text-slate-900"),children:[i.length>0?Math.round(J.length/i.length*100):0,"%"]})]}),U.jsxs("div",{className:"rounded-xl p-4 "+(s?"bg-gradient-to-br from-emerald-500/20 to-teal-500/10":"bg-gradient-to-br from-emerald-50 to-teal-50"),children:[U.jsx("p",{className:"text-sm font-medium "+(s?"text-emerald-300":"text-emerald-600"),children:"Response Rate"}),U.jsxs("p",{className:"text-2xl font-bold mt-1 "+(s?"text-white":"text-slate-900"),children:[V.length+Y.length+J.length>0?Math.round((Y.length+J.length)/(V.length+Y.length+J.length)*100):100,"%"]})]}),U.jsxs("div",{className:"rounded-xl p-4 "+(s?"bg-gradient-to-br from-amber-500/20 to-orange-500/10":"bg-gradient-to-br from-amber-50 to-orange-50"),children:[U.jsx("p",{className:"text-sm font-medium "+(s?"text-amber-300":"text-amber-600"),children:"Active Now"}),U.jsx("p",{className:"text-2xl font-bold mt-1 "+(s?"text-white":"text-slate-900"),children:Q.length})]})]})]})]}),C>0&&U.jsx("div",{className:"mb-8 rounded-2xl border px-6 py-4 shadow-lg backdrop-blur-xl "+(s?"border-purple-500/30 bg-gradient-to-r from-purple-500/20 to-pink-500/20":"border-purple-200 bg-gradient-to-r from-purple-50 to-pink-50"),children:U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx(Ms,{className:"h-5 w-5 "+(s?"text-purple-300":"text-purple-600")}),U.jsxs("div",{children:[U.jsxs("p",{className:"font-semibold "+(s?"text-white":"text-slate-900"),children:["You have ",C," unread message",C>1?"s":""," from ",A.length>0?A.map(e=>e.name).join(", "):"students"]}),U.jsx("p",{className:"text-sm mt-0.5 "+(s?"text-white/70":"text-slate-600"),children:A.length>0?U.jsxs(U.Fragment,{children:[U.jsx("span",{className:"font-medium",children:"From Student Chat:"})," ",1===A.length?`Message from ${A[0].name}`:`Messages from ${A.map(e=>e.name).join(", ")}`,U.jsx("br",{}),U.jsx("span",{className:"text-xs opacity-75",children:'Click "Chat" tab or "View Messages" to open Tutor Chat and view your messages'})]}):'Click "Chat" tab to view your messages from students'})]})]}),U.jsx("button",{onClick:()=>{v("chat"),P(!0)},className:"rounded-xl px-4 py-2 text-sm font-semibold transition-all bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600",children:"View Messages"})]})}),U.jsx("div",{className:"mb-12 grid gap-6 sm:grid-cols-2 xl:grid-cols-4",children:te.map(e=>{const t=e.icon,r=s?e.accent:"text-slate-900";return U.jsxs("div",{className:"rounded-[28px] border backdrop-blur-xl p-6 shadow-lg transition duration-300 hover:-translate-y-1 hover:shadow-2xl "+(s?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:[U.jsxs("div",{className:"flex items-start justify-between",children:[U.jsx("div",{className:`flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br ${e.iconGradient} text-white shadow-lg`,children:U.jsx(t,{className:"h-6 w-6"})}),U.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide "+(s?"text-white/60":"text-slate-400"),children:e.description})]}),U.jsx("h3",{className:"mt-6 text-sm font-semibold "+(s?"text-white/80":"text-slate-500"),children:e.title}),U.jsx("p",{className:`mt-2 text-3xl font-bold ${r}`,children:e.value})]},e.id)})}),U.jsxs("div",{className:"relative backdrop-blur-sm rounded-2xl shadow-lg border p-2 mb-8 "+(s?"bg-white/10 border-white/20":"bg-white/80 border-white/20"),children:[U.jsx("div",{className:"absolute inset-0 rounded-2xl blur-lg transition-all duration-300 "+(s?"bg-gradient-to-r from-blue-500/20 to-purple-500/20":"bg-gradient-to-r from-blue-500/10 to-purple-500/10")}),U.jsx("nav",{className:"relative flex space-x-2",children:se.map(e=>U.jsxs("button",{onClick:()=>{return t=e.id,v(t),void("completed"!==t&&O(1));var t},className:"flex-1 py-4 px-6 rounded-xl font-medium text-sm transition-all duration-300 flex items-center justify-center space-x-2 "+(w===e.id?s?"bg-white/20 text-white shadow-lg scale-105 border border-white/30":"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg scale-105":s?"text-gray-300 hover:text-white hover:bg-white/10":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:[U.jsx("span",{children:e.name}),e.count>0&&U.jsx("span",{className:"px-2 py-1 text-xs rounded-full "+(w===e.id?s?"bg-white/30 text-white":"bg-white/20 text-white":s?"bg-white/20 text-white":"bg-gradient-to-r from-blue-500 to-purple-500 text-white"),children:e.count})]},e.id))})]}),U.jsxs("div",{className:"space-y-8",children:["requests"===w&&U.jsxs(U.Fragment,{children:[U.jsx("h2",{className:"text-2xl font-bold "+(s?"bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent":"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent"),children:"Pending Requests"}),V.length>0?U.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:V.map(re)}):U.jsxs("div",{className:"rounded-3xl p-12 border text-center "+(s?"bg-white/10 border-white/20":"bg-gradient-to-br from-blue-50 to-purple-50 border-blue-100"),children:[U.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-2xl",children:U.jsx(Ms,{className:"w-10 h-10 text-white"})}),U.jsx("h3",{className:"text-2xl font-bold mb-4 "+(s?"text-white":"text-gray-900"),children:"No pending requests"}),U.jsx("p",{className:"text-lg "+(s?"text-gray-300":"text-gray-600"),children:"You'll see tutoring requests from students here when they come in."})]})]}),"accepted"===w&&U.jsxs(U.Fragment,{children:[U.jsx("h2",{className:"text-2xl font-bold "+(s?"bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent":"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent"),children:"Accepted Sessions"}),Y.length>0?U.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:Y.map(re)}):U.jsxs("div",{className:"rounded-3xl p-12 border text-center "+(s?"bg-white/10 border-white/20":"bg-gradient-to-br from-green-50 to-emerald-50 border-green-100"),children:[U.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-green-500 to-emerald-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-2xl",children:U.jsx($t,{className:"w-10 h-10 text-white"})}),U.jsx("h3",{className:"text-2xl font-bold mb-4 "+(s?"text-white":"text-gray-900"),children:"No accepted sessions"}),U.jsx("p",{className:"text-lg "+(s?"text-gray-300":"text-gray-600"),children:"Accepted tutoring sessions will appear here."})]})]}),"chat"===w&&U.jsxs(U.Fragment,{children:[U.jsx("h2",{className:"text-2xl font-bold "+(s?"bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent":"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent"),children:"Messages from Students"}),k?U.jsxs("div",{className:"rounded-3xl p-12 border text-center "+(s?"bg-white/10 border-white/20":"bg-gradient-to-br from-blue-50 to-purple-50 border-blue-100"),children:[U.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-2xl animate-pulse",children:U.jsx(Ms,{className:"w-10 h-10 text-white"})}),U.jsx("p",{className:"text-lg "+(s?"text-gray-300":"text-gray-600"),children:"Loading messages..."})]}):j.length>0?U.jsx("div",{className:"grid grid-cols-1 gap-4",children:j.map(e=>{var t;return U.jsx("div",{onClick:()=>n(`/chat-tutor/${e.userId}`,{state:{from:"tutor-dashboard"}}),className:"group rounded-2xl border p-6 cursor-pointer transition-all hover:shadow-xl hover:scale-[1.02] "+(s?"bg-white/10 border-white/20 hover:bg-white/15":"bg-white border-slate-200 hover:bg-slate-50"),children:U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx(Za,{user:e.user,size:"lg",className:"shadow-lg"}),U.jsxs("div",{className:"flex-1 min-w-0",children:[U.jsx("h3",{className:"text-lg font-semibold mb-1 "+(s?"text-white":"text-gray-900"),children:(null==(t=e.user)?void 0:t.name)||"Unknown Student"}),U.jsx("p",{className:"text-sm truncate "+(s?"text-gray-300":"text-gray-600"),children:e.latestMessage||"No messages yet"})]}),U.jsx("div",{className:"text-right",children:U.jsx("p",{className:"text-xs "+(s?"text-gray-400":"text-gray-500"),children:e.latestMessageTime?Cn(e.latestMessageTime):""})})]})},e.userId)})}):U.jsxs("div",{className:"rounded-3xl p-12 border text-center "+(s?"bg-white/10 border-white/20":"bg-gradient-to-br from-blue-50 to-purple-50 border-blue-100"),children:[U.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-2xl",children:U.jsx(Ms,{className:"w-10 h-10 text-white"})}),U.jsx("h3",{className:"text-2xl font-bold mb-4 "+(s?"text-white":"text-gray-900"),children:"No messages yet"}),U.jsx("p",{className:"text-lg "+(s?"text-gray-300":"text-gray-600"),children:"Students can start chatting with you from the tutoring page."})]})]}),"completed"===w&&U.jsxs(U.Fragment,{children:[U.jsxs("div",{className:"flex items-center justify-between mb-6",children:[U.jsx("h2",{className:"text-2xl font-bold "+(s?"bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent":"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent"),children:"Completed Sessions"}),J.length>0&&U.jsx("div",{className:"px-4 py-2 rounded-lg "+(s?"bg-white/10 border border-white/20":"bg-gray-100 border border-gray-200"),children:U.jsxs("span",{className:"text-sm font-medium "+(s?"text-gray-300":"text-gray-600"),children:["Page ",$," of ",K," (",J.length," total)"]})})]}),J.length>0?U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:ee.map(re)}),K>1&&U.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[U.jsx("button",{onClick:()=>O(Math.max(1,$-1)),disabled:1===$,className:"px-4 py-2 rounded-lg font-medium transition-all duration-200 "+(1===$?s?"bg-white/5 text-gray-500 cursor-not-allowed":"bg-gray-100 text-gray-400 cursor-not-allowed":s?"bg-white/10 text-white hover:bg-white/20 border border-white/20":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-200"),children:"Previous"}),U.jsx("div",{className:"flex space-x-2",children:Array.from({length:K},(e,t)=>t+1).map(e=>U.jsx("button",{onClick:()=>O(e),className:"px-3 py-2 rounded-lg font-medium transition-all duration-200 "+(e===$?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":s?"bg-white/10 text-gray-300 hover:bg-white/20 border border-white/20":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"),children:e},e))}),U.jsx("button",{onClick:()=>O(Math.min(K,$+1)),disabled:$===K,className:"px-4 py-2 rounded-lg font-medium transition-all duration-200 "+($===K?s?"bg-white/5 text-gray-500 cursor-not-allowed":"bg-gray-100 text-gray-400 cursor-not-allowed":s?"bg-white/10 text-white hover:bg-white/20 border border-white/20":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-200"),children:"Next"})]})]}):U.jsxs("div",{className:"rounded-3xl p-12 border text-center "+(s?"bg-white/10 border-white/20":"bg-gradient-to-br from-purple-50 to-pink-50 border-purple-100"),children:[U.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-purple-500 to-pink-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-2xl",children:U.jsx(or,{className:"w-10 h-10 text-white"})}),U.jsx("h3",{className:"text-2xl font-bold mb-4 "+(s?"text-white":"text-gray-900"),children:"No completed sessions"}),U.jsx("p",{className:"text-lg "+(s?"text-gray-300":"text-gray-600"),children:"Completed tutoring sessions will appear here."})]})]})]}),q&&M&&U.jsx(cn,{isOpen:q,onClose:()=>{R(!1),D(null)},sessionData:M,user:t}),U.jsx(Wn,{isOpen:L,onClose:()=>F(!1),currentProfile:null==t?void 0:t.tutorProfile})]})]})},Vn=()=>U.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:U.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[U.jsx("h1",{className:"text-2xl font-bold text-green-600 mb-4",children:" Application is Working!"}),U.jsx("p",{className:"text-gray-600 mb-4",children:"If you can see this page, the basic React application is running correctly."}),U.jsxs("div",{className:"space-y-2 text-sm text-gray-500",children:[U.jsx("p",{children:" React is rendering"}),U.jsx("p",{children:" Tailwind CSS is working"}),U.jsx("p",{children:" Routing is functional"}),U.jsx("p",{children:" No JavaScript errors"})]}),U.jsx("button",{onClick:()=>window.location.href="/",className:"mt-6 bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors",children:"Go to Home"})]})}),Yn=()=>U.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[U.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Debug Page"}),U.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:[U.jsx("p",{className:"text-gray-600",children:"This is a debug page to test if routing is working correctly."}),U.jsx("div",{className:"mt-4",children:U.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded",children:" Debug page is rendering successfully!"})})]})]}),Qn=()=>U.jsxs("div",{style:{padding:"50px",backgroundColor:"red",color:"white",fontSize:"30px",textAlign:"center",minHeight:"100vh"},children:[U.jsx("h1",{children:" "}),U.jsx("p",{children:""}),U.jsxs("p",{children:[": ",(new Date).toLocaleString()]})]}),Jn=()=>{const{showSuccess:e,showError:t,showWarning:s,showInfo:r}=Hr();return U.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center p-4",children:U.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full",children:[U.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:" Notification Polish Test"}),U.jsx("p",{className:"text-gray-600 mb-8 text-center",children:"polished"}),U.jsxs("div",{className:"space-y-4",children:[U.jsx("button",{onClick:()=>{e("Profile updated successfully! ",4e3,"Success")},className:"w-full bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 transform hover:scale-105",children:" Success Notification"}),U.jsx("button",{onClick:()=>{t("Invalid phone number format ",5e3,"Error")},className:"w-full bg-red-500 hover:bg-red-600 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 transform hover:scale-105",children:" Error Notification"}),U.jsx("button",{onClick:()=>{s("Please check your input data ",4e3,"Warning")},className:"w-full bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 transform hover:scale-105",children:" Warning Notification"}),U.jsx("button",{onClick:()=>{r("This is an informational message ",4e3,"Info")},className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 transform hover:scale-105",children:" Info Notification"})]}),U.jsxs("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:[U.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:" :"}),U.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[U.jsx("li",{children:" "}),U.jsx("li",{children:" /"}),U.jsx("li",{children:" "}),U.jsx("li",{children:" +"}),U.jsx("li",{children:" "}),U.jsx("li",{children:" "})]})]})]})})},Kn=()=>{var t;const[s,r]=e.useState("short-break"),[a,n]=e.useState(300),[i,o]=e.useState(!1),l=[{id:"pomodoro",name:"Pomodoro",duration:25},{id:"short-break",name:"Short Break",duration:5},{id:"long-break",name:"Long Break",duration:15},{id:"deep-focus",name:"Deep Focus",duration:90}],c=()=>{try{localStorage.removeItem("studiply_focus_session"),console.log("Session cleared")}catch(e){console.error("Failed to clear session from localStorage:",e)}};e.useEffect(()=>{const e=(()=>{try{const e=localStorage.getItem("studiply_focus_session");return e?JSON.parse(e):null}catch(e){return console.error("Failed to load session from localStorage:",e),null}})();if(e){const t=(new Date).getTime(),s=new Date(e.endTime).getTime();if(t<s){const a=Math.floor((s-t)/1e3);a>0?(console.log("Restoring session:",e),r(e.type),n(a),o(!0)):c()}else c()}},[]),e.useEffect(()=>{if(i){const e=l.find(e=>e.id===s),t=new Date(Date.now()+1e3*a);(e=>{try{localStorage.setItem("studiply_focus_session",JSON.stringify(e)),console.log("Session saved:",e)}catch(t){console.error("Failed to save session to localStorage:",t)}})({type:s,endTime:t.toISOString(),duration:(null==e?void 0:e.duration)||5})}},[a,i,s]),e.useEffect(()=>{let e=null;return i&&a>0?e=setInterval(()=>{n(e=>e-1)},1e3):0===a&&(o(!1),c()),()=>clearInterval(e)},[i,a]),e.useEffect(()=>{if(!i){const e=l.find(e=>e.id===s);e&&n(60*e.duration)}},[s,i]);return U.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 p-8",children:U.jsxs("div",{className:"max-w-4xl mx-auto",children:[U.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-8 text-center",children:"Focus Mode Test"}),U.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl border border-white/20 p-6 mb-8",children:[U.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Session Type"}),U.jsx("div",{className:"grid grid-cols-2 gap-4",children:l.map(e=>U.jsxs("button",{onClick:()=>r(e.id),className:"p-4 rounded-2xl font-medium transition-all duration-200 "+(s===e.id?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg scale-105":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[U.jsx("div",{className:"text-lg font-semibold",children:e.name}),U.jsxs("div",{className:"text-sm opacity-80",children:[e.duration," min"]})]},e.id))})]}),U.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl border border-white/20 p-8 mb-8 text-center",children:[U.jsx("div",{className:"text-6xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-4",children:(e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`})(a)}),U.jsxs("div",{className:"text-xl text-gray-600 mb-6",children:[null==(t=l.find(e=>e.id===s))?void 0:t.name," Session"]}),U.jsxs("div",{className:"flex justify-center space-x-4",children:[i?U.jsx("button",{onClick:()=>{o(!1)},className:"bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-200 shadow-lg hover:shadow-xl hover:scale-105",children:" Pause"}):U.jsx("button",{onClick:()=>{o(!0)},className:"bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-200 shadow-lg hover:shadow-xl hover:scale-105",children:" Start"}),U.jsx("button",{onClick:()=>{var e;o(!1),n(60*(null==(e=l.find(e=>e.id===s))?void 0:e.duration)||300),c()},className:"bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-200 shadow-lg hover:shadow-xl hover:scale-105",children:" Stop"})]})]}),U.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl border border-white/20 p-6",children:[U.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Debug Info"}),U.jsxs("div",{className:"space-y-2 text-sm",children:[U.jsxs("div",{children:["Session Type: ",s]}),U.jsxs("div",{children:["Time Left: ",a," seconds"]}),U.jsxs("div",{children:["Is Active: ",i?"Yes":"No"]})]}),U.jsx("button",{onClick:()=>{console.log("=== localStorage Debug ==="),console.log("Current session:",localStorage.getItem("studiply_focus_session")),console.log("Current state:",{sessionType:s,timeLeft:a,isActive:i})},className:"mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg text-sm hover:bg-gray-600",children:" Debug localStorage"})]})]})})},Xn=()=>{const[t,s]=e.useState(null),[r,a]=e.useState(!1),[n,i]=e.useState(!1),[o,l]=e.useState(null),c={}.VITE_AGORA_APP_ID,d="test-channel-"+Date.now();return U.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:U.jsx("div",{className:"max-w-4xl mx-auto px-4",children:U.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[U.jsxs("div",{className:"text-center mb-8",children:[U.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Agora "}),U.jsx("p",{className:"text-gray-600",children:" Agora RTC "})]}),U.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:[U.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:""}),U.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[U.jsxs("div",{children:[U.jsx("span",{className:"font-medium text-gray-600",children:"App ID:"}),U.jsx("span",{className:"ml-2 font-mono text-gray-800",children:c?`${c.substring(0,8)}...${c.substring(28)}`:""})]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-medium text-gray-600",children:"App ID :"}),U.jsxs("span",{className:"ml-2 text-gray-800",children:[(null==c?void 0:c.length)||0,"/32"]})]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-medium text-gray-600",children:":"}),U.jsx("span",{className:"ml-2 font-mono text-gray-800",children:d})]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-medium text-gray-600",children:":"}),U.jsx("span",{className:"ml-2 px-2 py-1 rounded text-xs "+(n?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:n?"":""})]})]})]}),U.jsx("div",{className:"flex justify-center space-x-4 mb-6",children:n?U.jsxs("button",{onClick:async()=>{if(o&&n)try{await o.leave(),i(!1),l(null),s(null)}catch(e){console.error("Error disconnecting:",e)}},className:"px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center space-x-2",children:[U.jsx(ir,{className:"w-5 h-5"}),U.jsx("span",{children:""})]}):U.jsx("button",{onClick:async()=>{a(!0),s(null);try{console.log("Testing Agora connection...",{APP_ID:c,TEST_CHANNEL:d});const e=C.createClient({mode:"rtc",codec:"vp8"});l(e),console.log("Attempting to join channel...");const t=await e.join(c,d,null,Date.now().toString());console.log("Successfully joined channel:",t),i(!0),s({success:!0,message:"Agora ",details:` ${d}UID: ${t}`})}catch(e){console.error("Agora test failed:",e),s({success:!1,message:"Agora ",details:`${e.code}: ${e.message}`})}finally{a(!1)}},disabled:r||!c,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:r?U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),U.jsx("span",{children:"..."})]}):U.jsxs(U.Fragment,{children:[U.jsx(Vs,{className:"w-5 h-5"}),U.jsx("span",{children:" Agora "})]})})}),t&&U.jsxs("div",{className:"rounded-lg p-6 mb-6 "+(u=t.success,null===u?"bg-gray-100 text-gray-800":u?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:[U.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[(e=>null===e?null:e?U.jsx($t,{className:"w-6 h-6 text-green-500"}):U.jsx(qr,{className:"w-6 h-6 text-red-500"}))(t.success),U.jsx("h3",{className:"text-lg font-semibold",children:t.message})]}),U.jsx("p",{className:"text-sm opacity-90 font-mono",children:t.details})]}),U.jsxs("div",{className:"bg-blue-50 rounded-lg p-6",children:[U.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[U.jsx(ft,{className:"w-5 h-5 text-blue-600"}),U.jsx("h3",{className:"font-semibold text-blue-900",children:""})]}),U.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[U.jsx("p",{children:U.jsx("strong",{children:""})}),U.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[U.jsx("li",{children:"App ID 32"}),U.jsx("li",{children:"Agora "}),U.jsx("li",{children:""}),U.jsx("li",{children:" Agora "}),U.jsx("li",{children:""})]}),U.jsxs("div",{className:"mt-4 p-3 bg-blue-100 rounded",children:[U.jsx("p",{children:U.jsx("strong",{children:""})}),U.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[U.jsxs("li",{children:[U.jsx("code",{children:"CAN_NOT_GET_GATEWAY_SERVER"}),": App ID "]}),U.jsxs("li",{children:[U.jsx("code",{children:"INVALID_APP_ID"}),": App ID "]}),U.jsxs("li",{children:[U.jsx("code",{children:"PERMISSION_DENIED"}),": "]})]})]})]})]})]})})});var u},Zn=()=>{const t=qe(),[s]=ot(),{user:r}=Br(),{showSuccess:a,showError:n}=Hr(),i=s.get("code"),[o,l]=e.useState(!1),[c,d]=e.useState(!1),[u,h]=e.useState("idle"),[m,x]=e.useState([]),[p,g]=e.useState(!1),[b,f]=e.useState(!0),[w,y]=e.useState("good"),[v,j]=e.useState(""),[N,k]=e.useState(!1),S=e.useRef(null),E=e.useRef(null),A=e.useRef(null),T=e.useRef([]),I={}.VITE_AGORA_APP_ID||"demo_app_id_for_testing",P=`meeting-${i}`;e.useEffect(()=>{i?r?"demo_app_id_for_testing"===I&&(j("Agora App ID "),h("error")):t("/login"):t("/")},[i,r,t,I]);const q=async()=>{if(i&&r)try{d(!0),h("connecting"),j(""),console.log(` : ${i}`),await F();const e=C.createClient({mode:"rtc",codec:"vp8"});S.current=e,M(e),await D(),await L(e),l(!0),d(!1)}catch(e){console.error(" :",e),j(e.message||""),h("error"),d(!1)}},R=async()=>{await F(),l(!1),h("idle"),t("/")},M=e=>{e.on("user-joined",e=>{console.log(" :",e.uid),y("good")}),e.on("user-left",e=>{console.log(" :",e.uid),x(t=>t.filter(t=>t.uid!==e.uid))}),e.on("user-published",async(t,s)=>{console.log(" :",t.uid,s);try{await e.subscribe(t,s),"video"===s&&A.current&&t.videoTrack.play(A.current),"audio"===s&&t.audioTrack.play(),x(e=>e.find(e=>e.uid===t.uid)?e.map(e=>e.uid===t.uid?{...e,[s]:t[`${s}Track`]}:e):[...e,t]),"connecting"===u&&(h("connected"),y("good"),console.log(" !"))}catch(r){console.error(" :",r)}}),e.on("user-unpublished",(e,t)=>{console.log(" :",e.uid,t),"video"===t&&e.videoTrack&&e.videoTrack.stop(),"audio"===t&&e.audioTrack&&e.audioTrack.stop()}),e.on("connection-state-change",(e,t)=>{switch(console.log(` : ${t} -> ${e}`),e){case"CONNECTING":y("connecting");break;case"CONNECTED":y("good"),"connecting"===u&&h("connected");break;case"DISCONNECTED":y("poor")}})},D=async()=>{try{console.log(" ...");const[e,t]=await C.createMicrophoneAndCameraTracks();T.current=[e,t],E.current&&t.play(E.current),console.log(" ")}catch(e){throw console.error(" :",e),e}},L=async e=>{try{console.log(` : ${P}`);const t=Date.now()%1e6;await e.join(I,P,null,t),await e.publish(T.current),console.log(" "),h("connected")}catch(t){throw console.error(" :",t),t}},F=()=>{if(console.log(" ..."),T.current.forEach(e=>{e.stop(),e.close()}),T.current=[],E.current&&(E.current.srcObject=null),A.current&&(A.current.srcObject=null),x([]),y("good"),S.current){const e=S.current;S.current=null;(async()=>{var t,s;try{await e.leave()}catch(r){(null==(t=r.message)?void 0:t.includes("statscollector"))||(null==(s=r.message)?void 0:s.includes("ERR_ADDRESS_UNREACHABLE"))||console.error(":",r)}finally{console.log(" ")}})().catch(e=>{console.error(" :",e)})}else console.log(" ")},$=async()=>{const e=`${window.location.origin}/meeting?code=${i}`;try{await navigator.clipboard.writeText(e),k(!0),a(""),setTimeout(()=>k(!1),2e3)}catch(t){n("")}};return"error"===u?U.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-4",children:U.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-8 max-w-md text-center",children:[U.jsx(bt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),U.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:""}),U.jsx("p",{className:"text-gray-600 mb-6",children:v}),U.jsx("button",{onClick:()=>t("/"),className:"bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition-colors",children:""})]})}):o?U.jsxs("div",{className:"h-screen bg-gray-900 flex flex-col",children:[U.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-800 text-white",children:[U.jsxs("div",{className:"flex items-center space-x-4",children:[U.jsxs("h1",{className:"text-xl font-semibold",children:[" ",i]}),(()=>{const e={connecting:{icon:U.jsx(Es,{className:"w-4 h-4 animate-spin"}),text:"...",color:"text-yellow-600"},connected:{icon:U.jsx(Pr,{className:"w-4 h-4"}),text:"",color:"text-green-600"},error:{icon:U.jsx(Ir,{className:"w-4 h-4"}),text:"",color:"text-red-600"}},t=e[u]||e.connecting;return U.jsxs("div",{className:`flex items-center space-x-2 ${t.color}`,children:[t.icon,U.jsx("span",{className:"text-sm font-medium",children:t.text})]})})(),U.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-300",children:[U.jsx(kr,{className:"w-4 h-4"}),U.jsxs("span",{children:[m.length+1," "]})]})]}),U.jsx("button",{onClick:R,className:"text-red-400 hover:text-red-300 transition-colors",children:""})]}),U.jsxs("div",{className:"flex-1 grid grid-cols-1 lg:grid-cols-2 gap-4 p-4",children:[U.jsxs("div",{className:"relative bg-gray-700 rounded-lg overflow-hidden",children:[U.jsx("video",{ref:E,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),U.jsxs("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded",children:[" ",p&&"()"]}),!b&&U.jsx("div",{className:"absolute inset-0 bg-gray-800 flex items-center justify-center",children:U.jsx(Sr,{size:48,className:"text-gray-400"})})]}),U.jsxs("div",{className:"relative bg-gray-700 rounded-lg overflow-hidden",children:[m.length>0?U.jsx("video",{ref:A,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}):U.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-gray-400",children:[U.jsx(kr,{size:64,className:"mb-4"}),U.jsx("p",{className:"text-lg",children:"..."}),U.jsxs("p",{className:"text-sm mt-2",children:[": ",i]})]}),m.length>0&&U.jsxs("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded",children:[" (",m.length,")"]})]})]}),U.jsxs("div",{className:"flex justify-center items-center p-4 bg-gray-800 space-x-4",children:[U.jsx("button",{onClick:()=>{T.current[0]&&(T.current[0].setEnabled(p),g(!p))},className:"p-3 rounded-full transition-colors "+(p?"bg-red-500 hover:bg-red-600 text-white":"bg-gray-600 hover:bg-gray-500 text-white"),children:p?U.jsx(Ls,{size:24}):U.jsx(Fs,{size:24})}),U.jsx("button",{onClick:()=>{T.current[1]&&(T.current[1].setEnabled(b),f(!b))},className:"p-3 rounded-full transition-colors "+(b?"bg-gray-600 hover:bg-gray-500 text-white":"bg-red-500 hover:bg-red-600 text-white"),children:b?U.jsx(Cr,{size:24}):U.jsx(Sr,{size:24})}),U.jsx("button",{onClick:R,className:"p-3 rounded-full bg-red-600 hover:bg-red-700 text-white transition-colors",children:U.jsx(Hs,{size:24})})]})]}):U.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-4",children:U.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-8 max-w-md w-full",children:[U.jsxs("div",{className:"text-center mb-8",children:[U.jsx("div",{className:"w-20 h-20 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-4",children:U.jsx(Cr,{className:"w-10 h-10 text-white"})}),U.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Join Meeting"}),U.jsx("p",{className:"text-gray-600",children:"Enter meeting code to join video conference"})]}),U.jsxs("div",{className:"space-y-6",children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),U.jsx("div",{className:"relative",children:U.jsx("input",{type:"text",value:i||"",readOnly:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-center text-2xl font-mono tracking-wider bg-gray-50",placeholder:"123456"})})]}),U.jsxs("div",{className:"flex space-x-3",children:[U.jsxs("button",{onClick:$,disabled:!i,className:"flex-1 bg-gray-500 text-white py-3 rounded-lg hover:bg-gray-600 transition-colors flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[N?U.jsx(Ot,{className:"w-4 h-4"}):U.jsx(Jt,{className:"w-4 h-4"}),U.jsx("span",{children:N?"":""})]}),U.jsxs("button",{onClick:q,disabled:!i||c,className:"flex-1 bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[c?U.jsx(Es,{className:"w-4 h-4 animate-spin"}):U.jsx(Cr,{className:"w-4 h-4"}),U.jsx("span",{children:c?"Joining...":"Join Meeting"})]})]})]}),U.jsx("div",{className:"mt-6 text-center",children:U.jsx("button",{onClick:()=>t("/"),className:"text-gray-500 hover:text-gray-700 transition-colors",children:""})})]})})},ei=({isOpen:t,onClose:s,sessionData:r,tutor:a})=>{const[n,i]=e.useState(0),[u,h]=e.useState(0),[m,x]=e.useState(""),[g,f]=e.useState(!1),{showSuccess:w,showError:y}=Hr(),v=()=>{i(0),x(""),h(0),s()};return t&&r&&a?U.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:U.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden",children:[U.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 p-6 text-white",children:U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsxs("div",{children:[U.jsx("h2",{className:"text-2xl font-bold",children:"Rate Your Session"}),U.jsxs("p",{className:"text-blue-100 mt-1",children:["How was your tutoring session with ",a.name,"?"]})]}),U.jsx("button",{onClick:v,className:"text-white hover:text-gray-200 transition-colors",children:U.jsx(Rr,{className:"w-6 h-6"})})]})}),U.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:U.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),0!==n)if(m.trim()){f(!0);try{const e=await(async(e,t,s,r,a="")=>{try{const n=o(dt,"ratings"),i=l(n,c("sessionId","==",e),c("studentId","==",s));if(!(await d(i)).empty)return{success:!1,error:"You have already rated this session."};const u={sessionId:e,tutorId:t,studentId:s,rating:r,review:a,createdAt:p(),updatedAt:p()},h=await b(n,u);return await rn(t,r),{success:!0,ratingId:h.id}}catch(n){return console.error("Error creating rating:",n),{success:!1,error:n.message}}})(r.id,r.tutorId,r.studentId,n,m.trim());e.success?(w("Thank you for your review! Your feedback helps other students.","Review Submitted!"),s(),i(0),x(""),h(0)):y(e.error||"Failed to submit review","Submission Failed")}catch(t){console.error("Error submitting review:",t),y("An error occurred while submitting your review","Error")}finally{f(!1)}}else y("Please write a review","Review Required");else y("Please select a rating","Rating Required")},className:"space-y-6",children:[U.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[U.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Session Details"}),U.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[U.jsxs("div",{children:[U.jsx("span",{className:"font-medium",children:"Tutor:"})," ",a.name]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-medium",children:"Subject:"})," ",r.subject||"General"]}),U.jsxs("div",{children:[U.jsx("span",{className:"font-medium",children:"Date:"})," ",r.createdAt?Pa(r.createdAt).toLocaleDateString():"Unknown"]})]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-lg font-semibold text-gray-900 mb-3",children:"How would you rate this session? *"}),U.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Array.from({length:5},(e,t)=>U.jsx(or,{className:"w-8 h-8 cursor-pointer transition-colors "+(t<(u||n)?"text-yellow-400 fill-current":"text-gray-300 hover:text-yellow-200"),onMouseEnter:()=>h(t+1),onMouseLeave:()=>h(0),onClick:()=>i(t+1)},t)),n>0&&U.jsx("span",{className:"ml-3 text-lg font-medium text-gray-700",children:(j=n,{1:"Poor",2:"Fair",3:"Good",4:"Very Good",5:"Excellent"}[j]||"")})]}),U.jsx("p",{className:"text-sm text-gray-500",children:"Click on a star to rate from 1 (Poor) to 5 (Excellent)"})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-lg font-semibold text-gray-900 mb-3",children:"Write a review *"}),U.jsxs("div",{className:"relative",children:[U.jsx(Ds,{className:"absolute left-3 top-3 w-5 h-5 text-gray-400"}),U.jsx("textarea",{value:m,onChange:e=>x(e.target.value),placeholder:"Share your experience with this tutor. What did you like? How did they help you? Any suggestions for improvement?",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 resize-none",rows:5,maxLength:500})]}),U.jsxs("div",{className:"flex justify-between items-center mt-2",children:[U.jsx("p",{className:"text-sm text-gray-500",children:"Be specific and helpful for other students"}),U.jsxs("span",{className:"text-sm text-gray-400",children:[m.length,"/500"]})]})]}),U.jsxs("div",{className:"bg-blue-50 rounded-xl p-4",children:[U.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Review Guidelines"}),U.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[U.jsx("li",{children:" Be honest and constructive"}),U.jsx("li",{children:" Focus on the tutoring experience"}),U.jsx("li",{children:" Help other students make informed decisions"}),U.jsx("li",{children:" Avoid personal attacks or inappropriate language"})]})]}),U.jsxs("div",{className:"flex space-x-3 pt-4",children:[U.jsx("button",{type:"button",onClick:v,className:"flex-1 bg-gray-200 text-gray-800 py-3 px-6 rounded-xl hover:bg-gray-300 transition-all duration-200 font-semibold",children:"Cancel"}),U.jsx("button",{type:"submit",disabled:g||0===n||!m.trim(),className:"flex-1 bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 px-6 rounded-xl hover:from-blue-600 hover:to-purple-700 transition-all duration-200 font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:g?U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Submitting..."]}):U.jsxs(U.Fragment,{children:[U.jsx(tr,{className:"w-5 h-5 mr-2"}),"Submit Review"]})})]})]})})]})}):null;var j},ti={}.VITE_API_BASE_URL||"http://localhost:3003/api",si=({invoice:t,onPaymentSuccess:s})=>{var r,a;const{isDark:n}=mt(),{user:i}=Br(),{showError:o}=Hr(),[l,c]=e.useState(!1),d=e=>{if(!e)return"N/A";try{return(e.toDate?e.toDate():new Date(e)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"N/A"}},u="pending"===t.status,h="paid"===t.status;return U.jsxs("div",{className:"rounded-2xl border p-6 transition-all "+(n?u?"border-orange-500/30 bg-gradient-to-br from-orange-500/10 to-amber-500/5":"border-white/10 bg-white/5":u?"border-orange-200 bg-gradient-to-br from-orange-50 to-amber-50":"border-slate-200 bg-white"),children:[U.jsxs("div",{className:"flex items-start justify-between mb-4",children:[U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx("div",{className:"p-3 rounded-xl "+(u?"bg-gradient-to-br from-orange-500 to-amber-500":"bg-gradient-to-br from-green-500 to-emerald-500"),children:U.jsx(Qs,{className:"w-6 h-6 text-white"})}),U.jsxs("div",{children:[U.jsx("h3",{className:"font-bold text-lg "+(n?"text-white":"text-slate-900"),children:t.subject}),U.jsxs("p",{className:"text-sm "+(n?"text-white/60":"text-slate-500"),children:["Invoice #",t.id.slice(-8).toUpperCase()]})]})]}),U.jsx("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-semibold "+(u?"bg-orange-500/20 text-orange-500":"bg-green-500/20 text-green-500"),children:u?U.jsxs(U.Fragment,{children:[U.jsx(bt,{className:"w-4 h-4"}),"Unpaid"]}):U.jsxs(U.Fragment,{children:[U.jsx($t,{className:"w-4 h-4"}),"Paid"]})})]}),U.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx(Nr,{className:"w-4 h-4 "+(n?"text-white/40":"text-slate-400")}),U.jsx("span",{className:"text-sm "+(n?"text-white/70":"text-slate-600"),children:t.tutorName})]}),U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx(xr,{className:"w-4 h-4 "+(n?"text-white/40":"text-slate-400")}),U.jsxs("span",{className:"text-sm "+(n?"text-white/70":"text-slate-600"),children:[t.durationMinutes," min"]})]}),U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx(Lt,{className:"w-4 h-4 "+(n?"text-white/40":"text-slate-400")}),U.jsx("span",{className:"text-sm "+(n?"text-white/70":"text-slate-600"),children:d(t.createdAt)})]}),U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx(as,{className:"w-4 h-4 "+(n?"text-white/40":"text-slate-400")}),U.jsxs("span",{className:"text-sm "+(n?"text-white/70":"text-slate-600"),children:["",t.hourlyRate,"/hour"]})]})]}),U.jsx("div",{className:"rounded-xl p-4 mb-4 "+(n?"bg-white/5":"bg-slate-50"),children:U.jsxs("div",{className:"space-y-2",children:[U.jsxs("div",{className:"flex justify-between",children:[U.jsx("span",{className:"text-sm "+(n?"text-white/60":"text-slate-500"),children:"Session Fee"}),U.jsxs("span",{className:"text-sm font-medium "+(n?"text-white":"text-slate-900"),children:["",null==(r=t.subtotal)?void 0:r.toFixed(2)]})]}),U.jsxs("div",{className:"flex justify-between",children:[U.jsxs("span",{className:"text-sm "+(n?"text-white/60":"text-slate-500"),children:["Platform Fee (",(100*t.platformFeeRate).toFixed(0),"%)"]}),U.jsx("span",{className:"text-sm "+(n?"text-white/40":"text-slate-400"),children:"Included"})]}),U.jsx("div",{className:"border-t pt-2 mt-2 "+(n?"border-white/10":"border-slate-200"),children:U.jsxs("div",{className:"flex justify-between items-center",children:[U.jsx("span",{className:"font-bold "+(n?"text-white":"text-slate-900"),children:"Total"}),U.jsxs("span",{className:"text-xl font-bold "+(u?"text-orange-500":"text-green-500"),children:["",null==(a=t.subtotal)?void 0:a.toFixed(2)]})]})})]})}),u&&U.jsx("button",{onClick:async()=>{if(!l){c(!0);try{const e=await(async(e,t,s,r,a,n)=>{try{console.log("Creating Invoice Stripe checkout session...",{invoiceId:e,amount:t,studentId:s,studentEmail:r});const i=await fetch(`${ti}/payment/stripe/create-invoice-checkout`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({invoiceId:e,amount:t,studentId:s,studentEmail:r,tutorName:a,subject:n})});console.log("Response status:",i.status);const o=await i.json();return console.log("Response result:",o),o.success?(console.log("Invoice checkout session created successfully, redirecting to:",o.url),{success:!0,sessionId:o.sessionId,url:o.url}):(console.error("Failed to create invoice checkout session:",o.error),{success:!1,error:o.error||"Failed to create checkout session"})}catch(i){return console.error("Error creating Invoice Stripe checkout:",i),{success:!1,error:"Network error. Please try again."}}})(t.id,t.subtotal,null==i?void 0:i.id,null==i?void 0:i.email,t.tutorName,t.subject);e.success&&e.url?window.location.href=e.url:o(e.error||"Failed to create checkout session",5e3,"Payment Error")}catch(e){console.error("Error processing payment:",e),o("An error occurred while processing payment",5e3,"Error")}finally{c(!1)}}},disabled:l,className:`w-full py-3 px-6 rounded-xl font-bold transition-all duration-300 flex items-center justify-center gap-2 ${l?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 hover:from-blue-600 hover:via-purple-600 hover:to-pink-600 hover:shadow-xl hover:-translate-y-0.5"} text-white`,children:l?U.jsxs(U.Fragment,{children:[U.jsx(As,{className:"w-5 h-5 animate-spin"}),"Processing..."]}):U.jsxs(U.Fragment,{children:[U.jsx(Kt,{className:"w-5 h-5"}),"Pay Now"]})}),h&&t.paidAt&&U.jsxs("div",{className:"flex items-center justify-center gap-2 py-3 "+(n?"text-green-400":"text-green-600"),children:[U.jsx($t,{className:"w-5 h-5"}),U.jsxs("span",{className:"font-medium",children:["Paid on ",d(t.paidAt)]})]})]})},ri=()=>{const{user:t}=Br(),{theme:s,isDark:r}=mt(),{showSuccess:a,showError:n}=Hr(),i=qe(),d=Ie(),[h,b]=e.useState([]),[f,w]=e.useState(!0),[y,v]=e.useState(null),[j,N]=e.useState(!1),[k,S]=e.useState(!1),[C,E]=e.useState(null),[A,T]=e.useState("all"),[I,P]=e.useState(!1),[q,R]=e.useState([]),[M,D]=e.useState(!1),[L,F]=e.useState(0),[$,O]=e.useState([]),[B,_]=e.useState({hasUnpaid:!1,unpaidCount:0,invoices:[]}),[z,W]=e.useState([]),[H,G]=e.useState("sessions"),[V,Y]=e.useState(!1);e.useEffect(()=>{(async()=>{const e=new URLSearchParams(d.search),s=e.get("payment"),r=e.get("session_id"),o=e.get("invoice_id");if("invoices"===e.get("tab")&&G("invoices"),"success"===s&&r){console.log(" Processing payment callback:",{sessionId:r,invoiceId:o}),Y(!0);try{const e=await(async e=>{try{const t=await fetch(`${ti}/payment/stripe/verify-invoice-payment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:e})}),s=await t.json();return s.success?{success:!0,studentId:s.studentId,invoiceId:s.invoiceId}:{success:!1,error:s.error||"Invoice payment verification failed"}}catch(t){return console.error("Error verifying invoice payment:",t),{success:!1,error:"Network error. Please try again."}}})(r);if(console.log(" Payment verification result:",e),e.success){if(a("Payment successful! Thank you for your payment.",5e3,"Payment Complete"),null==t?void 0:t.id){const e=await pn(t.id);e.success&&W(e.invoices);const s=await gn(t.id);s.success&&_({hasUnpaid:s.hasUnpaid,unpaidCount:s.unpaidCount,invoices:s.unpaidInvoices||[]})}}else console.error("Payment verification failed:",e.error),n("Payment verification failed. Please contact support if you were charged.",8e3,"Payment Error")}catch(l){console.error("Error processing payment callback:",l),n("Error processing payment. Please refresh the page.",5e3,"Error")}finally{Y(!1),i("/student-dashboard",{replace:!0})}}else"canceled"===s&&(n("Payment was canceled.",3e3,"Payment Canceled"),i("/student-dashboard",{replace:!0}))})()},[d.search]),e.useEffect(()=>{(async()=>{if(null==t?void 0:t.id)try{const e=await gn(t.id);e.success&&_({hasUnpaid:e.hasUnpaid,unpaidCount:e.unpaidCount,invoices:e.unpaidInvoices||[]});const s=await pn(t.id);s.success&&W(s.invoices)}catch(e){console.error("Error checking invoices:",e)}})()},[null==t?void 0:t.id]),e.useEffect(()=>{let e=null;const s=()=>{if(e&&"function"==typeof e)try{e()}catch(t){console.error("Error cleaning up chat list listener:",t)}};return(null==t?void 0:t.id)&&M?(e=En(t.id,async e=>{if(e.success){const t=await Promise.all(e.chatList.map(async e=>{try{const t=await m(u(dt,"users",e.userId));if(t.exists()){const s=t.data();return s.isTutor?{...e,user:{id:e.userId,name:s.name||"Unknown",email:s.email||"",avatar:s.avatar||null}}:null}return null}catch(t){return console.error("Error getting user info:",t),null}}));R(t.filter(e=>null!==e))}},"tutor"),s):s},[null==t?void 0:t.id,M]),e.useEffect(()=>{if(!(null==t?void 0:t.id))return;const e=An(t.id,async e=>{if(F(e),e>0)try{const e=await getUnreadTutorsList(t.id);if(e.success&&e.tutorIds.length>0){const t=e.tutorIds.map(async e=>{try{const t=await m(u(dt,"users",e));if(t.exists())return{id:e,name:t.data().name||"Tutor"}}catch(t){console.error("Error getting tutor info:",t)}return null}),s=(await Promise.all(t)).filter(Boolean);O(s)}else O([])}catch(s){console.error("Error getting unread tutors list:",s)}else O([])});return()=>{e&&e()}},[null==t?void 0:t.id]),e.useEffect(()=>{let e=null;const s=()=>{if(e&&"function"==typeof e)try{e()}catch(t){console.error("Error cleaning up sessions listener:",t)}};if(!(null==t?void 0:t.id))return s;w(!0);const r=o(dt,"sessions"),a=l(r,c("studentId","==",null==t?void 0:t.id));return e=g(a,async e=>{const t=[];for(const s of e.docs){const e=s.data();let r={id:e.tutorId,name:"Unknown",email:"",avatar:null};try{const t=await m(u(dt,"users",e.tutorId));if(t.exists()){const s=t.data();r={id:e.tutorId,name:s.name||"Unknown",email:s.email||"",avatar:s.avatar||null}}}catch(To){}console.log(" Student received session update:",{sessionId:s.id,status:e.status,meetingCode:e.meetingCode,tutorId:e.tutorId,studentId:e.studentId,allData:e});const a="accepted"===e.status||"active"===e.status;console.log(" Button display check:",{sessionId:s.id,status:e.status,shouldShowButton:a,buttonText:"active"===e.status?"Join Meeting":"Waiting for Meeting"}),t.push({id:s.id,...e,tutor:r})}t.sort((e,t)=>{const s=qa(e.createdAt);return qa(t.createdAt)-s}),b(t),w(!1)}),s},[null==t?void 0:t.id]);const Q=async e=>{var s,r;try{if(B.hasUnpaid)return n(`You have ${B.unpaidCount} unpaid invoice(s). Please pay your outstanding invoices before joining video calls.`,6e3,"Payment Required"),void G("invoices");let o=h.find(t=>t.id===e);if(!o)return;if(console.log(" Student clicked join meeting:",{sessionId:e,sessionStatus:o.status,meetingCode:o.meetingCode,sessionData:o}),console.log(" Current user info:",t),console.log(" Current session list:",h),"accepted"===o.status){console.log(" Session status is accepted, trying to start session...");const t=await Va(e);t.success?(console.log(" Session started successfully"),b(t=>t.map(t=>t.id===e?{...t,status:"active"}:t))):console.error(" Session start failed:",t.error)}let l=o.meetingCode;if(console.log(" Check meeting code:",l),!l){console.log(" No meeting code locally, trying to fetch from server...");try{const{doc:t,getDoc:s}=await ia(()=>import("./firebase-48788c29.js").then(e=>e.v),[]),{db:r}=await ia(()=>Promise.resolve().then(()=>ut),void 0),a=t(r,"sessions",e),n=await s(a);if(n.exists()){const t=n.data();l=t.meetingCode,console.log(" Session data fetched from server:",{status:t.status,meetingCode:t.meetingCode,allData:t}),l&&(b(s=>s.map(s=>s.id===e?{...s,meetingCode:l,status:t.status}:s)),o={...o,meetingCode:l})}}catch(i){console.error(" Failed to fetch session data from server:",i)}}if(!l)return console.log(" No meeting code, prompting student to wait for tutor to create meeting"),void n("Please wait for tutor to create meeting");if(console.log(" :",{meetingCode:l,sessionStatus:o.status,tutorId:null==(s=o.tutor)?void 0:s.id,studentId:null==(r=o.student)?void 0:r.id}),"active"!==o.status)return console.log("  active"),void n("Please wait for the tutor to create the meeting");const c=await hn(null==t?void 0:t.id,"videoCall");if(!c.success||!c.canPerform)return void n(c.error||"Daily video call limit reached. Please upgrade to Pro for more calls.",5e3,"Limit Reached");const d=await mn(null==t?void 0:t.id,"videoCall");if(window.dispatchEvent(new Event("limits-refresh")),!d.success)return void n(d.error||"Failed to join video call. Limit may have been reached.",5e3,"Error");console.log(" :",{meetingCode:l,user:t,sessionId:e});const g=await(async(e,t)=>{var s,r,a,n;try{const i=u(dt,"meetings",e),o=await m(i);if(!o.exists())return{success:!1,error:"Meeting does not exist or has ended"};const l=o.data();if("ended"===l.status)return{success:!1,error:"Meeting has ended"};if(console.log(" :",{meetingCode:e,userRole:t.role,userId:t.id,meetingCreator:null==(s=l.creator)?void 0:s.id,meetingParticipants:null==(r=l.participants)?void 0:r.map(e=>({id:e.id,role:e.role}))}),"student"===t.role&&"tutor"!==(null==(a=l.creator)?void 0:a.role))return console.log(" "),{success:!1,error:"No permission to join this meeting"};if(null==(n=l.participants)?void 0:n.find(e=>e.id===t.id))return{success:!0,meetingData:l,isExistingParticipant:!0};const c={id:t.id,name:t.name,role:t.role||"student",joinedAt:(new Date).toISOString()},d=[...l.participants||[],c];return await x(i,{participants:d,lastActivity:p()}),console.log(" :",t.name,e),{success:!0,meetingData:{...l,participants:d},isExistingParticipant:!1}}catch(i){return console.error(" :",i),{success:!1,error:i.message}}})(l,t);console.log(" :",g),console.log(" :",{meetingCode:l,sessionStatus:o.status,sessionData:o,isFromServer:"",isFromLocal:""}),g.success?(console.log(" :",l),E({...o,meetingCode:l,meetingData:g.meetingData,student:t,tutor:o.tutor}),S(!0),a(`Joined meeting! Code: ${l}`)):(console.error(" :",g.error),n(`Failed to join meeting: ${g.error}`)),console.log("Session started:",e)}catch(o){console.error("Error starting session:",o)}},J=()=>{switch(A){case"completed":return h.filter(e=>"completed"===e.status);case"pending":return h.filter(e=>["pending","accepted","active"].includes(e.status));case"accepted":return h.filter(e=>"accepted"===e.status);case"active":return h.filter(e=>"active"===e.status);default:return h}},K=e=>{if(!e)return"Unknown date";return new Date(qa(e)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},X=e=>{if(null==e)return null;const t=Math.max(0,Math.floor(e)),s=Math.floor(t/3600),r=Math.floor(t%3600/60),a=t%60;return s>0?`${s.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`:`${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},Z=e=>{switch(e){case"pending":return U.jsx(Ht,{className:"w-5 h-5 text-yellow-500"});case"accepted":return U.jsx($t,{className:"w-5 h-5 text-green-500"});case"active":return U.jsx(Vs,{className:"w-5 h-5 text-blue-500"});case"completed":return U.jsx($t,{className:"w-5 h-5 text-gray-500"});case"rejected":case"declined":case"cancelled":return U.jsx(Rr,{className:"w-5 h-5 text-red-500"});default:return U.jsx(bt,{className:"w-5 h-5 text-gray-500"})}},ee=e=>{switch(e){case"pending":return"Waiting for Response";case"accepted":return"Ready to Start";case"active":return"Session Active";case"completed":return"Session Completed";case"rejected":case"declined":return"Request Declined";case"cancelled":return"Request Cancelled";default:return"Unknown Status"}};return f?U.jsx("div",{className:"min-h-screen flex items-center justify-center "+(r?"bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900":"bg-gradient-to-br from-slate-100 via-blue-50 to-purple-100"),children:U.jsxs("div",{className:"text-center",children:[U.jsxs("div",{className:"relative",children:[U.jsx("div",{className:"absolute inset-0 rounded-2xl blur-lg "+(r?"bg-gradient-to-r from-blue-500 to-purple-600 opacity-30":"bg-gradient-to-r from-blue-500 to-purple-600 opacity-50 shadow-2xl shadow-blue-300/30")}),U.jsx("div",{className:"relative w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center mx-auto mb-4 shadow-lg",children:U.jsx(Vs,{className:"w-8 h-8 text-white animate-pulse"})})]}),U.jsx("h3",{className:"text-lg font-semibold mb-2 "+(r?"text-white":"text-gray-800"),children:"Loading Dashboard"}),U.jsx("p",{className:"text-sm "+(r?"text-gray-300":"text-gray-600"),children:"Loading your tutoring sessions..."})]})}):U.jsxs("div",{className:"min-h-screen relative overflow-hidden "+(r?"bg-gradient-to-br from-[#130d2f] via-[#1a1240] to-[#08071a] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:[U.jsx("style",{children:"\n        .hide-scrollbar::-webkit-scrollbar { width: 0; height: 0; }\n        .hide-scrollbar { scrollbar-width: none; }\n      "}),U.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[U.jsx("div",{className:"absolute -top-36 left-1/2 h-80 w-80 -translate-x-1/2 rounded-full bg-purple-500/30 blur-3xl"}),U.jsx("div",{className:"absolute bottom-12 right-16 h-72 w-72 rounded-full bg-pink-400/20 blur-[140px]"}),U.jsx("div",{className:"absolute top-1/2 left-12 h-60 w-60 rounded-full bg-blue-400/25 blur-[120px]"})]}),U.jsxs("div",{className:"relative z-10 mx-auto flex w-full max-w-7xl flex-col gap-10 px-6 py-14 hide-scrollbar",children:[L>0&&U.jsx("div",{className:"rounded-2xl border px-6 py-4 shadow-lg backdrop-blur-xl "+(r?"border-purple-500/30 bg-gradient-to-r from-purple-500/20 to-pink-500/20":"border-purple-200 bg-gradient-to-r from-purple-50 to-pink-50"),children:U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx(Ms,{className:"h-5 w-5 "+(r?"text-purple-300":"text-purple-600")}),U.jsxs("div",{children:[U.jsxs("p",{className:"font-semibold "+(r?"text-white":"text-slate-900"),children:["You have ",L," unread message",L>1?"s":""," from ",$.length>0?$.map(e=>e.name).join(", "):"tutors"]}),U.jsx("p",{className:"text-sm mt-0.5 "+(r?"text-white/70":"text-slate-600"),children:$.length>0?U.jsxs(U.Fragment,{children:[U.jsx("span",{className:"font-medium",children:"From Tutor Chat:"})," ",1===$.length?`Message from ${$[0].name}`:`Messages from ${$.map(e=>e.name).join(", ")}`,U.jsx("br",{}),U.jsx("span",{className:"text-xs opacity-75",children:'Click "View Messages" to open Tutor Chat and view your messages'})]}):'Click "View Messages" to view your messages from tutors'})]})]}),U.jsx("button",{onClick:()=>{D(!0)},className:"rounded-xl px-4 py-2 text-sm font-semibold transition-all bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600",children:"View Messages"})]})}),U.jsxs("section",{className:"grid gap-8 lg:grid-cols-[minmax(0,60%)_minmax(0,40%)]",children:[U.jsxs("div",{className:"rounded-[32px] border px-8 py-9 shadow-2xl backdrop-blur-xl "+(r?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-purple-500/10 px-3.5 py-2 text-xs font-semibold text-purple-500",children:[U.jsx(Vs,{className:"h-4 w-4"})," Keep your learning momentum"]}),U.jsx("h1",{className:"mt-4 text-3xl font-black tracking-tight md:text-4xl",children:"Continue your tutoring adventures and track every milestone"}),U.jsx("p",{className:"mt-3 max-w-xl text-sm md:text-base "+(r?"text-white/70":"text-slate-600"),children:"View upcoming sessions, join active meetings, and revisit completed lessons. Filter by status, rate tutors, and monitor your progressall from one place."}),U.jsxs("div",{className:"mt-6 space-y-4",children:[U.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[U.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide mr-2 "+(r?"text-white/60":"text-slate-500"),children:"Filter:"}),["all","pending","accepted","active","completed"].map(e=>U.jsx("button",{onClick:()=>(e=>{T(e),"ratings"!==e&&P(!1)})(e),className:"rounded-xl px-4 py-2 text-sm font-semibold transition-all duration-200 "+(A===e?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-md shadow-purple-500/30":r?"bg-white/8 text-white/70 hover:bg-white/12 border border-white/10":"bg-white text-slate-700 hover:bg-slate-50 border border-slate-200"),children:"all"===e?"All":e.charAt(0).toUpperCase()+e.slice(1)},e))]}),U.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[U.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide mr-2 "+(r?"text-white/60":"text-slate-500"),children:"Actions:"}),U.jsxs("button",{onClick:()=>{P(!I),T("ratings")},className:"rounded-xl px-4 py-2 text-sm font-semibold transition-all duration-200 flex items-center gap-2 "+(I?"bg-gradient-to-r from-blue-500 to-cyan-500 text-white shadow-md shadow-blue-500/30":r?"bg-white/8 text-white/70 hover:bg-white/12 border border-white/10":"bg-white text-slate-700 hover:bg-slate-50 border border-slate-200"),children:[U.jsx(or,{className:"h-4 w-4"}),I?"Hide Ratings":"View Ratings"]}),U.jsxs("button",{onClick:()=>D(!M),className:"rounded-xl px-4 py-2 text-sm font-semibold transition-all duration-200 flex items-center gap-2 "+(M?"bg-gradient-to-r from-indigo-500 to-purple-500 text-white shadow-md shadow-indigo-500/30":r?"bg-white/8 text-white/70 hover:bg-white/12 border border-white/10":"bg-white text-slate-700 hover:bg-slate-50 border border-slate-200"),children:[U.jsx(Ms,{className:"h-4 w-4"}),M?"Hide Chat":"Chat with Tutors"]})]}),U.jsxs("div",{className:"flex items-center gap-2 mt-4 pt-4 border-t border-white/10",children:[U.jsxs("button",{onClick:()=>G("sessions"),className:"rounded-xl px-5 py-2.5 text-sm font-semibold transition-all duration-200 flex items-center gap-2 "+("sessions"===H?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg shadow-purple-500/30":r?"bg-white/8 text-white/70 hover:bg-white/12 border border-white/10":"bg-white text-slate-700 hover:bg-slate-50 border border-slate-200"),children:[U.jsx(Cr,{className:"h-4 w-4"}),"Sessions"]}),U.jsxs("button",{onClick:()=>G("invoices"),className:"rounded-xl px-5 py-2.5 text-sm font-semibold transition-all duration-200 flex items-center gap-2 "+("invoices"===H?"bg-gradient-to-r from-orange-500 to-amber-500 text-white shadow-lg shadow-orange-500/30":r?"bg-white/8 text-white/70 hover:bg-white/12 border border-white/10":"bg-white text-slate-700 hover:bg-slate-50 border border-slate-200"),children:[U.jsx(Qs,{className:"h-4 w-4"}),"Invoices",B.hasUnpaid&&U.jsx("span",{className:"ml-1 px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full",children:B.unpaidCount})]})]})]})]}),U.jsx("div",{className:"rounded-[32px] border px-6 py-6 shadow-lg backdrop-blur-xl "+(r?"border-white/12 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:U.jsxs("div",{className:"space-y-4",children:[U.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[U.jsxs("div",{className:"rounded-2xl border px-4 py-4 "+(r?"border-white/10 bg-white/8":"border-slate-200 bg-white"),children:[U.jsx("p",{className:"text-xs uppercase tracking-wide text-purple-400",children:"Completed sessions"}),U.jsx("p",{className:"mt-1 text-lg font-semibold "+(r?"text-white drop-shadow-[0_0_10px_rgba(255,255,255,0.25)]":"text-slate-800"),children:h.filter(e=>"completed"===e.status).length})]}),U.jsxs("div",{className:"rounded-2xl border px-4 py-4 "+(r?"border-white/10 bg-white/8":"border-slate-200 bg-white"),children:[U.jsx("p",{className:"text-xs uppercase tracking-wide text-purple-400",children:"Upcoming"}),U.jsx("p",{className:"mt-1 text-lg font-semibold "+(r?"text-white drop-shadow-[0_0_10px_rgba(255,255,255,0.25)]":"text-slate-800"),children:h.filter(e=>["pending","accepted","active"].includes(e.status)).length})]})]}),U.jsxs("div",{className:"rounded-2xl border px-4 py-5 "+(r?"border-white/10 bg-white/8":"border-slate-200 bg-white"),children:[U.jsx("p",{className:"text-xs uppercase tracking-wide text-purple-400",children:"Average rating given"}),U.jsx("p",{className:"mt-2 text-2xl font-bold "+(r?"text-white drop-shadow-[0_0_12px_rgba(255,255,255,0.25)]":"text-slate-900"),children:h.filter(e=>e.rating).length>0?(h.filter(e=>e.rating).reduce((e,t)=>e+t.rating,0)/h.filter(e=>e.rating).length).toFixed(1):"N/A"})]})]})})]}),M&&U.jsxs("section",{className:"rounded-[32px] border px-6 py-6 backdrop-blur-xl "+(r?"border-white/12 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"flex items-center justify-between mb-6",children:[U.jsx("h3",{className:"text-lg font-semibold "+(r?"text-white":"text-slate-900"),children:"Chat with Tutors"}),U.jsx("button",{onClick:()=>D(!1),className:"rounded-full px-4 py-2 text-sm font-semibold transition-all "+(r?"bg-white/10 text-white hover:bg-white/15":"bg-slate-100 text-slate-700 hover:bg-slate-200"),children:"Close"})]}),q.length>0?U.jsx("div",{className:"space-y-3",children:q.map(e=>{var t;return U.jsx("div",{onClick:()=>i(`/chat-tutor/${e.userId}`,{state:{from:"student-dashboard"}}),className:"group rounded-2xl border p-4 cursor-pointer transition-all hover:shadow-xl hover:scale-[1.02] "+(r?"bg-white/10 border-white/20 hover:bg-white/15":"bg-white border-slate-200 hover:bg-slate-50"),children:U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx(Za,{user:e.user,size:"lg",className:"shadow-lg"}),U.jsxs("div",{className:"flex-1 min-w-0",children:[U.jsx("h3",{className:"text-base font-semibold mb-1 "+(r?"text-white":"text-gray-900"),children:(null==(t=e.user)?void 0:t.name)||"Unknown Tutor"}),U.jsx("p",{className:"text-sm truncate "+(r?"text-gray-300":"text-gray-600"),children:e.latestMessage||"No messages yet"})]}),U.jsx("div",{className:"text-right",children:U.jsx("p",{className:"text-xs "+(r?"text-gray-400":"text-gray-500"),children:e.latestMessageTime?Cn(e.latestMessageTime):""})})]})},e.userId)})}):U.jsxs("div",{className:"rounded-2xl p-8 text-center "+(r?"bg-white/5":"bg-slate-50"),children:[U.jsx(Ms,{className:"h-12 w-12 mx-auto mb-4 "+(r?"text-white/40":"text-slate-400")}),U.jsx("p",{className:"text-sm "+(r?"text-white/60":"text-slate-600"),children:"No messages yet. Start chatting with tutors from the tutoring page."})]})]}),I&&U.jsxs("section",{className:"rounded-[32px] border px-6 py-6 backdrop-blur-xl "+(r?"border-white/12 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsx("h3",{className:"text-lg font-semibold",children:"All Ratings Given"}),U.jsx("button",{onClick:()=>P(!1),className:"rounded-full px-4 py-2 text-sm font-semibold transition-all "+(r?"bg-white/10 text-white hover:bg-white/15":"bg-slate-100 text-slate-700 hover:bg-slate-200"),children:"Close"})]}),U.jsx("div",{className:"mt-5 space-y-4",children:h.filter(e=>e.rating).length>0?h.filter(e=>e.rating).map(e=>{var t;return U.jsxs("div",{className:"flex items-center justify-between rounded-2xl border px-4 py-4 "+(r?"border-white/12 bg-white/8":"border-slate-200 bg-white"),children:[U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx(Za,{user:e.tutor,size:"md"}),U.jsxs("div",{children:[U.jsx("h4",{className:"text-sm font-semibold",children:(null==(t=e.tutor)?void 0:t.name)||"Unknown Tutor"}),U.jsxs("p",{className:"text-xs "+(r?"text-white/60":"text-slate-500"),children:[e.subject,"  ",K(e.createdAt)]})]})]}),U.jsxs("div",{className:"flex items-center gap-2",children:[[1,2,3,4,5].map(t=>U.jsx(or,{className:"h-4 w-4 "+(t<=e.rating?"text-yellow-400 fill-current":r?"text-white/30":"text-slate-300")},t)),U.jsxs("span",{className:"text-sm font-semibold",children:[e.rating,"/5"]})]})]},e.id)}):U.jsx("div",{className:"rounded-2xl border px-6 py-10 text-center text-sm "+(r?"border-white/10 bg-white/8 text-white/60":"border-slate-200 bg-white text-slate-600"),children:"No ratings given yet. Complete sessions and rate your tutors to see them here."})})]}),"sessions"===H&&U.jsxs("section",{className:`rounded-[32px] border px-6 py-6 backdrop-blur-xl ${r?"border-white/12 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"} hide-scrollbar`,children:[U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsx("h3",{className:"text-lg font-semibold",children:"My Sessions"}),0===J().length&&U.jsx("span",{className:"text-xs "+(r?"text-white/60":"text-slate-500"),children:"No sessions yet  start your learning journey!"})]}),0===J().length?U.jsxs("div",{className:"mt-10 rounded-2xl border px-6 py-12 text-center text-sm "+(r?"border-white/10 bg-white/8 text-white/60":"border-slate-200 bg-white text-slate-600"),children:[U.jsx("div",{className:"text-5xl mb-4",children:""}),U.jsx("p",{children:"No sessions found for this filter."})]}):U.jsx("div",{className:"mt-6 space-y-4",children:J().map(e=>{var t;const s=(e=>e?e.callDurationFormatted?e.callDurationFormatted:void 0!==e.callDurationSeconds&&null!==e.callDurationSeconds?X(e.callDurationSeconds):void 0!==e.durationSeconds&&null!==e.durationSeconds?X(e.durationSeconds):null:null)(e),a={pending:"from-yellow-500 to-orange-500",accepted:"from-green-500 to-emerald-500",active:"from-blue-500 to-cyan-500",completed:"from-slate-500 to-slate-600",rejected:"from-red-500 to-pink-500",declined:"from-red-500 to-pink-500",cancelled:"from-red-500 to-pink-500"}[e.status]||"from-slate-500 to-slate-600";return U.jsx("div",{className:"rounded-[28px] border px-5 py-5 backdrop-blur-xl transition-transform hover:-translate-y-1 hover:shadow-2xl "+(r?"border-white/12 bg-white/8":"border-slate-200 bg-white"),children:U.jsxs("div",{className:"flex items-center justify-between gap-4",children:[U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx(Za,{user:e.tutor,size:"lg"}),U.jsxs("div",{children:[U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx("h3",{className:"text-base font-semibold "+(r?"text-white":"text-slate-900"),children:null==(t=e.tutor)?void 0:t.name}),U.jsx("span",{className:"rounded-full px-3 py-1 text-[11px] font-semibold "+(r?"bg-white/10 text-white/80":"bg-purple-100 text-purple-600"),children:e.subject||"General"})]}),U.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-3 text-xs "+(r?"text-white/60":"text-slate-500"),children:[U.jsxs("span",{className:"flex items-center gap-1",children:[U.jsx(Ht,{className:"h-3.5 w-3.5"}),e.preferredTime?new Date(e.preferredTime).toLocaleString():e.scheduledTime?new Date(e.scheduledTime).toLocaleString():"Flexible"]}),U.jsxs("span",{className:"flex items-center gap-1",children:[U.jsx(or,{className:"h-3.5 w-3.5"}),e.tutor.rating||"New Tutor"]}),s&&U.jsxs("span",{className:"flex items-center gap-1",children:[U.jsx(xr,{className:"h-3.5 w-3.5"}),s]})]})]})]}),U.jsxs("div",{className:"flex flex-col items-end gap-3",children:[U.jsxs("div",{className:`flex items-center gap-2 rounded-full px-4 py-2 text-xs font-semibold text-white bg-gradient-to-r ${a} shadow-lg shadow-black/20`,children:[Z(e.status),U.jsx("span",{children:ee(e.status)})]}),U.jsxs("div",{className:"flex gap-2",children:[("accepted"===e.status||"active"===e.status)&&U.jsx("button",{onClick:()=>Q(e.id),className:"rounded-2xl bg-gradient-to-r from-blue-500 to-cyan-500 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-blue-500/30 hover:-translate-y-0.5 transition",children:"active"===e.status?"Join meeting":"Start session"}),"completed"===e.status&&U.jsx("button",{onClick:()=>(async e=>{v(h.find(t=>t.id===e)),N(!0)})(e.id),className:"rounded-2xl bg-gradient-to-r from-purple-500 to-pink-500 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-purple-500/30 hover:-translate-y-0.5 transition",children:e.rated?"Rated":"Rate tutor"})]})]})]})},e.id)})})]}),"invoices"===H&&U.jsxs("section",{className:`rounded-[32px] border px-6 py-6 backdrop-blur-xl ${r?"border-white/12 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"} hide-scrollbar`,children:[U.jsxs("div",{className:"flex items-center justify-between mb-6",children:[U.jsxs("div",{children:[U.jsx("h3",{className:"text-lg font-semibold "+(r?"text-white":"text-slate-900"),children:"My Invoices"}),U.jsx("p",{className:"text-sm mt-1 "+(r?"text-white/60":"text-slate-500"),children:"Pay your tutoring session invoices to continue booking new sessions"})]}),B.hasUnpaid&&U.jsx("div",{className:"px-4 py-2 rounded-xl "+(r?"bg-orange-500/20 text-orange-400":"bg-orange-100 text-orange-600"),children:U.jsxs("span",{className:"font-semibold",children:[B.unpaidCount," Unpaid"]})})]}),0===z.length?U.jsxs("div",{className:"rounded-2xl border px-6 py-12 text-center "+(r?"border-white/10 bg-white/5":"border-slate-200 bg-slate-50"),children:[U.jsx(Qs,{className:"w-16 h-16 mx-auto mb-4 "+(r?"text-white/30":"text-slate-300")}),U.jsx("p",{className:"text-lg font-semibold mb-2 "+(r?"text-white":"text-slate-900"),children:"No invoices yet"}),U.jsx("p",{className:"text-sm "+(r?"text-white/60":"text-slate-500"),children:"Complete tutoring sessions to receive invoices"})]}):U.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:z.map(e=>U.jsx(si,{invoice:e},e.id))})]})]}),j&&y&&U.jsx(ei,{isOpen:j,onClose:()=>{N(!1),v(null)},sessionData:y,tutor:y.tutor}),k&&C&&U.jsx(cn,{isOpen:k,onClose:()=>{S(!1),E(null)},sessionData:C,user:t})]})},ai=({isOpen:t,onClose:s,onConfirm:r,type:a,item:n,loading:i=!1})=>{var o,l,c,d;const{showError:u}=Hr(),[h,m]=e.useState(""),[x,p]=e.useState("");if(!t)return null;const g="tutor"===a,b="review"===a,f="account"===a,w="unban"===a,y=g?"DELETE TUTOR":f?"BAN ACCOUNT":w?"UNBAN ACCOUNT":"DELETE REVIEW",v=h===y;return U.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:U.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[U.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white z-10",children:[U.jsxs("div",{className:"flex items-center space-x-3",children:[U.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center "+(w?"bg-gradient-to-r from-green-500 to-green-600":"bg-gradient-to-r from-red-500 to-red-600"),children:w?U.jsx($t,{className:"w-5 h-5 text-white"}):U.jsx(ft,{className:"w-5 h-5 text-white"})}),U.jsxs("div",{children:[U.jsx("h2",{className:"text-xl font-bold text-gray-900",children:g?"Delete Tutor Profile":f?"Ban User Account":w?"Unban User Account":b?"Delete Review":"Delete Item"}),U.jsx("p",{className:"text-sm text-gray-600",children:"Administrative action"})]})]}),U.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",disabled:i,children:U.jsx(Rr,{className:"w-5 h-5 text-gray-500"})})]}),U.jsxs("div",{className:"p-6",children:[U.jsx("p",{className:"text-gray-700 mb-6",children:g?`Are you sure you want to delete ${null==n?void 0:n.name}'s tutor profile? This will permanently remove all their tutor information, sessions, and reviews.`:f?`Are you sure you want to ban ${null==n?void 0:n.name}'s account? This will prevent them from logging in and they will be logged out immediately with a 5-second countdown.`:w?`Are you sure you want to unban ${null==n?void 0:n.name}'s account? This will restore their access and allow them to log in again.`:b?"Are you sure you want to delete this review? This action cannot be undone.":"Are you sure you want to delete this item? This action cannot be undone."}),U.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[U.jsxs("div",{className:"space-y-4",children:[g&&n&&U.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:[U.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[U.jsx(Nr,{className:"w-5 h-5 text-red-600"}),U.jsx("span",{className:"font-semibold text-red-800",children:"Tutor Information"})]}),U.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-red-700",children:[U.jsxs("p",{children:[U.jsx("strong",{children:"Name:"})," ",n.name]}),U.jsxs("p",{children:[U.jsx("strong",{children:"Email:"})," ",n.email]}),U.jsxs("p",{children:[U.jsx("strong",{children:"Sessions:"})," ",(null==(o=n.stats)?void 0:o.totalSessions)||0]}),U.jsxs("p",{children:[U.jsx("strong",{children:"Reviews:"})," ",(null==(l=n.stats)?void 0:l.ratingCount)||0]})]})]}),f&&n&&U.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:[U.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[U.jsx(Nr,{className:"w-5 h-5 text-red-600"}),U.jsx("span",{className:"font-semibold text-red-800",children:"Account Information"})]}),U.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-red-700",children:[U.jsxs("p",{children:[U.jsx("strong",{children:"Name:"})," ",n.name]}),U.jsxs("p",{children:[U.jsx("strong",{children:"Email:"})," ",n.email]}),U.jsxs("p",{children:[U.jsx("strong",{children:"School:"})," ",n.school||"N/A"]}),U.jsxs("p",{children:[U.jsx("strong",{children:"Grade:"})," ",n.grade||"N/A"]}),U.jsxs("p",{children:[U.jsx("strong",{children:"Is Tutor:"})," ",n.isTutor?"Yes":"No"]}),n.isTutor&&U.jsxs(U.Fragment,{children:[U.jsxs("p",{children:[U.jsx("strong",{children:"Sessions:"})," ",(null==(c=n.stats)?void 0:c.totalSessions)||0]}),U.jsxs("p",{children:[U.jsx("strong",{children:"Reviews:"})," ",(null==(d=n.stats)?void 0:d.ratingCount)||0]})]})]})]}),b&&n&&U.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:[U.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[U.jsx(or,{className:"w-5 h-5 text-red-600"}),U.jsx("span",{className:"font-semibold text-red-800",children:"Review Information"})]}),U.jsxs("div",{className:"text-sm text-red-700 space-y-1",children:[U.jsxs("p",{children:[U.jsx("strong",{children:"Rating:"})," ",n.rating,"/5 stars"]}),U.jsxs("p",{children:[U.jsx("strong",{children:"Student:"})," ",n.studentName]}),U.jsxs("p",{children:[U.jsx("strong",{children:"Review:"})," ",n.review||"No comment"]})]})]}),U.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4",children:U.jsxs("div",{className:"flex items-start space-x-3",children:[U.jsx(ft,{className:"w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0"}),U.jsxs("div",{children:[U.jsx("p",{className:"font-semibold text-yellow-800 mb-1",children:"Warning"}),U.jsx("p",{className:"text-sm text-yellow-700",children:g?"This will permanently delete the tutor profile and all associated data including sessions, reviews, and statistics.":f?"This will ban the user account. The user will be logged out immediately with a 5-second countdown and will not be able to log in again. They will see a message that their account has been banned by the administrator.":w?"This will restore the user's access to their account. They will be able to log in again immediately.":b?"This will permanently delete the review and update the tutor's rating statistics.":"This action cannot be undone."})]})]})})]}),U.jsx("div",{children:U.jsxs("form",{onSubmit:e=>{e.preventDefault(),console.log(" Delete modal form submitted"),console.log(" Confirm text:",h),console.log(" Required text:",y),console.log(" Is valid:",v),v?(console.log(" Confirmation valid, calling onConfirm"),f?r(x):r()):u("Please type the confirmation text exactly as shown","Invalid Confirmation")},className:"space-y-6",children:[f&&U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message to user (optional):"}),U.jsx("textarea",{value:x,onChange:e=>p(e.target.value),placeholder:"Enter a message that will be shown to the user before they are logged out...",rows:4,className:"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none",disabled:i}),U.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This message will be displayed to the user with a 5-second countdown before logout. If left empty, a default message will be shown."})]}),U.jsxs("div",{children:[U.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Type ",U.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:y})," to confirm:"]}),U.jsx("input",{type:"text",value:h,onChange:e=>m(e.target.value),placeholder:`Type "${y}" here`,className:"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent",disabled:i,autoComplete:"off"})]}),U.jsxs("div",{className:"flex space-x-3 pt-2",children:[U.jsx("button",{type:"button",onClick:s,disabled:i,className:"flex-1 py-3 px-4 border-2 border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors font-medium disabled:opacity-50",children:"Cancel"}),U.jsx("button",{type:"submit",disabled:!v||i,className:"flex-1 py-3 px-4 text-white rounded-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center space-x-2 "+(w?"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700":"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700"),children:i?U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),U.jsx("span",{children:w?"Unbanning...":"Deleting..."})]}):U.jsxs(U.Fragment,{children:[w?U.jsx($t,{className:"w-4 h-4"}):U.jsx(pr,{className:"w-4 h-4"}),U.jsx("span",{children:g?"Delete Tutor":f?"Ban Account":w?"Unban Account":"Delete Review"})]})})]})]})})]})]})]})})},ni=()=>{const{user:t}=Br(),{showError:s}=Hr(),[r,a]=e.useState([]),[n,i]=e.useState(!0),[c,h]=e.useState(""),[g,b]=e.useState("all"),[w,y]=e.useState("createdAt"),[v,j]=e.useState("desc"),[N,k]=e.useState(!1),[S,C]=e.useState(null),[E,A]=e.useState(!1),[T,I]=e.useState(null),[P,q]=e.useState(""),[R,M]=e.useState(!1);null==t||t.email,e.useEffect(()=>{t&&(console.log(" Admin access granted, loading tutors..."),D())},[t]);const D=async()=>{var e,t,r,n,c;try{i(!0),console.log(" Loading all tutors for admin...");const s=o(dt,"users"),u=l(s),h=await d(u);console.log(" Total users found:",h.docs.length);const m=[];let x=0;for(const a of h.docs){const s=a.data();if(console.log(" User data:",{id:a.id,name:s.name,email:s.email,isTutor:s.isTutor}),!s.isTutor)continue;x++,console.log(` Found tutor ${x}:`,s.name);const i=await L(a.id);m.push({id:a.id,name:s.name||"Unknown",email:s.email||"No email",phone:s.phone||"No phone",school:s.school||"Not specified",grade:s.grade||"Not specified",bio:s.bio||"No bio",subjects:s.subjects||[],tutorProfile:s.tutorProfile||{},location:s.location||"Online",avatar:s.avatar||null,createdAt:s.createdAt,updatedAt:s.updatedAt,lastLogin:s.lastLogin,isAvailable:!1!==(null==(e=s.tutorProfile)?void 0:e.isAvailable),specialties:(null==(t=s.tutorProfile)?void 0:t.specialties)||s.subjects||[],description:(null==(r=s.tutorProfile)?void 0:r.description)||s.bio||"No description",experience:(null==(n=s.tutorProfile)?void 0:n.experience)||"Student",responseTime:(null==(c=s.tutorProfile)?void 0:c.responseTime)||"Not specified",stats:i})}m.sort((e,t)=>{const s=e.createdAt?e.createdAt.seconds:0;return(t.createdAt?t.createdAt.seconds:0)-s}),console.log(" Loaded tutors:",m.length),a(m)}catch(u){console.error(" Error loading tutors:",u),s(`Failed to load tutors: ${u.message}`,"Error")}finally{i(!1)}},L=async e=>{try{console.log(" Getting stats for tutor:",e);const t=u(dt,"tutorStats",e),s=await m(t);if(console.log(" Stats doc exists:",s.exists()),s.exists()){const e=s.data();console.log(" Stats data:",e);const t={totalSessions:e.totalSessions||0,completedSessions:e.completedSessions||0,totalRating:e.totalRating||0,ratingCount:e.ratingCount||0,averageRating:e.ratingCount>0?e.totalRating/e.ratingCount:0,totalEarnings:e.totalEarnings||0};return console.log(" Calculated stats:",t),t}return console.log(" No stats found, returning defaults"),{totalSessions:0,completedSessions:0,totalRating:0,ratingCount:0,averageRating:0,totalEarnings:0}}catch(t){return console.error(" Error getting tutor stats:",t),{totalSessions:0,completedSessions:0,totalRating:0,ratingCount:0,averageRating:0,totalEarnings:0}}},F=[...r.filter(e=>{const t=e.name.toLowerCase().includes(c.toLowerCase())||e.email.toLowerCase().includes(c.toLowerCase())||e.school.toLowerCase().includes(c.toLowerCase())||e.specialties.some(e=>e.toLowerCase().includes(c.toLowerCase())),s="all"===g||"active"===g&&e.isAvailable||"inactive"===g&&!e.isAvailable||"new"===g&&e.createdAt&&new Date(1e3*e.createdAt.seconds)>new Date(Date.now()-6048e5);return t&&s})].sort((e,t)=>{let s,r;switch(w){case"name":s=e.name.toLowerCase(),r=t.name.toLowerCase();break;case"email":s=e.email.toLowerCase(),r=t.email.toLowerCase();break;case"rating":s=e.stats.averageRating,r=t.stats.averageRating;break;case"sessions":s=e.stats.totalSessions,r=t.stats.totalSessions;break;default:s=e.createdAt?e.createdAt.seconds:0,r=t.createdAt?t.createdAt.seconds:0}return"asc"===v?s>r?1:-1:s<r?1:-1});return t?n?U.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center",children:U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center mx-auto mb-4 shadow-lg",children:U.jsx(kr,{className:"w-8 h-8 text-white animate-pulse"})}),U.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Loading Tutor Accounts"}),U.jsx("p",{className:"text-gray-600 text-sm",children:"Fetching all tutor information..."})]})}):U.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:U.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[U.jsxs("div",{className:"text-center mb-12",children:[U.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-4",children:[U.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center",children:U.jsx(rr,{className:"w-6 h-6 text-white"})}),U.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Tutor Accounts Management"})]}),U.jsx("p",{className:"text-gray-600 text-lg",children:"Manage and monitor all tutor accounts"})]}),U.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[U.jsxs("div",{className:"bg-gradient-to-br from-white to-blue-50 rounded-2xl shadow-lg border border-blue-100 p-6 text-center",children:[U.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mx-auto mb-4",children:U.jsx(kr,{className:"w-6 h-6 text-white"})}),U.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-1",children:r.length}),U.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Total Tutors"})]}),U.jsxs("div",{className:"bg-gradient-to-br from-white to-green-50 rounded-2xl shadow-lg border border-green-100 p-6 text-center",children:[U.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-green-600 rounded-xl flex items-center justify-center mx-auto mb-4",children:U.jsx($t,{className:"w-6 h-6 text-white"})}),U.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-1",children:r.filter(e=>e.isAvailable).length}),U.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Active Tutors"})]}),U.jsxs("div",{className:"bg-gradient-to-br from-white to-purple-50 rounded-2xl shadow-lg border border-purple-100 p-6 text-center",children:[U.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl flex items-center justify-center mx-auto mb-4",children:U.jsx(or,{className:"w-6 h-6 text-white"})}),U.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-1",children:r.length>0?(r.reduce((e,t)=>e+t.stats.averageRating,0)/r.length).toFixed(1):"0.0"}),U.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Avg Rating"})]}),U.jsxs("div",{className:"bg-gradient-to-br from-white to-orange-50 rounded-2xl shadow-lg border border-orange-100 p-6 text-center",children:[U.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl flex items-center justify-center mx-auto mb-4",children:U.jsx(Ds,{className:"w-6 h-6 text-white"})}),U.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-1",children:r.reduce((e,t)=>e+t.stats.totalSessions,0)}),U.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Total Sessions"})]})]}),U.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6 mb-8",children:U.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),U.jsxs("div",{className:"relative",children:[U.jsx(er,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),U.jsx("input",{type:"text",placeholder:"Search tutors...",value:c,onChange:e=>h(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter"}),U.jsxs("select",{value:g,onChange:e=>b(e.target.value),className:"w-full p-2 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[U.jsx("option",{value:"all",children:"All Tutors"}),U.jsx("option",{value:"active",children:"Active Only"}),U.jsx("option",{value:"inactive",children:"Inactive Only"}),U.jsx("option",{value:"new",children:"New (Last 7 days)"})]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort By"}),U.jsxs("select",{value:w,onChange:e=>y(e.target.value),className:"w-full p-2 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[U.jsx("option",{value:"createdAt",children:"Join Date"}),U.jsx("option",{value:"name",children:"Name"}),U.jsx("option",{value:"email",children:"Email"}),U.jsx("option",{value:"rating",children:"Rating"}),U.jsx("option",{value:"sessions",children:"Sessions"})]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Order"}),U.jsxs("select",{value:v,onChange:e=>j(e.target.value),className:"w-full p-2 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[U.jsx("option",{value:"desc",children:"Descending"}),U.jsx("option",{value:"asc",children:"Ascending"})]})]})]})}),U.jsxs("div",{className:"space-y-6",children:[U.jsxs("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:["Tutor Accounts (",F.length,")"]}),F.length>0?U.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:F.map(e=>U.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6 hover:shadow-2xl transition-all duration-300 hover:scale-[1.02]",children:[U.jsxs("div",{className:"flex items-start space-x-4 mb-6",children:[U.jsx(Za,{user:e,size:"xl"}),U.jsxs("div",{className:"flex-1",children:[U.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:e.name}),U.jsx("p",{className:"text-gray-600 text-sm",children:e.email}),U.jsxs("div",{className:"inline-flex items-center space-x-1 px-3 py-1 rounded-full text-xs font-medium mt-2 "+(e.isAvailable?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:[e.isAvailable?U.jsx($t,{className:"w-3 h-3"}):U.jsx(qr,{className:"w-3 h-3"}),U.jsx("span",{children:e.isAvailable?"Active":"Inactive"})]})]})]}),U.jsxs("div",{className:"space-y-4",children:[U.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[U.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[U.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[U.jsx(ps,{className:"w-4 h-4 text-gray-500"}),U.jsx("span",{className:"text-xs font-medium text-gray-600",children:"School"})]}),U.jsx("span",{className:"text-sm font-semibold text-gray-900",children:e.school})]}),U.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[U.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[U.jsx(Nr,{className:"w-4 h-4 text-gray-500"}),U.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Grade"})]}),U.jsx("span",{className:"text-sm font-semibold text-gray-900",children:e.grade})]})]}),U.jsxs("div",{children:[U.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[U.jsx(Pt,{className:"w-4 h-4 text-gray-500"}),U.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Specialties"})]}),U.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.specialties.slice(0,3).map((e,t)=>U.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:e},t)),e.specialties.length>3&&U.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:["+",e.specialties.length-3," more"]})]})]}),U.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"text-lg font-bold text-gray-900",children:e.stats.totalSessions}),U.jsx("div",{className:"text-xs text-gray-600",children:"Sessions"})]}),U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"text-lg font-bold text-gray-900",children:e.stats.averageRating.toFixed(1)}),U.jsx("div",{className:"text-xs text-gray-600",children:"Rating"})]}),U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"text-lg font-bold text-gray-900",children:e.stats.ratingCount}),U.jsx("div",{className:"text-xs text-gray-600",children:"Reviews"})]})]}),U.jsxs("div",{className:"text-xs text-gray-500 text-center mb-4",children:["Joined: ",e.createdAt?Ra(e.createdAt):"Unknown"]}),U.jsxs("div",{className:"space-y-2",children:[e.stats.ratingCount>0&&U.jsxs("button",{onClick:()=>(e=>{console.log(" View reviews clicked for tutor:",e),console.log(" Tutor stats:",e.stats),C(e),k(!0),console.log(" Modal should be opening...")})(e),className:"w-full py-2 px-4 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl hover:from-blue-600 hover:to-purple-600 transition-all duration-200 flex items-center justify-center space-x-2 font-medium",children:[U.jsx(or,{className:"w-4 h-4"}),U.jsxs("span",{children:["View Reviews (",e.stats.ratingCount,")"]})]}),U.jsxs("button",{onClick:()=>(e=>{I(e),q("tutor"),A(!0)})(e),className:"w-full py-2 px-4 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl hover:from-red-600 hover:to-red-700 transition-all duration-200 flex items-center justify-center space-x-2 font-medium",children:[U.jsx(pr,{className:"w-4 h-4"}),U.jsx("span",{children:"Delete Tutor Profile"})]})]})]})]},e.id))}):U.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-blue-50 rounded-3xl p-12 border border-gray-100 text-center",children:[U.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-gray-500 to-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-2xl",children:U.jsx(kr,{className:"w-10 h-10 text-white"})}),U.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"No tutors found"}),U.jsx("p",{className:"text-gray-600 text-lg",children:"Try adjusting your search or filter criteria."})]})]}),N&&S&&U.jsx(on,{isOpen:N,onClose:()=>{console.log(" Closing modal..."),k(!1),C(null)},tutor:S}),U.jsx(ai,{isOpen:E,onClose:()=>{A(!1),I(null),q("")},onConfirm:async()=>{try{M(!0),console.log(" Deleting tutor profile:",T.id);const e=u(dt,"users",T.id);await x(e,{isTutor:!1,tutorProfile:null,subjects:[],updatedAt:p()});const t=u(dt,"tutorStats",T.id);await f(t),console.log(" Tutor profile deleted, real-time updates will handle the rest"),await D(),A(!1),I(null),q(""),console.log(" Tutor profile deleted successfully")}catch(e){console.error(" Error deleting tutor profile:",e),s(`Failed to delete tutor profile: ${e.message}`,"Delete Failed")}finally{M(!1)}},type:P,item:T,loading:R})]})}):U.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center",children:U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center mx-auto mb-4 shadow-lg",children:U.jsx(rr,{className:"w-8 h-8 text-white animate-pulse"})}),U.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Checking Access"}),U.jsx("p",{className:"text-gray-600 text-sm",children:"Verifying administrator permissions..."})]})})},ii={spanish:{name:"Spanish",flag:"",nativeName:"Espaol",dailyPractice:{week1:{title:"Essential Daily Words",description:"Words you use every day",lessons:[{id:"daily_greetings",title:"Daily Greetings",type:"vocabulary",difficulty:"beginner",xpReward:15,exercises:[{type:"translate",question:"Good morning",answer:"Buenos das",options:["Buenos das","Buenas tardes","Buenas noches","Hola"]},{type:"translate",question:"Good afternoon",answer:"Buenas tardes",options:["Buenos das","Buenas tardes","Buenas noches","Hola"]},{type:"translate",question:"How are you?",answer:"Cmo ests?",options:["Cmo ests?","Qu tal?","Cmo te va?","Bien, gracias"]},{type:"translate",question:"I'm fine, thank you",answer:"Bien, gracias",options:["Bien, gracias","Muy bien","Regular","Mal"]}]},{id:"common_objects",title:"Common Objects",type:"vocabulary",difficulty:"beginner",xpReward:15,exercises:[{type:"translate",question:"Water",answer:"Agua",options:["Agua","Comida","Casa","Coche"]},{type:"translate",question:"Food",answer:"Comida",options:["Agua","Comida","Casa","Coche"]},{type:"translate",question:"House",answer:"Casa",options:["Agua","Comida","Casa","Coche"]},{type:"translate",question:"Car",answer:"Coche",options:["Agua","Comida","Casa","Coche"]}]}]},week2:{title:"Basic Grammar",description:"Essential grammar for daily use",lessons:[{id:"basic_verbs",title:"Essential Verbs",type:"grammar",difficulty:"beginner",xpReward:20,exercises:[{type:"translate",question:"I am",answer:"Yo soy",options:["Yo soy","T eres","l es","Nosotros somos"]},{type:"translate",question:"You are",answer:"T eres",options:["Yo soy","T eres","l es","Nosotros somos"]},{type:"translate",question:"I have",answer:"Yo tengo",options:["Yo tengo","T tienes","l tiene","Nosotros tenemos"]},{type:"translate",question:"I want",answer:"Yo quiero",options:["Yo quiero","T quieres","l quiere","Nosotros queremos"]}]},{id:"numbers",title:"Numbers 1-20",type:"vocabulary",difficulty:"beginner",xpReward:15,exercises:[{type:"translate",question:"One",answer:"Uno",options:["Uno","Dos","Tres","Cuatro"]},{type:"translate",question:"Five",answer:"Cinco",options:["Cinco","Seis","Siete","Ocho"]},{type:"translate",question:"Ten",answer:"Diez",options:["Diez","Once","Doce","Trece"]},{type:"translate",question:"Twenty",answer:"Veinte",options:["Dieciocho","Diecinueve","Veinte","Veintiuno"]}]}]},week3:{title:"Daily Conversations",description:"Common phrases for daily life",lessons:[{id:"shopping",title:"Shopping",type:"conversation",difficulty:"intermediate",xpReward:25,exercises:[{type:"translate",question:"How much does it cost?",answer:"Cunto cuesta?",options:["Cunto cuesta?","Dnde est?","Qu hora es?","Cmo se dice?"]},{type:"translate",question:"I would like to buy...",answer:"Me gustara comprar...",options:["Me gustara comprar...","Tiene...?","Es muy caro","Es barato"]},{type:"translate",question:"Do you have...?",answer:"Tiene...?",options:["Tiene...?","Dnde est...?","Cunto cuesta?","Me gustara..."]}]},{id:"directions",title:"Asking for Directions",type:"conversation",difficulty:"intermediate",xpReward:25,exercises:[{type:"translate",question:"Where is...?",answer:"Dnde est...?",options:["Dnde est...?","Cmo llego a...?","Est lejos?","Est cerca?"]},{type:"translate",question:"How do I get to...?",answer:"Cmo llego a...?",options:["Cmo llego a...?","Dnde est...?","Est lejos?","Est cerca?"]},{type:"translate",question:"Is it far?",answer:"Est lejos?",options:["Est lejos?","Est cerca?","Dnde est?","Cmo llego?"]}]}]},week4:{title:"Food & Dining",description:"Essential food vocabulary and phrases",lessons:[{id:"food_vocabulary",title:"Food Vocabulary",type:"vocabulary",difficulty:"beginner",xpReward:20,exercises:[{type:"translate",question:"Bread",answer:"Pan",options:["Pan","Arroz","Pasta","Carne"]},{type:"translate",question:"Rice",answer:"Arroz",options:["Pan","Arroz","Pasta","Carne"]},{type:"translate",question:"Meat",answer:"Carne",options:["Pan","Arroz","Pasta","Carne"]},{type:"translate",question:"Vegetables",answer:"Verduras",options:["Verduras","Frutas","Leche","Huevos"]}]},{id:"restaurant",title:"At the Restaurant",type:"conversation",difficulty:"intermediate",xpReward:25,exercises:[{type:"translate",question:"I would like to order...",answer:"Me gustara pedir...",options:["Me gustara pedir...","Qu recomienda?","La cuenta, por favor","Tiene...?"]},{type:"translate",question:"What do you recommend?",answer:"Qu recomienda?",options:["Qu recomienda?","Me gustara pedir...","La cuenta, por favor","Tiene...?"]},{type:"translate",question:"The bill, please",answer:"La cuenta, por favor",options:["La cuenta, por favor","Qu recomienda?","Me gustara pedir...","Tiene...?"]}]}]}}},french:{name:"French",flag:"",nativeName:"Franais",dailyPractice:{week1:{title:"Essential Daily Words",description:"Words you use every day",lessons:[{id:"daily_greetings",title:"Daily Greetings",type:"vocabulary",difficulty:"beginner",xpReward:15,exercises:[{type:"translate",question:"Good morning",answer:"Bonjour",options:["Bonjour","Bonsoir","Bonne nuit","Salut"]},{type:"translate",question:"Good evening",answer:"Bonsoir",options:["Bonjour","Bonsoir","Bonne nuit","Salut"]},{type:"translate",question:"How are you?",answer:"Comment allez-vous?",options:["Comment allez-vous?","Comment a va?","a va bien?","Trs bien, merci"]},{type:"translate",question:"Very well, thank you",answer:"Trs bien, merci",options:["Trs bien, merci","a va","Pas mal","Mal"]}]},{id:"common_objects",title:"Common Objects",type:"vocabulary",difficulty:"beginner",xpReward:15,exercises:[{type:"translate",question:"Water",answer:"Eau",options:["Eau","Nourriture","Maison","Voiture"]},{type:"translate",question:"Food",answer:"Nourriture",options:["Eau","Nourriture","Maison","Voiture"]},{type:"translate",question:"House",answer:"Maison",options:["Eau","Nourriture","Maison","Voiture"]},{type:"translate",question:"Car",answer:"Voiture",options:["Eau","Nourriture","Maison","Voiture"]}]}]},week2:{title:"Basic Grammar",description:"Essential grammar for daily use",lessons:[{id:"basic_verbs",title:"Essential Verbs",type:"grammar",difficulty:"beginner",xpReward:20,exercises:[{type:"translate",question:"I am",answer:"Je suis",options:["Je suis","Tu es","Il est","Nous sommes"]},{type:"translate",question:"You are",answer:"Tu es",options:["Je suis","Tu es","Il est","Nous sommes"]},{type:"translate",question:"I have",answer:"J'ai",options:["J'ai","Tu as","Il a","Nous avons"]},{type:"translate",question:"I want",answer:"Je veux",options:["Je veux","Tu veux","Il veut","Nous voulons"]}]},{id:"numbers",title:"Numbers 1-20",type:"vocabulary",difficulty:"beginner",xpReward:15,exercises:[{type:"translate",question:"One",answer:"Un",options:["Un","Deux","Trois","Quatre"]},{type:"translate",question:"Five",answer:"Cinq",options:["Cinq","Six","Sept","Huit"]},{type:"translate",question:"Ten",answer:"Dix",options:["Dix","Onze","Douze","Treize"]},{type:"translate",question:"Twenty",answer:"Vingt",options:["Dix-huit","Dix-neuf","Vingt","Vingt-et-un"]}]}]}}},german:{name:"German",flag:"",nativeName:"Deutsch",dailyPractice:{week1:{title:"Essential Daily Words",description:"Words you use every day",lessons:[{id:"daily_greetings",title:"Daily Greetings",type:"vocabulary",difficulty:"beginner",xpReward:15,exercises:[{type:"translate",question:"Good morning",answer:"Guten Morgen",options:["Guten Morgen","Guten Tag","Guten Abend","Hallo"]},{type:"translate",question:"Good day",answer:"Guten Tag",options:["Guten Morgen","Guten Tag","Guten Abend","Hallo"]},{type:"translate",question:"How are you?",answer:"Wie geht es Ihnen?",options:["Wie geht es Ihnen?","Wie geht's?","Alles gut?","Gut, danke"]},{type:"translate",question:"Good, thank you",answer:"Gut, danke",options:["Gut, danke","Sehr gut","Es geht","Schlecht"]}]},{id:"common_objects",title:"Common Objects",type:"vocabulary",difficulty:"beginner",xpReward:15,exercises:[{type:"translate",question:"Water",answer:"Wasser",options:["Wasser","Essen","Haus","Auto"]},{type:"translate",question:"Food",answer:"Essen",options:["Wasser","Essen","Haus","Auto"]},{type:"translate",question:"House",answer:"Haus",options:["Wasser","Essen","Haus","Auto"]},{type:"translate",question:"Car",answer:"Auto",options:["Wasser","Essen","Haus","Auto"]}]}]},week2:{title:"Basic Grammar",description:"Essential grammar for daily use",lessons:[{id:"basic_verbs",title:"Essential Verbs",type:"grammar",difficulty:"beginner",xpReward:20,exercises:[{type:"translate",question:"I am",answer:"Ich bin",options:["Ich bin","Du bist","Er ist","Wir sind"]},{type:"translate",question:"You are",answer:"Du bist",options:["Ich bin","Du bist","Er ist","Wir sind"]},{type:"translate",question:"I have",answer:"Ich habe",options:["Ich habe","Du hast","Er hat","Wir haben"]},{type:"translate",question:"I want",answer:"Ich mchte",options:["Ich mchte","Du mchtest","Er mchte","Wir mchten"]}]}]}}},italian:{name:"Italian",flag:"",nativeName:"Italiano",dailyPractice:{week1:{title:"Essential Daily Words",description:"Words you use every day",lessons:[{id:"daily_greetings",title:"Daily Greetings",type:"vocabulary",difficulty:"beginner",xpReward:15,exercises:[{type:"translate",question:"Good morning",answer:"Buongiorno",options:["Buongiorno","Buonasera","Buonanotte","Ciao"]},{type:"translate",question:"Good evening",answer:"Buonasera",options:["Buongiorno","Buonasera","Buonanotte","Ciao"]},{type:"translate",question:"How are you?",answer:"Come stai?",options:["Come stai?","Come va?","Tutto bene?","Bene, grazie"]},{type:"translate",question:"Fine, thank you",answer:"Bene, grazie",options:["Bene, grazie","Molto bene","Cos cos","Male"]}]}]}}},japanese:{name:"Japanese",flag:"",nativeName:"",dailyPractice:{week1:{title:"Essential Daily Words",description:"Words you use every day",lessons:[{id:"daily_greetings",title:"Daily Greetings",type:"vocabulary",difficulty:"beginner",xpReward:15,exercises:[{type:"translate",question:"Good morning",answer:"",options:["","","",""]},{type:"translate",question:"Hello (daytime)",answer:"",options:["","","",""]},{type:"translate",question:"Good evening",answer:"",options:["","","",""]},{type:"translate",question:"Thank you",answer:"",options:["","","",""]}]}]}}},korean:{name:"Korean",flag:"",nativeName:"",dailyPractice:{week1:{title:"Essential Daily Words",description:"Words you use every day",lessons:[{id:"daily_greetings",title:"Daily Greetings",type:"vocabulary",difficulty:"beginner",xpReward:15,exercises:[{type:"translate",question:"Good morning",answer:" ",options:[" ",""," ",""]},{type:"translate",question:"Hello",answer:"",options:[" ",""," ",""]},{type:"translate",question:"Goodbye",answer:" ",options:[" ",""," ",""]},{type:"translate",question:"Thank you",answer:"",options:["","","",""]}]}]}}},chinese:{name:"Chinese",flag:"",nativeName:"",dailyPractice:{week1:{title:"Essential Daily Words",description:"Words you use every day",lessons:[{id:"daily_greetings",title:"Daily Greetings",type:"vocabulary",difficulty:"beginner",xpReward:15,exercises:[{type:"translate",question:"Good morning",answer:"",options:["","","",""]},{type:"translate",question:"Hello",answer:"",options:["","","",""]},{type:"translate",question:"Good evening",answer:"",options:["","","",""]},{type:"translate",question:"Thank you",answer:"",options:["","","",""]}]}]}}}},oi={language:{id:"language",name:"Language",icon:"BookOpen",color:"from-blue-500 to-cyan-500",bgColor:"from-blue-50 to-cyan-50",description:"Learn languages through casual daily practice with vocabulary and basic grammar",hasLanguageSelection:!0,availableLanguages:[{id:"spanish",name:"Spanish",flag:"",nativeName:"Espaol"},{id:"french",name:"French",flag:"",nativeName:"Franais"},{id:"german",name:"German",flag:"",nativeName:"Deutsch"},{id:"italian",name:"Italian",flag:"",nativeName:"Italiano"},{id:"japanese",name:"Japanese",flag:"",nativeName:""},{id:"korean",name:"Korean",flag:"",nativeName:""},{id:"chinese",name:"Chinese",flag:"",nativeName:""}],units:[{id:"week1",title:"Week 1: Essential Daily Words",description:"Words you use every day - greetings, common objects",icon:"",color:"green",lessons:[{id:"daily_greetings",title:"Daily Greetings",description:"Good morning, hello, how are you",icon:"",difficulty:"beginner",xpReward:15,lessons:[{id:"greetings_basic",title:"Basic Greetings",type:"vocabulary",content:{exercises:[{type:"translate",question:"Good morning",answer:"Buenos das",options:["Buenos das","Buenas tardes","Buenas noches","Hola"]},{type:"translate",question:"How are you?",answer:"Cmo ests?",options:["Cmo ests?","Qu tal?","Cmo te va?","Bien, gracias"]},{type:"translate",question:"I'm fine, thank you",answer:"Bien, gracias",options:["Bien, gracias","Muy bien","Regular","Mal"]}]}}]},{id:"common_objects",title:"Common Objects",description:"Water, food, house, car - everyday items",icon:"",difficulty:"beginner",xpReward:15,lessons:[{id:"objects_basic",title:"Basic Objects",type:"vocabulary",content:{exercises:[{type:"translate",question:"Water",answer:"Agua",options:["Agua","Comida","Casa","Coche"]},{type:"translate",question:"Food",answer:"Comida",options:["Agua","Comida","Casa","Coche"]},{type:"translate",question:"House",answer:"Casa",options:["Agua","Comida","Casa","Coche"]}]}}]}]},{id:"week2",title:"Week 2: Basic Grammar",description:"Essential grammar for daily use - verbs, numbers",icon:"",color:"blue",lessons:[{id:"basic_verbs",title:"Essential Verbs",description:"I am, you are, I have, I want",icon:"",difficulty:"beginner",xpReward:20,lessons:[{id:"verbs_basic",title:"Basic Verbs",type:"grammar",content:{exercises:[{type:"translate",question:"I am",answer:"Yo soy",options:["Yo soy","T eres","l es","Nosotros somos"]},{type:"translate",question:"You are",answer:"T eres",options:["Yo soy","T eres","l es","Nosotros somos"]},{type:"translate",question:"I have",answer:"Yo tengo",options:["Yo tengo","T tienes","l tiene","Nosotros tenemos"]}]}}]},{id:"numbers",title:"Numbers 1-20",description:"Learn to count from one to twenty",icon:"",difficulty:"beginner",xpReward:15,lessons:[{id:"numbers_basic",title:"Basic Numbers",type:"vocabulary",content:{exercises:[{type:"translate",question:"One",answer:"Uno",options:["Uno","Dos","Tres","Cuatro"]},{type:"translate",question:"Five",answer:"Cinco",options:["Cinco","Seis","Siete","Ocho"]},{type:"translate",question:"Ten",answer:"Diez",options:["Diez","Once","Doce","Trece"]}]}}]}]},{id:"week3",title:"Week 3: Daily Conversations",description:"Common phrases for daily life - shopping, directions",icon:"",color:"purple",lessons:[{id:"shopping",title:"Shopping",description:"How much does it cost? I would like to buy...",icon:"",difficulty:"intermediate",xpReward:25,lessons:[{id:"shopping_basic",title:"Shopping Phrases",type:"conversation",content:{exercises:[{type:"translate",question:"How much does it cost?",answer:"Cunto cuesta?",options:["Cunto cuesta?","Dnde est?","Qu hora es?","Cmo se dice?"]},{type:"translate",question:"I would like to buy...",answer:"Me gustara comprar...",options:["Me gustara comprar...","Tiene...?","Es muy caro","Es barato"]}]}}]},{id:"directions",title:"Asking for Directions",description:"Where is...? How do I get to...?",icon:"",difficulty:"intermediate",xpReward:25,lessons:[{id:"directions_basic",title:"Direction Phrases",type:"conversation",content:{exercises:[{type:"translate",question:"Where is...?",answer:"Dnde est...?",options:["Dnde est...?","Cmo llego a...?","Est lejos?","Est cerca?"]},{type:"translate",question:"How do I get to...?",answer:"Cmo llego a...?",options:["Cmo llego a...?","Dnde est...?","Est lejos?","Est cerca?"]}]}}]}]},{id:"week4",title:"Week 4: Food & Dining",description:"Essential food vocabulary and restaurant phrases",icon:"",color:"orange",lessons:[{id:"food_vocabulary",title:"Food Vocabulary",description:"Bread, rice, meat, vegetables",icon:"",difficulty:"beginner",xpReward:20,lessons:[{id:"food_basic",title:"Basic Food Words",type:"vocabulary",content:{exercises:[{type:"translate",question:"Bread",answer:"Pan",options:["Pan","Arroz","Pasta","Carne"]},{type:"translate",question:"Rice",answer:"Arroz",options:["Pan","Arroz","Pasta","Carne"]},{type:"translate",question:"Meat",answer:"Carne",options:["Pan","Arroz","Pasta","Carne"]}]}}]},{id:"restaurant",title:"At the Restaurant",description:"I would like to order... What do you recommend?",icon:"",difficulty:"intermediate",xpReward:25,lessons:[{id:"restaurant_basic",title:"Restaurant Phrases",type:"conversation",content:{exercises:[{type:"translate",question:"I would like to order...",answer:"Me gustara pedir...",options:["Me gustara pedir...","Qu recomienda?","La cuenta, por favor","Tiene...?"]},{type:"translate",question:"What do you recommend?",answer:"Qu recomienda?",options:["Qu recomienda?","Me gustara pedir...","La cuenta, por favor","Tiene...?"]}]}}]}]}],scenarios:[{id:"conversation",name:"Daily Conversation",level:1,description:"Practice everyday conversation skills with natural dialogue flow",unlocked:!0,steps:[{id:1,character:"Friend",message:"Hi! How was your day? I heard you had an interesting experience yesterday.",expectedResponse:["day","good","interesting"],hints:["Be natural and friendly","Share something about your day","Ask about their day too"],userInputType:"voice"},{id:2,character:"Friend",message:"That sounds amazing! Can you tell me more about what happened?",expectedResponse:["tell","more","happened"],hints:["Provide more details","Use descriptive language","Keep the conversation engaging"],userInputType:"choice",choices:["Sure! Let me tell you all about it...","Well, it was quite surprising actually...","I'd love to share the details with you..."]},{id:3,character:"Friend",message:"That's incredible! What did you learn from this experience?",expectedResponse:["learn","experience","insight"],hints:["Share your insights","What did you gain from this?","Be reflective"],userInputType:"voice"}]},{id:"presentation",name:"Public Speaking",level:2,description:"Practice presenting your ideas clearly and confidently to an audience",unlocked:!0,steps:[{id:1,character:"Audience Member",message:"Welcome! We're excited to hear your presentation. Could you start by introducing yourself and your topic?",expectedResponse:["introduce","topic","presentation"],hints:["Be confident and clear","Introduce yourself briefly","State your main topic clearly"],userInputType:"voice"},{id:2,character:"Audience Member",message:"Thank you for that introduction. Can you tell us why this topic is important to you?",expectedResponse:["important","reason","motivation"],hints:["Explain your personal connection","Share your motivation","Make it relatable"],userInputType:"choice",choices:["This topic has personally affected my life...","I believe this is crucial for our society...","Through my research, I discovered..."]}]},{id:"debate",name:"Debate & Discussion",level:3,description:"Engage in structured debates and thoughtful discussions",unlocked:!1,steps:[{id:1,character:"Debate Moderator",message:"Welcome to today's debate. The topic is: \"Technology improves education.\" You're arguing FOR this position. What's your opening statement?",expectedResponse:["technology","education","improves"],hints:["State your position clearly","Provide evidence","Be persuasive"],userInputType:"voice"},{id:2,character:"Opponent",message:"I disagree. Technology can be distracting and reduces face-to-face interaction. How do you respond?",expectedResponse:["response","counter","argument"],hints:["Acknowledge their point","Provide counter-evidence","Stay respectful"],userInputType:"voice"},{id:3,character:"Debate Moderator",message:"Excellent exchange! Now, what's your closing statement that summarizes your main points?",expectedResponse:["summary","conclusion","points"],hints:["Summarize key arguments","End strongly","Be concise"],userInputType:"voice"}]},{id:"writing",name:"Creative Writing",level:4,description:"Develop creative writing skills through storytelling exercises",unlocked:!1,steps:[{id:1,character:"Writing Instructor",message:'Let\'s start with a creative prompt: "A mysterious door appears in your bedroom wall." Begin your story with the first paragraph.',expectedResponse:["story","beginning","paragraph"],hints:["Set the scene","Create intrigue","Use descriptive language"],userInputType:"voice"},{id:2,character:"Writing Instructor",message:"Great start! Now develop your character. What do they think and feel about this mysterious door?",expectedResponse:["character","feelings","thoughts"],hints:["Show character emotions","Use inner dialogue","Make it personal"],userInputType:"voice"},{id:3,character:"Writing Instructor",message:"Perfect! Now create tension. What happens when they try to open the door?",expectedResponse:["tension","conflict","opening"],hints:["Build suspense","Create obstacles","Leave readers wanting more"],userInputType:"voice"}]},{id:"literature",name:"Literature Analysis",level:5,description:"Analyze literary works and express critical thinking",unlocked:!1,steps:[{id:1,character:"Literature Professor",message:'We\'re analyzing this excerpt: "The old man sat alone in the dimly lit room, memories flooding his mind like a river breaking its banks." What literary device is being used here?',expectedResponse:["metaphor","simile","imagery"],hints:["Look for comparisons","Identify figurative language","Consider the effect"],userInputType:"choice",choices:['Simile - "like a river breaking its banks"',"Metaphor - comparing memories to a river","Personification - giving memories human qualities"]},{id:2,character:"Literature Professor",message:"Excellent! Now analyze the deeper meaning. What does this passage suggest about the character's emotional state?",expectedResponse:["meaning","emotions","analysis"],hints:["Consider the symbolism","Think about the mood","Connect to character psychology"],userInputType:"voice"},{id:3,character:"Literature Professor",message:"Brilliant analysis! Finally, how does this passage contribute to the overall theme of the work?",expectedResponse:["theme","contribution","overall"],hints:["Think about the bigger picture","Connect to universal themes","Consider the author's message"],userInputType:"voice"}]}]},mathematics:{id:"mathematics",name:"Mathematics",icon:"Calculator",color:"from-purple-500 to-indigo-500",bgColor:"from-purple-50 to-indigo-50",description:"Develop mathematical thinking, problem-solving skills, and logical reasoning through practical applications",scenarios:[{id:"algebra",name:"Algebra Fundamentals",level:1,description:"Solve algebraic problems step by step with interactive guidance",unlocked:!0,steps:[{id:1,character:"Math Tutor",message:"Let's solve this equation: 2x + 5 = 13. What should be our first step?",expectedResponse:["subtract","isolate","variable"],hints:["Think about isolating the variable","What operation should we do first?","Remember the order of operations"],userInputType:"choice",choices:["Subtract 5 from both sides","Divide by 2 first","Add 5 to both sides"]},{id:2,character:"Math Tutor",message:"Great! After subtracting 5, we get 2x = 8. Now what's the next step to solve for x?",expectedResponse:["divide","2","both sides"],hints:["We need to isolate x","What's the coefficient of x?","Divide both sides by the same number"],userInputType:"voice"},{id:3,character:"Math Tutor",message:"Perfect! So x = 4. Let's verify this answer by substituting back into the original equation.",expectedResponse:["verify","substitute","check"],hints:["Replace x with 4","Calculate both sides","Check if they're equal"],userInputType:"voice"}]},{id:"geometry",name:"Geometry & Shapes",level:2,description:"Explore geometric concepts and spatial reasoning",unlocked:!0,steps:[{id:1,character:"Geometry Teacher",message:"We have a right triangle with legs of 3 and 4 units. What's the length of the hypotenuse?",expectedResponse:["hypotenuse","pythagorean","5"],hints:["Use the Pythagorean theorem","a + b = c","Calculate step by step"],userInputType:"choice",choices:["5 units","7 units","25 units"]}]},{id:"calculus",name:"Calculus Concepts",level:3,description:"Understand limits, derivatives, and integrals",unlocked:!1,steps:[{id:1,character:"Calculus Professor",message:"Let's find the derivative of f(x) = x + 2x - 5x + 1. What's the first step?",expectedResponse:["power","rule","derivative"],hints:["Use the power rule","Differentiate each term separately","Remember: d/dx(x) = nx"],userInputType:"choice",choices:["Apply the power rule to each term","Use the product rule","Factor the equation first"]},{id:2,character:"Calculus Professor",message:"Great! Now apply the power rule. What's the derivative of x?",expectedResponse:["3x","3x","x"],hints:["Power rule: x becomes nx","For x: 3x","Lower the power by 1"],userInputType:"voice"},{id:3,character:"Calculus Professor",message:"Perfect! Now complete the derivative. What's the final answer?",expectedResponse:["3x","4x","5"],hints:["Combine all terms","f'(x) = 3x + 4x - 5","Check each term"],userInputType:"voice"}]},{id:"statistics",name:"Statistics & Data",level:4,description:"Analyze data and understand statistical concepts",unlocked:!1,steps:[{id:1,character:"Statistics Professor",message:"We have test scores: [85, 92, 78, 96, 88, 91]. What's the mean?",expectedResponse:["mean","average","88.3"],hints:["Add all numbers","Divide by count","Mean = sum/n"],userInputType:"voice"},{id:2,character:"Statistics Professor",message:"Good! Now find the median. First, what do we need to do with the data?",expectedResponse:["sort","order","arrange"],hints:["Arrange in order","Find middle value","Sort first"],userInputType:"choice",choices:["Sort the data in ascending order","Find the highest value","Calculate the range"]},{id:3,character:"Statistics Professor",message:"Excellent! With sorted data [78, 85, 88, 91, 92, 96], what's the median?",expectedResponse:["89.5","88","91"],hints:["Even number of values","Average the two middle numbers","(88 + 91) / 2"],userInputType:"voice"}]},{id:"advanced",name:"Advanced Mathematics",level:5,description:"Explore complex mathematical theories and applications",unlocked:!1,steps:[{id:1,character:"Advanced Math Professor",message:"Solve this complex equation: z + 2z + 2 = 0, where z is a complex number.",expectedResponse:["quadratic","formula","complex"],hints:["Use quadratic formula","a=1, b=2, c=2","z = (-b  (b-4ac))/2a"],userInputType:"voice"},{id:2,character:"Advanced Math Professor",message:"Good start! Calculate the discriminant b - 4ac. What do you get?",expectedResponse:["-4","negative","4-8"],hints:["b - 4ac = 2 - 4(1)(2)","= 4 - 8","= -4"],userInputType:"voice"},{id:3,character:"Advanced Math Professor",message:"Perfect! Since discriminant is negative, what does this tell us about the roots?",expectedResponse:["complex","imaginary","conjugate"],hints:["Negative discriminant = complex roots","They come in conjugate pairs","z = -1  i"],userInputType:"voice"}]}]},physics:{id:"physics",name:"Physics",icon:"Atom",color:"from-pink-500 to-rose-500",bgColor:"from-pink-50 to-rose-50",description:"Explore the laws of nature, scientific principles, and physical phenomena through hands-on experiments",scenarios:[{id:"mechanics",name:"Classical Mechanics",level:1,description:"Explore motion, forces, and energy through interactive physics problems",unlocked:!0,steps:[{id:1,character:"Physics Professor",message:"A ball is dropped from a height of 20 meters. What force is acting on it, and what happens to its velocity?",expectedResponse:["gravity","force","velocity"],hints:["Think about gravitational force","What happens to velocity as it falls?","Consider Newton's laws"],userInputType:"voice"},{id:2,character:"Physics Professor",message:"Excellent! Now, if we ignore air resistance, what can we say about the ball's acceleration?",expectedResponse:["constant","acceleration","gravity"],hints:["Gravitational acceleration is constant","What's the value of g on Earth?","Acceleration doesn't change during free fall"],userInputType:"choice",choices:["It accelerates at 9.8 m/s","Acceleration increases as it falls","There's no acceleration without air resistance"]},{id:3,character:"Physics Professor",message:"Great understanding! Now, how long will it take for the ball to reach the ground?",expectedResponse:["time","equation","calculate"],hints:["Use the kinematic equation","h = gt","Solve for t"],userInputType:"voice"}]},{id:"thermodynamics",name:"Heat & Energy",level:2,description:"Understand heat transfer and energy conservation",unlocked:!0,steps:[{id:1,character:"Physics Professor",message:"A 1kg block of ice at 0C is heated until it becomes water at 100C. What energy is involved?",expectedResponse:["latent","specific","heat"],hints:["Consider phase change energy","Latent heat of fusion","Specific heat of water"],userInputType:"voice"}]},{id:"electricity",name:"Electricity & Magnetism",level:3,description:"Explore electric and magnetic fields",unlocked:!1,steps:[{id:1,character:"Physics Professor",message:"A 2C charge is placed 3cm from a -4C charge. What's the electric force between them?",expectedResponse:["coulomb","force","electrostatic"],hints:["Use Coulomb's law","F = k(qq)/r","k = 910 Nm/C"],userInputType:"voice"},{id:2,character:"Physics Professor",message:"Good! Now calculate the magnitude. What's the value of qq?",expectedResponse:["8","C","24"],hints:["q = 2C, q = -4C","Ignore the sign for magnitude","2  4 = 8"],userInputType:"choice",choices:["8C","6C","-8C"]},{id:3,character:"Physics Professor",message:"Perfect! Now plug into Coulomb's law. What's the final force?",expectedResponse:["800","N","newton"],hints:["F = (910)(810)/(0.03)","= 7210/910","= 800 N"],userInputType:"voice"}]},{id:"waves",name:"Waves & Optics",level:4,description:"Understand wave properties and light behavior",unlocked:!1,steps:[{id:1,character:"Physics Professor",message:"Light travels from air (n=1.0) to water (n=1.33) at 30 angle. What's the refracted angle?",expectedResponse:["snell","refraction","angle"],hints:["Use Snell's law","nsin = nsin","sin = (1.0)sin(30)/1.33"],userInputType:"voice"},{id:2,character:"Physics Professor",message:"Excellent! Calculate sin(30). What's the value?",expectedResponse:["0.5","half","1/2"],hints:["sin(30) = 0.5","This is a standard angle","sin(30) = 1/2"],userInputType:"choice",choices:["0.5","0.866","0.707"]},{id:3,character:"Physics Professor",message:"Great! Now solve for . What's the refracted angle?",expectedResponse:["22","degrees","22"],hints:["sin = 0.5/1.33 = 0.376"," = sin(0.376)"," 22"],userInputType:"voice"}]},{id:"quantum",name:"Quantum Physics",level:5,description:"Explore quantum mechanics and modern physics",unlocked:!1,steps:[{id:1,character:"Quantum Physics Professor",message:"An electron has wavelength 500nm. What's its momentum using de Broglie equation?",expectedResponse:["de broglie","momentum","wavelength"],hints:[" = h/p","p = h/","h = 6.6310 Js"],userInputType:"voice"},{id:2,character:"Quantum Physics Professor",message:"Good! What's the wavelength in meters?",expectedResponse:["510","meters","500nm"],hints:["500nm = 50010m","= 510m","Convert nanometers to meters"],userInputType:"choice",choices:["510m","510m","510m"]},{id:3,character:"Quantum Physics Professor",message:"Perfect! Now calculate momentum. What's the value?",expectedResponse:["1.3310","kgm/s","momentum"],hints:["p = h/ = (6.6310)/(510)","= 1.3310 kgm/s","This is very small!"],userInputType:"voice"}]}]}},li=async e=>{try{const t=u(dt,"skillProgress",e),s=await m(t);if(s.exists())return s.data();const r={userId:e,paths:{language:{progress:0,completedLessons:[],completedUnits:[],selectedLanguage:null},mathematics:{progress:0,completedLessons:[],completedUnits:[]},physics:{progress:0,completedLessons:[],completedUnits:[]}},totalXP:0,streak:0,lessonsCompleted:0,achievements:[],createdAt:p(),updatedAt:p()};return await h(t,r),r}catch(t){throw console.error("Error getting user skill progress:",t),t}},ci=(e,t,s,r)=>{if(console.log("=== getDynamicLessonContent ==="),console.log("Parameters:",{pathId:e,unitId:t,lessonId:s,selectedLanguage:r}),"language"!==e)return console.log("Non-language path, returning default lesson data"),{id:s,title:"Lesson Not Found",description:"This lesson is not available yet",icon:"",difficulty:"beginner",xpReward:10,lessons:[{id:"default",title:"Default Exercise",type:"translate",content:{exercises:[{type:"translate",question:"Hello",answer:"Hello",options:["Hello","Goodbye","Thank you"]}]}}]};const a=ii[r]||ii.spanish;console.log("Language content:",a);const n=((e,t)=>{var s;const r=null==(s=a.dailyPractice)?void 0:s[e];if(console.log(`${e} content:`,r),!r||!r.lessons)return console.log(`No lessons found in ${e}`),null;const n=r.lessons.find(e=>e.id===t);return console.log(`Lesson content for ${t}:`,n),n&&n.exercises&&Array.isArray(n.exercises)?{id:t,title:n.title,description:n.description,icon:n.icon,difficulty:n.difficulty,xpReward:n.xpReward,lessons:[{id:`${t}_exercises`,title:n.title,type:n.type,content:{exercises:n.exercises||[]}}]}:null})(t,s);return n?(console.log("Found lesson data:",n),n):(console.log("No matching content found, returning default lesson data"),{id:s,title:"Lesson Not Found",description:"This lesson is not available yet",icon:"",difficulty:"beginner",xpReward:10,lessons:[{id:"default",title:"Default Exercise",type:"translate",content:{exercises:[{type:"translate",question:"Hello",answer:"Hello",options:["Hello","Goodbye","Thank you"]}]}}]})},di=async()=>{try{console.log("Testing Firebase connection...");const e={test:!0,timestamp:(new Date).toISOString(),message:"Firebase test successful"},t=u(dt,"test","connection-test");console.log("Saving test data to Firebase..."),await h(t,e),console.log("Test data saved successfully!");const s=await m(t);return s.exists()?(console.log("Verification successful:",s.data()),!0):(console.log("Verification failed: Document not found"),!1)}catch(e){return console.error("Firebase test failed:",e),!1}},ui=async e=>{try{console.log("Testing user progress save...");const t={totalXP:100,gold:50,completedQuests:["test-quest-1"],currentLevel:1,skills:{},achievements:[],questHistory:[{questId:"test-quest-1",subject:"test",category:"test",questType:"quest",xpEarned:100,goldEarned:50,completedAt:(new Date).toISOString(),deliverables:[]}]},s=u(dt,"userProgress",e);console.log("Saving user progress to Firebase..."),await h(s,t,{merge:!0}),console.log("User progress saved successfully!");const r=await m(s);return r.exists()?(console.log("User progress verification successful:",r.data()),!0):(console.log("User progress verification failed: Document not found"),!1)}catch(t){return console.error("User progress test failed:",t),!1}},hi=()=>{var t,s,r,a,n,i,o,l,c;const{pathId:d,unitId:g,lessonId:b,exerciseId:f}=Re(),w=qe(),{user:y}=Br(),{showError:v,showSuccess:j}=Hr(),[N,k]=e.useState(0),[S,C]=e.useState(""),[E,A]=e.useState(""),[T,I]=e.useState(null),[P,q]=e.useState(!1),[R,M]=e.useState(0),[D,L]=e.useState(0),[F,$]=e.useState(0),[O,B]=e.useState(0),[_,z]=e.useState(null),[W,H]=e.useState(!0),[G,V]=e.useState(!1),[Y,Q]=e.useState(!1),[J,K]=e.useState(!1);e.useEffect(()=>{X()},[d,g,b]);const X=async()=>{var e,t,s,r;try{if(H(!0),"language"===d&&(null==y?void 0:y.id)){const s=await li(y.id),r=null==(t=null==(e=s.paths)?void 0:e.language)?void 0:t.selectedLanguage;if(!r)return v("Please select a language first",5e3,"Language Required"),void w(`/learning-paths?path=${d}`);L(s.streak||0),$(s.totalXP||0),B(s.lessonsCompleted||0);const a=ci(d,g,b,r);if(!a)return v("Lesson not found",5e3,"Error"),void w(`/learning-paths?path=${d}`);z(a)}else{const e=oi[d],t=null==(s=null==e?void 0:e.units)?void 0:s.find(e=>e.id===g),a=null==(r=null==t?void 0:t.lessons)?void 0:r.find(e=>e.id===b);if(!a)return v("Lesson not found",5e3,"Error"),void w(`/learning-paths?path=${d}`);if(z(a),null==y?void 0:y.id){const e=await li(y.id);L(e.streak||0),$(e.totalXP||0),B(e.lessonsCompleted||0)}}}catch(a){console.error("Error loading lesson data:",a),v("Failed to load lesson",5e3,"Loading Error")}finally{H(!1)}},Z=null==(a=null==(r=null==(s=null==(t=null==_?void 0:_.lessons)?void 0:t[f])?void 0:s.content)?void 0:r.exercises)?void 0:a[N],ee=()=>{if(!Z||Y)return;Q(!0);let e=!1;switch(Z.type){case"translate":case"listen":e=E===Z.answer;break;case"conversation":e=""!==E;break;default:e=S.toLowerCase()===Z.answer.toLowerCase()}I(e),q(!0),M(0);const t=setInterval(()=>{M(e=>e>=100?(clearInterval(t),setTimeout(()=>{te()},300),100):e+2)},20);e?(L(e=>e+1),$(e=>e+(_.xpReward||10))):L(0)},te=()=>{var e,t,s,r;const a=(null==(r=null==(s=null==(t=null==(e=null==_?void 0:_.lessons)?void 0:e[f])?void 0:t.content)?void 0:s.exercises)?void 0:r.length)||0;N<a-1?(k(e=>e+1),q(!1),I(null),A(""),C(""),M(0),Q(!1)):(B(e=>e+1),K(!0),se())},se=async()=>{try{if(null==y?void 0:y.id){console.log("Testing Firebase connection before saving progress...");const e=await di(y.id);if(console.log("Firebase connection test result:",e),!e.success)throw new Error(`Firebase connection failed: ${e.error}`);console.log("Testing skillProgress write...");const t=await(async e=>await ui(e))(y.id);if(console.log("skillProgress write test result:",t),!t.success)throw new Error(`skillProgress write failed: ${t.error}`);console.log("Saving lesson progress..."),console.log("Lesson data:",_),console.log("XP reward from lesson data:",null==_?void 0:_.xpReward);const s=(null==_?void 0:_.xpReward)||10;console.log("XP to award:",s),await(async(e,t,s,r,a)=>{var n,i,o,l,c,d,g,b;try{console.log("=== STARTING LESSON PROGRESS UPDATE ==="),console.log("Parameters:",{userId:e,pathId:t,unitId:s,lessonId:r,xpEarned:a}),console.log("=== TESTING FIREBASE WRITE PERMISSIONS ===");const v=u(dt,"test",e);try{await h(v,{test:!0,timestamp:p(),message:"Permission test"}),console.log(" Firebase write permission test: SUCCESS")}catch(f){throw console.error(" Firebase write permission test: FAILED",f),new Error(`Firebase write permission denied: ${f.message}`)}const j=u(dt,"skillProgress",e),N=await m(j);let k;N.exists()?(k=N.data(),console.log("=== LOADING FROM FIREBASE ==="),console.log("Loaded progress:",JSON.stringify(k,null,2))):(console.log("User progress not found, creating initial progress..."),k={userId:e,paths:{},totalXP:0,streak:0,lessonsCompleted:0,achievements:[],createdAt:p(),updatedAt:p()}),k.paths||(k.paths={}),k.paths[t]||(k.paths[t]={progress:0,completedLessons:[],completedUnits:[],selectedLanguage:null});const S=k.paths[t];S.completedLessons||(S.completedLessons=[]),S.completedUnits||(S.completedUnits=[]);const C=`${s}_${r}`;console.log("=== ADDING LESSON ==="),console.log("Adding lesson:",C),console.log("Current completed:",[...S.completedLessons]),S.completedLessons.includes(C)?console.log(" Lesson already completed"):(S.completedLessons.push(C),console.log(" Lesson added successfully")),console.log("Final completed lessons:",[...S.completedLessons]);const E=null==(i=null==(n=oi[t])?void 0:n.units)?void 0:i.find(e=>e.id===s);if(E){const e=E.lessons||[];e.filter(e=>S.completedLessons.includes(`${s}_${e.id}`)).length!==e.length||S.completedUnits.includes(s)||S.completedUnits.push(s)}const A=(null==(l=null==(o=oi[t])?void 0:o.units)?void 0:l.reduce((e,t)=>{var s;return e+((null==(s=t.lessons)?void 0:s.length)||0)},0))||0,T=S.completedLessons.length;S.progress=A>0?Math.round(T/A*100):0;const I=k.totalXP||0,P=I+a;k.totalXP=P,k.streak=(k.streak||0)+1,k.lessonsCompleted=(k.lessonsCompleted||0)+1,console.log("=== XP CALCULATION ==="),console.log("Old XP:",I),console.log("XP earned:",a),console.log("New XP:",P),console.log("=== UPDATING LESSON PROGRESS ==="),console.log("Lesson:",C),console.log("Completed lessons before:",[...S.completedLessons]),console.log("Total XP:",k.totalXP),console.log("Streak:",k.streak),console.log("Lessons completed:",k.lessonsCompleted),console.log("=== SAVING TO FIREBASE ==="),console.log("Path progress to save:",JSON.stringify(S,null,2));const q={[`paths.${t}.completedLessons`]:S.completedLessons,[`paths.${t}.completedUnits`]:S.completedUnits,[`paths.${t}.progress`]:S.progress,[`paths.${t}.selectedLanguage`]:S.selectedLanguage,totalXP:k.totalXP,streak:k.streak,lessonsCompleted:k.lessonsCompleted,updatedAt:p()};console.log("Update data:",JSON.stringify(q,null,2));try{await x(j,q),console.log(" Firebase update successful");const e=await m(j);if(e.exists()){const s=e.data();console.log(" Verification - Saved data:",JSON.stringify(s,null,2)),console.log(" Verification - Total XP:",s.totalXP),console.log(" Verification - Completed lessons:",null==(d=null==(c=s.paths)?void 0:c[t])?void 0:d.completedLessons)}else console.error(" Verification failed - Document does not exist")}catch(w){console.error(" Firebase update failed:",w),console.log(" Trying alternative save method with setDoc...");try{await h(j,k,{merge:!0}),console.log(" Alternative save method successful");const e=await m(j);if(e.exists()){const s=e.data();console.log(" Alternative verification - Total XP:",s.totalXP),console.log(" Alternative verification - Completed lessons:",null==(b=null==(g=s.paths)?void 0:g[t])?void 0:b.completedLessons)}}catch(y){throw console.error(" Alternative save method also failed:",y),new Error(`Both save methods failed. UpdateDoc: ${w.message}, SetDoc: ${y.message}`)}}return k}catch(v){throw console.error("Error updating lesson progress:",v),console.error("Error details:",{userId:e,pathId:t,unitId:s,lessonId:r,xpEarned:a,error:v.message,stack:v.stack}),v}})(y.id,d,g,b,s),console.log("Lesson progress updated successfully")}setTimeout(()=>{w(`/learning-paths?path=${d}`)},5e3)}catch(e){console.error("Error completing lesson:",e),console.error("Full error details:",e),v(`Failed to save lesson progress: ${e.message}`,8e3,"Error")}};if(W)return U.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center",children:U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),U.jsx("p",{className:"text-gray-600",children:"Loading lesson..."})]})});if(!_)return U.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center",children:U.jsxs("div",{className:"text-center",children:[U.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Lesson Not Found"}),U.jsxs("button",{onClick:()=>w(`/learning-paths?path=${d}`),className:"bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition-colors",children:["Back to ","language"===d?"Language":"mathematics"===d?"Mathematics":"physics"===d?"Physics":"Learning Path"]})]})});const re=(null==(l=null==(o=null==(i=null==(n=_.lessons)?void 0:n[f])?void 0:i.content)?void 0:o.exercises)?void 0:l.length)||0,ae=(N+1)/re*100;return U.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-cyan-50",children:[U.jsx("div",{className:"bg-white/80 backdrop-blur-sm shadow-xl border-b border-gray-100",children:U.jsxs("div",{className:"max-w-5xl mx-auto px-6 py-6",children:[U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsxs("div",{className:"flex items-center space-x-6",children:[U.jsxs("button",{onClick:()=>w(`/learning-paths?path=${d}`),className:"flex items-center space-x-2 text-gray-600 hover:text-indigo-600 transition-all duration-200 hover:bg-indigo-50 px-3 py-2 rounded-lg",children:[U.jsx(wt,{className:"w-5 h-5"}),U.jsxs("span",{className:"font-medium",children:["Back to ","language"===d?"Language":"mathematics"===d?"Mathematics":"physics"===d?"Physics":"Learning Path"]})]}),U.jsxs("div",{className:"border-l border-gray-200 pl-6",children:[U.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent",children:_.title}),U.jsx("p",{className:"text-gray-600 mt-1",children:_.description})]})]}),U.jsxs("div",{className:"flex items-center space-x-4",children:[U.jsxs("div",{className:"flex items-center space-x-2 bg-yellow-50 px-4 py-2 rounded-full border border-yellow-200",children:[U.jsx(Mr,{className:"w-5 h-5 text-yellow-600"}),U.jsx("span",{className:"font-bold text-yellow-700",children:F})]}),U.jsxs("div",{className:"flex items-center space-x-2 bg-orange-50 px-4 py-2 rounded-full border border-orange-200",children:[U.jsx(fr,{className:"w-5 h-5 text-orange-600"}),U.jsx("span",{className:"font-bold text-orange-700",children:D})]}),U.jsxs("div",{className:"flex items-center space-x-2 bg-blue-50 px-4 py-2 rounded-full border border-blue-200",children:[U.jsx(Pt,{className:"w-5 h-5 text-blue-600"}),U.jsx("span",{className:"font-bold text-blue-700",children:O})]})]})]}),U.jsxs("div",{className:"mt-6",children:[U.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-3",children:[U.jsx("span",{className:"font-medium",children:"Lesson Progress"}),U.jsxs("span",{className:"font-semibold",children:[N+1," / ",re]})]}),U.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 shadow-inner",children:U.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 h-3 rounded-full transition-all duration-700 ease-out shadow-sm",style:{width:`${ae}%`}})})]})]})}),U.jsx("div",{className:"max-w-5xl mx-auto px-6 py-8",children:Z&&U.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl border border-gray-100 p-10",children:[U.jsxs("div",{className:"text-center mb-10",children:[U.jsxs("div",{className:"inline-flex items-center space-x-2 bg-gradient-to-r from-indigo-100 to-purple-100 text-indigo-800 px-6 py-3 rounded-full text-sm font-semibold mb-6 shadow-sm border border-indigo-200",children:[U.jsx(ur,{className:"w-4 h-4"}),U.jsx("span",{className:"capitalize",children:Z.type})]}),U.jsx("h2",{className:"text-4xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent mb-4 leading-tight",children:Z.question})]}),Z.audio&&U.jsxs("div",{className:"text-center mb-10",children:[U.jsx("button",{onClick:()=>{(null==Z?void 0:Z.audio)&&(V(!0),setTimeout(()=>V(!1),2e3))},className:"p-6 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-full hover:from-indigo-600 hover:to-purple-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105",children:G?U.jsx(Ar,{className:"w-8 h-8"}):U.jsx(Er,{className:"w-8 h-8"})}),U.jsx("p",{className:"text-gray-600 mt-3 font-medium",children:"Click to listen"})]}),Z.options&&U.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-10",children:Z.options.map((e,t)=>U.jsx("button",{onClick:()=>A(e),className:`w-full p-6 text-left border-2 rounded-2xl transition-all duration-300 transform hover:scale-[1.02] ${E===e?"border-indigo-500 bg-gradient-to-r from-indigo-50 to-purple-50 text-indigo-700 shadow-lg":"border-gray-200 bg-white hover:border-indigo-300 hover:bg-indigo-50 hover:shadow-md"} ${P?e===Z.answer?"border-green-500 bg-gradient-to-r from-green-50 to-emerald-50 text-green-700":E===e&&e!==Z.answer?"border-red-500 bg-gradient-to-r from-red-50 to-pink-50 text-red-700":"":""}`,children:U.jsxs("div",{className:"flex items-center space-x-3",children:[U.jsx("div",{className:"w-6 h-6 rounded-full border-2 flex items-center justify-center "+(E===e?"border-indigo-500 bg-indigo-500":"border-gray-300"),children:E===e&&U.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),U.jsx("span",{className:"text-lg font-medium",children:e}),P&&e===Z.answer&&U.jsx($t,{className:"w-6 h-6 text-green-500 ml-auto"})]})},t))}),Z.userOptions&&U.jsxs("div",{className:"space-y-3 mb-8",children:[U.jsxs("div",{className:"bg-gray-100 p-4 rounded-xl mb-4",children:[U.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[U.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:U.jsx("span",{className:"text-white text-sm font-bold",children:(null==(c=Z.character)?void 0:c[0])||"A"})}),U.jsx("span",{className:"font-medium",children:Z.character})]}),U.jsx("p",{className:"text-gray-700",children:Z.message})]}),U.jsx("div",{className:"space-y-2",children:Z.userOptions.map((e,t)=>U.jsx("button",{onClick:()=>A(e),className:"w-full p-3 text-left border-2 rounded-lg transition-all duration-300 "+(E===e?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:e},t))})]}),!Z.options&&!Z.userOptions&&U.jsx("div",{className:"mb-8",children:U.jsx("input",{type:"text",value:S,onChange:e=>C(e.target.value),placeholder:"Type your answer here...",className:"w-full p-4 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg",onKeyPress:e=>"Enter"===e.key&&ee()})}),P&&U.jsxs("div",{className:"text-center p-8 rounded-3xl mb-10 shadow-lg border-2 "+(T?"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200":"bg-gradient-to-br from-red-50 to-pink-50 border-red-200"),children:[U.jsx("div",{className:"text-6xl mb-4 "+(T?"text-green-500":"text-red-500"),children:T?"":""}),U.jsx("h3",{className:"text-2xl font-bold mb-2 "+(T?"text-green-800":"text-red-800"),children:T?"Excellent!":"Keep trying!"}),U.jsx("p",{className:"text-lg font-medium "+(T?"text-green-600":"text-red-600"),children:T?`+${_.xpReward||10} XP earned!`:"No worries, keep learning!"}),U.jsxs("div",{className:"mt-6",children:[U.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 shadow-inner",children:U.jsx("div",{className:"h-2 rounded-full transition-all duration-100 ease-out "+(T?"bg-gradient-to-r from-green-400 to-emerald-400":"bg-gradient-to-r from-red-400 to-pink-400"),style:{width:`${R}%`}})}),U.jsx("p",{className:"text-sm text-gray-600 mt-3 font-medium",children:"Moving to next question..."})]})]}),J&&U.jsxs("div",{className:"text-center p-10 rounded-3xl mb-10 shadow-2xl border-2 bg-gradient-to-br from-yellow-50 to-orange-50 border-yellow-200",children:[U.jsx("div",{className:"text-8xl mb-6",children:""}),U.jsx("h2",{className:"text-4xl font-bold text-yellow-800 mb-4",children:"Lesson Completed!"}),U.jsx("p",{className:"text-xl text-yellow-700 mb-6",children:"Congratulations! You've finished this lesson."}),U.jsxs("div",{className:"flex items-center justify-center space-x-8 mb-6",children:[U.jsxs("div",{className:"flex items-center space-x-2 bg-yellow-100 px-4 py-2 rounded-full",children:[U.jsx("span",{className:"text-2xl",children:""}),U.jsxs("span",{className:"font-bold text-yellow-800",children:["+",_.xpReward||10," XP"]})]}),U.jsxs("div",{className:"flex items-center space-x-2 bg-orange-100 px-4 py-2 rounded-full",children:[U.jsx("span",{className:"text-2xl",children:""}),U.jsx("span",{className:"font-bold text-orange-800",children:"Streak +1"})]})]}),U.jsx("p",{className:"text-lg text-yellow-600 mb-4",children:"You can now continue to the next lesson!"}),U.jsx("div",{className:"w-full bg-yellow-200 rounded-full h-3 shadow-inner",children:U.jsx("div",{className:"h-3 rounded-full bg-gradient-to-r from-yellow-400 to-orange-400 transition-all duration-1000 ease-out",style:{width:"100%"}})}),U.jsx("p",{className:"text-sm text-yellow-600 mt-3 font-medium",children:"Returning to lesson selection..."})]}),U.jsx("div",{className:"flex justify-center",children:!J&&(Z.options||Z.userOptions)&&U.jsx("button",{onClick:ee,disabled:!E||Y,className:"px-12 py-4 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-2xl hover:from-indigo-600 hover:to-purple-600 disabled:from-gray-300 disabled:to-gray-400 disabled:cursor-not-allowed transition-all duration-300 font-semibold text-lg shadow-lg hover:shadow-xl transform hover:scale-105 disabled:transform-none disabled:shadow-none",children:Y?"Checking...":"Check Answer"})})]})})]})},mi=()=>{const[t]=ot();qe();const[s,r]=e.useState("processing"),[a,n]=e.useState("macOS...");e.useEffect(()=>{i()},[]);const i=async()=>{try{const s=t.get("platform"),a=t.get("user_id"),i=t.get("email"),c=t.get("name"),d=t.get("timestamp"),m=t.get("signature"),x=t.get("redirect_uri");if(console.log("macOS Login Request:",{platform:s,userId:a,email:i,name:c,timestamp:d,signature:m,redirectUri:x}),!(s&&a&&i&&c&&x))throw new Error("");const p=Math.floor(Date.now()/1e3),g=parseInt(d);if(p-g>300)throw new Error("");if(m!==o({id:a,email:i},g))throw new Error("");let b;try{b=(await k(ct,i,"macos_temp_password")).user,console.log("Existing user signed in:",b.uid)}catch(e){if("auth/user-not-found"!==e.code)throw e;{console.log("User not found, creating new user...");const e=l();b=(await S(ct,i,e)).user,await b.updateProfile({displayName:c}),await h(u(dt,"users",b.uid),{id:b.uid,email:i,name:c,platform:"macos",createdAt:new Date,totalXP:0,gold:0,level:1,isTutor:!1}),console.log("New user created:",b.uid)}}const f=`${x}?status=success&token=${await b.getIdToken()}&user_id=${b.uid}`;r("success"),n("macOS..."),setTimeout(()=>{window.location.href=f},2e3)}catch(e){console.error("macOS Login Error:",e),r("error"),n(`: ${e.message}`);const s=t.get("redirect_uri");s&&setTimeout(()=>{const t=`${s}?status=error&error=${encodeURIComponent(e.message)}`;window.location.href=t},3e3)}},o=(e,t)=>{const s=`${e.id}${e.email}${t}`;return btoa(s)},l=()=>"macos_"+Math.random().toString(36).substring(2,15);return U.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",padding:"20px",backgroundColor:"#f5f5f5"},children:[U.jsxs("div",{style:{backgroundColor:"white",padding:"40px",borderRadius:"20px",boxShadow:"0 10px 30px rgba(0,0,0,0.1)",textAlign:"center",maxWidth:"400px",width:"100%"},children:[U.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px",color:"white",fontSize:"36px"},children:""}),U.jsx("h2",{style:{color:"#333",marginBottom:"10px",fontSize:"24px",fontWeight:"bold"},children:"Studiply macOS "}),U.jsx("p",{style:{color:"#666",marginBottom:"30px",fontSize:"16px",lineHeight:"1.5"},children:a}),U.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",marginBottom:"20px"},children:["processing"===s&&U.jsxs(U.Fragment,{children:[U.jsx("div",{style:{width:"20px",height:"20px",border:"2px solid #667eea",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}),U.jsx("span",{style:{color:"#667eea",fontWeight:"500"},children:"..."})]}),"success"===s&&U.jsxs(U.Fragment,{children:[U.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:"#4CAF50",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"12px"},children:""}),U.jsx("span",{style:{color:"#4CAF50",fontWeight:"500"},children:""})]}),"error"===s&&U.jsxs(U.Fragment,{children:[U.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:"#f44336",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"12px"},children:""}),U.jsx("span",{style:{color:"#f44336",fontWeight:"500"},children:""})]})]}),U.jsx("button",{onClick:()=>window.close(),style:{backgroundColor:"#667eea",color:"white",border:"none",padding:"12px 24px",borderRadius:"10px",fontSize:"16px",fontWeight:"500",cursor:"pointer",transition:"background-color 0.3s"},onMouseOver:e=>e.target.style.backgroundColor="#5a6fd8",onMouseOut:e=>e.target.style.backgroundColor="#667eea",children:""})]}),U.jsx("style",{jsx:!0,children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})},xi=()=>{const[t,s]=e.useState({email:"",password:""}),[r,a]=e.useState(""),[n,i]=e.useState(!1),[o,l]=e.useState(!1),{login:c}=Br(),d=Ie();e.useEffect(()=>{l(!0)},[]);const u=e=>{s({...t,[e.target.name]:e.target.value}),r&&a("")};return U.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:U.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md transform transition-all duration-700 "+(o?"translate-y-0 opacity-100":"translate-y-8 opacity-0"),children:[U.jsxs("div",{className:"text-center mb-8",children:[U.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4",children:U.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:U.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),U.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Login to Studiply"}),U.jsx("p",{className:"text-gray-600",children:"Sign in to continue to your macOS app"})]}),U.jsxs("form",{onSubmit:async e=>{e.preventDefault(),i(!0),a("");try{const e=await c(t.email.trim().toLowerCase(),t.password.trim());if(e.success){const t=new URLSearchParams(d.search),s=t.get("redirect_uri"),r=t.get("platform");if(s&&"macos"===r){const t="mock_token_for_macos",r=`${s}?status=success&user_id=${e.user.id}&email=${encodeURIComponent(e.user.email)}&name=${encodeURIComponent(e.user.name)}&token=${t}&is_tutor=${e.user.isTutor||!1}`;console.log("Redirecting to macOS app:",r),window.location.href=r}else window.location.href="/tutoring"}else a(e.error)}catch(s){a("An unexpected error occurred")}finally{i(!1)}},className:"space-y-6",children:[U.jsxs("div",{children:[U.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),U.jsx("input",{type:"email",id:"email",name:"email",value:t.email,onChange:u,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Enter your email"})]}),U.jsxs("div",{children:[U.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),U.jsx("input",{type:"password",id:"password",name:"password",value:t.password,onChange:u,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Enter your password"})]}),r&&U.jsx("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg text-sm",children:r}),U.jsx("button",{type:"submit",disabled:n,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-4 rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:n?U.jsxs("div",{className:"flex items-center justify-center",children:[U.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[U.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),U.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign In & Continue to macOS App"})]}),U.jsx("div",{className:"mt-8 text-center",children:U.jsx("p",{className:"text-sm text-gray-500",children:"After signing in, you'll be automatically redirected back to your macOS app."})})]})})},pi=()=>{const t=qe(),s=Ie(),{user:a,reloadUser:n}=Br(),{isDark:i}=mt(),{showSuccess:o,showError:l}=Hr(),[c,d]=e.useState(1),[u,h]=e.useState(!1),[m,x]=e.useState(!0),[p,g]=e.useState({isAvailable:!0,specialties:[],description:"",experience:"Student",responseTime:"Usually responds within a few hours",hourlyRate:15});e.useEffect(()=>{(async()=>{if(!(null==a?void 0:a.id))return void t("/login");if(null==a?void 0:a.isTutor){const e=await Ja(a.id);if(e.success&&e.isVerified)return void t("/tutor-dashboard")}const e=new URLSearchParams(s.search).get("stripe");if("complete"===e){const e=await Ja(a.id);e.success&&e.isVerified?d(3):(d(2),l("Bank verification not complete. Please try again.")),t("/become-tutor",{replace:!0})}else"refresh"===e&&(d(2),t("/become-tutor",{replace:!0}));x(!1)})()},[a,s.search,t]);const b=e=>{const{name:t,value:s,type:r,checked:a}=e.target;g(e=>({...e,[t]:"checkbox"===r?a:s}))};return m?U.jsx("div",{className:"min-h-screen flex items-center justify-center "+(i?"bg-slate-900":"bg-gradient-to-br from-purple-50 via-pink-50 to-orange-50"),children:U.jsx(As,{className:"w-8 h-8 animate-spin text-purple-500"})}):U.jsxs("div",{className:"min-h-screen "+(i?"bg-slate-900":"bg-gradient-to-br from-purple-50 via-pink-50 to-orange-50"),children:[U.jsx("div",{className:`border-b ${i?"border-white/10 bg-slate-800/50":"border-white/50 bg-white/30"} backdrop-blur-xl`,children:U.jsx("div",{className:"max-w-4xl mx-auto px-6 py-4",children:U.jsxs("button",{onClick:()=>t(-1),className:`flex items-center gap-2 text-sm font-medium ${i?"text-white/70 hover:text-white":"text-slate-600 hover:text-slate-900"} transition-colors`,children:[U.jsx(wt,{className:"w-4 h-4"}),"Back"]})})}),U.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-12",children:[U.jsxs("div",{className:"text-center mb-12",children:[U.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-purple-500 to-pink-500 mb-4",children:U.jsx(ps,{className:"w-8 h-8 text-white"})}),U.jsx("h1",{className:"text-3xl font-bold mb-2 "+(i?"text-white":"text-slate-900"),children:"Become a Tutor"}),U.jsx("p",{className:""+(i?"text-white/60":"text-slate-600"),children:"Share your knowledge and earn money helping students"})]}),U.jsx("div",{className:"flex items-center justify-center mb-12",children:[{num:1,label:"Profile"},{num:2,label:"Bank Account"},{num:3,label:"Complete"}].map((e,t)=>U.jsxs(r.Fragment,{children:[U.jsxs("div",{className:"flex flex-col items-center",children:[U.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-bold transition-all "+(c>=e.num?"bg-gradient-to-br from-purple-500 to-pink-500 text-white":i?"bg-white/10 text-white/40":"bg-slate-200 text-slate-400"),children:c>e.num?U.jsx($t,{className:"w-5 h-5"}):e.num}),U.jsx("span",{className:"text-xs mt-2 font-medium "+(c>=e.num?i?"text-purple-400":"text-purple-600":i?"text-white/40":"text-slate-400"),children:e.label})]}),t<2&&U.jsx("div",{className:"w-20 h-1 mx-2 rounded-full "+(c>e.num?"bg-gradient-to-r from-purple-500 to-pink-500":i?"bg-white/10":"bg-slate-200")})]},e.num))}),U.jsxs("div",{className:`rounded-3xl ${i?"bg-white/5 border border-white/10":"bg-white shadow-xl"} overflow-hidden`,children:[1===c&&U.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),null==a?void 0:a.id)if(0!==p.specialties.length){h(!0);try{const e=await Fa(null==a?void 0:a.id,p);e.success?d(2):l(`Failed to setup tutor profile: ${e.error}`)}catch(t){l("An error occurred while setting up your tutor profile"),console.error("Error:",t)}finally{h(!1)}}else l("Please select at least one subject you can teach")},className:"p-8",children:[U.jsx("h2",{className:"text-xl font-bold mb-6 "+(i?"text-white":"text-slate-900"),children:"Set Up Your Tutor Profile"}),U.jsxs("div",{className:"space-y-6",children:[U.jsxs("div",{children:[U.jsxs("label",{className:"block text-sm font-semibold mb-2 "+(i?"text-white":"text-slate-700"),children:[U.jsx(ss,{className:"w-4 h-4 inline mr-2"}),"Hourly Rate ()"]}),U.jsx("input",{type:"number",name:"hourlyRate",value:p.hourlyRate,onChange:b,min:"5",max:"100",className:`w-full px-4 py-3 rounded-xl border ${i?"bg-white/5 border-white/10 text-white":"bg-slate-50 border-slate-200 text-slate-900"} focus:ring-2 focus:ring-purple-500 focus:border-purple-500`}),U.jsx("p",{className:"text-xs mt-1 "+(i?"text-white/50":"text-slate-500"),children:"20% platform fee will be deducted from each payment"})]}),U.jsxs("div",{children:[U.jsxs("label",{className:"block text-sm font-semibold mb-2 "+(i?"text-white":"text-slate-700"),children:[U.jsx(Nr,{className:"w-4 h-4 inline mr-2"}),"Experience Level"]}),U.jsx("select",{name:"experience",value:p.experience,onChange:b,className:`w-full px-4 py-3 rounded-xl border ${i?"bg-white/5 border-white/10 text-white":"bg-slate-50 border-slate-200 text-slate-900"} focus:ring-2 focus:ring-purple-500 focus:border-purple-500`,children:["Student","Recent Graduate","Graduate Student","Professional","Teacher/Professor"].map(e=>U.jsx("option",{value:e,children:e},e))})]}),U.jsxs("div",{children:[U.jsxs("label",{className:"block text-sm font-semibold mb-2 "+(i?"text-white":"text-slate-700"),children:[U.jsx(Pt,{className:"w-4 h-4 inline mr-2"}),"Subjects You Can Teach ",U.jsx("span",{className:"text-red-500",children:"*"})]}),U.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 max-h-48 overflow-y-auto rounded-xl border p-4 "+(i?"bg-white/5 border-white/10":"bg-slate-50 border-slate-200"),children:["Mathematics","Science","Physics","Chemistry","Biology","English","Literature","Writing","History","Geography","Art","Music","Programming","Computer Science","Economics","Psychology","Philosophy","French Language","German Language","Spanish Language","Other"].map(e=>U.jsxs("label",{className:"flex items-center space-x-2 text-sm cursor-pointer p-2 rounded-lg transition-colors "+(p.specialties.includes(e)?i?"bg-purple-500/20":"bg-purple-100":i?"hover:bg-white/5":"hover:bg-white"),children:[U.jsx("input",{type:"checkbox",checked:p.specialties.includes(e),onChange:()=>{return t=e,void g(e=>({...e,specialties:e.specialties.includes(t)?e.specialties.filter(e=>e!==t):[...e.specialties,t]}));var t},className:"rounded border-gray-300 text-purple-600"}),U.jsx("span",{className:i?"text-white/80":"text-slate-700",children:e})]},e))}),0===p.specialties.length&&U.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Please select at least one subject"})]}),U.jsxs("div",{children:[U.jsxs("label",{className:"block text-sm font-semibold mb-2 "+(i?"text-white":"text-slate-700"),children:[U.jsx(Ht,{className:"w-4 h-4 inline mr-2"}),"Response Time"]}),U.jsx("select",{name:"responseTime",value:p.responseTime,onChange:b,className:`w-full px-4 py-3 rounded-xl border ${i?"bg-white/5 border-white/10 text-white":"bg-slate-50 border-slate-200 text-slate-900"} focus:ring-2 focus:ring-purple-500 focus:border-purple-500`,children:["Usually responds within a few hours","Usually responds within a day","Usually responds within a few days"].map(e=>U.jsx("option",{value:e,children:e},e))})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(i?"text-white":"text-slate-700"),children:"About You"}),U.jsx("textarea",{name:"description",value:p.description,onChange:b,placeholder:"Tell students about your teaching style, experience, and what makes you a great tutor...",rows:4,className:`w-full px-4 py-3 rounded-xl border ${i?"bg-white/5 border-white/10 text-white placeholder:text-white/30":"bg-slate-50 border-slate-200 text-slate-900"} focus:ring-2 focus:ring-purple-500 focus:border-purple-500`})]})]}),U.jsxs("div",{className:"flex gap-4 mt-8 pt-6 border-t border-slate-200 dark:border-white/10",children:[U.jsx("button",{type:"button",onClick:()=>t(-1),className:"flex-1 py-3 px-6 rounded-xl font-semibold transition-colors "+(i?"bg-white/10 text-white hover:bg-white/20":"bg-slate-100 text-slate-700 hover:bg-slate-200"),children:"Cancel"}),U.jsx("button",{type:"submit",disabled:u||0===p.specialties.length,className:"flex-1 py-3 px-6 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl font-semibold hover:from-purple-600 hover:to-pink-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center shadow-lg shadow-purple-500/30",children:u?U.jsxs(U.Fragment,{children:[U.jsx(As,{className:"w-5 h-5 animate-spin mr-2"}),"Saving..."]}):U.jsxs(U.Fragment,{children:["Next: Bank Setup",U.jsx(yt,{className:"w-5 h-5 ml-2"})]})})]})]}),2===c&&U.jsxs("div",{className:"p-8",children:[U.jsxs("div",{className:"text-center mb-8",children:[U.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-emerald-500 to-teal-500 mb-4",children:U.jsx(Mt,{className:"w-8 h-8 text-white"})}),U.jsx("h2",{className:"text-xl font-bold mb-2 "+(i?"text-white":"text-slate-900"),children:"Connect Your Bank Account"}),U.jsx("p",{className:""+(i?"text-white/60":"text-slate-600"),children:"Required to receive payments from students"})]}),U.jsxs("div",{className:"rounded-xl p-4 mb-6 flex items-start gap-3 "+(i?"bg-green-500/10 border border-green-500/30":"bg-green-50 border border-green-200"),children:[U.jsx($t,{className:"w-6 h-6 text-green-500 flex-shrink-0"}),U.jsxs("div",{children:[U.jsx("p",{className:"font-semibold "+(i?"text-green-400":"text-green-700"),children:"Profile Created Successfully!"}),U.jsx("p",{className:"text-sm "+(i?"text-green-400/70":"text-green-600"),children:"Now let's set up your bank account to start earning."})]})]}),U.jsx("div",{className:"rounded-xl p-6 mb-6 "+(i?"bg-white/5":"bg-slate-50"),children:U.jsx("div",{className:"space-y-4",children:[{icon:Kt,text:"Receive payments directly to your bank"},{icon:nr,text:"Automatic payouts after each session"},{icon:rr,text:"Bank-level security by Stripe"},{icon:or,text:"View detailed earnings reports"}].map((e,t)=>U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx("div",{className:"p-2 rounded-lg "+(i?"bg-purple-500/20":"bg-purple-100"),children:U.jsx(e.icon,{className:"w-5 h-5 "+(i?"text-purple-400":"text-purple-600")})}),U.jsx("span",{className:""+(i?"text-white/80":"text-slate-700"),children:e.text})]},t))})}),U.jsx("div",{className:"rounded-xl p-4 mb-8 "+(i?"bg-orange-500/10 border border-orange-500/30":"bg-orange-50 border border-orange-200"),children:U.jsxs("p",{className:"text-sm "+(i?"text-orange-300":"text-orange-700"),children:[U.jsx("strong",{children:"Important:"})," You must connect your bank account to accept tutoring sessions and receive payments."]})}),U.jsxs("div",{className:"space-y-3",children:[U.jsx("button",{onClick:async()=>{if((null==a?void 0:a.id)&&(null==a?void 0:a.email)){h(!0);try{const e=await Qa(a.id,a.email);e.success?e.isVerified?(d(3),o("Bank account verified!")):e.onboardingUrl&&(window.location.href=e.onboardingUrl):l(e.error||"Failed to connect bank account")}catch(e){l("An error occurred"),console.error("Error:",e)}finally{h(!1)}}else l("User information not available")},disabled:u,className:"w-full py-4 px-6 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl font-bold hover:from-purple-600 hover:to-pink-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center shadow-lg shadow-purple-500/30",children:u?U.jsxs(U.Fragment,{children:[U.jsx(As,{className:"w-5 h-5 animate-spin mr-2"}),"Connecting..."]}):U.jsxs(U.Fragment,{children:[U.jsx(Kt,{className:"w-5 h-5 mr-2"}),"Connect Bank Account",U.jsx(ns,{className:"w-4 h-4 ml-2"})]})}),U.jsxs("button",{onClick:()=>d(1),disabled:u,className:"w-full py-3 px-6 rounded-xl font-medium transition-colors flex items-center justify-center "+(i?"bg-white/10 text-white hover:bg-white/20":"bg-slate-100 text-slate-700 hover:bg-slate-200"),children:[U.jsx(wt,{className:"w-4 h-4 mr-2"}),"Back to Profile"]})]}),U.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[U.jsx(rr,{className:"w-4 h-4 "+(i?"text-white/40":"text-slate-400")}),U.jsx("span",{className:"text-xs "+(i?"text-white/40":"text-slate-400"),children:"Powered by Stripe  Bank-level security"})]})]}),3===c&&U.jsxs("div",{className:"p-8 text-center",children:[U.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gradient-to-br from-green-500 to-emerald-500 mb-6",children:U.jsx($t,{className:"w-10 h-10 text-white"})}),U.jsx("h2",{className:"text-2xl font-bold mb-2 "+(i?"text-white":"text-slate-900"),children:" Congratulations!"}),U.jsx("p",{className:"text-lg mb-8 "+(i?"text-white/60":"text-slate-600"),children:"You are now officially a Studiply Tutor!"}),U.jsxs("div",{className:"rounded-xl p-6 mb-8 "+(i?"bg-white/5":"bg-slate-50"),children:[U.jsx("h3",{className:"font-semibold mb-4 "+(i?"text-white":"text-slate-900"),children:"What's Next?"}),U.jsx("div",{className:"space-y-3 text-left",children:["Students can now find and request sessions with you","You'll receive notifications when students request help","After each session, students will pay and you'll receive automatic payouts","Track your earnings and sessions in your dashboard"].map((e,t)=>U.jsxs("div",{className:"flex items-start gap-3",children:[U.jsx($t,{className:"w-5 h-5 flex-shrink-0 "+(i?"text-green-400":"text-green-500")}),U.jsx("span",{className:"text-sm "+(i?"text-white/70":"text-slate-600"),children:e})]},t))})]}),U.jsxs("button",{onClick:()=>{const e={...a,isTutor:!0};localStorage.setItem("simpleUser",JSON.stringify(e)),n(),o("Congratulations! You are now a tutor!"),t("/tutor-dashboard")},className:"w-full py-4 px-6 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl font-bold hover:from-purple-600 hover:to-pink-600 transition-all shadow-lg shadow-purple-500/30",children:["Go to Tutor Dashboard",U.jsx(yt,{className:"w-5 h-5 ml-2 inline"})]})]})]})]})]})},gi=()=>{const t=qe(),{user:s,loading:r}=Br(),[a,n]=e.useState("loading"),[i,o]=e.useState(""),[l,c]=e.useState(!1);e.useEffect(()=>{r||s||t("/login?redirect=/desktop-auth"),!r&&s&&n("ready")},[s,r,t]);return r||"loading"===a?U.jsx("div",{className:"min-h-screen bg-[#0d1117] flex items-center justify-center",children:U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"w-10 h-10 border-2 border-white/20 border-t-white rounded-full animate-spin mx-auto mb-4"}),U.jsx("p",{className:"text-white/60",children:"Loading..."})]})}):s?U.jsx("div",{className:"min-h-screen bg-[#0d1117] flex items-center justify-center p-4",children:U.jsxs("div",{className:"w-full max-w-md",children:[U.jsxs("div",{className:"text-center mb-8",children:[U.jsx("div",{className:"text-5xl mb-4",children:""}),U.jsx("h1",{className:"text-2xl font-semibold text-white",children:"Studiply for macOS"})]}),U.jsxs("div",{className:"bg-[#161b22] border border-[#30363d] rounded-xl p-6",children:["connecting"===a&&U.jsxs("div",{className:"text-center py-8",children:[U.jsx("div",{className:"w-10 h-10 border-2 border-white/20 border-t-green-500 rounded-full animate-spin mx-auto mb-4"}),U.jsx("p",{className:"text-white",children:"Opening app..."})]}),"ready"===a&&U.jsxs(U.Fragment,{children:[U.jsxs("div",{className:"flex items-center gap-4 p-4 bg-[#0d1117] rounded-lg mb-6",children:[s.avatar?U.jsx("img",{src:s.avatar,alt:"",className:"w-12 h-12 rounded-full object-cover"}):U.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white font-bold text-lg",children:s.name?s.name.charAt(0).toUpperCase():"U"}),U.jsxs("div",{children:[U.jsx("p",{className:"text-white font-medium",children:s.name||"User"}),U.jsx("p",{className:"text-[#8b949e] text-sm",children:s.email})]})]}),U.jsxs("button",{onClick:()=>{if(!s)return;n("connecting");const e={id:s.id,name:s.name,email:s.email,streak:s.streak||0,isTutor:s.isTutor||!1,avatar:s.avatar||null},t=btoa(unescape(encodeURIComponent(JSON.stringify(e))));o(t),window.location.href=`studiply://auth?data=${t}`,setTimeout(()=>{n("done"),navigator.clipboard.writeText(t).then(()=>{c(!0),setTimeout(()=>c(!1),2e3)}).catch(()=>{})},1500)},className:"w-full py-3 px-4 bg-[#238636] hover:bg-[#2ea043] text-white font-medium rounded-lg transition-colors flex items-center justify-center gap-2",children:[U.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:U.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),"Connect"]})]}),"done"===a&&U.jsxs("div",{className:"text-center py-4",children:[U.jsx("div",{className:"w-14 h-14 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:U.jsx("svg",{className:"w-7 h-7 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:U.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),U.jsx("p",{className:"text-white font-medium mb-1",children:"Code Ready!"}),U.jsx("p",{className:"text-[#8b949e] text-sm mb-4",children:'Return to Mac app and click "Paste Code"'}),U.jsx("button",{onClick:()=>{navigator.clipboard.writeText(i),c(!0),setTimeout(()=>c(!1),2e3)},className:"w-full py-3 px-4 bg-[#238636] hover:bg-[#2ea043] text-white font-medium rounded-lg transition-colors flex items-center justify-center gap-2",children:l?U.jsx(U.Fragment,{children:" Copied!"}):U.jsx(U.Fragment,{children:" Copy Code Again"})})]})]}),U.jsx("p",{className:"text-center text-[#8b949e] text-xs mt-6",children:"This will share your account info with the desktop app"})]})}):null},bi={success:{icon:$t,classes:"bg-green-50 border-green-200 text-green-800"},error:{icon:qr,classes:"bg-red-50 border-red-200 text-red-800"},warning:{icon:ft,classes:"bg-yellow-50 border-yellow-200 text-yellow-800"},info:{icon:ys,classes:"bg-blue-50 border-blue-200 text-blue-800"}},fi=({open:t,onClose:s,onMouseEnter:r,onMouseLeave:a})=>{const{user:n}=Br(),[i,o]=e.useState([]),l=e.useRef(null),[c,d]=e.useState(t),[u,h]=e.useState(!1);return e.useEffect(()=>{let e=null;const t=()=>{if(e&&"function"==typeof e)try{e()}catch(t){console.error("Error cleaning up notifications listener:",t)}};return(null==n?void 0:n.id)?(e=za(null==n?void 0:n.id,o,20),t):t},[null==n?void 0:n.id]),e.useEffect(()=>{if(t){d(!0);const e=requestAnimationFrame(()=>h(!0));return()=>cancelAnimationFrame(e)}{h(!1);const e=setTimeout(()=>d(!1),220);return()=>clearTimeout(e)}},[t]),c?U.jsxs("div",{ref:l,onMouseEnter:r,onMouseLeave:a,className:"absolute right-0 top-10 w-80 sm:w-96 bg-white/95 backdrop-blur-md rounded-xl border border-gray-200 overflow-hidden z-50 transition-all "+(u?"opacity-100 translate-y-0 scale-100 shadow-2xl":"opacity-0 -translate-y-2 scale-95 shadow-lg"),style:{transformOrigin:"90% 0%",transitionDuration:"220ms",transitionTimingFunction:"cubic-bezier(0.22, 1, 0.36, 1)"},children:[U.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200",children:[U.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Notifications"}),U.jsx("button",{className:"text-xs text-blue-600 hover:underline",onClick:()=>(null==n?void 0:n.id)&&Wa(null==n?void 0:n.id),children:"Mark all as read"})]}),U.jsx("div",{className:"max-h-96 overflow-auto divide-y divide-gray-100",children:0===i.length?U.jsx("div",{className:"p-6 text-center text-gray-500 text-sm",children:"No notifications"}):i.map(e=>{var t;const s=bi[e.type]||bi.info,r=s.icon,a=(()=>{if(e.fromName&&e.subject){if((e.title||"").toLowerCase().includes("request"))return`${e.fromName} requested a ${e.subject} session`;if((e.title||"").toLowerCase().includes("accepted"))return`${e.fromName} accepted your ${e.subject} session`;if((e.title||"").toLowerCase().includes("declined")||(e.title||"").toLowerCase().includes("rejected"))return`${e.fromName} declined your ${e.subject} session`}return e.fromName&&"string"==typeof e.message?e.message.replace(/^\d{6,}/,e.fromName):e.message})();return U.jsxs("div",{className:"flex items-start gap-3 p-4 hover:bg-gray-50",children:[U.jsx("div",{className:`w-9 h-9 rounded-lg border flex items-center justify-center ${s.classes}`,children:U.jsx(r,{className:"w-4 h-4"})}),U.jsxs("div",{className:"flex-1 min-w-0",children:[U.jsx("div",{className:"text-sm font-semibold text-gray-900 truncate",children:e.title||"Notification"}),U.jsx("div",{className:"text-sm text-gray-600 truncate",children:a}),U.jsx("div",{className:"text-xs text-gray-400 mt-1",children:e.createdAt&&(null==(t=Pa(e.createdAt))?void 0:t.toLocaleString())||""})]})]},e.id)})})]}):null},wi=({isVisible:t,onClose:s,title:r,message:a,type:n="warning"})=>{const[i,o]=e.useState(!1);if(e.useEffect(()=>{if(t){o(!0);const e=setTimeout(()=>{o(!1),setTimeout(()=>s(),300)},5e3);return()=>clearTimeout(e)}},[t,s]),!i)return null;return U.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:U.jsx("div",{className:`max-w-md w-full mx-4 p-6 rounded-xl border-2 shadow-2xl transform transition-all duration-300 ${{warning:"bg-yellow-50 border-yellow-200 text-yellow-800",error:"bg-red-50 border-red-200 text-red-800",success:"bg-green-50 border-green-200 text-green-800",info:"bg-blue-50 border-blue-200 text-blue-800"}[n]}`,children:U.jsxs("div",{className:"flex items-start space-x-4",children:[U.jsx(ft,{className:"w-8 h-8 text-yellow-600 flex-shrink-0 mt-1"}),U.jsxs("div",{className:"flex-1",children:[U.jsx("h3",{className:"text-xl font-bold mb-2",children:r}),U.jsx("p",{className:"text-lg mb-4",children:a}),U.jsxs("div",{className:"flex space-x-3",children:[U.jsx("button",{onClick:()=>{o(!1),setTimeout(()=>s(),300)},className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors",children:"I Understand"}),U.jsx("button",{onClick:()=>{o(!1),setTimeout(()=>s(),300)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Close"})]})]}),U.jsx("button",{onClick:()=>{o(!1),setTimeout(()=>s(),300)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:U.jsx(Rr,{className:"w-6 h-6"})})]})})})},yi=()=>{const{isDark:t}=mt(),s=qe(),[r,a]=e.useState(0),n=[{step:1,title:"Download Extension",description:"Click the download button to get the Studiply Focus Mode extension",icon:rs,completed:r>=1},{step:2,title:"Extract Files",description:"Extract the downloaded ZIP file to a folder on your computer",icon:Wt,completed:r>=2},{step:3,title:"Install in Chrome",description:"Open Chrome Extensions page and enable Developer mode",icon:rr,completed:r>=3,copyText:"chrome://extensions/"},{step:4,title:"Load Extension",description:"Click 'Load unpacked' and select the extracted folder",icon:$t,completed:r>=4}];return U.jsxs("div",{className:"min-h-screen relative overflow-hidden "+(t?"bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900":"bg-gradient-to-br from-blue-50 via-white to-purple-50"),children:[U.jsx("div",{className:"absolute inset-0 overflow-hidden",children:t?U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"}),U.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"}),U.jsx("div",{className:"absolute top-40 left-40 w-60 h-60 bg-pink-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"}),U.jsx("div",{className:"absolute bottom-20 right-20 w-40 h-40 bg-cyan-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"})]}):U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-r from-purple-400 to-purple-600 rounded-full filter blur-xl opacity-40 animate-pulse shadow-2xl shadow-purple-300/50"}),U.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-r from-blue-400 to-blue-600 rounded-full filter blur-xl opacity-40 animate-pulse shadow-2xl shadow-blue-300/50"}),U.jsx("div",{className:"absolute top-40 left-40 w-60 h-60 bg-gradient-to-r from-pink-400 to-pink-600 rounded-full filter blur-xl opacity-40 animate-pulse shadow-2xl shadow-pink-300/50"}),U.jsx("div",{className:"absolute bottom-20 right-20 w-40 h-40 bg-gradient-to-r from-cyan-400 to-cyan-600 rounded-full filter blur-xl opacity-40 animate-pulse shadow-2xl shadow-cyan-300/50"})]})}),U.jsxs("div",{className:"relative z-10 container mx-auto px-4 py-12",children:[U.jsx("div",{className:"mb-8",children:U.jsxs("button",{onClick:()=>s("/focus-mode"),className:"inline-flex items-center space-x-2 px-4 py-2 rounded-xl font-medium transition-all duration-200 "+(t?"bg-white/10 text-white hover:bg-white/20 border border-white/20":"bg-white/80 text-gray-700 hover:bg-white border border-gray-200"),children:[U.jsx(wt,{className:"w-4 h-4"}),U.jsx("span",{children:"Back to Focus Mode"})]})}),U.jsx("div",{className:"text-center mb-12",children:U.jsxs("div",{className:"group relative inline-block",children:[U.jsx("div",{className:"absolute inset-0 rounded-3xl blur-xl transition-all duration-500 group-hover:blur-2xl "+(t?"bg-gradient-to-r from-purple-500/30 to-blue-500/30 shadow-2xl shadow-purple-500/20":"bg-gradient-to-r from-purple-500/20 to-blue-500/20 shadow-2xl shadow-purple-300/30")}),U.jsx("div",{className:"relative backdrop-blur-sm rounded-3xl shadow-2xl border overflow-hidden transition-all duration-300 group-hover:scale-105 "+(t?"bg-white/10 border-white/20 group-hover:border-purple-400/50":"bg-white/90 border-white/20 group-hover:border-purple-200/50"),children:U.jsxs("div",{className:"p-8",children:[U.jsx("div",{className:"flex items-center justify-center mb-4",children:U.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center "+(t?"bg-gradient-to-r from-purple-500 to-blue-500":"bg-gradient-to-r from-purple-600 to-blue-600"),children:U.jsx(Wt,{className:"w-8 h-8 text-white"})})}),U.jsx("h1",{className:"text-4xl font-bold mb-4 "+(t?"bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent":"bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent drop-shadow-lg"),children:"Studiply Focus Mode Extension"}),U.jsx("p",{className:"text-lg "+(t?"text-gray-300":"text-gray-600"),children:"Block distracting websites during your focus sessions"})]})})]})}),U.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-12",children:[U.jsxs("div",{className:"group relative",children:[U.jsx("div",{className:"absolute inset-0 rounded-2xl blur-lg transition-all duration-500 group-hover:blur-xl "+(t?"bg-gradient-to-r from-green-500/20 to-emerald-500/20 shadow-2xl shadow-green-500/10":"bg-gradient-to-r from-green-500/10 to-emerald-500/10 shadow-2xl shadow-green-300/20")}),U.jsx("div",{className:"relative backdrop-blur-sm rounded-2xl shadow-xl border transition-all duration-300 group-hover:scale-105 "+(t?"bg-white/10 border-white/20 group-hover:border-green-400/50":"bg-white/90 border-white/20 group-hover:border-green-200/50"),children:U.jsxs("div",{className:"p-6 text-center",children:[U.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center mx-auto mb-4 "+(t?"bg-gradient-to-r from-green-500 to-emerald-500":"bg-gradient-to-r from-green-600 to-emerald-600"),children:U.jsx(rr,{className:"w-6 h-6 text-white"})}),U.jsx("h3",{className:"text-xl font-bold mb-2 "+(t?"text-white":"text-gray-800"),children:"Website Blocking"}),U.jsx("p",{className:"text-sm "+(t?"text-gray-300":"text-gray-600"),children:"Automatically block distracting websites during focus sessions"})]})})]}),U.jsxs("div",{className:"group relative",children:[U.jsx("div",{className:"absolute inset-0 rounded-2xl blur-lg transition-all duration-500 group-hover:blur-xl "+(t?"bg-gradient-to-r from-blue-500/20 to-cyan-500/20 shadow-2xl shadow-blue-500/10":"bg-gradient-to-r from-blue-500/10 to-cyan-500/10 shadow-2xl shadow-blue-300/20")}),U.jsx("div",{className:"relative backdrop-blur-sm rounded-2xl shadow-xl border transition-all duration-300 group-hover:scale-105 "+(t?"bg-white/10 border-white/20 group-hover:border-blue-400/50":"bg-white/90 border-white/20 group-hover:border-blue-200/50"),children:U.jsxs("div",{className:"p-6 text-center",children:[U.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center mx-auto mb-4 "+(t?"bg-gradient-to-r from-blue-500 to-cyan-500":"bg-gradient-to-r from-blue-600 to-cyan-600"),children:U.jsx($t,{className:"w-6 h-6 text-white"})}),U.jsx("h3",{className:"text-xl font-bold mb-2 "+(t?"text-white":"text-gray-800"),children:"Easy Setup"}),U.jsx("p",{className:"text-sm "+(t?"text-gray-300":"text-gray-600"),children:"Simple one-click installation process"})]})})]}),U.jsxs("div",{className:"group relative",children:[U.jsx("div",{className:"absolute inset-0 rounded-2xl blur-lg transition-all duration-500 group-hover:blur-xl "+(t?"bg-gradient-to-r from-purple-500/20 to-pink-500/20 shadow-2xl shadow-purple-500/10":"bg-gradient-to-r from-purple-500/10 to-pink-500/10 shadow-2xl shadow-purple-300/20")}),U.jsx("div",{className:"relative backdrop-blur-sm rounded-2xl shadow-xl border transition-all duration-300 group-hover:scale-105 "+(t?"bg-white/10 border-white/20 group-hover:border-purple-400/50":"bg-white/90 border-white/20 group-hover:border-purple-200/50"),children:U.jsxs("div",{className:"p-6 text-center",children:[U.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center mx-auto mb-4 "+(t?"bg-gradient-to-r from-purple-500 to-pink-500":"bg-gradient-to-r from-purple-600 to-pink-600"),children:U.jsx(ns,{className:"w-6 h-6 text-white"})}),U.jsx("h3",{className:"text-xl font-bold mb-2 "+(t?"text-white":"text-gray-800"),children:"Seamless Integration"}),U.jsx("p",{className:"text-sm "+(t?"text-gray-300":"text-gray-600"),children:"Works automatically with Studiply focus sessions"})]})})]})]}),U.jsxs("div",{className:"max-w-2xl mx-auto",children:[U.jsxs("div",{className:"group relative",children:[U.jsx("div",{className:"absolute inset-0 rounded-3xl blur-xl transition-all duration-500 group-hover:blur-2xl "+(t?"bg-gradient-to-r from-orange-500/30 to-red-500/30 shadow-2xl shadow-orange-500/20":"bg-gradient-to-r from-orange-500/20 to-red-500/20 shadow-2xl shadow-orange-300/30")}),U.jsx("div",{className:"relative backdrop-blur-sm rounded-3xl shadow-2xl border transition-all duration-300 group-hover:scale-105 "+(t?"bg-white/10 border-white/20 group-hover:border-orange-400/50":"bg-white/90 border-white/20 group-hover:border-orange-200/50"),children:U.jsxs("div",{className:"p-8 text-center",children:[U.jsx("h2",{className:"text-2xl font-bold mb-4 "+(t?"text-white":"text-gray-800"),children:"Download Extension"}),U.jsx("p",{className:"text-lg mb-6 "+(t?"text-gray-300":"text-gray-600"),children:"Download the Studiply Focus Mode extension to block distracting websites during your focus sessions"}),U.jsx("div",{className:"flex justify-center",children:U.jsxs("button",{onClick:()=>{const e=document.createElement("a");e.href="/studiply-focus-extension-fixed.zip",e.download="studiply-focus-extension-fixed.zip",document.body.appendChild(e),e.click(),document.body.removeChild(e),a(1)},className:"inline-flex items-center space-x-3 px-8 py-4 rounded-2xl font-bold text-xl transition-all duration-300 transform hover:scale-105 "+(t?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-2xl shadow-blue-500/30 hover:shadow-blue-500/50":"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-2xl shadow-blue-300/30 hover:shadow-blue-300/50"),children:[U.jsx(rs,{className:"w-7 h-7"}),U.jsx("span",{children:"Download Extension"})]})})]})})]}),U.jsxs("div",{className:"mt-8 space-y-4",children:[n.map((e,s)=>{const r=e.icon;return U.jsxs("div",{className:"group relative",children:[U.jsx("div",{className:"absolute inset-0 rounded-2xl blur-lg transition-all duration-500 "+(t?"bg-gradient-to-r from-gray-500/10 to-slate-500/10":"bg-gradient-to-r from-gray-500/5 to-slate-500/5")}),U.jsx("div",{className:"relative backdrop-blur-sm rounded-2xl shadow-xl border transition-all duration-300 "+(t?"bg-white/10 border-white/20":"bg-white/90 border-white/20"),children:U.jsx("div",{className:"p-6",children:U.jsxs("div",{className:"flex items-center space-x-4",children:[U.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center "+(e.completed?t?"bg-gradient-to-r from-green-500 to-emerald-500":"bg-gradient-to-r from-green-600 to-emerald-600":t?"bg-gradient-to-r from-gray-500 to-slate-500":"bg-gradient-to-r from-gray-400 to-slate-400"),children:U.jsx(r,{className:"w-6 h-6 text-white"})}),U.jsxs("div",{className:"flex-1",children:[U.jsxs("h3",{className:"text-lg font-bold "+(t?"text-white":"text-gray-800"),children:["Step ",e.step,": ",e.title]}),U.jsxs("p",{className:"text-sm "+(t?"text-gray-300":"text-gray-600"),children:[e.description,e.copyText&&U.jsx("div",{className:"mt-2",children:U.jsxs("div",{className:"inline-flex items-center space-x-2 px-3 py-1 rounded-lg text-xs font-mono "+(t?"bg-gray-800 text-gray-300 border border-gray-600":"bg-gray-100 text-gray-700 border border-gray-300"),children:[U.jsx("span",{children:e.copyText}),U.jsx("button",{onClick:()=>{navigator.clipboard.writeText(e.copyText)},className:"ml-2 px-2 py-1 rounded text-xs transition-colors duration-200 "+(t?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),children:"Copy"})]})})]})]})]})})})]},e.step)}),U.jsxs("div",{className:"group relative",children:[U.jsx("div",{className:"absolute inset-0 rounded-2xl blur-lg transition-all duration-500 "+(t?"bg-gradient-to-r from-yellow-500/20 to-orange-500/20 shadow-2xl shadow-yellow-500/10":"bg-gradient-to-r from-yellow-500/10 to-orange-500/10 shadow-2xl shadow-yellow-300/20")}),U.jsx("div",{className:"relative backdrop-blur-sm rounded-2xl shadow-xl border transition-all duration-300 "+(t?"bg-white/10 border-white/20":"bg-white/90 border-white/20"),children:U.jsx("div",{className:"p-6",children:U.jsxs("div",{className:"flex items-start space-x-4",children:[U.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center "+(t?"bg-gradient-to-r from-yellow-500 to-orange-500":"bg-gradient-to-r from-yellow-600 to-orange-600"),children:U.jsx(ft,{className:"w-6 h-6 text-white"})}),U.jsxs("div",{className:"flex-1",children:[U.jsx("h3",{className:"text-lg font-bold mb-2 "+(t?"text-white":"text-gray-800"),children:"Important Notes"}),U.jsxs("ul",{className:"text-sm space-y-1 "+(t?"text-gray-300":"text-gray-600"),children:[U.jsx("li",{children:" The extension only works on Chrome/Chromium browsers"}),U.jsx("li",{children:" You need to enable Developer mode in Chrome Extensions"}),U.jsx("li",{children:" The extension will only block websites during active focus sessions"}),U.jsx("li",{children:" All data is stored locally on your device"}),U.jsxs("li",{children:[" ",U.jsx("strong",{children:"Coming Soon:"})," Chrome Web Store version for easy installation!"]})]})]})]})})})]})]})]})]})]})},vi=({children:e})=>{const{user:t,loading:s}=Br(),r=Ie();return s?U.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),U.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):t?e:U.jsx(We,{to:"/login",state:{from:r.pathname},replace:!0})},ji=({children:e})=>{const{user:t}=Br();if(!t)return U.jsx(We,{to:"/login",replace:!0});return"studiply.email@gmail.com"===(null==t?void 0:t.email)?e:U.jsx(We,{to:"/",replace:!0})},Ni=()=>{var t;const{friendId:s}=Re(),r=qe(),a=Ie(),{user:n}=Br(),{isDark:i}=mt(),[h,p]=e.useState(null),[b,f]=e.useState([]),[w,y]=e.useState(""),v={tutoring:{path:"/tutoring",label:"Back to tutoring"},friends:{path:"/friends",label:"Back to friends"},"student-dashboard":{path:"/student-dashboard",label:"Back to dashboard"},"tutor-dashboard":{path:"/tutor-dashboard",label:"Back to dashboard"}}[null==(t=a.state)?void 0:t.from]||{path:"/friends",label:"Back to friends"},[j,N]=e.useState(!0),[k,S]=e.useState(!1),C=e.useRef(null),E=e.useRef(null);e.useEffect(()=>(s&&(null==n?void 0:n.id)&&T(),()=>{E.current&&E.current()}),[s,n]),e.useEffect(()=>{if(!C.current||!s||!(null==n?void 0:n.id))return;const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&A()})},{root:C.current.closest(".overflow-y-auto")||null,rootMargin:"0px",threshold:.1});return e.observe(C.current),setTimeout(()=>{if(C.current){const e=C.current.getBoundingClientRect(),t=C.current.closest(".overflow-y-auto");if(t){const s=t.getBoundingClientRect();e.bottom<=s.bottom+200&&A()}}},1e3),()=>{e.disconnect()}},[b,s,n]);const A=async()=>{if(s&&(null==n?void 0:n.id))try{const e=o(dt,"messages"),t=l(e,c("receiverId","==",n.id),c("senderId","==",s),c("read","==",!1),c("chatType","==","friend")),r=await d(t),a=[];r.forEach(e=>{const t=u(dt,"messages",e.id);a.push(x(t,{read:!0}))}),await Promise.all(a),console.log(` Marked ${r.size} friend messages as read`)}catch(e){console.error("Error marking friend messages as read:",e)}};e.useEffect(()=>{if(!s)return;const e=u(dt,"users",s),t=g(e,e=>{if(e.exists()){const t=e.data();p(e=>({...e,lastSeen:t.lastSeen||null,isOnline:t.isOnline||!1}))}});return()=>{t()}},[s]);e.useEffect(()=>{var e;null==(e=C.current)||e.scrollIntoView({behavior:"smooth"})},[b]);const T=async()=>{try{N(!0);const t=await Nn(s);if(t.success)p(t.friend);else try{const e=await m(u(dt,"users",s));if(e.exists()){const t=e.data();p({id:s,name:t.name||"User",email:t.email||"",avatar:t.avatar||null,lastSeen:t.lastSeen||null,isOnline:t.isOnline||!1})}else p({id:s,name:"Unknown User",email:"unknown@example.com"})}catch(e){console.error("Error getting user from users collection:",e),p({id:s,name:"Unknown User",email:"unknown@example.com"})}E.current=Sn(null==n?void 0:n.id,s,e=>{e.success&&f(e.messages)},"friend")}catch(e){console.error("Error loading chat data:",e)}finally{N(!1)}},I=async()=>{if(w.trim()&&!k)try{S(!0);const e=await kn(null==n?void 0:n.id,s,w.trim(),"friend");e.success?y(""):console.error("Failed to send message:",e.error)}catch(e){console.error("Error sending message:",e)}finally{S(!1)}};return j?U.jsx("div",{className:"min-h-screen flex items-center justify-center "+(i?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-3xl bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-2xl shadow-purple-500/30",children:U.jsx(Ms,{className:"h-9 w-9 animate-pulse"})}),U.jsx("h3",{className:"text-lg font-semibold",children:"Loading chat"}),U.jsx("p",{className:"mt-2 text-sm "+(i?"text-white/60":"text-slate-500"),children:"Preparing your conversation..."})]})}):U.jsxs("div",{className:"min-h-screen relative overflow-x-hidden "+(i?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:[U.jsx("style",{children:"\n        .hide-scrollbar::-webkit-scrollbar { width: 0; height: 0; }\n        .hide-scrollbar { scrollbar-width: none; }\n      "}),U.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[U.jsx("div",{className:"absolute -top-32 left-1/2 h-96 w-96 -translate-x-1/2 rounded-full bg-purple-500/25 blur-3xl"}),U.jsx("div",{className:"absolute top-0 right-4 h-72 w-72 rounded-full bg-pink-400/20 blur-[120px]"}),U.jsx("div",{className:"absolute bottom-8 left-10 h-64 w-64 rounded-full bg-indigo-400/20 blur-[140px]"})]}),U.jsx("div",{className:"relative z-10 mx-auto flex w-full max-w-[1320px] flex-col px-8 pb-16 pt-24",children:U.jsxs("div",{className:"w-full overflow-hidden rounded-[32px] border shadow-2xl backdrop-blur-xl flex flex-col "+(i?"border-white/12 bg-gradient-to-br from-white/10 via-white/4 to-transparent/35":"border-white/70 bg-white"),style:{height:"calc(100vh - 160px)"},children:[U.jsxs("div",{className:"flex items-center justify-between border-b px-6 py-6 "+(i?"border-white/10 bg-white/5":"border-slate-200 bg-slate-50"),children:[U.jsxs("div",{className:"flex items-center gap-5",children:[U.jsxs("button",{onClick:()=>r(v.path),className:"flex items-center gap-2 rounded-2xl px-4 py-2 text-sm font-semibold transition "+(i?"bg-white/10 text-white/80 hover:bg-white/15 hover:text-white":"bg-white text-slate-600 hover:text-slate-900 shadow-sm"),children:[U.jsx(wt,{className:"h-4 w-4"}),v.label]}),U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx("div",{className:"relative",children:U.jsx(Za,{user:h,size:"lg",showOnlineStatus:!0,className:"shadow-lg ring-2 ring-purple-400/40"})}),U.jsxs("div",{children:[U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx("h2",{className:"text-xl font-semibold "+(i?"text-white":"text-slate-900"),children:(null==h?void 0:h.name)||"Friend"}),U.jsx("span",{className:"px-2 py-0.5 rounded-lg text-xs font-semibold "+(i?"bg-blue-500/20 text-blue-300 border border-blue-500/30":"bg-blue-100 text-blue-700 border border-blue-200"),children:"Friend Chat"})]}),U.jsx("p",{className:"text-sm font-medium "+(Ur(h)?i?"text-green-300":"text-green-600":i?"text-gray-400":"text-gray-500"),children:Ur(h)?"Online now":"Offline now"})]})]})]}),U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx("button",{className:"rounded-2xl p-3 transition "+(i?"bg-white/5 text-white/70 hover:bg-white/10 hover:text-white":"bg-white text-slate-500 hover:text-slate-800 shadow-sm"),children:U.jsx(Gs,{className:"h-5 w-5"})}),U.jsx("button",{className:"rounded-2xl p-3 transition "+(i?"bg-white/5 text-white/70 hover:bg-white/10 hover:text-white":"bg-white text-slate-500 hover:text-slate-800 shadow-sm"),children:U.jsx(Cr,{className:"h-5 w-5"})}),U.jsx("button",{className:"rounded-2xl p-3 transition "+(i?"bg-white/5 text-white/70 hover:bg-white/10 hover:text-white":"bg-white text-slate-500 hover:text-slate-800 shadow-sm"),children:U.jsx($s,{className:"h-5 w-5"})})]})]}),U.jsx("div",{className:`flex-1 px-6 py-6 ${i?"bg-white/5 text-white":"bg-white text-slate-900"} flex flex-col`,style:{minHeight:"0"},children:U.jsx("div",{className:"flex-1 overflow-y-auto pr-2 hide-scrollbar",children:U.jsxs("div",{className:"space-y-4",children:[b.length>0?b.map((e,t)=>{const s=e.senderId===(null==n?void 0:n.id),r=!s&&(0===t||b[t-1].senderId!==e.senderId);return U.jsxs("div",{className:"flex items-start gap-3 "+(s?"justify-end":"justify-start"),children:[!s&&U.jsxs("div",{className:"flex flex-col items-center gap-1 text-xs text-white/60",children:[U.jsx(Za,{user:h,size:"sm",className:"h-9 w-9"}),r&&U.jsx("span",{className:""+(i?"text-white/70":"text-slate-500"),children:(null==h?void 0:h.name)||"Friend"})]}),U.jsxs("div",{className:"flex max-w-xs flex-col gap-1 sm:max-w-md",children:[U.jsx("div",{className:`rounded-2xl px-5 py-3 text-sm leading-relaxed ${s?"bg-gradient-to-r from-blue-500 to-cyan-500 text-white shadow-lg shadow-blue-500/30":i?"bg-blue-500/20 text-white border border-blue-500/30":"bg-blue-50 text-slate-800 border border-blue-200"} ${s?"rounded-br-md":"rounded-bl-md"}`,children:e.message}),U.jsx("p",{className:"px-2 text-[11px] "+(s?"text-right text-white/60":i?"text-white/50":"text-slate-500"),children:Cn(e.timestamp)})]}),s&&U.jsx(Za,{user:n,size:"sm",className:"h-9 w-9"})]},e.id)}):U.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[U.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-2xl bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg",children:U.jsx(Nr,{className:"h-8 w-8"})}),U.jsx("h3",{className:"mt-4 text-lg font-semibold",children:"No messages yet"}),U.jsxs("p",{className:"mt-2 text-sm "+(i?"text-white/60":"text-slate-500"),children:["Start the conversation with ",(null==h?void 0:h.name)||"your friend","."]})]}),U.jsx("div",{ref:C})]})})}),U.jsx("div",{className:"border-t px-6 py-5 "+(i?"border-white/10 bg-white/5":"border-slate-200 bg-white"),children:U.jsx("form",{onSubmit:async e=>{e.preventDefault(),await I()},className:"flex items-stretch",children:U.jsx("div",{className:"flex-1",children:U.jsx("textarea",{value:w,onChange:e=>y(e.target.value),onKeyDown:async e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),await I())},placeholder:`Message ${(null==h?void 0:h.name)||"your friend"}...`,className:"w-full resize-none rounded-2xl border px-5 py-4 text-sm transition focus:ring-2 focus:ring-blue-500 focus:outline-none hide-scrollbar "+(i?"border-white/15 bg-white/5 text-white placeholder-white/40":"border-slate-200 bg-white text-slate-900 placeholder-slate-400"),rows:1,disabled:k,style:{minHeight:"52px"}})})})})]})})]})},ki=()=>{var t;const{tutorId:s}=Re(),r=qe(),a=Ie(),{user:n}=Br(),{isDark:i}=mt(),[h,p]=e.useState(null),[b,f]=e.useState([]),[w,y]=e.useState(""),v={tutoring:{path:"/tutoring",label:"Back to tutoring"},friends:{path:"/friends",label:"Back to friends"},"student-dashboard":{path:"/student-dashboard",label:"Back to dashboard"},"tutor-dashboard":{path:"/tutor-dashboard",label:"Back to dashboard"}}[null==(t=a.state)?void 0:t.from]||{path:"/student-dashboard",label:"Back to dashboard"},[j,N]=e.useState(!0),[k,S]=e.useState(!1),C=e.useRef(null),E=e.useRef(null);e.useEffect(()=>(s&&(null==n?void 0:n.id)&&T(),()=>{E.current&&E.current()}),[s,n]),e.useEffect(()=>{if(!C.current||!s||!(null==n?void 0:n.id))return;const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&A()})},{root:C.current.closest(".overflow-y-auto")||null,rootMargin:"0px",threshold:.1});return e.observe(C.current),setTimeout(()=>{if(C.current){const e=C.current.getBoundingClientRect(),t=C.current.closest(".overflow-y-auto");if(t){const s=t.getBoundingClientRect();e.bottom<=s.bottom+200&&A()}}},1e3),()=>{e.disconnect()}},[b,s,n]);const A=async()=>{if(s&&(null==n?void 0:n.id))try{const e=o(dt,"messages"),t=l(e,c("receiverId","==",n.id),c("senderId","==",s),c("read","==",!1),c("chatType","==","tutor")),r=await d(t),a=[];r.forEach(e=>{const t=u(dt,"messages",e.id);a.push(x(t,{read:!0}))}),await Promise.all(a),console.log(` Marked ${r.size} tutor messages as read`)}catch(e){console.error("Error marking tutor messages as read:",e)}};e.useEffect(()=>{if(!s)return;const e=u(dt,"users",s),t=g(e,e=>{if(e.exists()){const t=e.data();p(e=>({...e,lastSeen:t.lastSeen||null,isOnline:t.isOnline||!1}))}});return()=>{t()}},[s]);e.useEffect(()=>{var e;null==(e=C.current)||e.scrollIntoView({behavior:"smooth"})},[b]);const T=async()=>{try{N(!0);try{const e=await m(u(dt,"users",s));if(e.exists()){const t=e.data();p({id:s,name:t.name||"Tutor",email:t.email||"",avatar:t.avatar||null,lastSeen:t.lastSeen||null,isOnline:t.isOnline||!1})}else p({id:s,name:"Unknown Tutor",email:"unknown@example.com"})}catch(e){console.error("Error getting tutor from users collection:",e),p({id:s,name:"Unknown Tutor",email:"unknown@example.com"})}E.current=Sn(null==n?void 0:n.id,s,e=>{e.success&&f(e.messages)},"tutor")}catch(e){console.error("Error loading chat data:",e)}finally{N(!1)}},I=async()=>{if(w.trim()&&!k)try{S(!0);const e=await kn(null==n?void 0:n.id,s,w.trim(),"tutor");e.success?y(""):console.error("Failed to send message:",e.error)}catch(e){console.error("Error sending message:",e)}finally{S(!1)}};return j?U.jsx("div",{className:"min-h-screen flex items-center justify-center "+(i?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-3xl bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-2xl shadow-purple-500/30",children:U.jsx(Ms,{className:"h-9 w-9 animate-pulse"})}),U.jsx("h3",{className:"text-lg font-semibold",children:"Loading chat"}),U.jsx("p",{className:"mt-2 text-sm "+(i?"text-white/60":"text-slate-500"),children:"Preparing your conversation..."})]})}):U.jsxs("div",{className:"min-h-screen relative overflow-x-hidden "+(i?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:[U.jsx("style",{children:"\n        .hide-scrollbar::-webkit-scrollbar { width: 0; height: 0; }\n        .hide-scrollbar { scrollbar-width: none; }\n      "}),U.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[U.jsx("div",{className:"absolute -top-32 left-1/2 h-96 w-96 -translate-x-1/2 rounded-full bg-purple-500/25 blur-3xl"}),U.jsx("div",{className:"absolute top-0 right-4 h-72 w-72 rounded-full bg-pink-400/20 blur-[120px]"}),U.jsx("div",{className:"absolute bottom-8 left-10 h-64 w-64 rounded-full bg-indigo-400/20 blur-[140px]"})]}),U.jsx("div",{className:"relative z-10 mx-auto flex w-full max-w-[1320px] flex-col px-8 pb-16 pt-24",children:U.jsxs("div",{className:"w-full overflow-hidden rounded-[32px] border shadow-2xl backdrop-blur-xl flex flex-col "+(i?"border-white/12 bg-gradient-to-br from-white/10 via-white/4 to-transparent/35":"border-white/70 bg-white"),style:{height:"calc(100vh - 160px)"},children:[U.jsxs("div",{className:"flex items-center justify-between border-b px-6 py-6 "+(i?"border-white/10 bg-white/5":"border-slate-200 bg-slate-50"),children:[U.jsxs("div",{className:"flex items-center gap-5",children:[U.jsxs("button",{onClick:()=>r(v.path),className:"flex items-center gap-2 rounded-2xl px-4 py-2 text-sm font-semibold transition "+(i?"bg-white/10 text-white/80 hover:bg-white/15 hover:text-white":"bg-white text-slate-600 hover:text-slate-900 shadow-sm"),children:[U.jsx(wt,{className:"h-4 w-4"}),v.label]}),U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx("div",{className:"relative",children:U.jsx(Za,{user:h,size:"lg",showOnlineStatus:!0,className:"shadow-lg ring-2 ring-purple-400/40"})}),U.jsxs("div",{children:[U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx("h2",{className:"text-xl font-semibold "+(i?"text-white":"text-slate-900"),children:(null==h?void 0:h.name)||"Tutor"}),U.jsx("span",{className:"px-2 py-0.5 rounded-lg text-xs font-semibold "+(i?"bg-purple-500/20 text-purple-300 border border-purple-500/30":"bg-purple-100 text-purple-700 border border-purple-200"),children:"Tutor Chat"})]}),U.jsx("p",{className:"text-sm font-medium "+(Ur(h)?i?"text-green-300":"text-green-600":i?"text-gray-400":"text-gray-500"),children:Ur(h)?"Online now":"Offline now"})]})]})]}),U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx("button",{className:"rounded-2xl p-3 transition "+(i?"bg-white/5 text-white/70 hover:bg-white/10 hover:text-white":"bg-white text-slate-500 hover:text-slate-800 shadow-sm"),children:U.jsx(Gs,{className:"h-5 w-5"})}),U.jsx("button",{className:"rounded-2xl p-3 transition "+(i?"bg-white/5 text-white/70 hover:bg-white/10 hover:text-white":"bg-white text-slate-500 hover:text-slate-800 shadow-sm"),children:U.jsx(Cr,{className:"h-5 w-5"})}),U.jsx("button",{className:"rounded-2xl p-3 transition "+(i?"bg-white/5 text-white/70 hover:bg-white/10 hover:text-white":"bg-white text-slate-500 hover:text-slate-800 shadow-sm"),children:U.jsx($s,{className:"h-5 w-5"})})]})]}),U.jsx("div",{className:`flex-1 px-6 py-6 ${i?"bg-white/5 text-white":"bg-white text-slate-900"} flex flex-col`,style:{minHeight:"0"},children:U.jsx("div",{className:"flex-1 overflow-y-auto pr-2 hide-scrollbar",children:U.jsxs("div",{className:"space-y-4",children:[b.length>0?b.map((e,t)=>{const s=e.senderId===(null==n?void 0:n.id),r=!s&&(0===t||b[t-1].senderId!==e.senderId);return U.jsxs("div",{className:"flex items-start gap-3 "+(s?"justify-end":"justify-start"),children:[!s&&U.jsxs("div",{className:"flex flex-col items-center gap-1 text-xs text-white/60",children:[U.jsx(Za,{user:h,size:"sm",className:"h-9 w-9"}),r&&U.jsx("span",{className:""+(i?"text-white/70":"text-slate-500"),children:(null==h?void 0:h.name)||"Tutor"})]}),U.jsxs("div",{className:"flex max-w-xs flex-col gap-1 sm:max-w-md",children:[U.jsx("div",{className:`rounded-2xl px-5 py-3 text-sm leading-relaxed ${s?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg shadow-purple-500/30":i?"bg-purple-500/20 text-white border border-purple-500/30":"bg-purple-50 text-slate-800 border border-purple-200"} ${s?"rounded-br-md":"rounded-bl-md"}`,children:e.message}),U.jsx("p",{className:"px-2 text-[11px] "+(s?"text-right text-white/60":i?"text-white/50":"text-slate-500"),children:Cn(e.timestamp)})]}),s&&U.jsx(Za,{user:n,size:"sm",className:"h-9 w-9"})]},e.id)}):U.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[U.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-2xl bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg",children:U.jsx(Nr,{className:"h-8 w-8"})}),U.jsx("h3",{className:"mt-4 text-lg font-semibold",children:"No messages yet"}),U.jsxs("p",{className:"mt-2 text-sm "+(i?"text-white/60":"text-slate-500"),children:["Start the conversation with ",(null==h?void 0:h.name)||"your tutor","."]})]}),U.jsx("div",{ref:C})]})})}),U.jsx("div",{className:"border-t px-6 py-5 "+(i?"border-white/10 bg-white/5":"border-slate-200 bg-white"),children:U.jsx("form",{onSubmit:async e=>{e.preventDefault(),await I()},className:"flex items-stretch",children:U.jsx("div",{className:"flex-1",children:U.jsx("textarea",{value:w,onChange:e=>y(e.target.value),onKeyDown:async e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),await I())},placeholder:`Message ${(null==h?void 0:h.name)||"your tutor"}...`,className:"w-full resize-none rounded-2xl border px-5 py-4 text-sm transition focus:ring-2 focus:ring-purple-500 focus:outline-none hide-scrollbar "+(i?"border-white/15 bg-white/5 text-white placeholder-white/40":"border-slate-200 bg-white text-slate-900 placeholder-slate-400"),rows:1,disabled:k,style:{minHeight:"52px"}})})})})]})})]})},Si=async(e="streak",t=100)=>{var s;try{console.log(` [Leaderboard] Starting fetch for type: ${e}`),console.log(" [Leaderboard] Fetching users collection...");const a=o(dt,"users");let n;try{n=await d(a),console.log(` [Leaderboard] Found ${n.docs.length} users`)}catch(r){throw console.error(" [Leaderboard] Error fetching users:",r),console.error("Error details:",{code:r.code,message:r.message,stack:r.stack}),r}if(0===n.docs.length)return console.warn(" [Leaderboard] No users found in database"),[];const i=[];let l=0,c=0;for(const t of n.docs)try{const a=t.data(),n=t.id;if(!0===a.banned){c++;continue}const o=a.name||(null==(s=a.email)?void 0:s.split("@")[0])||"Anonymous",d=a.avatar||null;let h={};try{const e=u(dt,"studyprogress",n),t=await m(e);t.exists()?h=t.data():console.log(` [Leaderboard] No progress data for user ${n} (${o})`)}catch(r){console.warn(` [Leaderboard] Failed to fetch progress for user ${n}:`,r.message)}let x=0;switch(e){case"streak":x=h.currentStreak||0;break;case"level":x=h.currentLevel||1;break;case"quests":x=(h.completedQuests||[]).length;break;default:x=0}i.push({userId:n,userName:o,userAvatar:d,value:x,totalXP:h.totalXP||0,gold:h.gold||0}),l++}catch(r){console.error(` [Leaderboard] Error processing user ${t.id}:`,r)}console.log(` [Leaderboard] Processed ${l} users, skipped ${c} banned users`),console.log(` [Leaderboard] Total entries: ${i.length}`),i.sort((e,t)=>t.value-e.value);const h=i.slice(0,t);return console.log(` [Leaderboard] Returning top ${h.length} users`),console.log(" [Leaderboard] Sample data (first 3):",h.slice(0,3).map(e=>({name:e.userName,value:e.value}))),h}catch(r){return console.error(" [Leaderboard] Fatal error fetching leaderboard:",r),console.error("Error details:",{code:r.code,message:r.message,stack:r.stack}),[]}},Ci=()=>{var t;const{user:s}=Br(),{isDark:r}=mt(),[a,n]=e.useState(null),[i,o]=e.useState(!0),[l,c]=e.useState("overview"),[d,h]=e.useState("streak"),[m,x]=e.useState([]),[p,b]=e.useState(!1),[f,w]=e.useState(null);e.useEffect(()=>{if(!(null==s?void 0:s.id))return void o(!1);const e=u(dt,"studyprogress",s.id),t=g(e,async e=>{if(e.exists()){const t=e.data(),s=sa.calculateLevelProgress(t.totalXP||0);n({...t,levelProgress:s})}else{const e={totalXP:0,currentLevel:1,gold:0,completedQuests:[],achievements:[],levelProgress:sa.calculateLevelProgress(0)};n(e)}o(!1)},e=>{console.error("Error listening to user progress:",e),o(!1)});return()=>t()},[null==s?void 0:s.id]),e.useEffect(()=>{(async()=>{if("leaderboard"!==l)return x([]),void w(null);console.log(" [Rewards] Fetching leaderboard...",{type:d,userId:null==s?void 0:s.id}),b(!0),x([]),w(null);try{console.log(" [Rewards] Calling getLeaderboard...");const e=await Si(d,100);if(console.log(" [Rewards] Received leaderboard data:",e.length,"entries"),e&&e.length>0?(console.log(" [Rewards] First entry:",e[0]),x(e)):(console.warn(" [Rewards] No leaderboard data returned"),x([])),null==s?void 0:s.id){console.log(" [Rewards] Getting user rank for:",s.id);const e=await(async(e,t="streak")=>{try{const s=await Si(t,1e3),r=s.findIndex(t=>t.userId===e);return-1===r?{rank:null,value:0}:{rank:r+1,value:s[r].value}}catch(s){return console.error("Error getting user rank:",s),{rank:null,value:0}}})(s.id,d);console.log(" [Rewards] User rank:",e),w(e)}}catch(e){console.error(" [Rewards] Error fetching leaderboard:",e),console.error("Error details:",{code:e.code,message:e.message,stack:e.stack}),x([]),w(null)}finally{b(!1),console.log(" [Rewards] Leaderboard fetch completed")}})()},[l,d,null==s?void 0:s.id]);const y=[{id:"first_quest",name:"First Steps",description:"Complete your first quest",icon:or,color:"from-yellow-400 to-orange-500",rarity:"common"},{id:"level_5",name:"Rising Star",description:"Reach level 5",icon:Ks,color:"from-blue-400 to-cyan-500",rarity:"common"},{id:"level_10",name:"Experienced Learner",description:"Reach level 10",icon:fr,color:"from-purple-400 to-pink-500",rarity:"rare"},{id:"level_20",name:"Knowledge Seeker",description:"Reach level 20",icon:Xt,color:"from-indigo-400 to-purple-500",rarity:"rare"},{id:"level_30",name:"Master Scholar",description:"Reach level 30",icon:us,color:"from-emerald-400 to-teal-500",rarity:"epic"},{id:"level_50",name:"Legendary Academic",description:"Reach level 50",icon:es,color:"from-amber-400 to-yellow-500",rarity:"legendary"},{id:"gold_1000",name:"Wealthy Scholar",description:"Accumulate 1000 gold",icon:Yt,color:"from-yellow-400 to-amber-500",rarity:"rare"},{id:"quest_master",name:"Quest Master",description:"Complete 50 quests",icon:ur,color:"from-red-400 to-rose-500",rarity:"epic"},{id:"streak_7",name:"Week Warrior",description:"Maintain a 7-day streak",icon:cs,color:"from-orange-400 to-red-500",rarity:"rare"},{id:"streak_30",name:"Monthly Champion",description:"Maintain a 30-day streak",icon:nr,color:"from-pink-400 to-purple-500",rarity:"epic"}],v=(null==a?void 0:a.achievements)||[],j=y.filter(e=>v.includes(e.id)),N=y.filter(e=>!v.includes(e.id)),k={totalQuests:(null==(t=null==a?void 0:a.completedQuests)?void 0:t.length)||0,totalXP:(null==a?void 0:a.totalXP)||0,currentLevel:(null==a?void 0:a.currentLevel)||1,gold:(null==a?void 0:a.gold)||0,achievements:j.length,totalAchievements:y.length},S=(null==a?void 0:a.levelProgress)||{currentLevel:1,nextLevel:2,progressXP:0,requiredXP:100,progressPercentage:0},C=[{id:"theme_dark",name:"Dark Theme",description:"Unlock dark mode theme",price:100,icon:ar,available:!0},{id:"badge_premium",name:"Premium Badge",description:"Show off your premium status",price:500,icon:Xt,available:!0},{id:"avatar_frame",name:"Golden Frame",description:"Exclusive avatar frame",price:300,icon:Nt,available:!0},{id:"title_legend",name:"Legend Title",description:'Custom title: "Legend"',price:1e3,icon:or,available:!0}];return i?U.jsx("div",{className:"min-h-screen flex items-center justify-center "+(r?"bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900":"bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50"),children:U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"w-16 h-16 border-4 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),U.jsx("p",{className:"text-lg "+(r?"text-white":"text-gray-700"),children:"Loading your rewards..."})]})}):U.jsx("div",{className:"min-h-screen "+(r?"bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900":"bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50"),children:U.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[U.jsx("div",{className:"mb-8",children:U.jsxs("div",{className:"relative rounded-3xl border shadow-2xl backdrop-blur-xl overflow-hidden "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:[U.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-500/20 via-pink-500/20 to-indigo-500/20"}),U.jsx("div",{className:"relative p-8",children:U.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[U.jsxs("div",{className:"flex-1 text-center md:text-left",children:[U.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-purple-500/20 to-pink-500/20 px-4 py-2 text-xs font-semibold uppercase tracking-wide mb-4",children:[U.jsx(hs,{className:"h-4 w-4"})," Rewards Center"]}),U.jsxs("h1",{className:"text-4xl md:text-5xl font-black tracking-tight mb-3 "+(r?"bg-gradient-to-r from-purple-200 via-pink-200 to-indigo-200 bg-clip-text text-transparent":"bg-gradient-to-r from-purple-600 via-pink-600 to-indigo-600 bg-clip-text text-transparent"),children:["Welcome back, ",(null==s?void 0:s.name)||"Scholar","!"]}),U.jsx("p",{className:"text-lg "+(r?"text-white/70":"text-slate-600"),children:"Track your progress, unlock achievements, and claim your rewards"})]}),U.jsxs("div",{className:"relative rounded-2xl border p-6 text-center "+(r?"border-purple-500/30 bg-gradient-to-br from-purple-500/20 to-pink-500/20":"border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50"),children:[U.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-3 shadow-lg",children:U.jsx(Xt,{className:"w-10 h-10 text-white"})}),U.jsxs("div",{className:"text-3xl font-bold mb-1 "+(r?"text-white":"text-purple-600"),children:["Level ",k.currentLevel]}),U.jsxs("div",{className:"text-sm "+(r?"text-white/70":"text-slate-600"),children:[S.progressXP," / ",S.requiredXP," XP"]})]})]})})]})}),U.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[U.jsxs("div",{className:"rounded-2xl border p-6 backdrop-blur-xl "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:[U.jsxs("div",{className:"flex items-center justify-between mb-2",children:[U.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-blue-500 to-cyan-500",children:U.jsx(or,{className:"w-5 h-5 text-white"})}),U.jsx("span",{className:"text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:k.totalXP.toLocaleString()})]}),U.jsx("p",{className:"text-sm "+(r?"text-white/70":"text-slate-600"),children:"Total XP"})]}),U.jsxs("div",{className:"rounded-2xl border p-6 backdrop-blur-xl "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:[U.jsxs("div",{className:"flex items-center justify-between mb-2",children:[U.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-yellow-500 to-amber-500",children:U.jsx(Yt,{className:"w-5 h-5 text-white"})}),U.jsx("span",{className:"text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:k.gold.toLocaleString()})]}),U.jsx("p",{className:"text-sm "+(r?"text-white/70":"text-slate-600"),children:"Gold"})]}),U.jsxs("div",{className:"rounded-2xl border p-6 backdrop-blur-xl "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:[U.jsxs("div",{className:"flex items-center justify-between mb-2",children:[U.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500",children:U.jsx(fr,{className:"w-5 h-5 text-white"})}),U.jsx("span",{className:"text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:k.totalQuests})]}),U.jsx("p",{className:"text-sm "+(r?"text-white/70":"text-slate-600"),children:"Quests"})]}),U.jsxs("div",{className:"rounded-2xl border p-6 backdrop-blur-xl "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:[U.jsxs("div",{className:"flex items-center justify-between mb-2",children:[U.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-emerald-500 to-teal-500",children:U.jsx(Nt,{className:"w-5 h-5 text-white"})}),U.jsxs("span",{className:"text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:[k.achievements,"/",k.totalAchievements]})]}),U.jsx("p",{className:"text-sm "+(r?"text-white/70":"text-slate-600"),children:"Achievements"})]})]}),U.jsx("div",{className:"flex gap-2 mb-6 overflow-x-auto",children:[{id:"overview",label:"Overview",icon:St},{id:"achievements",label:"Achievements",icon:fr},{id:"progress",label:"Progress",icon:br},{id:"leaderboard",label:"Leaderboard",icon:kr},{id:"shop",label:"Reward Shop",icon:hs}].map(e=>{const t=e.icon;return U.jsxs("button",{onClick:()=>c(e.id),className:"flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all whitespace-nowrap "+(l===e.id?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg":r?"bg-white/5 text-white/70 hover:bg-white/10":"bg-white text-slate-700 hover:bg-slate-50"),children:[U.jsx(t,{className:"w-5 h-5"}),e.label]},e.id)})}),U.jsxs("div",{className:"space-y-6",children:["overview"===l&&U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"rounded-3xl border shadow-2xl backdrop-blur-xl overflow-hidden "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:U.jsxs("div",{className:"p-8",children:[U.jsxs("div",{className:"flex items-center justify-between mb-6",children:[U.jsx("h2",{className:"text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:"Level Progress"}),U.jsxs("span",{className:"text-sm font-semibold px-3 py-1 rounded-full "+(r?"bg-purple-500/20 text-purple-300":"bg-purple-100 text-purple-700"),children:["Level ",S.currentLevel,"  ",S.nextLevel]})]}),U.jsxs("div",{className:"relative",children:[U.jsx("div",{className:"h-6 rounded-full overflow-hidden "+(r?"bg-white/10":"bg-slate-200"),children:U.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 via-pink-500 to-indigo-500 rounded-full transition-all duration-500 flex items-center justify-end pr-2",style:{width:`${Math.min(S.progressPercentage,100)}%`},children:S.progressPercentage>10&&U.jsxs("span",{className:"text-xs font-bold text-white",children:[S.progressPercentage,"%"]})})}),U.jsxs("div",{className:"flex justify-between mt-2 text-sm",children:[U.jsxs("span",{className:r?"text-white/70":"text-slate-600",children:[S.progressXP," XP"]}),U.jsxs("span",{className:r?"text-white/70":"text-slate-600",children:[S.requiredXP," XP needed"]})]})]})]})}),j.length>0&&U.jsx("div",{className:"rounded-3xl border shadow-2xl backdrop-blur-xl overflow-hidden "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:U.jsxs("div",{className:"p-8",children:[U.jsx("h2",{className:"text-2xl font-bold mb-6 "+(r?"text-white":"text-slate-900"),children:"Recent Achievements"}),U.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:j.slice(-4).reverse().map(e=>{const t=e.icon;return U.jsxs("div",{className:"relative rounded-2xl border p-4 backdrop-blur-xl transition-all hover:scale-105 "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:[U.jsx("div",{className:`w-12 h-12 bg-gradient-to-br ${e.color} rounded-xl flex items-center justify-center mb-3 mx-auto`,children:U.jsx(t,{className:"w-6 h-6 text-white"})}),U.jsx("h3",{className:"text-sm font-bold text-center mb-1 "+(r?"text-white":"text-slate-900"),children:e.name}),U.jsx("p",{className:"text-xs text-center "+(r?"text-white/60":"text-slate-500"),children:e.description})]},e.id)})})]})})]}),"achievements"===l&&U.jsx("div",{className:"rounded-3xl border shadow-2xl backdrop-blur-xl overflow-hidden "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:U.jsxs("div",{className:"p-8",children:[U.jsxs("div",{className:"flex items-center justify-between mb-6",children:[U.jsx("h2",{className:"text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:"All Achievements"}),U.jsxs("span",{className:"text-sm font-semibold px-3 py-1 rounded-full "+(r?"bg-purple-500/20 text-purple-300":"bg-purple-100 text-purple-700"),children:[j.length," / ",y.length," Unlocked"]})]}),U.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[j.map(e=>{const t=e.icon;return U.jsx("div",{className:"relative rounded-2xl border p-6 backdrop-blur-xl transition-all hover:scale-105 "+(r?"border-purple-500/30 bg-gradient-to-br from-purple-500/10 to-pink-500/10":"border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50"),children:U.jsxs("div",{className:"flex items-start gap-4",children:[U.jsx("div",{className:`w-16 h-16 bg-gradient-to-br ${e.color} rounded-xl flex items-center justify-center flex-shrink-0 shadow-lg`,children:U.jsx(t,{className:"w-8 h-8 text-white"})}),U.jsxs("div",{className:"flex-1",children:[U.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[U.jsx("h3",{className:"font-bold "+(r?"text-white":"text-slate-900"),children:e.name}),U.jsx(Ut,{className:"w-5 h-5 text-green-500"})]}),U.jsx("p",{className:"text-sm "+(r?"text-white/70":"text-slate-600"),children:e.description}),U.jsx("span",{className:"inline-block mt-2 text-xs font-semibold px-2 py-1 rounded-full "+("legendary"===e.rarity?"bg-amber-500/20 text-amber-300":"epic"===e.rarity?"bg-purple-500/20 text-purple-300":"rare"===e.rarity?"bg-blue-500/20 text-blue-300":"bg-slate-500/20 text-slate-300"),children:e.rarity.toUpperCase()})]})]})},e.id)}),N.map(e=>(e.icon,U.jsx("div",{className:"relative rounded-2xl border p-6 backdrop-blur-xl opacity-60 "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:U.jsxs("div",{className:"flex items-start gap-4",children:[U.jsx("div",{className:"w-16 h-16 bg-slate-400 rounded-xl flex items-center justify-center flex-shrink-0",children:U.jsx(Ts,{className:"w-8 h-8 text-white"})}),U.jsxs("div",{className:"flex-1",children:[U.jsx("h3",{className:"font-bold mb-1 "+(r?"text-white/50":"text-slate-400"),children:e.name}),U.jsx("p",{className:"text-sm "+(r?"text-white/40":"text-slate-400"),children:e.description})]})]})},e.id)))]})]})}),"progress"===l&&U.jsx("div",{className:"space-y-6",children:U.jsx("div",{className:"rounded-3xl border shadow-2xl backdrop-blur-xl overflow-hidden "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:U.jsxs("div",{className:"p-8",children:[U.jsx("h2",{className:"text-2xl font-bold mb-6 "+(r?"text-white":"text-slate-900"),children:"Learning Statistics"}),U.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[U.jsx("div",{className:"rounded-2xl border p-6 "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:U.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[U.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-blue-500 to-cyan-500",children:U.jsx(Pt,{className:"w-6 h-6 text-white"})}),U.jsxs("div",{children:[U.jsx("p",{className:"text-sm "+(r?"text-white/70":"text-slate-600"),children:"Quests Completed"}),U.jsx("p",{className:"text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:k.totalQuests})]})]})}),U.jsx("div",{className:"rounded-2xl border p-6 "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:U.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[U.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500",children:U.jsx(br,{className:"w-6 h-6 text-white"})}),U.jsxs("div",{children:[U.jsx("p",{className:"text-sm "+(r?"text-white/70":"text-slate-600"),children:"Total Experience"}),U.jsx("p",{className:"text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:k.totalXP.toLocaleString()})]})]})}),U.jsx("div",{className:"rounded-2xl border p-6 "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:U.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[U.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-yellow-500 to-amber-500",children:U.jsx(Yt,{className:"w-6 h-6 text-white"})}),U.jsxs("div",{children:[U.jsx("p",{className:"text-sm "+(r?"text-white/70":"text-slate-600"),children:"Gold Earned"}),U.jsx("p",{className:"text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:k.gold.toLocaleString()})]})]})}),U.jsx("div",{className:"rounded-2xl border p-6 "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:U.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[U.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-emerald-500 to-teal-500",children:U.jsx(fr,{className:"w-6 h-6 text-white"})}),U.jsxs("div",{children:[U.jsx("p",{className:"text-sm "+(r?"text-white/70":"text-slate-600"),children:"Achievement Rate"}),U.jsxs("p",{className:"text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:[Math.round(k.achievements/k.totalAchievements*100),"%"]})]})]})})]})]})})}),"leaderboard"===l&&U.jsxs("div",{className:"space-y-6",children:[U.jsx("div",{className:"rounded-3xl border shadow-2xl backdrop-blur-xl overflow-hidden "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:U.jsxs("div",{className:"p-6",children:[U.jsx("h2",{className:"text-2xl font-bold mb-4 "+(r?"text-white":"text-slate-900"),children:"Leaderboard"}),U.jsx("div",{className:"flex gap-3 flex-wrap",children:[{id:"streak",label:"Day Streak",icon:cs},{id:"level",label:"Level",icon:ps},{id:"quests",label:"Quests",icon:ur}].map(e=>{const t=e.icon;return U.jsxs("button",{onClick:()=>h(e.id),className:"flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all "+(d===e.id?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg":r?"bg-white/5 text-white/70 hover:bg-white/10":"bg-white text-slate-700 hover:bg-slate-50"),children:[U.jsx(t,{className:"w-5 h-5"}),e.label]},e.id)})})]})}),f&&f.rank&&U.jsx("div",{className:"rounded-3xl border shadow-2xl backdrop-blur-xl overflow-hidden "+(r?"border-purple-500/30 bg-gradient-to-br from-purple-500/10 to-pink-500/10":"border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50"),children:U.jsx("div",{className:"p-6",children:U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsxs("div",{children:[U.jsx("p",{className:`text-sm ${r?"text-white/70":"text-slate-600"} mb-1`,children:"Your Rank"}),U.jsxs("p",{className:"text-3xl font-bold "+(r?"text-white":"text-slate-900"),children:["#",f.rank]})]}),U.jsxs("div",{className:"text-right",children:[U.jsx("p",{className:`text-sm ${r?"text-white/70":"text-slate-600"} mb-1`,children:"streak"===d?"Day Streak":"level"===d?"Level":"Quests Completed"}),U.jsx("p",{className:"text-3xl font-bold "+(r?"text-white":"text-slate-900"),children:f.value})]})]})})}),U.jsx("div",{className:"rounded-3xl border shadow-2xl backdrop-blur-xl overflow-hidden "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:U.jsx("div",{className:"p-6",children:p?U.jsx("div",{className:"flex items-center justify-center py-12",children:U.jsx("div",{className:"w-12 h-12 border-4 border-purple-500 border-t-transparent rounded-full animate-spin"})}):0===m.length?U.jsxs("div",{className:"text-center py-12",children:[U.jsx(fr,{className:"w-16 h-16 mx-auto mb-4 "+(r?"text-white/30":"text-slate-300")}),U.jsx("p",{className:"text-lg "+(r?"text-white/70":"text-slate-600"),children:"No data available yet"})]}):U.jsx("div",{className:"space-y-2",children:m.map((e,t)=>{const a=e.userId===(null==s?void 0:s.id),n=t+1;return U.jsx("div",{className:"rounded-xl border p-4 transition-all "+(a?r?"border-purple-500/50 bg-gradient-to-r from-purple-500/20 to-pink-500/20":"border-purple-300 bg-gradient-to-r from-purple-50 to-pink-50":r?"border-white/10 bg-white/5 hover:bg-white/10":"border-slate-200 bg-white hover:bg-slate-50"),children:U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx("div",{className:"flex-shrink-0 w-12 text-center",children:n<=3?U.jsx("div",{className:`w-10 h-10 rounded-full bg-gradient-to-br ${{1:"from-yellow-400 to-amber-500",2:"from-slate-300 to-slate-400",3:"from-orange-400 to-orange-600"}[n]} flex items-center justify-center mx-auto shadow-lg`,children:U.jsx(fr,{className:"w-6 h-6 text-white"})}):U.jsxs("span",{className:"text-lg font-bold "+(r?"text-white/70":"text-slate-600"),children:["#",n]})}),U.jsx("div",{className:"flex-shrink-0",children:e.userAvatar?U.jsx("img",{src:e.userAvatar,alt:e.userName,className:"w-12 h-12 rounded-full border-2 border-purple-500/30"}):U.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center border-2 border-purple-500/30",children:U.jsx(Nr,{className:"w-6 h-6 text-white"})})}),U.jsxs("div",{className:"flex-1 min-w-0",children:[U.jsx("div",{className:"flex items-center gap-2",children:U.jsxs("p",{className:"font-semibold truncate "+(r?"text-white":"text-slate-900"),children:[e.userName,a&&U.jsx("span",{className:"ml-2 text-xs text-purple-500",children:"(You)"})]})}),U.jsx("div",{className:"flex items-center gap-4 mt-1",children:U.jsx("span",{className:"text-xs "+(r?"text-white/60":"text-slate-500"),children:"streak"===d?`${e.value} day${1!==e.value?"s":""} streak`:"level"===d?`Level ${e.value}`:`${e.value} quest${1!==e.value?"s":""} completed`})})]}),U.jsx("div",{className:"flex-shrink-0 px-4 py-2 rounded-lg "+(1===n?"bg-gradient-to-r from-yellow-400 to-amber-500 text-white":2===n?"bg-gradient-to-r from-slate-300 to-slate-400 text-white":3===n?"bg-gradient-to-r from-orange-400 to-orange-600 text-white":r?"bg-purple-500/20 text-purple-300":"bg-purple-100 text-purple-700"),children:U.jsx("span",{className:"font-bold text-lg",children:e.value})})]})},e.userId)})})})})]}),"shop"===l&&U.jsx("div",{className:"rounded-3xl border shadow-2xl backdrop-blur-xl overflow-hidden "+(r?"border-white/12 bg-white/6":"border-white/80 bg-white"),children:U.jsxs("div",{className:"p-8",children:[U.jsxs("div",{className:"flex items-center justify-between mb-6",children:[U.jsx("h2",{className:"text-2xl font-bold "+(r?"text-white":"text-slate-900"),children:"Reward Shop"}),U.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 rounded-xl "+(r?"bg-yellow-500/20 border border-yellow-500/30":"bg-yellow-50 border border-yellow-200"),children:[U.jsx(Yt,{className:"w-5 h-5 text-yellow-500"}),U.jsxs("span",{className:"font-bold "+(r?"text-yellow-300":"text-yellow-700"),children:[k.gold," Gold"]})]})]}),U.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map(e=>{const t=e.icon||hs,s=k.gold>=e.price;return U.jsxs("div",{className:"relative rounded-2xl border p-6 backdrop-blur-xl transition-all hover:scale-105 "+(s?r?"border-purple-500/30 bg-gradient-to-br from-purple-500/10 to-pink-500/10":"border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50":r?"border-white/12 bg-white/6 opacity-60":"border-white/80 bg-white opacity-60"),children:[U.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center mb-4 mx-auto shadow-lg",children:U.jsx(t,{className:"w-8 h-8 text-white"})}),U.jsx("h3",{className:"text-lg font-bold text-center mb-2 "+(r?"text-white":"text-slate-900"),children:e.name}),U.jsx("p",{className:"text-sm text-center mb-4 "+(r?"text-white/70":"text-slate-600"),children:e.description}),U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx(Yt,{className:"w-5 h-5 text-yellow-500"}),U.jsx("span",{className:"font-bold "+(r?"text-white":"text-slate-900"),children:e.price})]}),U.jsx("button",{disabled:!s,className:"px-4 py-2 rounded-xl font-semibold transition-all "+(s?"bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600":"bg-slate-400 text-white cursor-not-allowed"),children:s?"Purchase":"Insufficient Gold"})]})]},e.id)})})]})})]})]})})},Ei=()=>{const{user:t,updateUser:s}=Br(),{isDark:r}=mt(),a=qe(),[n]=ot(),{showSuccess:i,showError:o}=Hr(),[l,c]=e.useState("pro"),[d,h]=e.useState(!1),m="studiply.email@gmail.com"===(null==t?void 0:t.email),[p,g]=e.useState(()=>{if(m){return"true"===localStorage.getItem("studiply-test-mode")}return!1});e.useEffect(()=>{m&&localStorage.setItem("studiply-test-mode",p.toString())},[p,m]);const b=[{id:"basic",name:"Studiply Pass",tagline:"Perfect for getting started",price:8.99,originalPrice:17.99,period:"month",icon:or,gradient:"from-amber-500 via-orange-500 to-red-500",bgGradient:"from-amber-500/10 via-orange-500/10 to-red-500/10",borderColor:"border-amber-400/50",features:["Unlimited video calls","Exclusive study badges","Priority customer support","Monthly free courses","Study progress tracking","Personalized study plans","Ad-free experience","Basic analytics"],popular:!1},{id:"pro",name:"Studiply Pass Pro",tagline:"For serious learners",price:17.99,originalPrice:35.99,period:"month",icon:Xt,gradient:"from-purple-500 via-pink-500 to-rose-500",bgGradient:"from-purple-500/10 via-pink-500/10 to-rose-500/10",borderColor:"border-purple-400/50",features:["Everything in Studiply Pass","Unlimited 1-on-1 tutoring","Exclusive tutor matching","Advanced learning analytics","Priority booking slots","Exclusive study community","Custom learning paths","24/7 dedicated support","Early access to new features","AI-powered study coach"],popular:!0}],f=[{icon:Mr,title:"Faster Learning",description:"Accelerate your progress with premium tools"},{icon:rr,title:"Priority Support",description:"Get help when you need it, 24/7"},{icon:Ks,title:"Early Access",description:"Try new features before everyone else"},{icon:fr,title:"Exclusive Content",description:"Access member-only courses and materials"}];e.useEffect(()=>{const e=n.get("success"),t=n.get("canceled"),s=n.get("session_id");sessionStorage.getItem("payment-processed")||(e&&s?(sessionStorage.setItem("payment-processed","true"),(async e=>{try{const t=await fetch(`${ti}/payment/stripe/verify-payment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:e})}),s=await t.json();return s.success?{success:!0,userId:s.userId,planId:s.planId}:{success:!1,error:s.error||"Payment verification failed"}}catch(t){return console.error("Error verifying payment:",t),{success:!1,error:"Network error. Please try again."}}})(s).then(e=>{e.success?(i("Payment successful! Your Studiply Pass has been activated.",5e3,"Payment Success"),setTimeout(()=>{window.location.reload()},2e3)):(o("Payment verification failed. Please contact support.",5e3,"Payment Error"),sessionStorage.removeItem("payment-processed"))}).catch(e=>{console.error("Payment verification error:",e),sessionStorage.removeItem("payment-processed")})):t&&(sessionStorage.setItem("payment-processed","true"),o("Payment was canceled.",3e3,"Payment Canceled"),setTimeout(()=>{sessionStorage.removeItem("payment-processed")},3e3)))},[n]);const w=async e=>{if(t)if(p&&m)(async e=>{if(t&&m){h(!0);try{const r=u(dt,"users",t.id);await x(r,{hasStudiplyPass:!0,subscription:"basic"===e.id?"basic":"pro",subscriptionStartDate:(new Date).toISOString(),updatedAt:(new Date).toISOString()}),s&&s({...t,hasStudiplyPass:!0,subscription:"basic"===e.id?"basic":"pro"}),i(`Test mode: ${e.name} activated successfully!`,5e3,"Test Activation"),setTimeout(()=>{window.location.reload()},2e3)}catch(r){console.error("Test activation error:",r),o("Failed to activate subscription in test mode",5e3,"Test Error"),h(!1)}}else o("Test mode is only available for administrators",3e3,"Access Denied")})(e);else{console.log("handlePayment called for plan:",e),h(!0);try{const s=await(async(e,t,s,r)=>{try{const a="en";console.log("Creating Stripe checkout session...",{planId:e,price:t,userId:s,userEmail:r,locale:a,API_BASE_URL:ti});const n=await fetch(`${ti}/payment/stripe/create-checkout-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:e,price:t,userId:s,userEmail:r})});console.log("Response status:",n.status);const i=await n.json();return console.log("Response result:",i),i.success?(console.log("Checkout session created successfully, redirecting to:",i.url),{success:!0,sessionId:i.sessionId,url:i.url}):(console.error("Failed to create checkout session:",i.error),{success:!1,error:i.error||"Failed to create checkout session"})}catch(a){return console.error("Error creating Stripe checkout:",a),{success:!1,error:"Network error. Please try again."}}})(e.id,e.price,t.id,t.email);console.log("createStripeCheckout result:",s),s.success&&s.url?(console.log("Redirecting to Stripe checkout:",s.url),window.location.href=s.url):(console.error("Failed to create checkout session:",s.error),o(s.error||"Failed to create checkout session",5e3,"Payment Error"),h(!1))}catch(r){console.error("Payment error:",r),o("An error occurred. Please try again.",5e3,"Payment Error"),h(!1)}}else o("Please log in to purchase a plan",3e3,"Login Required")};return b.find(e=>e.id===l),U.jsxs("div",{className:"min-h-screen "+(r?"bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950":"bg-gradient-to-br from-slate-50 via-white to-slate-50"),children:[U.jsx("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:r?U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-purple-500/20 rounded-full blur-3xl"}),U.jsx("div",{className:"absolute top-1/2 -left-40 w-80 h-80 bg-pink-500/20 rounded-full blur-3xl"}),U.jsx("div",{className:"absolute bottom-0 right-1/4 w-80 h-80 bg-indigo-500/20 rounded-full blur-3xl"})]}):U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-purple-100/50 rounded-full blur-3xl"}),U.jsx("div",{className:"absolute top-1/2 -left-40 w-80 h-80 bg-pink-100/50 rounded-full blur-3xl"}),U.jsx("div",{className:"absolute bottom-0 right-1/4 w-80 h-80 bg-indigo-100/50 rounded-full blur-3xl"})]})}),U.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[U.jsxs("div",{className:"text-center mb-16",children:[U.jsxs("div",{className:"flex items-center justify-between mb-8",children:[U.jsxs("button",{onClick:()=>a(-1),className:"inline-flex items-center gap-2 px-4 py-2 rounded-xl font-medium transition-all "+(r?"bg-white/5 text-white/70 hover:bg-white/10 hover:text-white border border-white/10":"bg-white text-slate-700 hover:bg-slate-50 border border-slate-200 shadow-sm"),children:[U.jsx(Rr,{className:"w-4 h-4"}),"Back"]}),m&&U.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 rounded-xl border transition-all "+(r?p?"bg-yellow-500/20 border-yellow-500/50":"bg-white/5 border-white/10":p?"bg-yellow-50 border-yellow-300":"bg-white border-slate-200"),children:[U.jsx("span",{className:"text-sm font-medium "+(r?"text-white/70":"text-slate-600"),children:p?" Test Mode":" Live Mode"}),U.jsx("button",{onClick:()=>g(!p),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors "+(p?"bg-yellow-500":r?"bg-slate-600":"bg-slate-300"),children:U.jsx("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform "+(p?"translate-x-6":"translate-x-1")})}),p&&U.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+(r?"bg-yellow-500/30 text-yellow-300":"bg-yellow-100 text-yellow-700"),children:"No Payment"})]})]}),U.jsxs("div",{className:"mb-6",children:[U.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-500/30 mb-6",children:[U.jsx(nr,{className:"w-4 h-4 text-purple-400"}),U.jsx("span",{className:"text-sm font-semibold "+(r?"text-purple-300":"text-purple-700"),children:"Upgrade Your Learning Experience"})]}),U.jsx("h1",{className:"text-5xl md:text-6xl font-black tracking-tight mb-4 "+(r?"bg-gradient-to-r from-white via-purple-200 to-pink-200 bg-clip-text text-transparent":"bg-gradient-to-r from-slate-900 via-purple-900 to-pink-900 bg-clip-text text-transparent"),children:"Choose Your Plan"}),U.jsx("p",{className:"text-xl max-w-2xl mx-auto "+(r?"text-white/60":"text-slate-600"),children:"Unlock premium features and accelerate your learning journey"})]})]}),U.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-16 max-w-6xl mx-auto",children:b.map(e=>{const t=e.icon,s=l===e.id;return U.jsxs("div",{className:"relative group cursor-pointer transition-all duration-500 "+(s?"lg:scale-105":"hover:scale-[1.02]"),onClick:()=>c(e.id),children:[s&&U.jsx("div",{className:`absolute -inset-1 bg-gradient-to-r ${e.gradient} rounded-3xl blur-xl opacity-50 animate-pulse`}),U.jsxs("div",{className:"relative h-full rounded-3xl border-2 transition-all duration-500 overflow-hidden "+(s?`border-transparent bg-gradient-to-br ${e.bgGradient} shadow-2xl`:r?"border-slate-700/50 bg-slate-800/50 backdrop-blur-sm":"border-slate-200 bg-white/80 backdrop-blur-sm"),children:[e.popular&&U.jsx("div",{className:"absolute top-6 right-6 z-10",children:U.jsxs("div",{className:"relative",children:[U.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${e.gradient} rounded-full blur-md opacity-75`}),U.jsx("div",{className:`relative bg-gradient-to-r ${e.gradient} text-white text-xs font-bold px-4 py-1.5 rounded-full shadow-lg`,children:"MOST POPULAR"})]})}),s&&U.jsx("div",{className:"absolute top-6 left-6 z-10",children:U.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center shadow-lg",children:U.jsx(Ut,{className:"w-5 h-5 text-white"})})}),U.jsxs("div",{className:"p-8",children:[U.jsxs("div",{className:"mb-6",children:[U.jsx("div",{className:`w-16 h-16 rounded-2xl bg-gradient-to-br ${e.gradient} flex items-center justify-center mb-4 shadow-lg`,children:U.jsx(t,{className:"w-8 h-8 text-white"})}),U.jsx("h3",{className:"text-2xl font-bold mb-1 "+(r?"text-white":"text-slate-900"),children:e.name}),U.jsx("p",{className:"text-sm "+(r?"text-white/60":"text-slate-500"),children:e.tagline})]}),U.jsxs("div",{className:"mb-8",children:[U.jsxs("div",{className:"flex items-baseline gap-2 mb-2",children:[U.jsxs("span",{className:"text-5xl font-black "+(r?"text-white":"text-slate-900"),children:["",e.price]}),U.jsx("span",{className:"text-lg font-medium "+(r?"text-white/40":"text-slate-400"),children:"/month"})]}),U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsxs("span",{className:"text-sm line-through "+(r?"text-white/30":"text-slate-400"),children:["",e.originalPrice]}),U.jsxs("span",{className:"text-sm font-semibold px-2 py-0.5 rounded-full "+(r?"bg-green-500/20 text-green-400":"bg-green-100 text-green-700"),children:["Save ",Math.round((e.originalPrice-e.price)/e.originalPrice*100),"%"]})]})]}),U.jsx("div",{className:"space-y-3 mb-8",children:e.features.map((e,t)=>U.jsxs("div",{className:"flex items-start gap-3",children:[U.jsx(Ut,{className:"w-5 h-5 flex-shrink-0 mt-0.5 "+(r?"text-green-400":"text-green-600")}),U.jsx("span",{className:"text-sm "+(r?"text-white/80":"text-slate-700"),children:e})]},t))}),U.jsx("div",{className:"space-y-2",children:U.jsx("button",{className:"w-full py-4 rounded-xl font-bold text-white transition-all duration-300 "+(s?p&&m?"bg-gradient-to-r from-yellow-500 to-orange-500 shadow-xl hover:shadow-2xl transform hover:-translate-y-1":`bg-gradient-to-r ${e.gradient} shadow-xl hover:shadow-2xl transform hover:-translate-y-1`:r?"bg-slate-700 hover:bg-slate-600":"bg-slate-200 text-slate-700 hover:bg-slate-300"),onClick:t=>{t.stopPropagation(),s&&!d&&w(e)},disabled:!s||d,children:U.jsx("div",{className:"flex items-center justify-center gap-2",children:d?U.jsxs(U.Fragment,{children:[U.jsx(As,{className:"w-5 h-5 animate-spin"}),U.jsx("span",{children:"Processing..."})]}):U.jsxs(U.Fragment,{children:[U.jsx("span",{children:p&&m?" Activate (Test)":"Get Started"}),U.jsx(yt,{className:"w-5 h-5"})]})})})})]})]})]},e.id)})}),U.jsx("div",{className:"rounded-3xl border backdrop-blur-xl overflow-hidden max-w-5xl mx-auto mb-16 "+(r?"border-slate-700/50 bg-slate-800/30":"border-slate-200 bg-white/60"),children:U.jsxs("div",{className:"p-12",children:[U.jsx("h2",{className:"text-3xl font-bold mb-2 text-center "+(r?"text-white":"text-slate-900"),children:"Why Choose Studiply Pro?"}),U.jsx("p",{className:"text-center mb-10 "+(r?"text-white/60":"text-slate-600"),children:"Join thousands of learners who are accelerating their progress"}),U.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:f.map((e,t)=>{const s=e.icon;return U.jsxs("div",{className:"p-6 rounded-2xl border transition-all hover:scale-105 "+(r?"border-slate-700/50 bg-slate-800/30 hover:bg-slate-800/50":"border-slate-200 bg-white/60 hover:bg-white"),children:[U.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center mb-4 shadow-lg",children:U.jsx(s,{className:"w-6 h-6 text-white"})}),U.jsx("h3",{className:"font-bold mb-2 "+(r?"text-white":"text-slate-900"),children:e.title}),U.jsx("p",{className:"text-sm "+(r?"text-white/60":"text-slate-600"),children:e.description})]},t)})})]})}),U.jsx("div",{className:"flex justify-center mb-8",children:U.jsxs("div",{className:"inline-flex items-center gap-2 px-6 py-3 rounded-xl border "+(r?"bg-slate-800/50 border-slate-700/50":"bg-white border-slate-200 shadow-sm"),children:[U.jsx(rr,{className:"w-5 h-5 "+(r?"text-green-400":"text-green-600")}),U.jsx("span",{className:"font-medium text-sm "+(r?"text-white/70":"text-slate-600"),children:"Secure payment powered by Stripe"})]})}),U.jsx("div",{className:"text-center",children:U.jsxs("div",{className:"flex items-center justify-center gap-8 flex-wrap",children:[U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx(rr,{className:"w-5 h-5 "+(r?"text-green-400":"text-green-600")}),U.jsx("span",{className:"text-sm "+(r?"text-white/60":"text-slate-600"),children:"Secure Payment"})]}),U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx(ws,{className:"w-5 h-5 "+(r?"text-purple-400":"text-purple-600")}),U.jsx("span",{className:"text-sm "+(r?"text-white/60":"text-slate-600"),children:"Cancel Anytime"})]}),U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx(kr,{className:"w-5 h-5 "+(r?"text-blue-400":"text-blue-600")}),U.jsx("span",{className:"text-sm "+(r?"text-white/60":"text-slate-600"),children:"10,000+ Happy Users"})]})]})})]})]})},Ai={}.VITE_API_BASE_URL||"http://localhost:3003/api",Ti=async e=>{if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(t.error||"Request failed")}return e.json()},Ii=async(e={})=>{const t=await fetch(`${Ai}/quest-requests${((e={})=>{const t=new URLSearchParams;Object.entries(e).forEach(([e,s])=>{null!=s&&""!==s&&t.append(e,s)});const s=t.toString();return s?`?${s}`:""})(e)}`);return Ti(t)};"undefined"!=typeof window&&(window.__QUEST_API_BASE__={}.VITE_API_BASE_URL);const Pi=e=>e&&"object"==typeof e&&e.toString?e.toString():e,qi=e=>e?e.id?{...e,id:Pi(e.id)}:{...e,id:Pi(e._id||e.questId||e.requestId)}:e,Ri=async(e,t,s)=>{try{const r=await(async({userId:e,userName:t,questData:s})=>{const r=`${Ai}/quest-requests`;console.log(" [Quest Request API] Sending request to:",r),console.log(" [Quest Request API] Request data:",{userId:e,userName:t,subject:null==s?void 0:s.subject,category:null==s?void 0:s.category,title:null==s?void 0:s.title});try{const a=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,userName:t,questData:s})});console.log(" [Quest Request API] Response status:",a.status);const n=await Ti(a);return console.log(" [Quest Request API] Success:",n.requestId),n}catch(a){throw console.error(" [Quest Request API] Error:",a),a}})({userId:e,userName:t,questData:s});return console.log(" Quest request created:",r.requestId),{success:!0,requestId:r.requestId,request:qi(r.request)}}catch(r){return console.error(" Error creating quest request:",r),{success:!1,error:r.message}}},Mi=async(e,t)=>{try{const s=await(async(e,t)=>{const s=await fetch(`${Ai}/quest-requests/${e}/approve`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminUserId:t})});return Ti(s)})(e,t);return console.log(" Quest request approved:",e," Quest ID:",s.questId),{success:!0,questId:s.questId,request:qi(s.request)}}catch(s){return console.error(" Error approving quest request:",s),{success:!1,error:s.message}}},Di=async(e,t,s="")=>{try{return await(async(e,t,s)=>{const r=await fetch(`${Ai}/quest-requests/${e}/reject`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminUserId:t,rejectionReason:s})});return Ti(r)})(e,t,s),console.log(" Quest request rejected:",e),{success:!0}}catch(r){return console.error(" Error rejecting quest request:",r),{success:!1,error:r.message}}},Li=async(e=null,t=null)=>{try{const s={};e&&(s.subject=e),t&&(s.category=t);const r=await(async(e={})=>{const t=await fetch(`${Jr}/quests${Kr(e)}`);if(!t.ok)throw new Error("Failed to fetch quests");return t.json()})(s),a=(r.quests||[]).map(qi);return console.log(` Loaded ${a.length} approved quests`),{success:!0,quests:a}}catch(s){return console.error(" Error fetching approved quests:",s),{success:!1,error:s.message,quests:[]}}},Fi=()=>{var t,s;const{user:r,logout:a}=Br(),{showError:n,showSuccess:i}=Hr(),h=qe(),{toggleTheme:m}=mt(),[g,b]=e.useState("tutor-accounts"),[y,v]=e.useState([]),[j,N]=e.useState([]),[k,S]=e.useState(!0),[C,E]=e.useState(""),[A,T]=e.useState("all"),[I,P]=e.useState("createdAt"),[q,R]=e.useState("desc"),[M,D]=e.useState(!1),[L,F]=e.useState(null),[$,O]=e.useState(!1),[B,_]=e.useState(null),[z,W]=e.useState(""),[H,G]=e.useState(!1),[V,Y]=e.useState([]),[Q,J]=e.useState("pending"),[K,X]=e.useState(null),[Z,ee]=e.useState(!1),[te,se]=e.useState(""),[re,ae]=e.useState(!1),[ne,ie]=e.useState(!1);null==r||r.email,e.useEffect(()=>{r&&(console.log(" Admin access granted, loading data..."),oe())},[r]);const oe=async()=>{S(!0);try{await Promise.all([ce(),de(),le()])}catch(e){console.error(" Error loading data:",e),n("Failed to load data","Error")}finally{S(!1)}},le=async()=>{var e;ie(!0);try{console.log(" Loading quest requests with status:",Q);const t=await(async(e="all")=>{try{console.log(` Fetching quest requests with status: ${e}`);const t=((await Ii({status:e})).requests||[]).map(qi);return console.log(` Loaded ${t.length} quest requests (status: ${e})`),{success:!0,requests:t}}catch(t){return console.error(" Error fetching quest requests:",t),{success:!1,error:t.message,requests:[]}}})(Q);console.log(" Quest requests result:",t),t.success?(console.log(` Loaded ${(null==(e=t.requests)?void 0:e.length)||0} quest requests`),Y(t.requests||[])):(console.error(" Error loading quest requests:",t.error),n(t.error||"Failed to load quest requests","Error"),Y([]))}catch(t){console.error(" Error loading quest requests:",t),n("An error occurred while loading quest requests","Error"),Y([])}finally{ie(!1)}};e.useEffect(()=>{"requests"===g&&le()},[g,Q]);const ce=async()=>{var e,t,s,r;console.log(" Loading all tutors for admin...");const a=o(dt,"users"),n=l(a),i=await d(n);console.log(" Total users found:",i.docs.length);const c=[];let u=0;for(const o of i.docs){const a=o.data();if(!a.isTutor)continue;u++,console.log(` Found tutor ${u}:`,a.name);const n=await ue(o.id);c.push({id:o.id,name:a.name||"Unknown",email:a.email||"No email",phone:a.phone||"No phone",school:a.school||"Not specified",grade:a.grade||"Not specified",bio:a.bio||"No bio",subjects:a.subjects||[],specialties:a.subjects||[],tutorProfile:a.tutorProfile||{},location:a.location||"Online",avatar:a.avatar||null,createdAt:a.createdAt,updatedAt:a.updatedAt,lastLogin:a.lastLogin,isAvailable:!1!==(null==(e=a.tutorProfile)?void 0:e.isAvailable),description:(null==(t=a.tutorProfile)?void 0:t.description)||a.bio||"No description",experience:(null==(s=a.tutorProfile)?void 0:s.experience)||"Student",responseTime:(null==(r=a.tutorProfile)?void 0:r.responseTime)||"Not specified",stats:n})}console.log(` Loaded ${c.length} tutors`),v(c)},de=async()=>{console.log(" Loading all users for admin...");const e=o(dt,"users"),t=l(e),s=await d(t);console.log(" Total users found:",s.docs.length);const r=[];for(const n of s.docs){const e=n.data(),t={id:n.id,name:e.name||"Unknown",email:e.email||"No email",school:e.school||"Not specified",grade:e.grade||"Not specified",isTutor:e.isTutor||!1,avatar:e.avatar||null,banned:!0===e.banned,banMessage:e.banMessage||null,createdAt:e.createdAt,updatedAt:e.updatedAt,lastLogin:e.lastLogin};t.banned&&console.log(` Found banned user: ${t.name} (${t.email})`),r.push(t)}const a=r.filter(e=>e.banned).length;console.log(` Loaded ${r.length} users (${a} banned)`),N(r)},ue=async e=>{try{const t=await an(e);return t.success?{totalSessions:t.totalSessions||0,averageRating:t.averageRating||0,ratingCount:t.ratingCount||0}:(console.error("Error getting tutor stats:",t.error),{totalSessions:0,averageRating:0,ratingCount:0})}catch(t){return console.error("Error getting tutor stats:",t),{totalSessions:0,averageRating:0,ratingCount:0}}},he=y.filter(e=>{const t=e.name.toLowerCase().includes(C.toLowerCase())||e.email.toLowerCase().includes(C.toLowerCase())||e.school.toLowerCase().includes(C.toLowerCase()),s="all"===A||"active"===A&&e.isAvailable||"inactive"===A&&!e.isAvailable;return t&&s}),me=j.filter(e=>{const t=e.name.toLowerCase().includes(C.toLowerCase())||e.email.toLowerCase().includes(C.toLowerCase())||e.school.toLowerCase().includes(C.toLowerCase()),s="all"===A||"tutors"===A&&e.isTutor||"students"===A&&!e.isTutor;return t&&s}),xe=[...he].sort((e,t)=>{let s=e[I],r=t[I];return"createdAt"!==I&&"updatedAt"!==I||(s=Pa(s),r=Pa(r)),"asc"===q?s>r?1:-1:s<r?1:-1}),pe=[...me].sort((e,t)=>{let s=e[I],r=t[I];return"createdAt"!==I&&"updatedAt"!==I||(s=Pa(s),r=Pa(r)),"asc"===q?s>r?1:-1:s<r?1:-1});return r?U.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:U.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[U.jsxs("div",{className:"text-center mb-12",children:[U.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-4",children:[U.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center",children:U.jsx(rr,{className:"w-6 h-6 text-white"})}),U.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Admin Panel"})]}),U.jsx("p",{className:"text-gray-600 text-lg",children:"Manage tutor profiles and user accounts"})]}),U.jsxs("div",{className:"flex space-x-1 bg-white/80 backdrop-blur-sm rounded-2xl p-2 mb-8 shadow-lg border border-white/20",children:[U.jsx("button",{onClick:()=>b("tutor-accounts"),className:"flex-1 py-3 px-6 rounded-xl font-medium transition-all duration-200 "+("tutor-accounts"===g?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"text-gray-600 hover:text-gray-900 hover:bg-white/50"),children:U.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[U.jsx(kr,{className:"w-5 h-5"}),U.jsx("span",{children:"Tutor Accounts"})]})}),U.jsx("button",{onClick:()=>b("user-accounts"),className:"flex-1 py-3 px-6 rounded-xl font-medium transition-all duration-200 "+("user-accounts"===g?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"text-gray-600 hover:text-gray-900 hover:bg-white/50"),children:U.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[U.jsx(Zt,{className:"w-5 h-5"}),U.jsx("span",{children:"User Accounts"})]})}),U.jsx("button",{onClick:()=>b("requests"),className:"flex-1 py-3 px-6 rounded-xl font-medium transition-all duration-200 "+("requests"===g?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"text-gray-600 hover:text-gray-900 hover:bg-white/50"),children:U.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[U.jsx(ls,{className:"w-5 h-5"}),U.jsx("span",{children:"Requests"})]})})]}),U.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[U.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6",children:U.jsxs("div",{className:"flex items-center space-x-4",children:[U.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl flex items-center justify-center",children:U.jsx(kr,{className:"w-6 h-6 text-white"})}),U.jsxs("div",{children:[U.jsx("div",{className:"text-2xl font-bold text-gray-900",children:y.length}),U.jsx("div",{className:"text-sm text-gray-600",children:"Total Tutors"})]})]})}),U.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6",children:U.jsxs("div",{className:"flex items-center space-x-4",children:[U.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-green-600 rounded-xl flex items-center justify-center",children:U.jsx($t,{className:"w-6 h-6 text-white"})}),U.jsxs("div",{children:[U.jsx("div",{className:"text-2xl font-bold text-gray-900",children:y.filter(e=>e.isAvailable).length}),U.jsx("div",{className:"text-sm text-gray-600",children:"Active Tutors"})]})]})}),U.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6",children:U.jsxs("div",{className:"flex items-center space-x-4",children:[U.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl flex items-center justify-center",children:U.jsx(Nr,{className:"w-6 h-6 text-white"})}),U.jsxs("div",{children:[U.jsx("div",{className:"text-2xl font-bold text-gray-900",children:j.length}),U.jsx("div",{className:"text-sm text-gray-600",children:"Total Users"})]})]})}),U.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6",children:U.jsxs("div",{className:"flex items-center space-x-4",children:[U.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl flex items-center justify-center",children:U.jsx(jr,{className:"w-6 h-6 text-white"})}),U.jsxs("div",{children:[U.jsx("div",{className:"text-2xl font-bold text-gray-900",children:j.filter(e=>!e.isTutor).length}),U.jsx("div",{className:"text-sm text-gray-600",children:"Students"})]})]})})]}),("tutor-accounts"===g||"user-accounts"===g)&&U.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6 mb-8",children:U.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[U.jsx("div",{className:"flex-1",children:U.jsxs("div",{className:"relative",children:[U.jsx(er,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),U.jsx("input",{type:"text",placeholder:`Search ${"tutor-accounts"===g?"tutors":"users"}...`,value:C,onChange:e=>E(e.target.value),className:"w-full pl-10 pr-4 py-3 bg-white/80 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]})}),U.jsxs("div",{className:"flex gap-4",children:[U.jsx("select",{value:A,onChange:e=>T(e.target.value),className:"px-4 py-3 bg-white/80 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",children:"tutor-accounts"===g?U.jsxs(U.Fragment,{children:[U.jsx("option",{value:"all",children:"All Tutors"}),U.jsx("option",{value:"active",children:"Active Only"}),U.jsx("option",{value:"inactive",children:"Inactive Only"})]}):U.jsxs(U.Fragment,{children:[U.jsx("option",{value:"all",children:"All Users"}),U.jsx("option",{value:"tutors",children:"Tutors Only"}),U.jsx("option",{value:"students",children:"Students Only"})]})}),U.jsxs("select",{value:`${I}-${q}`,onChange:e=>{const[t,s]=e.target.value.split("-");P(t),R(s)},className:"px-4 py-3 bg-white/80 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",children:[U.jsx("option",{value:"createdAt-desc",children:"Newest First"}),U.jsx("option",{value:"createdAt-asc",children:"Oldest First"}),U.jsx("option",{value:"name-asc",children:"Name A-Z"}),U.jsx("option",{value:"name-desc",children:"Name Z-A"})]})]})]})}),k?U.jsxs("div",{className:"text-center py-12",children:[U.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:U.jsx(Ht,{className:"w-8 h-8 text-white animate-spin"})}),U.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Loading..."}),U.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch the data."})]}):U.jsxs("div",{className:"space-y-6",children:["tutor-accounts"===g&&U.jsxs(U.Fragment,{children:[U.jsxs("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:["Tutor Accounts (",xe.length,")"]}),xe.length>0?U.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:xe.map(e=>U.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6 hover:shadow-2xl transition-all duration-300 hover:scale-[1.02]",children:[U.jsxs("div",{className:"flex items-start space-x-4 mb-6",children:[U.jsx(Za,{user:e,size:"xl"}),U.jsxs("div",{className:"flex-1",children:[U.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:e.name}),U.jsx("p",{className:"text-gray-600 text-sm",children:e.email}),U.jsxs("div",{className:"inline-flex items-center space-x-1 px-3 py-1 rounded-full text-xs font-medium mt-2 "+(e.isAvailable?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:[e.isAvailable?U.jsx($t,{className:"w-3 h-3"}):U.jsx(qr,{className:"w-3 h-3"}),U.jsx("span",{children:e.isAvailable?"Active":"Inactive"})]})]})]}),U.jsxs("div",{className:"space-y-4",children:[U.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[U.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[U.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[U.jsx(ps,{className:"w-4 h-4 text-gray-500"}),U.jsx("span",{className:"text-xs font-medium text-gray-600",children:"School"})]}),U.jsx("span",{className:"text-sm font-semibold text-gray-900",children:e.school})]}),U.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[U.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[U.jsx(Nr,{className:"w-4 h-4 text-gray-500"}),U.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Grade"})]}),U.jsx("span",{className:"text-sm font-semibold text-gray-900",children:e.grade})]})]}),U.jsxs("div",{children:[U.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[U.jsx(Pt,{className:"w-4 h-4 text-gray-500"}),U.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Specialties"})]}),U.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.specialties.slice(0,3).map((e,t)=>U.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:e},t)),e.specialties.length>3&&U.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:["+",e.specialties.length-3," more"]})]})]}),U.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"text-lg font-bold text-gray-900",children:e.stats.totalSessions}),U.jsx("div",{className:"text-xs text-gray-600",children:"Sessions"})]}),U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"text-lg font-bold text-gray-900",children:e.stats.averageRating.toFixed(1)}),U.jsx("div",{className:"text-xs text-gray-600",children:"Rating"})]}),U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"text-lg font-bold text-gray-900",children:e.stats.ratingCount}),U.jsx("div",{className:"text-xs text-gray-600",children:"Reviews"})]})]}),U.jsxs("div",{className:"space-y-2",children:[e.stats.ratingCount>0&&U.jsxs("button",{onClick:()=>(e=>{F(e),D(!0),console.log(" Modal should be opening...")})(e),className:"w-full py-2 px-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-200 flex items-center justify-center space-x-2 font-medium",children:[U.jsx(os,{className:"w-4 h-4"}),U.jsxs("span",{children:["View Reviews (",e.stats.ratingCount,")"]})]}),U.jsxs("button",{onClick:()=>(e=>{console.log(" Delete tutor button clicked for:",e.name),_(e),W("tutor"),O(!0),console.log(" Delete modal should be opening for tutor:",e.name)})(e),className:"w-full py-2 px-4 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl hover:from-red-600 hover:to-red-700 transition-all duration-200 flex items-center justify-center space-x-2 font-medium",children:[U.jsx(pr,{className:"w-4 h-4"}),U.jsx("span",{children:"Delete Tutor Profile"})]})]})]})]},e.id))}):U.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-blue-50 rounded-3xl p-12 border border-gray-100 text-center",children:[U.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-gray-500 to-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-2xl",children:U.jsx(kr,{className:"w-10 h-10 text-white"})}),U.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"No tutors found"}),U.jsx("p",{className:"text-gray-600 text-lg",children:"Try adjusting your search or filter criteria."})]})]}),"user-accounts"===g&&U.jsxs(U.Fragment,{children:[U.jsxs("div",{className:"flex items-center justify-between mb-6",children:[U.jsxs("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:["User Accounts (",pe.length,")"]}),U.jsxs("button",{onClick:async()=>{if(window.confirm("Are you sure you want to delete ALL chat messages? This action cannot be undone."))try{const e=await(async()=>{try{const e=o(dt,"messages"),t=await d(e);if(t.empty)return{success:!0,count:0,message:"No messages to delete"};const s=[];let r=w(dt),a=0;return t.docs.forEach((e,t)=>{r.delete(e.ref),a++,a%500==0&&(s.push(r.commit()),r=w(dt))}),a%500!=0&&s.push(r.commit()),await Promise.all(s),{success:!0,count:a,message:`Successfully deleted ${a} messages`}}catch(e){return console.error("Error deleting all messages:",e),{success:!1,error:"Failed to delete all messages"}}})();e.success?i(`Successfully deleted ${e.count} messages`):n(e.error||"Failed to delete messages")}catch(e){n("Error deleting messages: "+e.message)}},className:"flex items-center gap-2 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-xl font-medium transition-all shadow-lg hover:shadow-xl",children:[U.jsx(pr,{className:"w-4 h-4"}),"Delete All Messages"]})]}),pe.length>0?U.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:pe.map(e=>U.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6 hover:shadow-2xl transition-all duration-300 hover:scale-[1.02]",children:[U.jsxs("div",{className:"flex items-start space-x-4 mb-6",children:[U.jsx(Za,{user:e,size:"xl"}),U.jsxs("div",{className:"flex-1",children:[U.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:e.name}),U.jsx("p",{className:"text-gray-600 text-sm",children:e.email}),U.jsxs("div",{className:"inline-flex items-center space-x-1 px-3 py-1 rounded-full text-xs font-medium mt-2 "+(e.isTutor?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:[e.isTutor?U.jsx(kr,{className:"w-3 h-3"}):U.jsx(Nr,{className:"w-3 h-3"}),U.jsx("span",{children:e.isTutor?"Tutor":"Student"})]})]})]}),U.jsxs("div",{className:"space-y-4",children:[U.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[U.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[U.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[U.jsx(ps,{className:"w-4 h-4 text-gray-500"}),U.jsx("span",{className:"text-xs font-medium text-gray-600",children:"School"})]}),U.jsx("span",{className:"text-sm font-semibold text-gray-900",children:e.school})]}),U.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[U.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[U.jsx(Nr,{className:"w-4 h-4 text-gray-500"}),U.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Grade"})]}),U.jsx("span",{className:"text-sm font-semibold text-gray-900",children:e.grade})]})]}),U.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[U.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[U.jsx(Lt,{className:"w-4 h-4 text-gray-500"}),U.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Joined"})]}),U.jsx("span",{className:"text-sm font-semibold text-gray-900",children:Ra(e.createdAt)})]}),U.jsx("div",{className:"space-y-2",children:e.banned?U.jsxs(U.Fragment,{children:[U.jsxs("div",{className:"w-full py-2 px-4 bg-red-100 border-2 border-red-300 rounded-xl flex items-center justify-center space-x-2 font-medium",children:[U.jsx(ft,{className:"w-4 h-4 text-red-600"}),U.jsx("span",{className:"text-red-700",children:"Banned"})]}),U.jsxs("button",{onClick:()=>(e=>{console.log(" Unban account button clicked for:",e.name),_(e),W("unban"),O(!0),console.log(" Unban modal should be opening for account:",e.name)})(e),className:"w-full py-2 px-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl hover:from-green-600 hover:to-green-700 transition-all duration-200 flex items-center justify-center space-x-2 font-medium",children:[U.jsx($t,{className:"w-4 h-4"}),U.jsx("span",{children:"Unban Account"})]})]}):U.jsxs("button",{onClick:()=>(e=>{console.log(" Ban account button clicked for:",e.name),_(e),W("account"),O(!0),console.log(" Ban modal should be opening for account:",e.name)})(e),className:"w-full py-2 px-4 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl hover:from-red-600 hover:to-red-700 transition-all duration-200 flex items-center justify-center space-x-2 font-medium",children:[U.jsx(jr,{className:"w-4 h-4"}),U.jsx("span",{children:"Ban Account"})]})})]})]},e.id))}):U.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-blue-50 rounded-3xl p-12 border border-gray-100 text-center",children:[U.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-gray-500 to-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-2xl",children:U.jsx(Zt,{className:"w-10 h-10 text-white"})}),U.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"No users found"}),U.jsx("p",{className:"text-gray-600 text-lg",children:"Try adjusting your search or filter criteria."})]})]})]}),"requests"===g&&U.jsx(U.Fragment,{children:ne?U.jsxs("div",{className:"text-center py-12",children:[U.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:U.jsx(Ht,{className:"w-8 h-8 text-white animate-spin"})}),U.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Loading quest requests..."}),U.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch the data."})]}):U.jsxs(U.Fragment,{children:[U.jsxs("div",{className:"flex items-center justify-between mb-6",children:[U.jsxs("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:["Quest Requests (",V.length,")"]}),U.jsxs("select",{value:Q,onChange:e=>J(e.target.value),className:"px-4 py-2 bg-white/80 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[U.jsx("option",{value:"pending",children:"Pending"}),U.jsx("option",{value:"approved",children:"Approved"}),U.jsx("option",{value:"rejected",children:"Rejected"}),U.jsx("option",{value:"all",children:"All"})]})]}),V.length>0?U.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:V.map(e=>{var t;return U.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6 hover:shadow-2xl transition-all duration-300 hover:scale-[1.02]",children:[U.jsxs("div",{className:"flex items-start justify-between mb-4",children:[U.jsxs("div",{className:"flex-1",children:[U.jsx("h3",{className:"font-bold text-gray-900 text-lg mb-2",children:e.title}),U.jsx("p",{className:"text-gray-600 text-sm line-clamp-2",children:e.description||"No description"})]}),U.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-semibold "+("pending"===e.status?"bg-yellow-100 text-yellow-800":"approved"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.status})]}),U.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[U.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[U.jsx("div",{className:"text-xs font-medium text-gray-600 mb-1",children:"Subject"}),U.jsx("div",{className:"text-sm font-semibold text-gray-900",children:e.subject})]}),U.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[U.jsx("div",{className:"text-xs font-medium text-gray-600 mb-1",children:"Difficulty"}),U.jsx("div",{className:"text-sm font-semibold text-gray-900",children:e.difficulty})]}),U.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[U.jsx("div",{className:"text-xs font-medium text-gray-600 mb-1",children:"Category"}),U.jsx("div",{className:"text-sm font-semibold text-gray-900",children:e.category})]}),U.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[U.jsx("div",{className:"text-xs font-medium text-gray-600 mb-1",children:"Questions"}),U.jsx("div",{className:"text-sm font-semibold text-gray-900",children:(null==(t=e.questions)?void 0:t.length)||0})]})]}),U.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-4",children:[U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx(Nr,{className:"w-4 h-4"}),U.jsx("span",{children:e.createdByName||"Anonymous"})]}),U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx(Ht,{className:"w-4 h-4"}),U.jsx("span",{children:e.createdAt?Ra(e.createdAt):"N/A"})]})]}),"pending"===e.status&&U.jsx("div",{className:"flex gap-2",children:U.jsxs("button",{onClick:()=>(e=>{X(e),ee(!0),se("")})(e),className:"flex-1 py-2 px-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-200 flex items-center justify-center space-x-2 font-medium",children:[U.jsx(os,{className:"w-4 h-4"}),U.jsx("span",{children:"Review"})]})})]},e.id)})}):U.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-blue-50 rounded-3xl p-12 border border-gray-100 text-center",children:[U.jsx(ls,{className:"w-20 h-20 text-gray-400 mx-auto mb-6"}),U.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"No quest requests found"}),U.jsx("p",{className:"text-gray-600 text-lg",children:"pending"===Q?"No pending quest requests at the moment.":`No ${Q} quest requests.`})]})]})}),M&&L&&U.jsx(on,{isOpen:M,tutor:L,onClose:()=>{D(!1),F(null)}}),$&&B&&U.jsx(ai,{isOpen:$,item:B,type:z,onConfirm:"tutor"===z?async()=>{try{G(!0),console.log(" Deleting tutor profile:",B.id);const t=u(dt,"users",B.id);await x(t,{isTutor:!1,tutorProfile:null,subjects:[],updatedAt:p()}),console.log(" User document updated - tutor profile removed");const s=o(dt,"sessions"),r=l(s,c("tutorId","==",B.id)),a=await d(r);for(const e of a.docs)await f(e.ref);console.log(` Deleted ${a.docs.length} tutor sessions`);const n=o(dt,"ratings"),h=l(n,c("tutorId","==",B.id)),m=await d(h);for(const e of m.docs)await f(e.ref);console.log(` Deleted ${m.docs.length} tutor ratings`);const g=u(dt,"tutorStats",B.id);try{await f(g),console.log(" Tutor stats deleted")}catch(e){console.log(" No tutor stats to delete")}await ce(),O(!1),_(null),W(""),console.log(" Tutor profile and all related data deleted successfully"),i("Tutor profile and all related data deleted successfully","Success")}catch(e){console.error(" Error deleting tutor profile:",e),n(`Failed to delete tutor profile: ${e.message}`,"Delete Failed")}finally{G(!1)}}:"unban"===z?async()=>{try{G(!0),console.log(" Unbanning account:",B.id);const e=u(dt,"users",B.id);await x(e,{banned:!1,banMessage:null,unbannedAt:p(),unbannedBy:r.email}),console.log(" User account unbanned"),await oe(),O(!1),_(null),W(""),console.log(" Account unbanned successfully"),i("Account unbanned successfully","Success")}catch(e){console.error(" Error unbanning account:",e),n(`Failed to unban account: ${e.message}`,"Unban Failed")}finally{G(!1)}}:async(e="")=>{try{G(!0),console.log(" Banning account:",B.id),console.log(" Ban message:",e);const t=u(dt,"users",B.id);await x(t,{banned:!0,banMessage:e.trim()||"Your account has been banned by the administrator.",bannedAt:p(),bannedBy:r.email}),console.log(" User account banned"),await oe(),O(!1),_(null),W(""),console.log(" Account banned successfully"),i("Account banned successfully","Success"),B.id===r.id&&(console.log(" Banning current user account, logging out..."),await a(),m("light"),h("/",{replace:!0}),i("Your account has been banned. You have been logged out.","Account Banned"))}catch(t){console.error(" Error banning account:",t),n(`Failed to ban account: ${t.message}`,"Ban Failed")}finally{G(!1)}},onClose:()=>{O(!1),_(null),W("")},loading:H}),Z&&K&&U.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:U.jsx("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:U.jsxs("div",{className:"p-8",children:[U.jsxs("div",{className:"flex justify-between items-center mb-6",children:[U.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Review Quest Request"}),U.jsx("button",{onClick:()=>{ee(!1),X(null),se("")},className:"p-2 rounded-xl text-gray-500 hover:bg-gray-100 transition-colors",children:U.jsx(Rr,{className:"w-6 h-6"})})]}),U.jsxs("div",{className:"space-y-6",children:[U.jsxs("div",{children:[U.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Basic Information"}),U.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[U.jsxs("div",{children:[U.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Title"}),U.jsx("p",{className:"text-gray-900 font-semibold",children:K.title})]}),U.jsxs("div",{children:[U.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Difficulty"}),U.jsx("p",{className:"text-gray-900 font-semibold",children:K.difficulty})]}),U.jsxs("div",{children:[U.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Subject"}),U.jsx("p",{className:"text-gray-900 font-semibold",children:K.subject})]}),U.jsxs("div",{children:[U.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Category"}),U.jsx("p",{className:"text-gray-900 font-semibold",children:K.category})]})]}),K.description&&U.jsxs("div",{className:"mt-4",children:[U.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Description"}),U.jsx("p",{className:"text-gray-900",children:K.description})]})]}),U.jsxs("div",{children:[U.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:["Questions (",(null==(t=K.questions)?void 0:t.length)||0,")"]}),U.jsx("div",{className:"space-y-4",children:null==(s=K.questions)?void 0:s.map((e,t)=>{var s,r;return U.jsxs("div",{className:"border border-gray-200 rounded-xl p-4",children:[U.jsxs("div",{className:"flex items-start justify-between mb-3",children:[U.jsxs("h4",{className:"font-semibold text-gray-900",children:["Question ",t+1]}),U.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full",children:"multiple-choice"===e.type?"Multiple Choice":"Fill in Blank"})]}),U.jsx("p",{className:"text-gray-700 mb-3",children:e.question}),"multiple-choice"===e.type?U.jsx("div",{className:"space-y-2",children:null==(s=e.options)?void 0:s.map((t,s)=>U.jsx("div",{className:"p-2 rounded-lg "+(s===e.correctAnswer?"bg-green-100 border-2 border-green-500":"bg-gray-50 border border-gray-200"),children:U.jsxs("div",{className:"flex items-center gap-2",children:[s===e.correctAnswer&&U.jsx($t,{className:"w-4 h-4 text-green-600"}),U.jsx("span",{className:s===e.correctAnswer?"font-semibold text-green-900":"text-gray-700",children:t})]})},s))}):U.jsxs("div",{className:"space-y-2",children:[U.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Correct Answers:"}),null==(r=e.correctAnswers)?void 0:r.map((e,t)=>U.jsx("div",{className:"p-2 bg-green-100 border border-green-300 rounded-lg",children:U.jsx("span",{className:"text-green-900 font-medium",children:e})},t))]}),e.explanation&&U.jsxs("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg",children:[U.jsx("label",{className:"text-sm font-medium text-blue-900",children:"Explanation:"}),U.jsx("p",{className:"text-blue-800 text-sm",children:e.explanation})]})]},t)})})]}),"pending"===K.status&&U.jsxs("div",{className:"border-t pt-6",children:[U.jsxs("div",{className:"mb-4",children:[U.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rejection Reason (if rejecting)"}),U.jsx("textarea",{value:te,onChange:e=>se(e.target.value),placeholder:"Optional: Provide a reason for rejection...",rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none"})]}),U.jsxs("div",{className:"flex gap-4",children:[U.jsxs("button",{onClick:()=>(async e=>{ae(!0);try{const t=await Mi(e,r.id);t.success?(i("Quest approved successfully!","Success"),await le(),ee(!1),X(null)):n(t.error||"Failed to approve quest","Error")}catch(t){console.error("Error approving quest:",t),n("An error occurred while approving the quest","Error")}finally{ae(!1)}})(K.id),disabled:re,className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl hover:from-green-600 hover:to-green-700 transition-all duration-200 flex items-center justify-center space-x-2 font-medium disabled:opacity-50",children:[U.jsx(mr,{className:"w-5 h-5"}),U.jsx("span",{children:"Approve"})]}),U.jsxs("button",{onClick:()=>(async e=>{if(te.trim()){ae(!0);try{const t=await Di(e,r.id,te);t.success?(i("Quest rejected","Success"),await le(),ee(!1),X(null),se("")):n(t.error||"Failed to reject quest","Error")}catch(t){console.error("Error rejecting quest:",t),n("An error occurred while rejecting the quest","Error")}finally{ae(!1)}}else n("Please provide a reason for rejection","Validation Error")})(K.id),disabled:re,className:"flex-1 px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl hover:from-red-600 hover:to-red-700 transition-all duration-200 flex items-center justify-center space-x-2 font-medium disabled:opacity-50",children:[U.jsx(hr,{className:"w-5 h-5"}),U.jsx("span",{children:"Reject"})]})]})]})]})]})})})]})}):U.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center",children:U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:U.jsx(rr,{className:"w-8 h-8 text-white"})}),U.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Loading..."}),U.jsx("p",{className:"text-gray-600",children:"Please wait while we verify your access."})]})})},Ui=[{id:"italian",name:"Italian Language",headline:"Speak with style and confidence",description:"Master expressive communication, cultural nuances, and modern Italian conversation.",highlights:["Daily conversation labs","Cultural immersion capsules","Grammar accelerators"],challenge:"Host a 10-minute live conversation with a native mentor."},{id:"english",name:"English Language",headline:"Craft global communication fluency",description:"Elevate storytelling, academic writing, and persuasive speaking for any audience.",highlights:["Story craft workshops","Debate lounge","Academic writing studio"],challenge:"Deliver a persuasive talk to a real audience."},{id:"spanish",name:"Spanish Language",headline:"Connect through vibrant dialogue",description:"Learn practical conversation, cultural context, and regional expressions.",highlights:["Immersive conversation tables","Latin culture capsules","Listening labs"],challenge:"Produce a video journal entirely in Spanish."},{id:"french",name:"French Language",headline:"Speak with elegance and nuance",description:"Combine grammar mastery with cultural experiences from France and beyond.",highlights:["Pronunciation ateliers","French cinema club","Grammar masterclasses"],challenge:"Host a French caf-style conversation session."},{id:"german",name:"German Language",headline:"Engineer precise and powerful communication",description:"Build vocabulary and grammar for academic, travel, and professional contexts.",highlights:["Technical vocabulary labs","Cultural immersion panels","Grammar drills"],challenge:"Publish an informative article in German."},{id:"mandarin",name:"Mandarin Chinese",headline:"Navigate tonal language with confidence",description:"Master tones, characters, and cultural etiquette for real-world interactions.",highlights:["Tone dojo sessions","Character design labs","Conversation with mentors"],challenge:"Complete a live Q&A session entirely in Mandarin."},{id:"business",name:"Business & Entrepreneurship",headline:"Design ventures that deliver value",description:"Blend strategy, finance, marketing, and leadership into a purposeful business vision.",highlights:["Pitch studio","Business model sprint","Financial fluency lab"],challenge:"Launch a micro venture and present results to advisors."},{id:"philosophy",name:"Philosophy",headline:"Think critically and ask bigger questions",description:"Explore ethics, logic, metaphysics, and modern thought to sharpen perspective.",highlights:["Socratic dialogues","Logic puzzles","Ethics case labs"],challenge:"Lead a Socratic seminar on a contemporary dilemma."},{id:"mathematics",name:"Mathematics",headline:"Think in elegant structures",description:"Explore problem solving through algebraic design, geometric intuition, and calculus thinking.",highlights:["Strategy studio","Proof builders","Visual geometry labs"],challenge:"Design a strategy guide that solves a real-world optimisation problem."},{id:"computerScience",name:"Computer Science",headline:"Build intelligent digital ideas",description:"Develop code, algorithms, and data intuition to create human-centred technology.",highlights:["Product sprints","Algorithm playground","AI prompt gym"],challenge:"Ship a working prototype to the Launch Gallery."},{id:"chemistry",name:"Chemistry",headline:"Design reactions with purpose",description:"Investigate matter, reactions, and material science through guided experimentation.",highlights:["Organic synthesis quests","Analytical playbook","Safety-first lab design"],challenge:"Deliver a full lab report with data visualisations."},{id:"biology",name:"Biology",headline:"Understand life at every scale",description:"Dive into cellular systems, genetics, ecology, and evolutionary storytelling.",highlights:["Microscope adventures","Field ecology journeys","Genetics code labs"],challenge:"Curate a micro-documentary about a living system."},{id:"history",name:"History",headline:"Connect past to present narratives",description:"Analyse ancient, medieval, and modern turning points to forecast the future.",highlights:["Time capsule writing","Debate forums","Archive exploration"],challenge:"Publish a timeline that reframes a historic event for today."},{id:"geography",name:"Geography",headline:"Map human and natural systems",description:"Blend physical landscapes with human stories through cartography and exploration.",highlights:["Map lab","Sustainable development case files","Geo-data expeditions"],challenge:"Build an interactive map that tells a data-driven story."}],$i=()=>{const t=qe(),{isDark:s}=mt(),[r,a]=e.useState(Ui[0]);return U.jsxs("div",{className:"min-h-screen relative overflow-hidden "+(s?"bg-gradient-to-br from-slate-950 via-purple-950 to-slate-900 text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:[U.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[U.jsx("div",{className:"absolute -top-40 left-1/2 h-72 w-72 -translate-x-1/2 rounded-full bg-purple-500/30 blur-3xl"}),U.jsx("div",{className:"absolute bottom-10 right-10 h-64 w-64 rounded-full bg-pink-400/20 blur-3xl"}),U.jsx("div",{className:"absolute top-1/2 left-10 h-48 w-48 rounded-full bg-blue-400/20 blur-3xl"})]}),U.jsxs("div",{className:"relative mx-auto flex w-full max-w-6xl flex-col gap-8 px-6 py-14 lg:flex-row",children:[U.jsxs("section",{className:"flex-1 rounded-4xl border px-7 py-9 shadow-2xl backdrop-blur "+(s?"border-white/10 bg-white/5":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"flex flex-col gap-6 md:flex-row md:items-start md:justify-between",children:[U.jsxs("div",{children:[U.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-purple-500/10 px-3.5 py-2 text-[11px] font-semibold text-purple-500",children:[U.jsx(nr,{className:"h-3.5 w-3.5"})," Immersive Learning Journey"]}),U.jsx("h1",{className:"mt-3.5 text-3xl font-black tracking-tight md:text-3.5xl",children:"Quest Academy"}),U.jsx("p",{className:"mt-3 max-w-xl text-sm md:text-base "+(s?"text-white/70":"text-slate-600"),children:"Choose a realm of knowledge and we will craft a tailored path of quests, workshops, and mentor moments. Switch subjects at any time to explore parallel worlds of understanding."})]}),U.jsxs("div",{className:"rounded-3xl px-5 py-4 text-sm font-medium shadow-lg "+(s?"bg-gradient-to-br from-purple-500/40 to-pink-500/40 text-white":"bg-gradient-to-br from-purple-500 to-pink-500 text-white"),children:[U.jsx("p",{className:"text-[11px] uppercase tracking-wide opacity-80",children:"Current focus"}),U.jsx("h2",{className:"mt-2 text-lg font-semibold",children:r.name}),U.jsx("p",{className:"mt-2 text-sm leading-relaxed opacity-90",children:r.headline})]})]}),U.jsxs("div",{className:"mt-8 grid gap-6 md:grid-cols-2",children:[U.jsxs("div",{className:"rounded-3xl border px-6 py-6 "+(s?"border-white/10 bg-black/35":"border-slate-200 bg-white"),children:[U.jsxs("h3",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-purple-400",children:[U.jsx(Qt,{className:"h-4 w-4"})," Subject Overview"]}),U.jsx("p",{className:"mt-4 text-sm leading-relaxed "+(s?"text-white/80":"text-slate-700"),children:r.description}),U.jsx("div",{className:"mt-4 space-y-2.5",children:r.highlights.map(e=>U.jsxs("div",{className:"flex items-center gap-3 rounded-2xl px-4 py-3 text-sm "+(s?"bg-white/6 text-white/80":"bg-purple-50 text-purple-700"),children:[U.jsx(Ns,{className:"h-3.5 w-3.5"}),U.jsx("span",{children:e})]},e))})]}),U.jsxs("div",{className:"flex h-full flex-col justify-between rounded-3xl border px-6 py-6 "+(s?"border-white/10 bg-white/5":"border-slate-200 bg-white"),children:[U.jsxs("div",{children:[U.jsx("p",{className:"text-[11px] uppercase tracking-wide text-purple-400",children:"Signature challenge"}),U.jsx("p",{className:"mt-3 text-sm leading-relaxed "+(s?"text-white/80":"text-slate-700"),children:r.challenge})]}),U.jsxs("button",{type:"button",onClick:()=>t("/quest-academy/quests"),className:"mt-6 inline-flex items-center justify-center gap-2 rounded-2xl bg-gradient-to-r from-purple-500 to-pink-500 px-5 py-3 text-sm font-semibold text-white shadow-lg shadow-purple-500/30 transition-transform hover:-translate-y-0.5",children:["Start curated plan",U.jsx(vt,{className:"h-4 w-4"})]})]})]}),U.jsx("div",{onClick:()=>t("/homework-helper"),className:"mt-6 cursor-pointer rounded-3xl border px-6 py-6 transition-all hover:scale-[1.01] hover:shadow-xl "+(s?"border-orange-500/30 bg-gradient-to-br from-orange-500/15 via-rose-500/10 to-transparent hover:border-orange-400/50":"border-orange-200 bg-gradient-to-br from-orange-50 to-rose-50 hover:border-orange-300"),children:U.jsxs("div",{className:"flex items-start justify-between gap-4",children:[U.jsxs("div",{className:"flex-1",children:[U.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[U.jsx("div",{className:"p-2.5 rounded-xl "+(s?"bg-orange-500/20":"bg-orange-100"),children:U.jsx(It,{className:"h-5 w-5 "+(s?"text-orange-400":"text-orange-600")})}),U.jsxs("div",{children:[U.jsx("h3",{className:"text-lg font-bold "+(s?"text-white":"text-slate-900"),children:"Homework Helper"}),U.jsxs("span",{className:"text-xs font-semibold px-2 py-0.5 rounded-full "+(s?"bg-orange-500/20 text-orange-400":"bg-orange-100 text-orange-600"),children:[U.jsx(Rt,{className:"inline h-3 w-3 mr-1"}),"AI Learning Companion"]})]})]}),U.jsxs("p",{className:"text-sm leading-relaxed "+(s?"text-white/70":"text-slate-600"),children:["Stuck on homework? Upload a photo or describe your problem, and I'll guide you step-by-step to understand and solve it yourself.",U.jsx("span",{className:"font-semibold "+(s?"text-orange-400":"text-orange-600"),children:" No direct answers"}),"  just real learning!"]})]}),U.jsxs("div",{className:"flex-shrink-0 flex items-center gap-3 "+(s?"text-white/50":"text-slate-400"),children:[U.jsxs("div",{className:"flex flex-col items-center gap-1 text-center",children:[U.jsx(Ft,{className:"h-6 w-6 "+(s?"text-orange-400":"text-orange-500")}),U.jsx("span",{className:"text-[10px]",children:"Take Photo"})]}),U.jsx(vt,{className:"h-5 w-5 "+(s?"text-orange-400":"text-orange-500")})]})]})})]}),U.jsxs("aside",{className:"w-full max-w-xs space-y-4 rounded-4xl border px-6 py-7 backdrop-blur lg:flex-shrink-0 "+(s?"border-white/10 bg-white/5":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"flex items-center gap-3 pb-3",children:[U.jsx("div",{className:"rounded-full bg-gradient-to-tr from-purple-500 to-pink-500 p-3 text-white shadow-lg",children:U.jsx(qs,{className:"h-5 w-5"})}),U.jsxs("div",{children:[U.jsx("p",{className:"text-[11px] uppercase tracking-wide text-purple-400",children:"World Map"}),U.jsx("h2",{className:"text-base font-semibold",children:"Select a realm"})]})]}),U.jsxs("div",{className:"space-y-2 overflow-y-auto pr-1",style:{maxHeight:"65vh"},children:[U.jsx("style",{children:"\n              .hide-scrollbar::-webkit-scrollbar { width: 0; height: 0; }\n              .hide-scrollbar { scrollbar-width: none; }\n            "}),U.jsx("div",{className:"hide-scrollbar",children:Ui.map(e=>{const t=r.id===e.id;return U.jsxs("button",{type:"button",onClick:()=>a(e),className:"mb-2 w-full rounded-2xl px-4 py-3 text-left transition-all "+(t?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg shadow-purple-500/30":s?"bg-white/5 text-white/70 hover:bg-white/10":"bg-white/85 text-slate-700 hover:bg-white"),children:[U.jsx("p",{className:"text-sm font-semibold",children:e.name}),U.jsx("p",{className:"mt-1 text-xs "+(t?"text-white/80":s?"text-white/50":"text-slate-500"),children:e.headline})]},e.id)})})]})]})]})]})},Oi={}.VITE_API_BASE_URL||"http://localhost:3003/api",Bi=async e=>{if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(t.error||"Request failed")}return e.json()},_i=({learningMaterial:t,onComplete:s,onSkip:r,isVisible:a=!0})=>{const[n,i]=e.useState(0),[o,l]=e.useState(!1);if(!a||!t)return null;const c=()=>{r&&r()};return U.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:U.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden shadow-xl",children:[U.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[U.jsxs("div",{className:"flex items-center space-x-3",children:[U.jsx(Pt,{className:"w-6 h-6 text-blue-600"}),U.jsxs("div",{children:[U.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Learning Material"}),U.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Please read the following content before starting the quest"})]})]}),U.jsx("button",{onClick:c,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:U.jsx(Rr,{className:"w-6 h-6"})})]}),U.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-200px)]",children:[U.jsx("div",{className:"flex items-center justify-between mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:U.jsxs("div",{className:"flex items-center space-x-4",children:[U.jsxs("div",{className:"flex items-center space-x-2",children:[U.jsx(Ht,{className:"w-4 h-4 text-blue-600"}),U.jsxs("span",{className:"text-sm text-blue-700 dark:text-blue-300",children:["Estimated reading time: ",t.readingTime]})]}),U.jsxs("div",{className:"flex items-center space-x-2",children:[U.jsx("div",{className:"w-32 bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:U.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${n}%`}})}),U.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[n,"%"]})]})]})}),U.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:t.title}),U.jsx("div",{className:"prose prose-lg max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:t.content.replace(/\n/g,"<br/>").replace(/#{1,6}\s/g,e=>{const t=e.trim().length;return`<h${t} class="text-${1===t?"3xl":2===t?"2xl":"xl"} font-bold mt-6 mb-3">`}).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>")}}),t.keyPoints&&t.keyPoints.length>0&&U.jsxs("div",{className:"mt-8 p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[U.jsx("h3",{className:"text-lg font-semibold text-yellow-800 dark:text-yellow-200 mb-3",children:"Key Learning Points"}),U.jsx("ul",{className:"space-y-2",children:t.keyPoints.map((e,t)=>U.jsxs("li",{className:"flex items-start space-x-2",children:[U.jsx($t,{className:"w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0"}),U.jsx("span",{className:"text-yellow-700 dark:text-yellow-300",children:e})]},t))})]})]}),U.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50",children:[U.jsx("div",{className:"flex items-center space-x-4",children:U.jsx("button",{onClick:c,className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",children:"Skip Learning"})}),U.jsxs("div",{className:"flex items-center space-x-3",children:[U.jsx("button",{onClick:()=>{l(!0),i(100)},className:"px-4 py-2 rounded-lg transition-colors "+(o?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-900/50"),children:o?" Read":"Mark as Read"}),U.jsx("button",{onClick:()=>{s&&s()},disabled:!o,className:"px-6 py-2 rounded-lg font-medium transition-colors "+(o?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-600 dark:text-gray-400"),children:"Start Quest"})]})]})]})})},zi=()=>{const{subject:t,category:s,questId:r}=Re(),a=qe(),n=Ie(),{isDark:i}=mt(),{showSuccess:o,showError:l}=Hr(),{user:c}=Br(),[d,x]=e.useState(null),[p,g]=e.useState(null),[b,f]=e.useState(0),[w,y]=e.useState(!1),[v,j]=e.useState(0),[N,k]=e.useState(!1),[S,C]=e.useState({}),[E,A]=e.useState(!0),[T,I]=e.useState(!1),[P,q]=e.useState(!1),[R,M]=e.useState(!1),[D,L]=e.useState(null),[F,$]=e.useState(""),[O,B]=e.useState(!1);e.useEffect(()=>{q(!1),I(!1),_()},[t,s,r]),e.useEffect(()=>{let e=null;return N?e=setInterval(()=>{j(e=>e+1)},1e3):N||clearInterval(e),()=>clearInterval(e)},[N]);const _=async()=>{var e,i;try{if(A(!0),!(null==c?void 0:c.id))return l("User not authenticated",3e3,"Error"),void a("/quest-academy");const o=await ta(c.id);g(o);let d=null;const u=(null==(e=n.state)?void 0:e.isAI)||!1;if(null==(i=n.state)?void 0:i.quest)d=n.state.quest,console.log("Using quest from location.state:",d,"isAI:",u);else if(u||"ai-generated"===s){const e=await(async(e,t)=>{try{const s=await fetch(`${Oi}/ai-quests/${e}?userId=${t}`);return{success:!0,quest:(await Bi(s)).quest}}catch(s){return console.error("Error fetching AI quest:",s),{success:!1,error:s.message}}})(r,c.id);e.success&&e.quest&&(d=e.quest,console.log("Loaded quest from AI quests:",d))}else{const e=await(async(e,t,s)=>{try{const r=await Xr({questId:e,subject:t,category:s});return r.success?{success:!0,quest:qi(r.quest)}:{success:!1,error:"Quest not found"}}catch(r){return console.error(" Error fetching approved quest:",r),{success:!1,error:r.message}}})(r,t,s);e.success&&e.quest?(d=e.quest,console.log("Loaded quest from approved quests:",d)):d=await ea(t,s,r)}if(d){if(d.questions&&Array.isArray(d.questions)){const e=d.questions.map((e,t)=>({id:`step-${t+1}`,title:`Question ${t+1}`,type:e.type,question:e.question,options:e.options||[],correctAnswer:void 0!==e.correctAnswer?e.correctAnswer:null,correctAnswers:e.correctAnswers||[],explanation:e.explanation||""}));d={...d,steps:e,xpReward:d.xpReward||100,goldReward:d.goldReward||50}}x(d),y(o.completedQuests.includes(r))}else l("Quest not found",3e3,"Error"),a("/quest-academy")}catch(o){console.error("Error loading quest:",o),l("Failed to load quest",3e3,"Error")}finally{A(!1)}},z=(e,t)=>{C(s=>({...s,[e]:t})),M(!1),L(null),$(""),B(!1)},W=async()=>{try{y(!0),k(!1);const e=50,n=25;console.log("Testing Firebase connection before saving...");const i=await di();if(console.log("Firebase connection test result:",i),!i)return console.error("Firebase connection failed!"),void l("Firebase connection failed",5e3,"Error");console.log("Testing user progress save...");const x=await ui(c.id);console.log("User progress save test result:",x);const p=(null==d?void 0:d.id)||r;console.log("Updating quest progress:",{userId:c.id,questId:p,subject:t,category:s,xpEarned:e,goldEarned:n});const g=await(async(e,t,s,r,a,n,i,o)=>{try{console.log("Starting quest progress update...");const c=await ta(e);console.log("Current progress:",c);const d=`${s}_${r}_${t}`;if(c.completedQuests&&(c.completedQuests.includes(t)||c.completedQuests.includes(d)))return console.log("Quest already completed, skipping update"),c;const x={...c,totalXP:(c.totalXP||0)+n,gold:(c.gold||0)+i,completedQuests:[...c.completedQuests||[],d],questHistory:[...c.questHistory||[],{questId:t,subject:s,category:r,questType:a,xpEarned:n,goldEarned:i,completedAt:(new Date).toISOString(),deliverables:o}]};console.log("Updated progress to save:",x),console.log("Attempting to save to Firebase studyprogress...");const p=u(dt,"studyprogress",e);console.log("Firebase document reference:",p),console.log("Data to save:",x);try{await h(p,x,{merge:!0}),console.log("Quest progress successfully saved to Firebase");const t=await m(p);console.log("Verification - saved document:",t.exists()?t.data():"Document not found");const s=await ra(e,x.totalXP),r=await ta(e),a={...s,currentStreak:r.currentStreak||0,longestStreak:r.longestStreak||0},n=await Qr(e,a);return n.newAchievements.length>0&&(s.achievements=n.allAchievements,s.newAchievements=n.newAchievements),s}catch(l){throw console.error("Firebase save error:",l),l}}catch(c){return console.error("Error updating quest progress:",c),{totalXP:(await ta(e)).totalXP+n,gold:(await ta(e)).gold+i,completedQuests:[...(await ta(e)).completedQuests,t]}}})(c.id,p,t,s,"quest",e,n,[]);if(console.log("Quest progress updated successfully"),g.newAchievements&&g.newAchievements.length>0){const e=g.newAchievements.map(e=>{var t;return(null==(t={first_quest:{id:"first_quest",name:"First Steps",description:"Complete your first quest",rarity:"common"},level_5:{id:"level_5",name:"Rising Star",description:"Reach level 5",rarity:"common"},level_10:{id:"level_10",name:"Experienced Learner",description:"Reach level 10",rarity:"rare"},level_20:{id:"level_20",name:"Knowledge Seeker",description:"Reach level 20",rarity:"rare"},level_30:{id:"level_30",name:"Master Scholar",description:"Reach level 30",rarity:"epic"},level_50:{id:"level_50",name:"Legendary Academic",description:"Reach level 50",rarity:"legendary"},gold_1000:{id:"gold_1000",name:"Wealthy Scholar",description:"Accumulate 1000 gold",rarity:"rare"},quest_master:{id:"quest_master",name:"Quest Master",description:"Complete 50 quests",rarity:"epic"},streak_7:{id:"streak_7",name:"Week Warrior",description:"Maintain a 7-day streak",rarity:"rare"},streak_30:{id:"streak_30",name:"Monthly Champion",description:"Maintain a 30-day streak",rarity:"epic"}}[e]||null)?void 0:t.name)||e}).join(", ");o(`Quest completed!  Unlocked: ${e}`,5e3,"Achievement Unlocked!")}else o("Quest completed! Great job!",3e3,"Quest Complete");window.dispatchEvent(new CustomEvent("questCompleted",{detail:{questId:r,subject:t,category:s,xpEarned:e,goldEarned:n}})),setTimeout(()=>{a("/quest-academy")},3e3)}catch(e){console.error("Error completing quest:",e),l("Failed to complete quest",3e3,"Error")}};if(E)return U.jsx("div",{className:"min-h-screen flex items-center justify-center "+(i?"bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900":"bg-gradient-to-br from-blue-50 via-white to-purple-50"),children:U.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600"})});if(!d)return U.jsx("div",{className:"min-h-screen flex items-center justify-center "+(i?"bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900":"bg-gradient-to-br from-blue-50 via-white to-purple-50"),children:U.jsxs("div",{className:"text-center",children:[U.jsx("h2",{className:"text-2xl font-bold mb-4 "+(i?"text-white":"text-gray-800"),children:"Quest not found"}),U.jsx("button",{onClick:()=>a("/quest-academy"),className:"px-6 py-3 rounded-xl font-medium transition-all duration-200 "+(i?"bg-white/10 text-white hover:bg-white/20 border border-white/20":"bg-white text-gray-800 hover:bg-gray-50 border border-gray-200"),children:"Back to Quest Academy"})]})});const H=d.steps&&d.steps.length>0?d.steps[b]:null;return U.jsxs("div",{className:"min-h-screen relative overflow-hidden "+(i?"bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900":"bg-gradient-to-br from-blue-50 via-white to-purple-50"),children:[T&&(null==d?void 0:d.learningMaterial)&&U.jsx(_i,{learningMaterial:d.learningMaterial,onComplete:()=>{I(!1),q(!0),k(!0),console.log("Learning material completed, quest started")},onSkip:()=>{var e;I(!1),q(!0),k(!0),console.log("Learning material skipped, quest started"),console.log("Quest data:",d),console.log("Quest steps:",null==d?void 0:d.steps),console.log("Quest steps length:",null==(e=null==d?void 0:d.steps)?void 0:e.length),console.log("Current step:",b),console.log("Is completed:",w)},isVisible:T}),U.jsx("div",{className:"absolute inset-0 overflow-hidden",children:i?U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"}),U.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"}),U.jsx("div",{className:"absolute top-40 left-40 w-60 h-60 bg-pink-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"}),U.jsx("div",{className:"absolute bottom-20 right-20 w-40 h-40 bg-cyan-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"})]}):U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-r from-purple-400 to-purple-600 rounded-full filter blur-xl opacity-40 animate-pulse shadow-2xl shadow-purple-300/50"}),U.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-r from-blue-400 to-blue-600 rounded-full filter blur-xl opacity-40 animate-pulse shadow-2xl shadow-blue-300/50"}),U.jsx("div",{className:"absolute top-40 left-40 w-60 h-60 bg-gradient-to-r from-pink-400 to-pink-600 rounded-full filter blur-xl opacity-40 animate-pulse shadow-2xl shadow-pink-300/50"}),U.jsx("div",{className:"absolute bottom-20 right-20 w-40 h-40 bg-gradient-to-r from-cyan-400 to-cyan-600 rounded-full filter blur-xl opacity-40 animate-pulse shadow-2xl shadow-cyan-300/50"})]})}),U.jsxs("div",{className:"relative z-10 max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[U.jsxs("div",{className:"mb-8",children:[U.jsxs("div",{className:"flex items-center justify-between mb-6",children:[U.jsxs("button",{onClick:()=>a("/quest-academy"),className:"flex items-center space-x-2 px-4 py-2 rounded-xl font-medium transition-all duration-200 "+(i?"bg-white/10 text-white hover:bg-white/20 border border-white/20":"bg-white text-gray-800 hover:bg-gray-50 border border-gray-200"),children:[U.jsx(wt,{className:"w-5 h-5"}),U.jsx("span",{children:"Back to Quest Academy"})]}),U.jsxs("div",{className:"flex items-center space-x-4 px-4 py-2 rounded-xl "+(i?"bg-white/10 border border-white/20":"bg-white border border-gray-200"),children:[U.jsx(Ht,{className:"w-5 h-5 "+(i?"text-white":"text-gray-600")}),U.jsx("span",{className:"font-mono text-lg font-bold "+(i?"text-white":"text-gray-800"),children:(e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`})(v)}),U.jsxs("div",{className:"flex space-x-2",children:[U.jsx("button",{onClick:()=>{k(!N)},className:"p-2 rounded-lg transition-all duration-200 "+(i?"bg-white/10 hover:bg-white/20 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-600"),children:N?U.jsx(zs,{className:"w-4 h-4"}):U.jsx(Vs,{className:"w-4 h-4"})}),U.jsx("button",{onClick:()=>{j(0),k(!1)},className:"p-2 rounded-lg transition-all duration-200 "+(i?"bg-white/10 hover:bg-white/20 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-600"),children:U.jsx(Xs,{className:"w-4 h-4"})})]})]})]}),U.jsxs("div",{className:"relative group rounded-3xl p-8 border-2 backdrop-blur-xl "+(i?"bg-gradient-to-br from-white/10 via-purple-500/10 to-white/10 border-purple-400/30 shadow-xl shadow-purple-500/10":"bg-white/90 border-purple-200/50 shadow-xl"),children:[U.jsxs("div",{className:"flex items-start space-x-6 mb-6",children:[U.jsx("div",{className:"text-5xl p-4 rounded-2xl "+(i?"bg-white/10":"bg-purple-50"),children:d.icon}),U.jsxs("div",{className:"flex-1",children:[U.jsx("h1",{className:"text-3xl font-bold mb-2 "+(i?"text-white":"text-gray-900"),children:d.title}),U.jsx("p",{className:"text-lg leading-relaxed "+(i?"text-white/80":"text-gray-600"),children:d.description})]})]}),U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsx("div",{className:"flex items-center space-x-6",children:U.jsxs("div",{className:"flex items-center space-x-2 px-4 py-2 rounded-xl "+(i?"bg-white/10":"bg-gray-100"),children:[U.jsx(ur,{className:"w-5 h-5 "+(i?"text-purple-400":"text-purple-600")}),U.jsx("span",{className:"font-semibold "+(i?"text-white":"text-gray-800"),children:d.difficulty.charAt(0).toUpperCase()+d.difficulty.slice(1)})]})}),U.jsxs("div",{className:"text-sm font-medium px-4 py-2 rounded-xl "+(i?"bg-white/10 text-white/90":"bg-gray-100 text-gray-700"),children:["Step ",b+1," of ",d.steps.length]})]})]})]}),U.jsxs("div",{className:"mb-8",children:[U.jsxs("div",{className:"flex items-center justify-between mb-2",children:[U.jsx("span",{className:"text-sm font-medium "+(i?"text-white/70":"text-gray-600"),children:"Progress"}),U.jsxs("span",{className:"text-sm font-semibold "+(i?"text-white":"text-gray-800"),children:[Math.round((b+1)/d.steps.length*100),"%"]})]}),U.jsx("div",{className:"w-full rounded-full h-2.5 overflow-hidden "+(i?"bg-white/10":"bg-gray-200"),children:U.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 transition-all duration-500 shadow-lg shadow-purple-500/30",style:{width:(b+1)/d.steps.length*100+"%"}})})]}),d.steps&&d.steps.length>0?U.jsxs("div",{className:"relative group rounded-3xl p-8 border-2 backdrop-blur-xl "+(i?"bg-gradient-to-br from-white/10 via-purple-500/10 to-white/10 border-purple-400/30 shadow-xl shadow-purple-500/10":"bg-white/90 border-purple-200/50 shadow-xl"),children:[U.jsx("div",{className:"mb-8",children:U.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-xl mb-4 "+(i?"bg-white/10":"bg-purple-50"),children:[U.jsx(ur,{className:"w-5 h-5 "+(i?"text-purple-400":"text-purple-600")}),U.jsx("h2",{className:"text-xl font-bold "+(i?"text-white":"text-gray-900"),children:H.title})]})}),(e=>{switch(e.type){case"multiple-choice":return U.jsxs("div",{className:"space-y-6",children:[U.jsxs("div",{className:"rounded-3xl border-2 p-8 shadow-xl backdrop-blur-xl "+(i?"border-purple-400/30 bg-gradient-to-br from-purple-500/20 via-pink-500/15 to-blue-500/20":"border-purple-200 bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50"),children:[U.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[U.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-2xl flex items-center justify-center bg-gradient-to-br from-purple-500 to-pink-500 text-white shadow-lg",children:U.jsx(ur,{className:"w-6 h-6"})}),U.jsx("div",{className:"flex-1",children:U.jsx("h3",{className:"text-2xl font-bold "+(i?"text-white":"text-slate-900"),children:e.question})})]}),U.jsx("div",{className:"space-y-3",children:e.options.map((t,s)=>{const r=S[e.id]===s,a=s===e.correctAnswer,n=R;return U.jsx("button",{onClick:()=>z(e.id,s),disabled:n,className:`relative w-full p-5 rounded-2xl border-2 transition-all duration-300 text-left group ${n?a?i?"border-green-400/50 bg-gradient-to-r from-green-500/30 to-emerald-500/30 text-green-100 shadow-lg shadow-green-500/20":"border-green-400 bg-gradient-to-r from-green-100 to-emerald-100 text-green-800 shadow-lg shadow-green-200":r?i?"border-red-400/50 bg-gradient-to-r from-red-500/30 to-orange-500/30 text-red-100 shadow-lg shadow-red-500/20":"border-red-400 bg-gradient-to-r from-red-100 to-orange-100 text-red-800 shadow-lg shadow-red-200":i?"border-white/10 bg-white/5 text-white/60":"border-gray-200 bg-white text-gray-500":r?i?"border-purple-400/50 bg-gradient-to-r from-purple-500/30 to-pink-500/30 text-white shadow-lg shadow-purple-500/30 hover:shadow-xl hover:shadow-purple-500/40":"border-purple-400 bg-gradient-to-r from-purple-100 to-pink-100 text-purple-900 shadow-lg shadow-purple-200 hover:shadow-xl hover:shadow-purple-300":i?"border-white/20 bg-white/5 hover:border-purple-400/50 hover:bg-white/10 text-white hover:shadow-lg hover:shadow-purple-500/20":"border-gray-200 bg-white hover:border-purple-300 hover:bg-purple-50 text-slate-800 hover:shadow-lg hover:shadow-purple-200"} disabled:opacity-70 disabled:cursor-not-allowed`,children:U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-xl flex items-center justify-center font-bold text-lg transition-all "+(n?a?"bg-green-500 text-white":r?"bg-red-500 text-white":i?"bg-white/10 text-white/40":"bg-gray-200 text-gray-400":r?"bg-purple-500 text-white":i?"bg-white/10 text-white/70":"bg-gray-100 text-slate-600"),children:String.fromCharCode(65+s)}),U.jsx("span",{className:"flex-1 font-semibold text-lg "+(n&&a?i?"text-green-200":"text-green-800":n&&r&&!a?i?"text-red-200":"text-red-800":r?i?"text-white":"text-purple-900":i?"text-white":"text-slate-800"),children:t}),n&&a&&U.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center bg-green-500 text-white",children:U.jsx($t,{className:"w-5 h-5"})}),n&&r&&!a&&U.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center bg-red-500 text-white",children:U.jsx(Rr,{className:"w-5 h-5"})}),!n&&r&&U.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center bg-purple-500 text-white",children:U.jsx($t,{className:"w-5 h-5"})})]})},s)})})]}),R&&U.jsx("div",{className:"rounded-2xl border-2 p-6 shadow-xl backdrop-blur-xl transition-all duration-300 "+(D?i?"border-green-400/50 bg-gradient-to-br from-green-500/20 to-emerald-500/20":"border-green-400 bg-gradient-to-br from-green-50 to-emerald-50":i?"border-red-400/50 bg-gradient-to-br from-red-500/20 to-orange-500/20":"border-red-400 bg-gradient-to-br from-red-50 to-orange-50"),children:U.jsxs("div",{className:"flex items-start gap-4",children:[D?U.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-2xl flex items-center justify-center bg-gradient-to-br from-green-500 to-emerald-500 text-white shadow-lg",children:U.jsx($t,{className:"w-6 h-6"})}):U.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-2xl flex items-center justify-center bg-gradient-to-br from-red-500 to-orange-500 text-white shadow-lg",children:U.jsx(Rr,{className:"w-6 h-6"})}),U.jsxs("div",{className:"flex-1",children:[U.jsx("h4",{className:"text-xl font-bold mb-2 "+(D?i?"text-green-300":"text-green-700":i?"text-red-300":"text-red-700"),children:D?"Excellent! Correct Answer!":"Not quite right"}),F&&U.jsx("p",{className:"text-base leading-relaxed "+(i?"text-white/80":"text-slate-700"),children:F}),!D&&e.options&&U.jsxs("div",{className:"mt-4 p-4 rounded-xl "+(i?"bg-white/10":"bg-white"),children:[U.jsx("p",{className:"text-sm font-semibold mb-2 "+(i?"text-white/90":"text-slate-700"),children:"The correct answer is:"}),U.jsxs("p",{className:"text-lg font-bold "+(i?"text-green-300":"text-green-700"),children:[String.fromCharCode(65+e.correctAnswer),". ",e.options[e.correctAnswer]]})]})]})]})})]});case"fill-in-blank":return U.jsxs("div",{className:"space-y-6",children:[U.jsxs("div",{className:"rounded-3xl border-2 p-8 shadow-xl backdrop-blur-xl "+(i?"border-purple-400/30 bg-gradient-to-br from-purple-500/20 via-pink-500/15 to-blue-500/20":"border-purple-200 bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50"),children:[U.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[U.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-2xl flex items-center justify-center bg-gradient-to-br from-purple-500 to-pink-500 text-white shadow-lg",children:U.jsx(ur,{className:"w-6 h-6"})}),U.jsxs("div",{className:"flex-1",children:[U.jsx("h3",{className:"text-2xl font-bold mb-2 "+(i?"text-white":"text-slate-900"),children:e.question}),e.correctAnswers&&e.correctAnswers.length>0&&U.jsxs("p",{className:"text-sm flex items-center gap-2 "+(i?"text-white/70":"text-slate-600"),children:[U.jsx($t,{className:"w-4 h-4"}),"Multiple correct answers accepted (case-insensitive)"]})]})]}),U.jsxs("div",{className:"relative",children:[U.jsx("div",{className:`absolute inset-0 rounded-2xl blur-xl opacity-50 ${S[e.id]?i?"bg-gradient-to-r from-purple-500 to-pink-500":"bg-gradient-to-r from-purple-400 to-pink-400":""} transition-all duration-300`}),U.jsx("input",{type:"text",value:S[e.id]||"",onChange:t=>z(e.id,t.target.value),placeholder:"Type your answer here...",className:"relative w-full p-6 rounded-2xl border-2 text-lg font-medium transition-all duration-300 "+(i?S[e.id]?"border-purple-400/50 bg-white/10 text-white placeholder-white/40 focus:border-purple-400 focus:bg-white/15 focus:shadow-lg focus:shadow-purple-500/30":"border-white/20 bg-white/5 text-white placeholder-white/40 focus:border-purple-400 focus:bg-white/10":S[e.id]?"border-purple-400 bg-white text-slate-900 placeholder-gray-400 focus:border-purple-500 focus:shadow-lg focus:shadow-purple-200":"border-gray-200 bg-white text-slate-900 placeholder-gray-400 focus:border-purple-400 focus:bg-purple-50"),autoFocus:!0}),S[e.id]&&U.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 "+(i?"text-purple-400":"text-purple-600"),children:U.jsx($t,{className:"w-6 h-6"})})]})]}),R&&U.jsx("div",{className:"rounded-2xl border-2 p-6 shadow-xl backdrop-blur-xl transition-all duration-300 "+(D?i?"border-green-400/50 bg-gradient-to-br from-green-500/20 to-emerald-500/20":"border-green-400 bg-gradient-to-br from-green-50 to-emerald-50":i?"border-red-400/50 bg-gradient-to-br from-red-500/20 to-orange-500/20":"border-red-400 bg-gradient-to-br from-red-50 to-orange-50"),children:U.jsxs("div",{className:"flex items-start gap-4",children:[D?U.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-2xl flex items-center justify-center bg-gradient-to-br from-green-500 to-emerald-500 text-white shadow-lg",children:U.jsx($t,{className:"w-6 h-6"})}):U.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-2xl flex items-center justify-center bg-gradient-to-br from-red-500 to-orange-500 text-white shadow-lg",children:U.jsx(Rr,{className:"w-6 h-6"})}),U.jsxs("div",{className:"flex-1",children:[U.jsx("h4",{className:"text-xl font-bold mb-2 "+(D?i?"text-green-300":"text-green-700":i?"text-red-300":"text-red-700"),children:D?"Correct!":"Incorrect"}),F&&U.jsx("p",{className:"text-base leading-relaxed "+(i?"text-white/80":"text-slate-700"),children:F}),!D&&e.correctAnswers&&e.correctAnswers.length>0&&U.jsxs("div",{className:"mt-4 p-4 rounded-xl "+(i?"bg-white/10":"bg-white"),children:[U.jsx("p",{className:"text-sm font-semibold mb-2 "+(i?"text-white/90":"text-slate-700"),children:"Correct answers:"}),U.jsx("div",{className:"flex flex-wrap gap-2",children:e.correctAnswers.map((e,t)=>U.jsx("span",{className:"px-3 py-1.5 rounded-lg text-sm font-medium "+(i?"bg-green-500/30 text-green-300 border border-green-400/50":"bg-green-100 text-green-700 border border-green-300"),children:e},t))})]})]})]})})]});case"text-input":return U.jsxs("div",{className:"space-y-4",children:[U.jsx("p",{className:"text-lg font-medium "+(i?"text-white":"text-gray-800"),children:e.question}),U.jsx("textarea",{value:S[e.id]||"",onChange:t=>z(e.id,t.target.value),placeholder:"Type your answer here...",className:"w-full p-4 rounded-xl border-2 transition-all duration-200 resize-none "+(i?"border-white/20 bg-white/5 text-white placeholder-gray-400 focus:border-blue-400 focus:bg-white/10":"border-gray-200 bg-white text-gray-800 placeholder-gray-400 focus:border-blue-500 focus:bg-gray-50"),rows:4})]});case"essay":return U.jsxs("div",{className:"space-y-4",children:[U.jsx("p",{className:"text-lg font-medium "+(i?"text-white":"text-gray-800"),children:e.question}),U.jsx("div",{className:"p-3 rounded-lg "+(i?"bg-yellow-500/20 border border-yellow-400/30":"bg-yellow-50 border border-yellow-200"),children:U.jsxs("p",{className:"text-sm "+(i?"text-yellow-300":"text-yellow-700"),children:["Minimum ",e.minWords," words required"]})}),U.jsx("textarea",{value:S[e.id]||"",onChange:t=>z(e.id,t.target.value),placeholder:"Write your essay here...",className:"w-full p-4 rounded-xl border-2 transition-all duration-200 resize-none "+(i?"border-white/20 bg-white/5 text-white placeholder-gray-400 focus:border-blue-400 focus:bg-white/10":"border-gray-200 bg-white text-gray-800 placeholder-gray-400 focus:border-blue-500 focus:bg-gray-50"),rows:8}),U.jsxs("div",{className:"text-sm "+(i?"text-gray-400":"text-gray-600"),children:["Word count: ",(S[e.id]||"").split(" ").filter(e=>e.length>0).length]})]});default:return U.jsx("div",{children:"Unknown step type"})}})(H),U.jsxs("div",{className:"flex items-center justify-between mt-8",children:[U.jsx("button",{onClick:()=>{b>0&&f(b-1)},disabled:0===b,className:"px-6 py-3 rounded-xl font-medium transition-all duration-200 "+(0===b?i?"bg-white/5 text-gray-500 cursor-not-allowed":"bg-gray-100 text-gray-400 cursor-not-allowed":i?"bg-white/10 text-white hover:bg-white/20 border border-white/20":"bg-white text-gray-800 hover:bg-gray-50 border border-gray-200"),children:"Previous"}),O?U.jsx("button",{onClick:()=>{var e;const t=null==(e=null==d?void 0:d.steps)?void 0:e[b];t&&C(e=>{const s={...e};return delete s[t.id],s}),M(!1),L(null),$(""),B(!1)},className:"px-6 py-3 rounded-xl font-medium transition-all duration-200 bg-gradient-to-r from-orange-500 to-red-500 text-white hover:from-orange-600 hover:to-red-600",children:"Restart"}):U.jsx("button",{onClick:()=>{var e;console.log("handleNextStep called:",{currentStep:b,stepsLength:d.steps.length});const t=null==(e=null==d?void 0:d.steps)?void 0:e[b];if(!t)return void console.error("No current step data found");const s=S[t.id];if(null==s||""===s){const e="fill-in-blank"===t.type?"Please enter an answer before proceeding":"Please select an answer before proceeding";return void l(e,3e3,"Error")}let r=!1;if("multiple-choice"===t.type)r=s===t.correctAnswer;else if("fill-in-blank"===t.type){const e=String(s).trim().toLowerCase();r=(t.correctAnswers||[]).map(e=>String(e).trim().toLowerCase()).includes(e)}else"text-input"!==t.type&&"essay"!==t.type||(r=!0);if(L(r),$(t.explanation||""),M(!0),!r)return l("Incorrect answer! Please review the explanation and try again",3e3,"Error"),void B(!0);o("Correct answer!",2e3,"Success"),setTimeout(()=>{M(!1),L(null),$(""),d.steps&&d.steps.length>0&&b<d.steps.length-1?f(b+1):d.steps&&d.steps.length>0?W():(console.error("Quest has no steps or steps is empty!",d),alert("Quest data error: No questions found. Please refresh the page and try again."))},2e3)},className:"px-6 py-3 rounded-xl font-medium transition-all duration-200 bg-gradient-to-r from-blue-500 to-purple-500 text-white hover:from-blue-600 hover:to-purple-600",children:b===d.steps.length-1?"Complete Quest":"Next Step"})]})]}):U.jsx("div",{className:"relative group rounded-3xl p-8 border-2 "+(i?"bg-white/10 border-white/20":"bg-white/90 border-white/20 shadow-xl"),children:U.jsxs("div",{className:"text-center",children:[U.jsx("h2",{className:"text-2xl font-bold mb-4 "+(i?"text-white":"text-gray-800"),children:"Quest Data Error"}),U.jsx("p",{className:"text-lg "+(i?"text-gray-300":"text-gray-600"),children:"This quest has no question data. Please refresh the page and try again."}),U.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"Refresh Page"})]})}),w&&U.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:U.jsx("div",{className:"relative group rounded-3xl p-10 border-2 max-w-lg w-full mx-4 shadow-2xl "+(i?"bg-gradient-to-br from-slate-800/95 via-purple-900/95 to-slate-800/95 border-purple-400/30":"bg-white border-purple-200 shadow-purple-200/50"),children:U.jsxs("div",{className:"text-center",children:[U.jsxs("div",{className:"relative mb-6",children:[U.jsx("div",{className:"w-24 h-24 mx-auto rounded-full flex items-center justify-center "+(i?"bg-gradient-to-br from-green-500 to-emerald-500 shadow-lg shadow-green-500/50":"bg-gradient-to-br from-green-500 to-emerald-500 shadow-lg shadow-green-200"),children:U.jsx($t,{className:"w-12 h-12 text-white"})}),U.jsx("div",{className:`absolute inset-0 rounded-full border-4 ${i?"border-green-400/30":"border-green-300/50"} animate-ping`,style:{animationDuration:"2s"}})]}),U.jsx("h3",{className:"text-3xl font-bold mb-3 "+(i?"text-white":"text-gray-900"),children:"Quest Completed!"}),U.jsx("p",{className:"text-lg mb-6 "+(i?"text-white/80":"text-gray-600"),children:"Congratulations! You've successfully completed this quest."}),U.jsxs("div",{className:"flex items-center justify-center gap-2 mb-6",children:[U.jsx("div",{className:`h-1 w-1 rounded-full ${i?"bg-white/40":"bg-gray-300"} animate-pulse`,style:{animationDelay:"0s"}}),U.jsx("div",{className:`h-1 w-1 rounded-full ${i?"bg-white/40":"bg-gray-300"} animate-pulse`,style:{animationDelay:"0.2s"}}),U.jsx("div",{className:`h-1 w-1 rounded-full ${i?"bg-white/40":"bg-gray-300"} animate-pulse`,style:{animationDelay:"0.4s"}})]}),U.jsx("p",{className:"text-sm "+(i?"text-white/60":"text-gray-500"),children:"Returning to Quest Academy in 3 seconds..."})]})})})]})]})},Wi=[{id:"italian",name:"Italian Language"},{id:"english",name:"English Language"},{id:"spanish",name:"Spanish Language"},{id:"french",name:"French Language"},{id:"german",name:"German Language"},{id:"mandarin",name:"Mandarin Chinese"},{id:"business",name:"Business & Entrepreneurship"},{id:"philosophy",name:"Philosophy"},{id:"mathematics",name:"Mathematics"},{id:"computerScience",name:"Computer Science"},{id:"chemistry",name:"Chemistry"},{id:"biology",name:"Biology"},{id:"history",name:"History"},{id:"geography",name:"Geography"}],Hi=[{value:"beginner",label:"Beginner"},{value:"intermediate",label:"Intermediate"},{value:"advanced",label:"Advanced"}],Gi=({isOpen:t,onClose:s,onQuestGenerated:r})=>{const{isDark:a}=mt(),{user:n}=Br(),{showSuccess:i,showError:o}=Hr(),[l,c]=e.useState(""),[d,u]=e.useState(""),[h,m]=e.useState("beginner"),[x,p]=e.useState(5),[g,b]=e.useState(!1),[f,w]=e.useState(""),[y,v]=e.useState(0),j=e.useRef(null);if(e.useEffect(()=>()=>{j.current&&clearInterval(j.current)},[]),!t)return null;return U.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[U.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:s}),U.jsxs("div",{className:"relative w-full max-w-2xl rounded-2xl border shadow-2xl "+(a?"border-white/10 bg-gradient-to-br from-[#1a1240] to-[#09071b]":"border-gray-200 bg-white"),children:[U.jsxs("div",{className:"flex items-center justify-between p-6 border-b "+(a?"border-white/10":"border-gray-200"),children:[U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx("div",{className:"p-2 rounded-lg "+(a?"bg-purple-500/20":"bg-purple-100"),children:U.jsx(nr,{className:"h-5 w-5 "+(a?"text-purple-400":"text-purple-600")})}),U.jsxs("div",{children:[U.jsx("h2",{className:"text-xl font-bold "+(a?"text-white":"text-slate-900"),children:"AI Generate Quest"}),U.jsx("p",{className:"text-sm "+(a?"text-white/70":"text-slate-600"),children:"Let AI create personalized questions for you"})]})]}),U.jsx("button",{onClick:s,className:"p-2 rounded-lg transition "+(a?"hover:bg-white/10 text-white/70 hover:text-white":"hover:bg-gray-100 text-gray-500 hover:text-gray-700"),children:U.jsx(Rr,{className:"h-5 w-5"})})]}),g&&U.jsx("div",{className:"absolute inset-0 rounded-2xl flex flex-col items-center justify-center "+(a?"bg-[#1a1240]/95 backdrop-blur-sm":"bg-white/95 backdrop-blur-sm"),children:U.jsxs("div",{className:"text-center space-y-4 px-8",children:[U.jsxs("div",{className:"relative",children:[U.jsx(Es,{className:"h-16 w-16 mx-auto animate-spin "+(a?"text-purple-400":"text-purple-600")}),U.jsx(nr,{className:`absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 h-8 w-8 ${a?"text-purple-300":"text-purple-500"} animate-pulse`})]}),U.jsxs("div",{children:[U.jsx("h3",{className:"text-xl font-bold mb-2 "+(a?"text-white":"text-slate-900"),children:f||"Generating..."}),U.jsx("p",{className:"text-sm "+(a?"text-white/70":"text-slate-600"),children:"Usually takes 10-30 seconds, please wait..."}),y>0&&U.jsxs("p",{className:"text-xs mt-2 "+(a?"text-white/50":"text-gray-500"),children:["Elapsed time: ",y,"s"]})]}),U.jsx("div",{className:"w-64 h-1 rounded-full overflow-hidden "+(a?"bg-white/10":"bg-gray-200"),children:U.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-pink-500 transition-all duration-300 "+(y>0?"animate-pulse":""),style:{width:`${Math.min(y/30*100,90)}%`}})})]})}),U.jsxs("div",{className:"p-6 space-y-6 "+(g?"opacity-30 pointer-events-none":""),children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(a?"text-white/80":"text-slate-700"),children:"Subject *"}),U.jsxs("select",{value:l,onChange:e=>c(e.target.value),className:"w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-purple-500 focus:border-transparent "+(a?"bg-white/10 border-white/20 text-white":"bg-white border-gray-300 text-slate-900"),required:!0,children:[U.jsx("option",{value:"",children:"Select a subject"}),Wi.map(e=>U.jsx("option",{value:e.id,children:e.name},e.id))]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(a?"text-white/80":"text-slate-700"),children:"What do you want to learn? *"}),U.jsx("textarea",{value:d,onChange:e=>u(e.target.value),placeholder:"e.g., Italian verb conjugations in present tense, or basic algebra equations, or World War II events...",rows:4,className:"w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none "+(a?"bg-white/10 border-white/20 text-white placeholder-white/50":"bg-white border-gray-300 text-slate-900 placeholder-gray-400"),required:!0}),U.jsx("p",{className:"mt-1 text-xs "+(a?"text-white/50":"text-gray-500"),children:"Describe the topic or concept you want to practice. Be as specific as possible."})]}),U.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(a?"text-white/80":"text-slate-700"),children:"Difficulty"}),U.jsx("select",{value:h,onChange:e=>m(e.target.value),className:"w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-purple-500 focus:border-transparent "+(a?"bg-white/10 border-white/20 text-white":"bg-white border-gray-300 text-slate-900"),children:Hi.map(e=>U.jsx("option",{value:e.value,children:e.label},e.value))})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(a?"text-white/80":"text-slate-700"),children:"Number of Questions"}),U.jsx("select",{value:x,onChange:e=>p(parseInt(e.target.value)),className:"w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-purple-500 focus:border-transparent "+(a?"bg-white/10 border-white/20 text-white":"bg-white border-gray-300 text-slate-900"),children:[3,5,7,10].map(e=>U.jsxs("option",{value:e,children:[e," questions"]},e))})]})]})]}),U.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t "+(a?"border-white/10":"border-gray-200"),children:[U.jsx("button",{onClick:s,disabled:g,className:`px-4 py-2 rounded-xl font-semibold transition ${a?"bg-white/10 text-white hover:bg-white/20":"bg-gray-100 text-slate-700 hover:bg-gray-200"} disabled:opacity-50`,children:"Cancel"}),U.jsx("button",{onClick:async()=>{if(!n)return void o("Please log in to generate AI quests","Authentication Required");if(!l)return void o("Please select a subject","Validation Error");if(!d.trim())return void o("Please enter a description of what you want to learn","Validation Error");if(d.trim().length<10)return void o("Please provide a more detailed description (at least 10 characters)","Validation Error");b(!0),v(0),w("Connecting to AI service...");const e=Date.now();j.current=setInterval(()=>{const t=Math.floor((Date.now()-e)/1e3);v(t),w(t<5?"Analyzing your requirements...":t<10?"AI is generating questions...":t<20?"Optimizing question content...":"Almost done, please wait...")},1e3);try{const t=await(async(e,t,s,r,a="beginner",n=5)=>{try{console.log(" [AI Quest Service] Generating quest:",{userId:e,subject:s,prompt:r,difficulty:a,questionCount:n});const i=await fetch(`${Oi}/ai-quests/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,userName:t,subject:s,prompt:r,difficulty:a,questionCount:n})}),o=await Bi(i);return console.log(" [AI Quest Service] Quest generated successfully:",o.questId),{success:!0,quest:o.quest,questId:o.questId}}catch(i){return console.error(" [AI Quest Service] Error generating quest:",i),{success:!1,error:i.message||"Failed to generate AI quest"}}})(n.id,n.name||n.email,l,d.trim(),h,x);if(j.current&&(clearInterval(j.current),j.current=null),t.success){const a=Math.floor((Date.now()-e)/1e3);i(`AI quest generated successfully! Took ${a}s`,"Success"),r&&r(t.quest),c(""),u(""),m("beginner"),p(5),s()}else o(t.error||"Failed to generate quest","Error")}catch(t){console.error("Error generating AI quest:",t),j.current&&(clearInterval(j.current),j.current=null),o("An error occurred while generating the quest","Error")}finally{b(!1),w(""),v(0)}},disabled:g||!l||!d.trim(),className:"inline-flex items-center gap-2 px-6 py-2 rounded-xl font-semibold transition shadow-lg bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600 disabled:opacity-50 disabled:cursor-not-allowed",children:g?U.jsxs(U.Fragment,{children:[U.jsx(Es,{className:"h-5 w-5 animate-spin"}),"Generating..."]}):U.jsxs(U.Fragment,{children:[U.jsx(nr,{className:"h-5 w-5"}),"Generate Quest"]})})]})]})]})},Vi=[{id:"italian",name:"Italian Language"},{id:"english",name:"English Language"},{id:"spanish",name:"Spanish Language"},{id:"french",name:"French Language"},{id:"german",name:"German Language"},{id:"mandarin",name:"Mandarin Chinese"},{id:"business",name:"Business & Entrepreneurship"},{id:"philosophy",name:"Philosophy"},{id:"mathematics",name:"Mathematics"},{id:"computerScience",name:"Computer Science"},{id:"chemistry",name:"Chemistry"},{id:"biology",name:"Biology"},{id:"history",name:"History"},{id:"geography",name:"Geography"}],Yi=[{value:"beginner",label:"Beginner",color:"green"},{value:"intermediate",label:"Intermediate",color:"yellow"},{value:"advanced",label:"Advanced",color:"red"}],Qi=()=>{const t=qe(),{isDark:s}=mt(),{user:r}=Br(),{showError:a,showSuccess:n}=Hr(),[i,o]=e.useState([]),[l,c]=e.useState([]),[d,u]=e.useState([]),[h,m]=e.useState(!0),[x,p]=e.useState(""),[g,b]=e.useState("all"),[f,w]=e.useState("all"),[y,v]=e.useState(!1),[j,N]=e.useState("public");e.useEffect(()=>{k(),(null==r?void 0:r.id)&&S()},[r]),e.useEffect(()=>{E()},[i,l,x,g,f,j]),e.useEffect(()=>{E()},[i,x,g,f]);const k=async()=>{m(!0);try{const e=await Li();e.success?o(e.quests||[]):a(e.error||"Failed to load quests","Error")}catch(e){console.error("Error loading quests:",e),a("An error occurred while loading quests","Error")}finally{m(!1)}},S=async()=>{if(null==r?void 0:r.id)try{const e=await(async e=>{try{const t=await fetch(`${Oi}/ai-quests/user/${e}`);return{success:!0,quests:(await Bi(t)).quests||[]}}catch(t){return console.error("Error fetching user AI quests:",t),{success:!1,error:t.message,quests:[]}}})(r.id);e.success&&c(e.quests||[])}catch(e){console.error("Error loading AI quests:",e)}},C=async(e,t)=>{if(t.stopPropagation(),window.confirm("Are you sure you want to delete this AI-generated quest?"))try{const t=await(async(e,t)=>{try{const s=await fetch(`${Oi}/ai-quests/${e}?userId=${t}`,{method:"DELETE"});return await Bi(s),{success:!0}}catch(s){return console.error("Error deleting AI quest:",s),{success:!1,error:s.message}}})(e,r.id);t.success?(n("Quest deleted successfully","Success"),S()):a(t.error||"Failed to delete quest","Error")}catch(s){console.error("Error deleting AI quest:",s),a("An error occurred while deleting the quest","Error")}},E=()=>{let e=[..."my-ai"===j?l:i];if(x){const t=x.toLowerCase();e=e.filter(e=>{var s,r,a;return(null==(s=e.title)?void 0:s.toLowerCase().includes(t))||(null==(r=e.description)?void 0:r.toLowerCase().includes(t))||(null==(a=e.createdByName)?void 0:a.toLowerCase().includes(t))})}"all"!==g&&(e=e.filter(e=>e.subject===g)),"all"!==f&&(e=e.filter(e=>e.difficulty===f)),u(e)},A=e=>{const t=Yi.find(t=>t.value===e);if(!t)return"gray";if(s)switch(t.color){case"green":return"bg-green-500/20 text-green-400 border-green-400/30";case"yellow":return"bg-yellow-500/20 text-yellow-400 border-yellow-400/30";case"red":return"bg-red-500/20 text-red-400 border-red-400/30";default:return"bg-gray-500/20 text-gray-400 border-gray-400/30"}else switch(t.color){case"green":return"bg-green-100 text-green-700 border-green-200";case"yellow":return"bg-yellow-100 text-yellow-700 border-yellow-200";case"red":return"bg-red-100 text-red-700 border-red-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}};return U.jsxs("div",{className:"min-h-screen relative overflow-hidden "+(s?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:[U.jsx("style",{children:"\n        .hide-scrollbar::-webkit-scrollbar { width: 0; height: 0; }\n        .hide-scrollbar { scrollbar-width: none; }\n      "}),U.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[U.jsx("div",{className:"absolute -top-36 left-1/2 h-80 w-80 -translate-x-1/2 rounded-full bg-purple-500/30 blur-3xl"}),U.jsx("div",{className:"absolute top-1/2 right-12 h-64 w-64 rounded-full bg-pink-400/25 blur-[120px]"}),U.jsx("div",{className:"absolute bottom-10 left-10 h-60 w-60 rounded-full bg-blue-400/20 blur-[120px]"})]}),U.jsxs("div",{className:"relative z-10 mx-auto flex w-full max-w-6xl flex-col gap-8 px-6 py-14 hide-scrollbar",children:[U.jsxs("div",{className:"flex items-center justify-between mb-4",children:[U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx("button",{onClick:()=>t("/quest-academy"),className:"p-3 rounded-xl transition-all "+(s?"bg-white/10 text-white hover:bg-white/20":"bg-white text-slate-700 hover:bg-slate-50 shadow-sm"),children:U.jsx(wt,{className:"h-5 w-5"})}),U.jsxs("div",{children:[U.jsx("h1",{className:"text-3xl font-black tracking-tight "+(s?"text-white":"text-slate-900"),children:"Study Quests"}),U.jsx("p",{className:"mt-1 text-sm "+(s?"text-white/70":"text-slate-600"),children:"Explore quests created by the community"})]})]}),U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsxs("button",{onClick:()=>t("/homework-helper"),className:"inline-flex items-center gap-2 px-5 py-3 rounded-xl font-semibold transition shadow-lg bg-gradient-to-r from-orange-500 to-rose-500 text-white hover:from-orange-600 hover:to-rose-600",children:[U.jsx(It,{className:"h-5 w-5"}),"Homework Helper"]}),U.jsxs("button",{onClick:()=>v(!0),className:"inline-flex items-center gap-2 px-5 py-3 rounded-xl font-semibold transition shadow-lg bg-gradient-to-r from-blue-500 to-cyan-500 text-white hover:from-blue-600 hover:to-cyan-600",children:[U.jsx(nr,{className:"h-5 w-5"}),"AI Generate"]}),U.jsxs("button",{onClick:()=>t("/create-quest"),className:"inline-flex items-center gap-2 px-5 py-3 rounded-xl font-semibold transition shadow-lg bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600",children:[U.jsx(Ys,{className:"h-5 w-5"}),"Create Quest"]})]})]}),r&&U.jsxs("div",{className:"flex gap-2 rounded-xl border p-1 "+(s?"border-white/10 bg-white/5":"border-gray-200 bg-gray-50"),children:[U.jsx("button",{onClick:()=>N("public"),className:"flex-1 px-4 py-2 rounded-lg font-semibold transition "+("public"===j?s?"bg-purple-500/20 text-purple-400 border border-purple-400/30":"bg-purple-100 text-purple-700 border border-purple-200":s?"text-white/70 hover:text-white":"text-gray-600 hover:text-gray-900"),children:"Public Quests"}),U.jsx("button",{onClick:()=>N("my-ai"),className:"flex-1 px-4 py-2 rounded-lg font-semibold transition "+("my-ai"===j?s?"bg-blue-500/20 text-blue-400 border border-blue-400/30":"bg-blue-100 text-blue-700 border border-blue-200":s?"text-white/70 hover:text-white":"text-gray-600 hover:text-gray-900"),children:U.jsxs("span",{className:"flex items-center justify-center gap-2",children:[U.jsx(nr,{className:"h-4 w-4"}),"My AI Quests (",l.length,")"]})})]}),U.jsx("div",{className:"rounded-[32px] border px-6 py-6 shadow-2xl backdrop-blur-xl "+(s?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:U.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[U.jsxs("div",{className:"relative",children:[U.jsx(er,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 "+(s?"text-white/50":"text-gray-400")}),U.jsx("input",{type:"text",placeholder:"Search quests...",value:x,onChange:e=>p(e.target.value),className:"w-full pl-10 pr-4 py-3 rounded-xl border focus:ring-2 focus:ring-purple-500 focus:border-transparent "+(s?"bg-white/10 border-white/20 text-white placeholder-white/50":"bg-white border-gray-300 text-slate-900 placeholder-gray-400")})]}),U.jsxs("select",{value:g,onChange:e=>b(e.target.value),className:"px-4 py-3 rounded-xl border focus:ring-2 focus:ring-purple-500 focus:border-transparent "+(s?"bg-white/10 border-white/20 text-white":"bg-white border-gray-300 text-slate-900"),children:[U.jsx("option",{value:"all",children:"All Subjects"}),Vi.map(e=>U.jsx("option",{value:e.id,children:e.name},e.id))]}),U.jsxs("select",{value:f,onChange:e=>w(e.target.value),className:"px-4 py-3 rounded-xl border focus:ring-2 focus:ring-purple-500 focus:border-transparent "+(s?"bg-white/10 border-white/20 text-white":"bg-white border-gray-300 text-slate-900"),children:[U.jsx("option",{value:"all",children:"All Difficulties"}),Yi.map(e=>U.jsx("option",{value:e.value,children:e.label},e.value))]})]})}),h?U.jsxs("div",{className:"rounded-[32px] border px-8 py-16 shadow-2xl backdrop-blur-xl text-center "+(s?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsx("div",{className:"w-16 h-16 border-4 border-purple-500/30 border-t-purple-500 rounded-full animate-spin mx-auto mb-4"}),U.jsx("p",{className:"text-lg "+(s?"text-white/70":"text-slate-600"),children:"Loading quests..."})]}):0===d.length?U.jsxs("div",{className:"rounded-[32px] border px-8 py-16 shadow-2xl backdrop-blur-xl text-center "+(s?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsx(Pt,{className:"h-16 w-16 mx-auto mb-4 "+(s?"text-white/30":"text-gray-300")}),U.jsx("h3",{className:"text-xl font-bold mb-2 "+(s?"text-white":"text-slate-900"),children:"No quests found"}),U.jsx("p",{className:""+(s?"text-white/70":"text-slate-600"),children:x||"all"!==g||"all"!==f?"Try adjusting your filters":"Be the first to create a quest!"}),!x&&"all"===g&&"all"===f&&U.jsxs("button",{onClick:()=>t("/create-quest"),className:"mt-4 inline-flex items-center gap-2 px-5 py-3 rounded-xl font-semibold transition bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600",children:[U.jsx(Ys,{className:"h-5 w-5"}),"Create Your First Quest"]})]}):U.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(e=>{var r,a,n;const i="my-ai"===j,o=i?e._id:e.id;return U.jsxs("div",{onClick:()=>((e,s=!1)=>{const r=s?e._id:e.questId||e.id,a=e.category||"ai-generated";t(`/quest-execution/${e.subject}/${a}/${r}`,{state:{quest:e,isAI:s}})})(e,i),className:"rounded-2xl border p-6 cursor-pointer transition-all hover:scale-[1.02] hover:shadow-xl relative "+(s?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35 hover:border-purple-400/50":"border-gray-200 bg-white hover:border-purple-300 hover:shadow-lg"),children:[i&&U.jsx("button",{onClick:t=>C(e._id,t),className:"absolute top-3 right-3 p-2 rounded-lg transition "+(s?"text-red-400 hover:bg-red-500/20":"text-red-600 hover:bg-red-50"),title:"Delete this AI quest",children:U.jsx(pr,{className:"h-4 w-4"})}),i&&U.jsx("div",{className:"absolute top-3 left-3",children:U.jsxs("span",{className:"px-2 py-1 rounded-full text-xs font-semibold "+(s?"bg-blue-500/20 text-blue-400 border border-blue-400/30":"bg-blue-100 text-blue-700 border border-blue-200"),children:[U.jsx(nr,{className:"h-3 w-3 inline mr-1"}),"AI Generated"]})}),U.jsx("div",{className:"flex items-start justify-between mb-4",children:U.jsxs("div",{className:"flex-1",children:[U.jsx("h3",{className:"text-lg font-bold mb-2 "+(s?"text-white":"text-slate-900"),children:e.title}),U.jsx("p",{className:"text-sm line-clamp-2 "+(s?"text-white/70":"text-slate-600"),children:e.description||"No description provided"})]})}),U.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[U.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold border ${A(e.difficulty)}`,children:(null==(r=Yi.find(t=>t.value===e.difficulty))?void 0:r.label)||e.difficulty}),U.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-semibold "+(s?"bg-purple-500/20 text-purple-400 border border-purple-400/30":"bg-purple-100 text-purple-700 border border-purple-200"),children:(null==(a=Vi.find(t=>t.id===e.subject))?void 0:a.name)||e.subject}),U.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-semibold "+(s?"bg-blue-500/20 text-blue-400 border border-blue-400/30":"bg-blue-100 text-blue-700 border border-blue-200"),children:e.category})]}),U.jsxs("div",{className:"flex items-center justify-between text-xs mt-4",children:[U.jsxs("div",{className:"flex items-center gap-2 "+(s?"text-white/60":"text-slate-500"),children:[U.jsx(Nr,{className:"h-4 w-4"}),U.jsx("span",{children:e.createdByName||"Anonymous"})]}),U.jsxs("div",{className:"flex items-center gap-2 "+(s?"text-white/60":"text-slate-500"),children:[U.jsx(Pt,{className:"h-4 w-4"}),U.jsxs("span",{children:[(null==(n=e.questions)?void 0:n.length)||0," questions"]})]})]})]},o)})}),U.jsx(Gi,{isOpen:y,onClose:()=>v(!1),onQuestGenerated:()=>{S(),N("my-ai")}})]})]})},Ji=[{id:"italian",name:"Italian Language",categories:["grammar","vocabulary","conversation"]},{id:"english",name:"English Language",categories:["grammar","literature","writing"]},{id:"spanish",name:"Spanish Language",categories:["grammar","vocabulary","conversation"]},{id:"french",name:"French Language",categories:["grammar","vocabulary","conversation"]},{id:"german",name:"German Language",categories:["grammar","vocabulary"]},{id:"mandarin",name:"Mandarin Chinese",categories:["characters","pinyin","conversation"]},{id:"business",name:"Business & Entrepreneurship",categories:["strategy","finance","marketing"]},{id:"philosophy",name:"Philosophy",categories:["ethics","logic","metaphysics"]},{id:"mathematics",name:"Mathematics",categories:["algebra","geometry","calculus"]},{id:"computerScience",name:"Computer Science",categories:["programming","algorithms","data-structures"]},{id:"chemistry",name:"Chemistry",categories:["organic","inorganic","physical"]},{id:"biology",name:"Biology",categories:["cell-biology","genetics","ecology"]},{id:"history",name:"History",categories:["ancient","medieval","modern"]},{id:"geography",name:"Geography",categories:["physical","human","environmental"]}],Ki=[{value:"beginner",label:"Beginner"},{value:"intermediate",label:"Intermediate"},{value:"advanced",label:"Advanced"}],Xi=()=>{const t=qe(),{isDark:s}=mt(),{user:r}=Br(),{showSuccess:a,showError:n}=Hr(),[i,o]=e.useState(1),[l,c]=e.useState({title:"",description:"",subject:"",category:"",difficulty:"beginner",questionType:"multiple-choice"}),[d,u]=e.useState([{id:Date.now(),type:"multiple-choice",question:"",options:["","","",""],correctAnswer:0,explanation:""}]),[h,m]=e.useState(0),[x,p]=e.useState(!1),[g,b]=e.useState(null),f=()=>{(l.title.trim()?l.subject?l.category||(n("Please select a category","Validation Error"),0):(n("Please select a subject","Validation Error"),0):(n("Please enter a quest title","Validation Error"),0))&&o(2)},w=(e,t)=>{const s=[...d];s[h]={...s[h],[e]:t},u(s)},y=e=>{c({...l,questionType:e});const t=[...d];t[h]={...t[h],type:e,options:"multiple-choice"===e?t[h].options.length>0?t[h].options:["","","",""]:[],correctAnswer:"multiple-choice"===e?0:"",correctAnswers:"fill-in-blank"===e?t[h].correctAnswers&&t[h].correctAnswers.length>0?t[h].correctAnswers:[""]:[]},u(t)},v=d[h];return U.jsxs("div",{className:"min-h-screen relative overflow-hidden "+(s?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:[U.jsx("style",{children:"\n        .hide-scrollbar::-webkit-scrollbar { width: 0; height: 0; }\n        .hide-scrollbar { scrollbar-width: none; }\n      "}),U.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[U.jsx("div",{className:"absolute -top-36 left-1/2 h-80 w-80 -translate-x-1/2 rounded-full bg-purple-500/30 blur-3xl"}),U.jsx("div",{className:"absolute top-1/2 right-12 h-64 w-64 rounded-full bg-pink-400/25 blur-[120px]"}),U.jsx("div",{className:"absolute bottom-10 left-10 h-60 w-60 rounded-full bg-blue-400/20 blur-[120px]"})]}),U.jsxs("div",{className:"relative z-10 mx-auto flex w-full max-w-5xl flex-col gap-8 px-6 py-14 hide-scrollbar",children:[U.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[U.jsx("button",{onClick:()=>1===i?t("/quest-academy"):o(1),className:"p-3 rounded-xl transition-all "+(s?"bg-white/10 text-white hover:bg-white/20":"bg-white text-slate-700 hover:bg-slate-50 shadow-sm"),children:U.jsx(wt,{className:"h-5 w-5"})}),U.jsxs("div",{children:[U.jsx("h1",{className:"text-3xl font-black tracking-tight "+(s?"text-white":"text-slate-900"),children:"Create Study Quest"}),U.jsx("p",{className:"mt-1 text-sm "+(s?"text-white/70":"text-slate-600"),children:1===i?"Fill in the basic information about your quest":`Question ${h+1} of ${d.length}`})]})]}),1===i&&U.jsx("form",{onSubmit:e=>{e.preventDefault(),f()},className:"space-y-6",children:U.jsxs("div",{className:"rounded-[32px] border px-8 py-9 shadow-2xl backdrop-blur-xl "+(s?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsx("h2",{className:"text-xl font-bold mb-6 "+(s?"text-white":"text-slate-900"),children:"Basic Information"}),U.jsxs("div",{className:"space-y-5",children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(s?"text-white/80":"text-slate-700"),children:"Quest Title *"}),U.jsx("input",{type:"text",value:l.title,onChange:e=>c({...l,title:e.target.value}),placeholder:"e.g., Italian Grammar Basics",className:"w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-purple-500 focus:border-transparent "+(s?"bg-white/10 border-white/20 text-white placeholder-white/50":"bg-white border-gray-300 text-slate-900 placeholder-gray-400"),required:!0})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(s?"text-white/80":"text-slate-700"),children:"Description"}),U.jsx("textarea",{value:l.description,onChange:e=>c({...l,description:e.target.value}),placeholder:"Describe what students will learn from this quest...",rows:3,className:"w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none "+(s?"bg-white/10 border-white/20 text-white placeholder-white/50":"bg-white border-gray-300 text-slate-900 placeholder-gray-400")})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(s?"text-white/80":"text-slate-700"),children:"Subject *"}),U.jsxs("select",{value:l.subject,onChange:e=>(e=>{const t=Ji.find(t=>t.id===e);b(t),c({...l,subject:e,category:""})})(e.target.value),className:"w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-purple-500 focus:border-transparent "+(s?"bg-white/10 border-white/20 text-white":"bg-white border-gray-300 text-slate-900"),required:!0,children:[U.jsx("option",{value:"",children:"Select a subject"}),Ji.map(e=>U.jsx("option",{value:e.id,children:e.name},e.id))]})]}),g&&U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(s?"text-white/80":"text-slate-700"),children:"Category *"}),U.jsxs("select",{value:l.category,onChange:e=>c({...l,category:e.target.value}),className:"w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-purple-500 focus:border-transparent "+(s?"bg-white/10 border-white/20 text-white":"bg-white border-gray-300 text-slate-900"),required:!0,children:[U.jsx("option",{value:"",children:"Select a category"}),g.categories.map(e=>U.jsx("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(s?"text-white/80":"text-slate-700"),children:"Difficulty *"}),U.jsx("select",{value:l.difficulty,onChange:e=>c({...l,difficulty:e.target.value}),className:"w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-purple-500 focus:border-transparent "+(s?"bg-white/10 border-white/20 text-white":"bg-white border-gray-300 text-slate-900"),required:!0,children:Ki.map(e=>U.jsx("option",{value:e.value,children:e.label},e.value))})]})]}),U.jsx("div",{className:"mt-8",children:U.jsx("button",{type:"submit",className:"w-full px-6 py-4 rounded-xl font-semibold transition shadow-lg bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600",children:U.jsxs("span",{className:"flex items-center justify-center gap-2",children:["Start to Create Questions",U.jsx(yt,{className:"h-5 w-5"})]})})})]})}),2===i&&U.jsx("form",{onSubmit:async e=>{if(e.preventDefault(),!r)return n("Please log in to create a quest","Authentication Required"),void t("/login");if((()=>{for(let e=0;e<d.length;e++){const t=d[e];if(!t.question.trim())return n(`Question ${e+1}: Please enter the question text`,"Validation Error"),m(e),!1;if("multiple-choice"===t.type){if(t.options.length<2)return n(`Question ${e+1}: Please add at least 2 options`,"Validation Error"),m(e),!1;if(t.options.some(e=>!e.trim()))return n(`Question ${e+1}: Please fill in all options`,"Validation Error"),m(e),!1}else if("fill-in-blank"===t.type){if(!t.correctAnswers||0===t.correctAnswers.length)return n(`Question ${e+1}: Please add at least one correct answer`,"Validation Error"),m(e),!1;if(t.correctAnswers.some(e=>!e.trim()))return n(`Question ${e+1}: Please fill in all correct answers`,"Validation Error"),m(e),!1}}return!0})()){p(!0);try{const e=d.map(e=>"multiple-choice"===e.type?{type:"multiple-choice",question:e.question.trim(),options:e.options.map(e=>e.trim()),correctAnswer:e.correctAnswer,explanation:e.explanation.trim()||""}:{type:"fill-in-blank",question:e.question.trim(),correctAnswers:e.correctAnswers.map(e=>e.trim()),explanation:e.explanation.trim()||""}),s={title:l.title.trim(),description:l.description.trim(),subject:l.subject,category:l.category,difficulty:l.difficulty,questionType:l.questionType,questions:e},i=await Ri(r.id,r.name||r.email,s);i.success?(a("Quest created successfully! It will be reviewed by an administrator.","Quest Created"),setTimeout(()=>{t("/quest-academy")},2e3)):n(i.error||"Failed to create quest","Error")}catch(s){console.error("Error creating quest:",s),n("An error occurred while creating the quest","Error")}finally{p(!1)}}},className:"space-y-6",children:U.jsxs("div",{className:"rounded-[32px] border px-8 py-9 shadow-2xl backdrop-blur-xl "+(s?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"flex items-center justify-between mb-6",children:[U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx("button",{type:"button",onClick:()=>{h>0&&m(h-1)},disabled:0===h,className:"p-2 rounded-xl transition "+(0===h?"opacity-50 cursor-not-allowed":s?"bg-white/10 text-white hover:bg-white/20":"bg-gray-100 text-slate-700 hover:bg-gray-200"),children:U.jsx(_t,{className:"h-5 w-5"})}),U.jsx("div",{className:"text-center",children:U.jsxs("p",{className:"text-sm font-semibold "+(s?"text-white/80":"text-slate-600"),children:["Question ",h+1," of ",d.length]})}),U.jsx("button",{type:"button",onClick:()=>{h<d.length-1&&m(h+1)},disabled:h===d.length-1,className:"p-2 rounded-xl transition "+(h===d.length-1?"opacity-50 cursor-not-allowed":s?"bg-white/10 text-white hover:bg-white/20":"bg-gray-100 text-slate-700 hover:bg-gray-200"),children:U.jsx(zt,{className:"h-5 w-5"})})]}),U.jsxs("div",{className:"flex items-center gap-3",children:[d.length>1&&U.jsx("button",{type:"button",onClick:()=>(e=>{if(d.length>1){const t=d.filter((t,s)=>s!==e);u(t),h>=t.length?m(t.length-1):h>e&&m(h-1)}else n("At least one question is required","Error")})(h),className:"p-2 rounded-xl transition "+(s?"text-red-400 hover:bg-red-500/20":"text-red-600 hover:bg-red-50"),children:U.jsx(pr,{className:"h-5 w-5"})}),U.jsxs("button",{type:"button",onClick:()=>{const e={id:Date.now(),type:l.questionType,question:"",options:"multiple-choice"===l.questionType?["","","",""]:[],correctAnswer:"multiple-choice"===l.questionType?0:"",correctAnswers:"fill-in-blank"===l.questionType?[""]:[],explanation:""};u([...d,e]),m(d.length)},className:"inline-flex items-center gap-2 px-4 py-2 rounded-xl font-semibold transition "+(s?"bg-white/10 text-white hover:bg-white/20":"bg-purple-50 text-purple-700 hover:bg-purple-100"),children:[U.jsx(Ys,{className:"h-4 w-4"}),"Add Question"]})]})]}),v&&U.jsxs("div",{className:"space-y-6",children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(s?"text-white/80":"text-slate-700"),children:"Question Type *"}),U.jsxs("div",{className:"flex gap-3",children:[U.jsx("button",{type:"button",onClick:()=>y("multiple-choice"),className:"flex-1 px-4 py-3 rounded-xl border-2 transition-all "+("multiple-choice"===v.type?s?"border-purple-400 bg-purple-500/20 text-white":"border-purple-500 bg-purple-50 text-purple-700":s?"border-white/20 bg-white/5 text-white/70 hover:border-white/40":"border-gray-200 bg-white text-slate-700 hover:border-gray-300"),children:"Multiple Choice"}),U.jsx("button",{type:"button",onClick:()=>y("fill-in-blank"),className:"flex-1 px-4 py-3 rounded-xl border-2 transition-all "+("fill-in-blank"===v.type?s?"border-purple-400 bg-purple-500/20 text-white":"border-purple-500 bg-purple-50 text-purple-700":s?"border-white/20 bg-white/5 text-white/70 hover:border-white/40":"border-gray-200 bg-white text-slate-700 hover:border-gray-300"),children:"Fill in the Blank"})]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(s?"text-white/80":"text-slate-700"),children:"Question Text *"}),U.jsx("textarea",{value:v.question,onChange:e=>w("question",e.target.value),placeholder:"fill-in-blank"===v.type?"e.g., The capital of Italy is ___.":"e.g., What is the capital of Italy?",rows:2,className:"w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none "+(s?"bg-white/10 border-white/20 text-white placeholder-white/50":"bg-white border-gray-300 text-slate-900 placeholder-gray-400"),required:!0})]}),"multiple-choice"===v.type&&U.jsxs("div",{className:"space-y-3",children:[U.jsxs("div",{className:"flex items-center justify-between mb-2",children:[U.jsx("label",{className:"text-sm font-semibold "+(s?"text-white/80":"text-slate-700"),children:"Options *"}),U.jsxs("button",{type:"button",onClick:()=>{const e=[...d];e[h]={...e[h],options:[...e[h].options,""]},u(e)},className:"text-xs px-2 py-1 rounded-lg transition "+(s?"bg-white/10 text-white hover:bg-white/20":"bg-gray-200 text-slate-700 hover:bg-gray-300"),children:[U.jsx(Ys,{className:"h-3 w-3 inline mr-1"}),"Add Option"]})]}),v.options.map((e,t)=>U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx("input",{type:"radio",name:`correct-${v.id}`,checked:v.correctAnswer===t,onChange:()=>w("correctAnswer",t),className:"w-5 h-5 text-purple-500"}),U.jsx("input",{type:"text",value:e,onChange:e=>((e,t)=>{const s=[...d];s[h]={...s[h],options:s[h].options.map((s,r)=>r===e?t:s)},u(s)})(t,e.target.value),placeholder:`Option ${t+1}`,className:"flex-1 px-4 py-2 rounded-xl border focus:ring-2 focus:ring-purple-500 focus:border-transparent "+(s?"bg-white/10 border-white/20 text-white placeholder-white/50":"bg-white border-gray-300 text-slate-900 placeholder-gray-400"),required:!0}),v.options.length>2&&U.jsx("button",{type:"button",onClick:()=>(e=>{const t=[...d],s=t[h],r=s.options.filter((t,s)=>s!==e);t[h]={...s,options:r,correctAnswer:s.correctAnswer>=r.length?0:s.correctAnswer},u(t)})(t),className:"p-2 rounded-lg transition "+(s?"text-red-400 hover:bg-red-500/20":"text-red-600 hover:bg-red-50"),children:U.jsx(Rr,{className:"h-4 w-4"})})]},t))]}),"fill-in-blank"===v.type&&U.jsxs("div",{className:"space-y-3",children:[U.jsxs("div",{className:"flex items-center justify-between mb-2",children:[U.jsx("label",{className:"text-sm font-semibold "+(s?"text-white/80":"text-slate-700"),children:"Correct Answers * (Multiple accepted)"}),U.jsxs("button",{type:"button",onClick:()=>{const e=[...d];e[h]={...e[h],correctAnswers:[...e[h].correctAnswers||[],""]},u(e)},className:"text-xs px-2 py-1 rounded-lg transition "+(s?"bg-white/10 text-white hover:bg-white/20":"bg-gray-200 text-slate-700 hover:bg-gray-300"),children:[U.jsx(Ys,{className:"h-3 w-3 inline mr-1"}),"Add Answer"]})]}),(v.correctAnswers||[""]).map((e,t)=>U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx($t,{className:"h-5 w-5 "+(s?"text-green-400":"text-green-600")}),U.jsx("input",{type:"text",value:e,onChange:e=>((e,t)=>{const s=[...d];s[h]={...s[h],correctAnswers:s[h].correctAnswers.map((s,r)=>r===e?t:s)},u(s)})(t,e.target.value),placeholder:`Correct answer ${t+1} (e.g., Rome, Roma, ROME)`,className:"flex-1 px-4 py-2 rounded-xl border focus:ring-2 focus:ring-purple-500 focus:border-transparent "+(s?"bg-white/10 border-white/20 text-white placeholder-white/50":"bg-white border-gray-300 text-slate-900 placeholder-gray-400"),required:!0}),(v.correctAnswers||[]).length>1&&U.jsx("button",{type:"button",onClick:()=>(e=>{const t=[...d];t[h]={...t[h],correctAnswers:t[h].correctAnswers.filter((t,s)=>s!==e)},u(t)})(t),className:"p-2 rounded-lg transition "+(s?"text-red-400 hover:bg-red-500/20":"text-red-600 hover:bg-red-50"),children:U.jsx(Rr,{className:"h-4 w-4"})})]},t))]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(s?"text-white/80":"text-slate-700"),children:"Explanation (Optional)"}),U.jsx("textarea",{value:v.explanation,onChange:e=>w("explanation",e.target.value),placeholder:"Explain why this is the correct answer...",rows:2,className:"w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none "+(s?"bg-white/10 border-white/20 text-white placeholder-white/50":"bg-white border-gray-300 text-slate-900 placeholder-gray-400")})]})]}),U.jsxs("div",{className:"flex gap-4 mt-8",children:[U.jsx("button",{type:"button",onClick:()=>o(1),className:"flex-1 px-6 py-4 rounded-xl font-semibold transition "+(s?"bg-white/10 text-white hover:bg-white/20 border border-white/20":"bg-white text-slate-700 hover:bg-gray-50 border border-gray-200"),children:"Back to Basic Info"}),U.jsx("button",{type:"submit",disabled:x,className:"flex-1 px-6 py-4 rounded-xl font-semibold transition shadow-lg bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600 disabled:opacity-50 disabled:cursor-not-allowed",children:x?U.jsxs("span",{className:"flex items-center justify-center gap-2",children:[U.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Saving..."]}):U.jsxs("span",{className:"flex items-center justify-center gap-2",children:[U.jsx(Zs,{className:"h-5 w-5"}),"Submit for Review"]})})]})]})})]})]})},Zi={}.VITE_API_BASE_URL||"http://localhost:3003/api",eo=async(e,t,s)=>{try{if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t))return{success:!1,error:"Invalid email format"};const r=o(dt,"users"),a=l(r,c("email","==",t.toLowerCase().trim())),n=await d(a);if(!n.empty){if(n.docs[0].data().id!==e)return{success:!1,error:"This email is already in use by another account"}}const i=`${Date.now()}-${Math.random().toString(36).substring(2,15)}-${Math.random().toString(36).substring(2,15)}`,m=Date.now()+36e5,x=o(dt,"emailChangeRequests"),p=u(x,i);await h(p,{userId:e,oldEmail:s.toLowerCase().trim(),newEmail:t.toLowerCase().trim(),token:i,expiresAt:m,createdAt:Date.now()});const g=await fetch(`${Zi}/send-email-change-verification`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,newEmail:t.toLowerCase().trim(),oldEmail:s.toLowerCase().trim(),token:i})}),b=await g.json();return b.success?{success:!0,message:"Verification email sent. Please check your new email inbox."}:(await f(p),{success:!1,error:b.error||"Failed to send verification email"})}catch(r){return console.error("Error requesting email change:",r),{success:!1,error:"Failed to request email change. Please try again."}}},to=()=>{const{user:t}=Br(),{showSuccess:s,showError:r}=Hr(),{theme:a,toggleTheme:n,isDark:i}=mt(),[o,l]=e.useState({}),[c,d]=e.useState(!1),[u,h]=e.useState(""),[m,x]=e.useState(!1);e.useEffect(()=>{const e=JSON.parse(localStorage.getItem("userSettings")||"{}");l(t=>({...t,...e}))},[]);const p=e=>{n(e),s("Theme updated successfully!",3e3,"Theme Changed")};return U.jsxs("div",{className:"min-h-screen relative overflow-hidden "+(i?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:[U.jsx("style",{children:"\n        .hide-scrollbar::-webkit-scrollbar { width: 0; height: 0; }\n        .hide-scrollbar { scrollbar-width: none; }\n      "}),U.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[U.jsx("div",{className:"absolute -top-36 left-1/2 h-80 w-80 -translate-x-1/2 rounded-full bg-purple-500/30 blur-3xl"}),U.jsx("div",{className:"absolute top-1/2 right-12 h-64 w-64 rounded-full bg-pink-400/25 blur-[120px]"}),U.jsx("div",{className:"absolute bottom-10 left-10 h-60 w-60 rounded-full bg-blue-400/20 blur-[120px]"})]}),U.jsxs("div",{className:"relative z-10 mx-auto flex w-full max-w-6xl flex-col gap-10 px-6 py-14 hide-scrollbar",children:[U.jsxs("section",{className:"rounded-[32px] border px-8 py-9 shadow-2xl backdrop-blur-xl "+(i?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-purple-500/10 px-3.5 py-2 text-xs font-semibold text-purple-500",children:[U.jsx(sr,{className:"h-4 w-4"})," Customize your experience"]}),U.jsx("h1",{className:"mt-4 text-3xl font-black tracking-tight md:text-4xl",children:"Settings"}),U.jsx("p",{className:"mt-3 max-w-xl text-sm md:text-base "+(i?"text-white/70":"text-slate-600"),children:"Personalize your learning journey with theme preferences, notifications, and more."})]}),U.jsxs("section",{className:"rounded-[32px] border px-8 py-9 shadow-2xl backdrop-blur-xl "+(i?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[U.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-purple-500 via-pink-500 to-blue-500 text-white shadow-lg",children:U.jsx(_s,{className:"h-6 w-6"})}),U.jsxs("div",{children:[U.jsx("h2",{className:"text-2xl font-bold "+(i?"text-white":"text-slate-900"),children:"Theme Settings"}),U.jsx("p",{className:"text-sm "+(i?"text-white/70":"text-slate-600"),children:"Choose your preferred color scheme"})]})]}),U.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[U.jsxs("button",{onClick:()=>p("light"),className:"relative p-6 rounded-[24px] border-2 transition-all duration-300 text-left "+("light"===a?i?"border-purple-400/50 bg-purple-500/20 shadow-lg shadow-purple-500/20":"border-purple-500 bg-purple-50 shadow-lg":i?"border-white/10 bg-white/5 hover:border-purple-400/30 hover:bg-white/8":"border-slate-200 bg-white hover:border-purple-300 hover:shadow-md"),children:[U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-yellow-400 to-orange-500 text-white shadow-lg",children:U.jsx(lr,{className:"h-6 w-6"})}),U.jsxs("div",{className:"flex-1",children:[U.jsx("h3",{className:"text-lg font-bold "+(i?"text-white":"text-slate-900"),children:"Light Mode"}),U.jsx("p",{className:"text-sm mt-1 "+(i?"text-white/70":"text-slate-600"),children:"Clean and bright interface"})]})]}),"light"===a&&U.jsx("div",{className:"absolute top-4 right-4 flex h-6 w-6 items-center justify-center rounded-full bg-gradient-to-r from-purple-500 to-pink-500 shadow-lg",children:U.jsx("div",{className:"h-3 w-3 rounded-full bg-white"})})]}),U.jsxs("button",{onClick:()=>p("dark"),className:"relative p-6 rounded-[24px] border-2 transition-all duration-300 text-left "+("dark"===a?i?"border-purple-400/50 bg-purple-500/20 shadow-lg shadow-purple-500/20":"border-purple-500 bg-purple-50 shadow-lg":i?"border-white/10 bg-white/5 hover:border-purple-400/30 hover:bg-white/8":"border-slate-200 bg-white hover:border-purple-300 hover:shadow-md"),children:[U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-slate-600 to-purple-600 text-white shadow-lg",children:U.jsx(Us,{className:"h-6 w-6"})}),U.jsxs("div",{className:"flex-1",children:[U.jsx("h3",{className:"text-lg font-bold "+(i?"text-white":"text-slate-900"),children:"Dark Mode"}),U.jsx("p",{className:"text-sm mt-1 "+(i?"text-white/70":"text-slate-600"),children:"Easy on the eyes"})]})]}),"dark"===a&&U.jsx("div",{className:"absolute top-4 right-4 flex h-6 w-6 items-center justify-center rounded-full bg-gradient-to-r from-purple-500 to-pink-500 shadow-lg",children:U.jsx("div",{className:"h-3 w-3 rounded-full bg-white"})})]})]})]}),U.jsxs("section",{className:"rounded-[32px] border px-8 py-9 shadow-2xl backdrop-blur-xl "+(i?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[U.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-rose-500 via-pink-500 to-purple-500 text-white shadow-lg",children:U.jsx(Nr,{className:"h-6 w-6"})}),U.jsxs("div",{children:[U.jsx("h2",{className:"text-2xl font-bold "+(i?"text-white":"text-slate-900"),children:"Account"}),U.jsx("p",{className:"text-sm "+(i?"text-white/70":"text-slate-600"),children:"Manage your account information"})]})]}),U.jsxs("div",{className:"p-5 rounded-[20px] border "+(i?"border-white/10 bg-white/5":"border-slate-200 bg-slate-50"),children:[U.jsx("div",{className:"flex items-center justify-between mb-4",children:U.jsxs("div",{children:[U.jsx("p",{className:"text-sm font-semibold "+(i?"text-white/90":"text-slate-700"),children:"Logged in as"}),U.jsx("p",{className:"text-base mt-1 "+(i?"text-white":"text-slate-900"),children:(null==t?void 0:t.email)||(null==t?void 0:t.username)||"Guest"})]})}),U.jsxs("button",{onClick:()=>d(!0),className:"inline-flex items-center gap-2 rounded-xl px-4 py-2.5 text-sm font-semibold transition hover:-translate-y-0.5 hover:shadow-lg "+(i?"bg-white/10 text-white border border-white/20 hover:bg-white/15 hover:border-white/30":"border border-slate-200 bg-white text-slate-700 hover:bg-slate-50 hover:border-slate-300"),children:[U.jsx(Is,{className:"h-4 w-4"}),"Change Email"]})]})]}),U.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[U.jsxs("button",{onClick:()=>{localStorage.setItem("userSettings",JSON.stringify(o)),s("Settings saved successfully!",3e3,"Settings Saved")},className:"inline-flex items-center justify-center gap-2 rounded-2xl px-6 py-3.5 text-sm font-semibold shadow-lg transition hover:-translate-y-0.5 hover:shadow-xl "+(i?"bg-gradient-to-r from-purple-500 via-pink-500 to-blue-500 text-white hover:from-purple-600 hover:via-pink-600 hover:to-blue-600":"bg-gradient-to-r from-blue-500 to-purple-500 text-white hover:from-blue-600 hover:to-purple-600"),children:[U.jsx(Zs,{className:"h-5 w-5"}),"Save Settings"]}),U.jsxs("button",{onClick:()=>{const e={};l(e),n("light"),localStorage.setItem("userSettings",JSON.stringify(e)),s("Settings reset to default!",3e3,"Settings Reset")},className:"inline-flex items-center justify-center gap-2 rounded-2xl px-6 py-3.5 text-sm font-semibold transition hover:-translate-y-0.5 "+(i?"bg-white/10 text-white border border-white/20 hover:bg-white/15 hover:border-white/30":"border border-slate-200 bg-white text-slate-700 hover:bg-slate-50 hover:border-slate-300"),children:[U.jsx(Xs,{className:"h-5 w-5"}),"Reset to Default"]})]})]}),c&&U.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:U.jsxs("div",{className:"relative rounded-[32px] border shadow-2xl backdrop-blur-xl w-full max-w-md "+(i?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsx("button",{onClick:()=>{d(!1),h("")},className:"absolute top-4 right-4 p-2 rounded-full transition "+(i?"hover:bg-white/10":"hover:bg-slate-100"),children:U.jsx(Rr,{className:"h-5 w-5 "+(i?"text-white":"text-slate-600")})}),U.jsxs("div",{className:"p-8",children:[U.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[U.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 via-purple-500 to-blue-600 text-white shadow-lg",children:U.jsx(Is,{className:"h-6 w-6"})}),U.jsxs("div",{children:[U.jsx("h3",{className:"text-xl font-bold "+(i?"text-white":"text-slate-900"),children:"Change Email Address"}),U.jsx("p",{className:"text-sm "+(i?"text-white/70":"text-slate-600"),children:"Enter your new email address"})]})]}),U.jsxs("div",{className:"space-y-4",children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(i?"text-white/90":"text-slate-700"),children:"Current Email"}),U.jsx("div",{className:"rounded-xl px-4 py-3 border "+(i?"border-white/10 bg-white/5":"border-slate-200 bg-slate-50"),children:U.jsx("span",{className:"text-sm "+(i?"text-white/70":"text-slate-600"),children:(null==t?void 0:t.email)||"N/A"})})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold mb-2 "+(i?"text-white/90":"text-slate-700"),children:"New Email Address"}),U.jsx("input",{type:"email",value:u,onChange:e=>h(e.target.value),placeholder:"Enter new email address",className:"w-full rounded-xl px-4 py-3 transition-all "+(i?"bg-white/10 border-2 border-white/20 text-white placeholder-white/40 focus:border-purple-400/50 focus:ring-2 focus:ring-purple-500/30":"bg-white border-2 border-slate-200 text-slate-900 placeholder-slate-400 focus:border-purple-300 focus:ring-2 focus:ring-purple-500/20"),disabled:m})]}),U.jsx("div",{className:"rounded-xl p-4 border "+(i?"border-blue-400/30 bg-blue-500/20":"border-blue-200 bg-blue-50"),children:U.jsxs("p",{className:"text-sm "+(i?"text-blue-300":"text-blue-800"),children:[U.jsx("strong",{children:"Note:"})," We'll send a verification email to your new address. Click the link in that email to confirm the change."]})})]}),U.jsxs("div",{className:"flex gap-3 mt-6",children:[U.jsx("button",{onClick:async()=>{var e;if(!u||!u.trim())return void r("Please enter a new email address",3e3,"Error");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u))if(u.toLowerCase().trim()!==(null==(e=null==t?void 0:t.email)?void 0:e.toLowerCase().trim()))try{x(!0);const e=await eo(t.id,u,t.email);e.success?(s("Verification email sent! Please check your new email inbox.",5e3,"Email Sent"),d(!1),h("")):r(e.error||"Failed to send verification email",5e3,"Error")}catch(a){console.error("Error changing email:",a),r("An unexpected error occurred. Please try again.",5e3,"Error")}finally{x(!1)}else r("New email must be different from your current email",3e3,"Error");else r("Please enter a valid email address",3e3,"Error")},disabled:m||!u.trim(),className:"flex-1 inline-flex items-center justify-center gap-2 rounded-xl px-6 py-3 text-sm font-semibold shadow-lg transition hover:-translate-y-0.5 hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed "+(i?"bg-gradient-to-r from-purple-500 via-pink-500 to-blue-500 text-white hover:from-purple-600 hover:via-pink-600 hover:to-blue-600":"bg-gradient-to-r from-blue-500 to-purple-500 text-white hover:from-blue-600 hover:to-purple-600"),children:m?U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"w-4 h-4 border-2 rounded-full animate-spin border-white border-t-transparent"}),"Sending..."]}):U.jsxs(U.Fragment,{children:[U.jsx(Is,{className:"h-4 w-4"}),"Send Verification Email"]})}),U.jsx("button",{onClick:()=>{d(!1),h("")},disabled:m,className:"inline-flex items-center justify-center gap-2 rounded-xl px-6 py-3 text-sm font-semibold transition hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed "+(i?"bg-white/10 text-white border border-white/20 hover:bg-white/15 hover:border-white/30":"border border-slate-200 bg-white text-slate-700 hover:bg-slate-50 hover:border-slate-300"),children:"Cancel"})]})]})]})})]})},so=()=>{const[t]=ot(),s=qe(),{user:r,updateUser:a,reloadUser:n}=Br(),{isDark:i}=mt(),{showSuccess:h,showError:p}=Hr(),[g,b]=e.useState("verifying"),[w,y]=e.useState(""),v=e.useRef(!1);return e.useEffect(()=>{if(v.current)return;const e=t.get("token");if(!e)return b("error"),y("Invalid verification link. No token provided."),void(v.current=!0);(async()=>{v.current=!0;try{b("verifying");const t=await(async e=>{try{const t=o(dt,"emailChangeRequests"),s=u(t,e),r=await m(s);if(!r.exists())return{success:!1,error:"Invalid or expired verification link"};const a=r.data();if(Date.now()>a.expiresAt)return await f(s),{success:!1,error:"Verification link has expired. Please request a new one."};const n=o(dt,"users"),i=l(n,c("email","==",a.newEmail)),h=await d(i);if(!h.empty&&h.docs[0].data().id!==a.userId)return await f(s),{success:!1,error:"This email is already in use by another account"};const p=u(dt,"users",a.userId);return await x(p,{email:a.newEmail}),await f(s),{success:!0,message:"Email changed successfully",newEmail:a.newEmail,userId:a.userId}}catch(t){return console.error("Error verifying email change:",t),{success:!1,error:"Failed to verify email change. Please try again."}}})(e);if(t.success){if(b("success"),y("Your email address has been successfully changed!"),r&&r.id===t.userId){const e={...r,email:t.newEmail};a(e),await n()}h("Email changed successfully!",5e3,"Success"),setTimeout(()=>{s("/settings")},3e3)}else b("error"),y(t.error||"Failed to verify email change"),p(t.error||"Failed to verify email change",5e3,"Error")}catch(t){console.error("Error verifying email change:",t),b("error"),y("An unexpected error occurred. Please try again."),p("An unexpected error occurred. Please try again.",5e3,"Error")}})()},[t]),U.jsxs("div",{className:"min-h-screen relative overflow-hidden flex items-center justify-center "+(i?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:[U.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[U.jsx("div",{className:"absolute -top-36 left-1/2 h-80 w-80 -translate-x-1/2 rounded-full bg-purple-500/30 blur-3xl"}),U.jsx("div",{className:"absolute top-1/2 right-12 h-64 w-64 rounded-full bg-pink-400/25 blur-[120px]"}),U.jsx("div",{className:"absolute bottom-10 left-10 h-60 w-60 rounded-full bg-blue-400/20 blur-[120px]"})]}),U.jsx("div",{className:"relative z-10 max-w-md w-full mx-6",children:U.jsxs("div",{className:"rounded-[32px] border px-8 py-12 shadow-2xl backdrop-blur-xl text-center "+(i?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:["verifying"===g&&U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"flex justify-center mb-6",children:U.jsx(As,{className:"h-16 w-16 animate-spin "+(i?"text-purple-400":"text-purple-600")})}),U.jsx("h2",{className:"text-2xl font-bold mb-4 "+(i?"text-white":"text-slate-900"),children:"Verifying Email Change"}),U.jsx("p",{className:"text-base "+(i?"text-white/70":"text-slate-600"),children:"Please wait while we verify your email change request..."})]}),"success"===g&&U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"flex justify-center mb-6",children:U.jsx("div",{className:"h-16 w-16 rounded-full flex items-center justify-center "+(i?"bg-green-500/20":"bg-green-100"),children:U.jsx($t,{className:"h-10 w-10 text-green-500"})})}),U.jsx("h2",{className:"text-2xl font-bold mb-4 "+(i?"text-white":"text-slate-900"),children:"Email Changed Successfully!"}),U.jsx("p",{className:"text-base mb-6 "+(i?"text-white/70":"text-slate-600"),children:w}),U.jsx("p",{className:"text-sm "+(i?"text-white/60":"text-slate-500"),children:"Redirecting to Settings page..."})]}),"error"===g&&U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"flex justify-center mb-6",children:U.jsx("div",{className:"h-16 w-16 rounded-full flex items-center justify-center "+(i?"bg-red-500/20":"bg-red-100"),children:U.jsx(qr,{className:"h-10 w-10 text-red-500"})})}),U.jsx("h2",{className:"text-2xl font-bold mb-4 "+(i?"text-white":"text-slate-900"),children:"Verification Failed"}),U.jsx("p",{className:"text-base mb-6 "+(i?"text-white/70":"text-slate-600"),children:w}),U.jsx("button",{onClick:()=>s("/settings"),className:"inline-flex items-center justify-center gap-2 rounded-2xl px-6 py-3 text-sm font-semibold shadow-lg transition hover:-translate-y-0.5 hover:shadow-xl "+(i?"bg-gradient-to-r from-purple-500 via-pink-500 to-blue-500 text-white hover:from-purple-600 hover:via-pink-600 hover:to-blue-600":"bg-gradient-to-r from-blue-500 to-purple-500 text-white hover:from-blue-600 hover:to-purple-600"),children:"Go to Settings"})]})]})})]})},ro=({events:t=[]})=>{const{isDark:s}=mt(),[r,a]=e.useState([]),[n,i]=e.useState(!1),[o,l]=e.useState(null),[c,d]=e.useState({}),[u,h]=e.useState(null);e.useEffect(()=>{const e=new Date,s=[];t.forEach(t=>{const r=new Date(t.date),a=Math.ceil((r-e)/864e5);a===t.reminderDays&&a>0&&("homework"===t.type?s.push({id:`homework-${t.id}`,type:"homework",title:"Homework Reminder",message:`You have homework due in ${a} day${a>1?"s":""}: ${t.title}`,subject:t.subject,event:t}):"summative"===t.type&&s.push({id:`summative-${t.id}`,type:"summative",title:"Test Reminder",message:`You have a ${t.subject} test in ${a} day${a>1?"s":""}: ${t.title}`,subject:t.subject,event:t}))}),a(s)},[t]);const m=()=>{if(!o)return;let e=0;o.questions.forEach((t,s)=>{c[s]===t.correct&&e++});const t=Math.round(e/o.questions.length*100);h(t)},x=e=>{a(r.filter(t=>t.id!==e))};return 0!==r.length||n?U.jsxs(U.Fragment,{children:[r.map(e=>U.jsx("div",{className:"fixed top-20 right-6 z-50 w-96 p-6 rounded-2xl border-2 shadow-2xl backdrop-blur-xl transform transition-all duration-300 "+(s?"bg-gradient-to-br from-white/15 via-white/10 to-white/5 border-white/30 text-white":"bg-white border-gray-200 text-gray-800 shadow-xl"),children:U.jsxs("div",{className:"flex items-start gap-4",children:[U.jsx("div",{className:"flex-shrink-0 p-3 rounded-xl "+("homework"===e.type?"bg-gradient-to-br from-orange-500 to-orange-600 text-white shadow-lg":"bg-gradient-to-br from-red-500 to-red-600 text-white shadow-lg"),children:"homework"===e.type?U.jsx(ur,{className:"w-6 h-6"}):U.jsx(fr,{className:"w-6 h-6"})}),U.jsxs("div",{className:"flex-1 min-w-0",children:[U.jsx("h4",{className:"font-bold text-lg mb-2 "+(s?"text-white":"text-gray-900"),children:e.title}),U.jsx("p",{className:"text-sm mb-4 leading-relaxed "+(s?"text-white/80":"text-gray-600"),children:e.message}),U.jsxs("div",{className:"flex gap-3",children:["summative"===e.type&&U.jsx("button",{onClick:()=>(e=>{const t={subject:s=e.subject,questions:({Mathematics:[{question:"What is the derivative of x?",options:["2x","x","2","x"],correct:0},{question:"What is the integral of 2x?",options:["x","x + C","2x","x"],correct:1}],Science:[{question:"What is the chemical symbol for water?",options:["H2O","CO2","O2","H2"],correct:0},{question:"What is the speed of light?",options:["300,000 km/s","150,000 km/s","450,000 km/s","600,000 km/s"],correct:0}],English:[{question:"What is a metaphor?",options:["A comparison using 'like' or 'as'","A direct comparison","A sound device","A type of poem"],correct:1},{question:"What is the past tense of 'go'?",options:["goed","went","gone","going"],correct:1}]}[s]||[{question:"What is the capital of France?",options:["London","Berlin","Paris","Madrid"],correct:2}]).slice(0,3),timeLimit:30};var s;l(t),i(!0),d({}),h(null),setTimeout(()=>{n&&!u&&m()},3e4)})(e),className:"flex-1 px-4 py-2.5 text-sm font-bold rounded-xl transition-all shadow-lg hover:shadow-xl hover:-translate-y-0.5 bg-gradient-to-r from-red-500 to-red-600 text-white hover:from-red-600 hover:to-red-700",children:"Take Quiz"}),U.jsx("button",{onClick:()=>x(e.id),className:"px-4 py-2.5 text-sm font-semibold rounded-xl transition-all "+(s?"bg-white/10 text-white hover:bg-white/20 border border-white/20":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-200"),children:"Dismiss"})]})]}),U.jsx("button",{onClick:()=>x(e.id),className:"flex-shrink-0 p-1.5 rounded-lg transition-colors "+(s?"hover:bg-white/10 text-white/60 hover:text-white":"hover:bg-gray-100 text-gray-400 hover:text-gray-600"),children:U.jsx(Rr,{className:"w-5 h-5"})})]})},e.id)),n&&o&&U.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:U.jsxs("div",{className:"rounded-3xl p-6 border-2 max-w-md mx-4 w-full "+(s?"bg-white/10 border-white/20":"bg-white/90 border-white/20 shadow-xl"),children:[U.jsxs("div",{className:"flex items-center justify-between mb-4",children:[U.jsxs("h3",{className:"text-xl font-bold "+(s?"text-white":"text-gray-800"),children:[o.subject," Quiz"]}),U.jsxs("div",{className:"flex items-center space-x-2 px-3 py-1 rounded-lg "+(s?"bg-white/10":"bg-gray-100"),children:[U.jsx(Ht,{className:"w-4 h-4"}),U.jsx("span",{className:"text-sm font-medium",children:"30s"})]})]}),u?U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 "+(u>=70?s?"bg-green-500/20 text-green-400":"bg-green-100 text-green-600":s?"bg-red-500/20 text-red-400":"bg-red-100 text-red-600"),children:U.jsx(fr,{className:"w-8 h-8"})}),U.jsxs("h4",{className:"text-2xl font-bold mb-2 "+(s?"text-white":"text-gray-800"),children:[u,"%"]}),U.jsx("p",{className:"mb-4 "+(s?"text-gray-300":"text-gray-600"),children:u>=70?"Great job! You're ready for the test!":"Keep studying! You can do better next time."}),U.jsx("button",{onClick:()=>{i(!1),l(null),d({}),h(null)},className:"px-4 py-2 rounded-xl font-medium transition-colors bg-purple-500 text-white hover:bg-purple-600",children:"Close"})]}):U.jsxs("div",{className:"space-y-4",children:[o.questions.map((e,t)=>U.jsxs("div",{children:[U.jsxs("p",{className:"font-medium mb-2 "+(s?"text-white":"text-gray-800"),children:[t+1,". ",e.question]}),U.jsx("div",{className:"space-y-2",children:e.options.map((e,r)=>U.jsxs("label",{className:"flex items-center space-x-2 p-2 rounded-lg cursor-pointer transition-colors "+(c[t]===r?s?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-600":s?"hover:bg-white/5":"hover:bg-gray-50"),children:[U.jsx("input",{type:"radio",name:`question-${t}`,value:r,checked:c[t]===r,onChange:e=>d({...c,[t]:parseInt(e.target.value)}),className:"sr-only"}),U.jsx("span",{className:"text-sm",children:e})]},r))})]},t)),U.jsx("button",{onClick:m,className:"w-full px-4 py-2 rounded-xl font-medium transition-colors bg-blue-500 text-white hover:bg-blue-600",children:"Submit Quiz"})]})]})})]}):null},ao=e=>{if(!e)throw new Error("User ID is required to access calendar events");return o(dt,"users",e,"calendarEvents")};va(Na);const no=async(e,t,s,r,a)=>{var n,i;try{const l=u(dt,"users",e,"calendarEvents",a,"reminders","sent"),c=await m(l);if(c.exists()){const e=c.data(),t=(null==(i=null==(n=e.date)?void 0:n.toDate)?void 0:i.call(n))||new Date(e.date),s=new Date;if(s.setHours(0,0,0,0),t&&t.toDateString()===s.toDateString())return console.log(`Reminder already sent today for event: ${r.title}`),{success:!0,alreadySent:!0}}const d=new Date(r.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),x=r.time||"All day",p={study:"Study Session",homework:"Homework",summative:"Summative Test",social:"Social Event",mission:"Mission",reward:"Reward"},g={to_email:t,to_name:s||t.split("@")[0],event_title:r.title||"Untitled Event",event_date:d,event_time:x,event_type:p[r.type]||r.type||"Event",event_description:r.description||"No description provided.",event_subject:r.subject||"",reminder_days:r.reminderDays||1,app_name:"Studiply",from_name:"Studiply Calendar",user_email:t,user_name:s||t.split("@")[0],email:t,name:s||t.split("@")[0]},b={}.VITE_API_BASE_URL||"http://localhost:3003/api";try{console.log(" Attempting to send calendar reminder via Neo Email (backend)...",{to:t,event:r.title});const e={email:t,eventTitle:r.title,eventDate:r.date,eventTime:r.time,reminderDays:r.reminderDays};console.log(" Sending calendar reminder request to backend:",{url:`${b}/send-calendar-reminder`,email:t,eventTitle:r.title,eventDate:r.date});const s=await fetch(`${b}/send-calendar-reminder`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok){const e=await s.text();throw console.error(` Backend API error (${s.status}):`,e),new Error(`Backend API error: ${s.status} - ${e}`)}const a=await s.json();if(console.log(" Backend API response:",a),a.success)return await h(l,{sent:!0,date:new Date,reminderDays:r.reminderDays,eventTitle:r.title}),console.log(` Calendar reminder sent via Neo Email for: ${r.title}`),{success:!0,alreadySent:!1};throw new Error(a.error||"Backend email failed")}catch(o){console.warn(" Neo Email failed for calendar reminder, falling back to EmailJS:",o.message||o)}const f=Ca||"template_event_reminder";console.log(" Sending event reminder email via EmailJS (fallback)...",{to:t,event:r.title,templateId:f});const w=await ja(ka,f,g,Na);if(200===w.status)return await h(l,{sent:!0,date:new Date,reminderDays:r.reminderDays,eventTitle:r.title}),console.log(` Event reminder sent via EmailJS for: ${r.title}`),{success:!0,alreadySent:!1};throw new Error(`EmailJS returned status ${w.status}`)}catch(l){return console.error("Error sending event reminder:",l),{success:!1,error:l.message,alreadySent:!1}}},io=()=>{const{isDark:t}=mt(),{user:s}=Br(),[r,a]=e.useState(new Date),[n,i]=e.useState(new Date),[l,c]=e.useState([]),[m,x]=e.useState(!1),[g,b]=e.useState(!1),[w,y]=e.useState({title:"",time:"",type:"study",description:"",subject:"",reminderDays:1}),v=e=>{const t=e.toDateString();return l.filter(e=>new Date(e.date).toDateString()===t)},j=async e=>{try{(null==s?void 0:s.id)&&await(async(e,t)=>{try{const s=u(dt,"users",e,"calendarEvents",t);await f(s)}catch(s){throw console.error("Failed to delete calendar event:",s),s}})(s.id,e),c(t=>t.filter(t=>t.id!==e))}catch(t){console.error("Unable to delete calendar event:",t)}},N=(()=>{const e=(t=r,new Date(t.getFullYear(),t.getMonth(),1).getDay());var t;const s=new Date(r.getFullYear(),r.getMonth(),1-e),a=[];for(let n=0;n<42;n++){const e=new Date(s.getFullYear(),s.getMonth(),s.getDate()+n),t=e.getMonth()===r.getMonth();a.push({key:`${e.getFullYear()}-${e.getMonth()}-${e.getDate()}`,date:e,label:e.getDate(),isCurrentMonth:t})}return a})(),k=v(n);return e.useEffect(()=>{let e=!0;return(async()=>{if(null==s?void 0:s.id){x(!0);try{const t=await(async e=>{try{return(await d(ao(e))).docs.map(e=>{const t=e.data();return{id:e.id,title:t.title||"",time:t.time||"",type:t.type||"study",description:t.description||"",subject:t.subject||"",reminderDays:t.reminderDays??1,date:t.date}})}catch(t){throw console.error("Failed to fetch calendar events:",t),t}})(s.id);e&&c(t)}catch(t){console.error("Unable to load calendar events:",t)}finally{e&&x(!1)}}else c([])})(),()=>{e=!1}},[null==s?void 0:s.id]),e.useEffect(()=>{if(!(null==s?void 0:s.id)||!(null==s?void 0:s.email))return;const e=async()=>{try{await(async(e,t,s)=>{if(!e||!t)return console.log("Missing userId or userEmail, skipping reminder check"),{success:!1,error:"Missing user information"};try{const r=o(dt,"users",e,"calendarEvents"),a=await d(r),n=new Date;n.setHours(0,0,0,0);const i=[];a.forEach(e=>{const t=e.data();if(!t.date)return void console.log(` Event ${e.id} has no date, skipping`);const s=new Date(t.date);s.setHours(0,0,0,0);const r=Math.ceil((s-n)/864e5),a=t.reminderDays||1;console.log(` Event: ${t.title||"Untitled"}, Date: ${s.toISOString()}, Days until: ${r}, Reminder days: ${a}`),r===a&&r>0?(console.log(` Event "${t.title||"Untitled"}" matches reminder criteria (${r} days until event, reminder set for ${a} days)`),i.push({eventId:e.id,event:{...t,id:e.id},daysUntilEvent:r})):console.log(`  Event "${t.title||"Untitled"}" does not match reminder criteria (${r} days until event, reminder set for ${a} days)`)});const l=[];if(a.forEach(e=>{const t=e.data();if(!t.date)return;const s=new Date(t.date);s.setHours(0,0,0,0);const r=new Date;r.setHours(0,0,0,0);const a=Math.ceil((s-r)/864e5),n=t.reminderDays||1;l.push({id:e.id,title:t.title||"Untitled",date:s.toISOString(),daysUntilEvent:a,reminderDays:n,matches:a===n&&a>0,isPast:a<0})}),0===i.length)return console.log("No reminders to send"),{success:!0,remindersSent:0,totalEvents:l.length,eventsInfo:l};let c=0;const u=[];for(const o of i){console.log(` Sending reminder for event: ${o.event.title} (${o.daysUntilEvent} days until event)`);const r=await no(e,t,s,o.event,o.eventId);u.push({eventTitle:o.event.title,success:r.success,alreadySent:r.alreadySent,error:r.error}),r.success&&!r.alreadySent?(c++,console.log(` Reminder sent successfully for: ${o.event.title}`)):r.alreadySent?console.log(`  Reminder already sent today for: ${o.event.title}`):console.error(` Failed to send reminder for: ${o.event.title}`,r.error)}return console.log(` Sent ${c} event reminder(s) out of ${i.length} total`),{success:!0,remindersSent:c,totalReminders:i.length,totalEvents:l.length,eventsInfo:l,sendResults:u}}catch(r){return console.error("Error checking event reminders:",r),{success:!1,error:r.message}}})(s.id,s.email,s.name)}catch(e){console.error("Error checking reminders:",e)}};e();const t=setInterval(()=>{e()},36e5);return()=>clearInterval(t)},[null==s?void 0:s.id,null==s?void 0:s.email,null==s?void 0:s.name]),U.jsxs("div",{className:"min-h-screen relative overflow-hidden "+(t?"bg-gradient-to-br from-[#120b2c] via-[#1a1240] to-[#09071b] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-rose-100 text-slate-900"),children:[U.jsx("style",{children:"\n        .hide-scrollbar::-webkit-scrollbar { width: 0; height: 0; }\n        .hide-scrollbar { scrollbar-width: none; }\n      "}),U.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[U.jsx("div",{className:"absolute -top-36 left-1/2 h-80 w-80 -translate-x-1/2 rounded-full bg-purple-500/30 blur-3xl"}),U.jsx("div",{className:"absolute top-1/2 right-12 h-64 w-64 rounded-full bg-pink-400/25 blur-[120px]"}),U.jsx("div",{className:"absolute bottom-10 left-10 h-60 w-60 rounded-full bg-blue-400/20 blur-[120px]"})]}),U.jsxs("div",{className:"relative z-10 mx-auto flex w-full max-w-6xl flex-col gap-10 px-6 py-14 hide-scrollbar",children:[U.jsxs("section",{className:"rounded-[32px] border px-8 py-9 shadow-2xl backdrop-blur-xl "+(t?"border-white/10 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-purple-500/10 px-3.5 py-2 text-xs font-semibold text-purple-500",children:[U.jsx(Lt,{className:"h-4 w-4"})," Plan your adventures"]}),U.jsx("h1",{className:"mt-4 text-3xl font-black tracking-tight md:text-4xl",children:"Map out study sessions, quests, and reminders in one view"}),U.jsx("p",{className:"mt-3 max-w-xl text-sm md:text-base "+(t?"text-white/70":"text-slate-600"),children:"Navigate across months, add focused events, and review what is happening each day. Your learning journey is always one click away."}),U.jsxs("div",{className:"mt-6 grid gap-4 sm:grid-cols-3",children:[U.jsxs("div",{className:"rounded-2xl border px-4 py-4 "+(t?"border-white/12 bg-white/8":"border-slate-200 bg-white"),children:[U.jsx("p",{className:"text-xs uppercase tracking-wide text-purple-400",children:"Events this month"}),U.jsx("p",{className:"mt-1 text-lg font-semibold "+(t?"text-white drop-shadow-[0_0_10px_rgba(255,255,255,0.25)]":"text-slate-900"),children:l.filter(e=>{const t=new Date(e.date);return t.getMonth()===r.getMonth()&&t.getFullYear()===r.getFullYear()}).length})]}),U.jsxs("div",{className:"rounded-2xl border px-4 py-4 "+(t?"border-white/12 bg-white/8":"border-slate-200 bg-white"),children:[U.jsx("p",{className:"text-xs uppercase tracking-wide text-purple-400",children:"Study sessions"}),U.jsx("p",{className:"mt-1 text-lg font-semibold "+(t?"text-white drop-shadow-[0_0_10px_rgba(255,255,255,0.25)]":"text-slate-900"),children:l.filter(e=>"study"===e.type).length})]}),U.jsxs("div",{className:"rounded-2xl border px-4 py-4 "+(t?"border-white/12 bg-white/8":"border-slate-200 bg-white"),children:[U.jsx("p",{className:"text-xs uppercase tracking-wide text-purple-400",children:"Upcoming reminders"}),U.jsx("p",{className:"mt-1 text-lg font-semibold "+(t?"text-white drop-shadow-[0_0_10px_rgba(255,255,255,0.25)]":"text-slate-900"),children:l.filter(e=>new Date(e.date)>=new Date).length})]})]})]}),U.jsxs("section",{className:"grid gap-8 lg:grid-cols-[minmax(0,60%)_minmax(0,40%)]",children:[U.jsxs("div",{className:"rounded-[32px] border px-6 py-6 shadow-lg backdrop-blur-xl "+(t?"border-white/12 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsxs("div",{children:[U.jsx("p",{className:"text-xs uppercase tracking-wide text-purple-400",children:"Current month"}),U.jsxs("h2",{className:"text-2xl font-semibold "+(t?"text-white":"text-slate-900"),children:[["January","February","March","April","May","June","July","August","September","October","November","December"][r.getMonth()]," ",r.getFullYear()]})]}),U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx("button",{onClick:()=>a(new Date(r.getFullYear(),r.getMonth()-1)),className:"rounded-full p-3 transition "+(t?"bg-white/10 text-white hover:bg-white/15":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:U.jsx(_t,{className:"h-5 w-5"})}),U.jsx("button",{onClick:()=>a(new Date(r.getFullYear(),r.getMonth()+1)),className:"rounded-full p-3 transition "+(t?"bg-white/10 text-white hover:bg-white/15":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:U.jsx(zt,{className:"h-5 w-5"})})]})]}),U.jsx("div",{className:"mt-6 grid grid-cols-7 gap-2 text-xs font-semibold "+(t?"text-white/60":"text-slate-500"),children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>U.jsx("div",{className:"text-center uppercase tracking-wide",children:e},e))}),U.jsx("div",{className:"mt-4 grid grid-cols-7 gap-2 text-sm",children:N.map(e=>{const s=v(e.date),r=n.toDateString()===e.date.toDateString(),o=(new Date).toDateString()===e.date.toDateString();return U.jsxs("button",{onClick:()=>{i(e.date),e.isCurrentMonth||a(new Date(e.date.getFullYear(),e.date.getMonth(),1))},className:"relative h-20 rounded-2xl border transition "+(r?"border-transparent bg-gradient-to-br from-purple-500 to-pink-500 text-white shadow-lg shadow-purple-500/30":o?t?"border-white/20 bg-white/10 text-white":"border-purple-200 bg-purple-50 text-purple-600":e.isCurrentMonth?t?"border-white/10 bg-white/6 text-white/80 hover:border-white/20 hover:bg-white/10":"border-slate-200 bg-white text-slate-700 hover:bg-slate-50":t?"border-transparent bg-transparent text-white/40":"border-transparent bg-transparent text-slate-400"),children:[U.jsx("span",{className:"text-sm font-medium",children:e.label}),s.length>0&&U.jsx("div",{className:"absolute bottom-3 left-1/2 flex -translate-x-1/2 gap-1",children:s.slice(0,3).map(e=>U.jsx("span",{className:"h-1.5 w-1.5 rounded-full "+("study"===e.type?"bg-blue-400":"homework"===e.type||"summative"===e.type?"bg-yellow-400":"social"===e.type?"bg-green-400":"bg-purple-400")},e.id))})]},e.key)})})]}),U.jsxs("div",{className:"rounded-[32px] border px-6 py-6 shadow-lg backdrop-blur-xl "+(t?"border-white/12 bg-gradient-to-br from-white/12 via-white/6 to-transparent/35":"border-white/70 bg-white"),children:[U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsxs("div",{children:[U.jsx("p",{className:"text-xs uppercase tracking-wide text-purple-400",children:"Selected date"}),U.jsx("h3",{className:"text-lg font-semibold "+(t?"text-white":"text-slate-900"),children:n.toLocaleDateString()})]}),U.jsxs("button",{onClick:()=>b(!0),className:"inline-flex items-center gap-2 rounded-2xl bg-gradient-to-r from-purple-500 to-pink-500 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-purple-500/30 hover:-translate-y-0.5 transition",children:[U.jsx(Ys,{className:"h-4 w-4"})," Add event"]})]}),U.jsx("div",{className:"mt-4 space-y-3 max-h-[50vh] overflow-y-auto hide-scrollbar",children:k.length>0?k.map(e=>U.jsxs("div",{className:"rounded-2xl border px-4 py-4 "+(t?"border-white/10 bg-white/8":"border-slate-200 bg-white"),children:[U.jsxs("div",{className:"flex items-center justify-between gap-3",children:[U.jsxs("div",{children:[U.jsx("p",{className:"text-sm font-semibold "+(t?"text-white":"text-slate-800"),children:e.title}),U.jsx("p",{className:"text-xs mt-1 "+(t?"text-white/60":"text-slate-500"),children:e.time||"All day"})]}),U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx("div",{className:"rounded-full px-3 py-1 text-[11px] font-semibold "+("study"===e.type?"bg-blue-500/15 text-blue-300":"homework"===e.type?"bg-yellow-500/15 text-yellow-300":"summative"===e.type?"bg-red-500/15 text-red-300":"social"===e.type?"bg-green-500/15 text-green-300":"bg-purple-500/15 text-purple-300"),children:e.type}),U.jsx("button",{onClick:()=>j(e.id),className:"rounded-full p-2 transition "+(t?"bg-white/10 text-white/70 hover:bg-white/15 hover:text-white":"bg-slate-100 text-slate-500 hover:bg-slate-200 hover:text-slate-700"),children:U.jsx(pr,{className:"h-4 w-4"})})]})]}),e.description&&U.jsx("p",{className:"mt-3 text-sm leading-relaxed "+(t?"text-white/70":"text-slate-600"),children:e.description}),U.jsx("div",{className:"mt-3 text-xs text-slate-500 flex justify-end gap-3",children:U.jsxs("span",{className:"uppercase tracking-wide",children:["Reminder ",e.reminderDays,"d before"]})})]},e.id)):U.jsx("div",{className:"rounded-2xl border px-6 py-12 text-center text-sm "+(t?"border-white/10 bg-white/8 text-white/60":"border-slate-200 bg-white text-slate-600"),children:"No events scheduled for this date."})})]})]})]}),g&&U.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50",children:U.jsxs("div",{className:"rounded-3xl p-6 border-2 max-w-md mx-4 w-full "+(t?"bg-slate-900/90 border-white/20":"bg-white/95 border-white/40 shadow-2xl"),children:[U.jsx("h3",{className:"text-xl font-bold mb-4 "+(t?"text-white":"text-gray-800"),children:"Add Event"}),U.jsxs("div",{className:"space-y-4",children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-medium mb-2 "+(t?"text-gray-300":"text-gray-600"),children:"Title"}),U.jsx("input",{type:"text",value:w.title,onChange:e=>y({...w,title:e.target.value}),className:"w-full px-3 py-2 rounded-xl border "+(t?"bg-white/5 border-white/20 text-white":"bg-white border-gray-200 text-gray-800"),placeholder:"Event title"})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-medium mb-2 "+(t?"text-gray-300":"text-gray-600"),children:"Time"}),U.jsx("input",{type:"time",value:w.time,onChange:e=>y({...w,time:e.target.value}),className:"w-full px-3 py-2 rounded-xl border "+(t?"bg-white/5 border-white/20 text-white":"bg-white border-gray-200 text-gray-800")})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-medium mb-2 "+(t?"text-gray-300":"text-gray-600"),children:"Type"}),U.jsxs("select",{value:w.type,onChange:e=>y({...w,type:e.target.value}),className:"w-full px-3 py-2 rounded-xl border "+(t?"bg-white/5 border-white/20 text-white":"bg-white border-gray-200 text-gray-800"),children:[U.jsx("option",{value:"study",children:"Study Session"}),U.jsx("option",{value:"homework",children:"Homework"}),U.jsx("option",{value:"summative",children:"Summative Test"}),U.jsx("option",{value:"social",children:"Social Event"}),U.jsx("option",{value:"mission",children:"Mission"}),U.jsx("option",{value:"reward",children:"Reward"})]})]}),("homework"===w.type||"summative"===w.type)&&U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-medium mb-2 "+(t?"text-gray-300":"text-gray-600"),children:"Subject"}),U.jsx("input",{type:"text",value:w.subject,onChange:e=>y({...w,subject:e.target.value}),className:"w-full px-3 py-2 rounded-xl border "+(t?"bg-white/5 border-white/20 text-white":"bg-white border-gray-200 text-gray-800"),placeholder:"e.g., Mathematics, Science, English"})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-medium mb-2 "+(t?"text-gray-300":"text-gray-600"),children:"Reminder Days Before"}),U.jsxs("select",{value:w.reminderDays,onChange:e=>y({...w,reminderDays:parseInt(e.target.value)}),className:"w-full px-3 py-2 rounded-xl border "+(t?"bg-white/5 border-white/20 text-white":"bg-white border-gray-200 text-gray-800"),children:[U.jsx("option",{value:1,children:"1 day before"}),U.jsx("option",{value:2,children:"2 days before"}),U.jsx("option",{value:3,children:"3 days before"}),U.jsx("option",{value:7,children:"1 week before"})]})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-medium mb-2 "+(t?"text-gray-300":"text-gray-600"),children:"Description"}),U.jsx("textarea",{value:w.description,onChange:e=>y({...w,description:e.target.value}),className:"w-full px-3 py-2 rounded-xl border "+(t?"bg-white/5 border-white/20 text-white":"bg-white border-gray-200 text-gray-800"),rows:"3",placeholder:"Event description"})]})]}),U.jsxs("div",{className:"flex space-x-3 mt-6",children:[U.jsx("button",{onClick:()=>b(!1),className:"flex-1 px-4 py-2 rounded-xl font-medium transition-colors "+(t?"bg-white/10 text-white hover:bg-white/20":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Cancel"}),U.jsx("button",{onClick:async()=>{var e;if(w.title&&w.time){const r={...w,date:n.toISOString()};try{let t;t=(null==s?void 0:s.id)?await(async(e,t)=>{try{const s=ao(e),r=u(s),a={title:t.title,time:t.time,type:t.type,description:t.description,subject:t.subject,reminderDays:t.reminderDays,date:t.date,createdAt:p(),updatedAt:p()};return await h(r,a),{id:r.id,...t}}catch(s){throw console.error("Failed to create calendar event:",s),s}})(s.id,r):{id:(null==(e=null==crypto?void 0:crypto.randomUUID)?void 0:e.call(crypto))||Date.now().toString(),...r},c(e=>[...e,t]),y({title:"",time:"",type:"study",description:"",subject:"",reminderDays:1}),b(!1)}catch(t){console.error("Unable to add calendar event:",t)}}},className:"flex-1 px-4 py-2 rounded-xl font-medium transition-colors bg-purple-500 text-white hover:bg-purple-600",children:"Add Event"})]})]})}),U.jsx(ro,{events:l})]})},oo=({isOpen:t,onClose:s,onComplete:r,subject:a="Italian"})=>{const[n,i]=e.useState(30),[o,l]=e.useState(0),[c,d]=e.useState(null),[u,h]=e.useState(0),[m,x]=e.useState(!1),p=(e=>{const t={italian:[{question:"What does 'Ciao' mean in Italian?",options:["Hello","Goodbye","Thank you","Please"],correct:0},{question:"How do you say 'Good morning' in Italian?",options:["Buonasera","Buongiorno","Buonanotte","Arrivederci"],correct:1},{question:"What is the Italian word for 'water'?",options:["Acqua","Pane","Vino","Caff"],correct:0}],mathematics:[{question:"What is 15 + 27?",options:["42","41","43","40"],correct:0},{question:"What is 8  7?",options:["54","56","58","60"],correct:1},{question:"What is 144  12?",options:["11","12","13","14"],correct:1}],philosophy:[{question:"Who wrote 'The Republic'?",options:["Aristotle","Plato","Socrates","Descartes"],correct:1},{question:"What is the main principle of utilitarianism?",options:["Greatest good for greatest number","Individual rights","Divine command","Virtue ethics"],correct:0},{question:"What does 'cogito ergo sum' mean?",options:["I think therefore I am","I see therefore I believe","I know therefore I exist","I feel therefore I am"],correct:0}],biology:[{question:"What is the powerhouse of the cell?",options:["Nucleus","Mitochondria","Ribosome","Golgi apparatus"],correct:1},{question:"What is the process by which plants make food?",options:["Respiration","Photosynthesis","Digestion","Fermentation"],correct:1},{question:"What is the basic unit of heredity?",options:["Chromosome","Gene","DNA","Protein"],correct:1}]};return t[e.toLowerCase()]||t.italian})(a);e.useEffect(()=>{if(t&&n>0){const e=setTimeout(()=>{i(n-1)},1e3);return()=>clearTimeout(e)}0!==n||m||g()},[t,n]),e.useEffect(()=>{t&&(i(30),l(0),d(null),h(0),x(!1))},[t]);const g=()=>{x(!0),setTimeout(()=>{r(u,p.length),s()},2e3)};return t?U.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:U.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl p-8 max-w-md w-full shadow-2xl",children:[U.jsxs("div",{className:"flex items-center justify-between mb-6",children:[U.jsxs("div",{className:"flex items-center space-x-3",children:[U.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900 rounded-xl",children:U.jsx(Rt,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),U.jsxs("div",{children:[U.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Focus Test"}),U.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[a," - 30 seconds"]})]})]}),U.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors",children:U.jsx(Rr,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),U.jsxs("div",{className:"mb-6",children:[U.jsxs("div",{className:"flex items-center justify-between mb-2",children:[U.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Time Remaining"}),U.jsx("span",{className:"text-lg font-bold "+(n<=10?"text-red-500":"text-purple-600 dark:text-purple-400"),children:(b=n,`${Math.floor(b/60)}:${(b%60).toString().padStart(2,"0")}`)})]}),U.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:U.jsx("div",{className:"h-2 rounded-full transition-all duration-1000 "+(n<=10?"bg-red-500":"bg-purple-500"),style:{width:n/30*100+"%"}})})]}),m?U.jsxs("div",{className:"text-center",children:[U.jsxs("div",{className:"mb-6",children:[U.jsx("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mx-auto mb-4",children:U.jsx($t,{className:"w-8 h-8 text-green-600 dark:text-green-400"})}),U.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Test Completed!"}),U.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["You scored ",u," out of ",p.length]})]}),U.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-xl p-4 mb-6",children:[U.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[U.jsx(ur,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),U.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["Focus Level: ",u>=.8*p.length?"Excellent":u>=.6*p.length?"Good":"Needs Improvement"]})]}),U.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:u>=.8*p.length?"You're ready to focus! You can now access social media.":"Consider taking a short break before using social media."})]})]}):U.jsxs("div",{children:[U.jsxs("div",{className:"flex items-center justify-between mb-6",children:[U.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Question ",o+1," of ",p.length]}),U.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["Score: ",u,"/",o]})]}),U.jsxs("div",{className:"mb-6",children:[U.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:p[o].question}),U.jsx("div",{className:"space-y-3",children:p[o].options.map((e,t)=>U.jsx("button",{onClick:()=>{d(t)},className:"w-full p-3 text-left rounded-xl border-2 transition-all "+(c===t?"border-purple-500 bg-purple-50 dark:bg-purple-900/20 text-purple-700 dark:text-purple-300":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 text-gray-700 dark:text-gray-300"),children:e},t))})]}),U.jsx("button",{onClick:()=>{c===p[o].correct&&h(u+1),o<p.length-1?(l(o+1),d(null)):g()},disabled:null===c,className:"w-full py-3 rounded-xl font-medium transition-colors "+(null!==c?"bg-purple-500 hover:bg-purple-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-400 dark:text-gray-500 cursor-not-allowed"),children:o<p.length-1?"Next Question":"Complete Test"})]})]})}):null;var b},lo=()=>{const[t,s]=e.useState(!1),[r,a]=e.useState("Italian"),[n,i]=e.useState(null),[o,l]=e.useState([]),c=["facebook.com","instagram.com","twitter.com","tiktok.com","youtube.com","snapchat.com","linkedin.com","reddit.com","pinterest.com","discord.com"],d=e=>{try{const t=new URL(e).hostname.toLowerCase();return c.some(e=>t.includes(e))}catch{return!1}};e.useEffect(()=>{const e=()=>{if((()=>{if(t)return!1;if("undefined"!=typeof window&&d(window.location.href)){const e=Date.now();if(!n||e-n>36e5)return!0}return!1})()){s(!0);const e=["Italian","Mathematics","Philosophy","Biology"];a(e[Math.floor(Math.random()*e.length)])}};e();const r=()=>{setTimeout(e,100)};window.addEventListener("popstate",r);const i=setInterval(e,2e3);return()=>{window.removeEventListener("popstate",r),clearInterval(i)}},[n,t]);return e.useEffect(()=>{const e=localStorage.getItem("focusTestResults"),t=localStorage.getItem("lastFocusTestTime");e&&l(JSON.parse(e)),t&&i(parseInt(t))},[]),{showFocusTest:t,testSubject:r,testResults:o,handleTestComplete:(e,t)=>{const a={score:e,totalQuestions:t,subject:r,timestamp:(new Date).toISOString(),percentage:Math.round(e/t*100)};l(e=>[...e.slice(-9),a]),i(Date.now()),s(!1),localStorage.setItem("focusTestResults",JSON.stringify([...o.slice(-9),a])),localStorage.setItem("lastFocusTestTime",Date.now().toString())},closeFocusTest:()=>{s(!1)},triggerFocusTest:(e="Italian")=>{a(e),s(!0)},getTestStats:()=>{if(0===o.length)return null;const e=o.length,t=o.reduce((e,t)=>e+t.percentage,0)/e,s=Math.max(...o.map(e=>e.percentage)),r=o.slice(-5),a=r.reduce((e,t)=>e+t.percentage,0)/r.length;return{totalTests:e,averageScore:Math.round(t),bestScore:s,recentAverage:Math.round(a),lastTest:o[o.length-1]}},isSocialMediaSite:d}},co={}.VITE_API_BASE_URL||"http://localhost:3003/api",uo=[{id:"mathematics",name:"Mathematics",Icon:Dt},{id:"physics",name:"Physics",Icon:jt},{id:"chemistry",name:"Chemistry",Icon:ds},{id:"biology",name:"Biology",Icon:ts},{id:"english",name:"English",Icon:Pt},{id:"italian",name:"Italian",Icon:js},{id:"spanish",name:"Spanish",Icon:js},{id:"french",name:"French",Icon:js},{id:"history",name:"History",Icon:vs},{id:"geography",name:"Geography",Icon:ms},{id:"computerScience",name:"Computer Science",Icon:Gt},{id:"other",name:"Other",Icon:Ss}],ho=()=>{const t=qe(),{isDark:s}=mt(),{user:r}=Br(),{showSuccess:a,showError:n}=Hr(),i=e.useRef(null),o=e.useRef(null),[l,c]=e.useState(""),[d,u]=e.useState(null),[h,m]=e.useState(null),[x,p]=e.useState(""),[g,b]=e.useState(!1),[f,w]=e.useState(!1),[y,v]=e.useState(null),[j,N]=e.useState(!1),[k,S]=e.useState(0),[C,E]=e.useState([]),[A,T]=e.useState([]),[I,P]=e.useState([]),[q,R]=e.useState(""),[M,D]=e.useState(!1),[L,F]=e.useState(null),[$,O]=e.useState(!1),[B,_]=e.useState(0),[z,W]=e.useState(!1),[H,G]=e.useState("");e.useEffect(()=>{var e;null==(e=o.current)||e.scrollIntoView({behavior:"smooth"})},[I]);const V=e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(!s)return;if(["image/jpeg","image/png","image/gif","image/webp","application/pdf"].includes(s.type))if(s.size>10485760)n("File size must be less than 10MB","File Too Large");else if(u(s),s.type.startsWith("image/")){const e=new FileReader;e.onloadend=()=>{m(e.result)},e.readAsDataURL(s)}else m(null);else n("Please upload an image (JPEG, PNG, GIF, WebP) or PDF file","Invalid File")},Y=async()=>{if(!q.trim()||M)return;const e=q.trim();R(""),P(t=>[...t,{type:"user",content:e,timestamp:new Date}]),D(!0);try{const t=await(async({sessionId:e,userId:t,answer:s,currentStep:r,steps:a})=>{try{const a=await fetch(`${co}/homework/check`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:e,userId:t,answer:s,currentStep:r})}),n=await a.json();return a.ok&&n.success?{success:!0,response:n.response,isCorrect:n.isCorrect,isPartiallyCorrect:n.isPartiallyCorrect,nextStep:n.nextStep,problemSolved:n.problemSolved}:{success:!1,error:n.error||"Failed to check answer"}}catch(n){return console.error(" [Homework Helper] Error checking answer:",n),{success:!1,error:n.message||"Failed to check answer"}}})({sessionId:L,userId:r.id,answer:e,currentStep:k,steps:C});t.success?(P(e=>[...e,{type:"tutor",content:t.response,isCorrect:t.isCorrect,timestamp:new Date}]),t.isCorrect&&t.nextStep&&(S(t.nextStep),t.nextStep<C.length&&setTimeout(()=>{P(e=>[...e,{type:"tutor",content:`**Step ${t.nextStep+1}: ${C[t.nextStep].title}**\n\n${C[t.nextStep].guidance}`,timestamp:new Date}])},1500)),t.problemSolved&&(O(!0),setTimeout(()=>{P(e=>[...e,{type:"celebration",content:` **Congratulations!** You've successfully solved this problem!\n\nYou used ${B} hint${1!==B?"s":""} and completed all ${C.length} steps. Great job working through it yourself!`,timestamp:new Date}])},2e3))):n(t.error||"Failed to process your answer","Error")}catch(t){console.error("Error checking answer:",t),P(e=>[...e,{type:"tutor",content:"I'm having trouble processing that. Could you try rephrasing your answer?",timestamp:new Date}])}finally{D(!1)}},Q=()=>{N(!1),w(!1),u(null),m(null),v(null),p(""),c(""),P([]),E([]),T([]),S(0),F(null),O(!1),_(0),W(!1),G("")};return U.jsxs("div",{className:"min-h-screen relative overflow-hidden "+(s?"bg-gradient-to-br from-[#0d0a1f] via-[#1a1040] to-[#0a0818] text-white":"bg-gradient-to-br from-amber-50 via-orange-50 to-rose-50 text-slate-900"),children:[U.jsxs("div",{className:"pointer-events-none absolute inset-0 overflow-hidden",children:[U.jsx("div",{className:"absolute -top-40 -left-20 h-96 w-96 rounded-full blur-3xl "+(s?"bg-orange-500/20":"bg-orange-300/40")}),U.jsx("div",{className:"absolute top-1/3 right-0 h-80 w-80 rounded-full blur-3xl "+(s?"bg-amber-500/15":"bg-amber-200/50")}),U.jsx("div",{className:"absolute bottom-20 left-1/4 h-64 w-64 rounded-full blur-3xl "+(s?"bg-rose-500/15":"bg-rose-200/40")})]}),U.jsxs("div",{className:"relative z-10 mx-auto max-w-5xl px-6 py-10",children:[U.jsxs("div",{className:"flex items-center justify-between mb-8",children:[U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx("button",{onClick:()=>t("/quest-academy/quests"),className:"p-3 rounded-2xl transition-all "+(s?"bg-white/10 text-white hover:bg-white/20":"bg-white text-slate-700 hover:bg-slate-50 shadow-lg"),children:U.jsx(wt,{className:"h-5 w-5"})}),U.jsxs("div",{children:[U.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full px-3 py-1.5 text-xs font-semibold mb-2 "+(s?"bg-orange-500/20 text-orange-400":"bg-orange-100 text-orange-600"),children:[U.jsx(Rt,{className:"h-3.5 w-3.5"}),"AI Learning Companion"]}),U.jsx("h1",{className:"text-3xl font-black tracking-tight "+(s?"text-white":"text-slate-900"),children:"Homework Helper"}),U.jsx("p",{className:"mt-1 text-sm "+(s?"text-white/60":"text-slate-500"),children:"Learn step-by-step, understand deeply"})]})]}),j&&U.jsxs("button",{onClick:Q,className:"inline-flex items-center gap-2 px-4 py-2.5 rounded-xl font-semibold transition "+(s?"bg-white/10 text-white hover:bg-white/20":"bg-white text-slate-700 hover:bg-slate-50 shadow-lg"),children:[U.jsx(Js,{className:"h-4 w-4"}),"New Problem"]})]}),j?U.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[U.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[(y||h)&&U.jsxs("div",{className:"rounded-3xl border p-4 "+(s?"border-white/10 bg-gradient-to-br from-white/8 via-white/5 to-transparent":"border-orange-200/50 bg-white shadow-lg"),children:[U.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 "+(s?"text-white":"text-slate-900"),children:[U.jsx(Ft,{className:"h-4 w-4 text-orange-500"}),"Your Homework"]}),U.jsx("img",{src:y||h,alt:"Homework",className:"w-full rounded-xl object-contain max-h-48 cursor-pointer hover:opacity-90 transition "+(s?"border border-white/10":"border border-orange-200"),onClick:()=>window.open(y||h,"_blank"),title:"Click to view full size"}),U.jsx("p",{className:"text-xs mt-2 text-center "+(s?"text-white/50":"text-slate-500"),children:"Click to enlarge"})]}),U.jsxs("div",{className:"rounded-3xl border p-5 "+(s?"border-white/10 bg-gradient-to-br from-white/8 via-white/5 to-transparent":"border-orange-200/50 bg-white shadow-lg"),children:[U.jsxs("h3",{className:"text-sm font-bold mb-4 flex items-center gap-2 "+(s?"text-white":"text-slate-900"),children:[U.jsx(ur,{className:"h-4 w-4 text-orange-500"}),"Your Progress"]}),U.jsx("div",{className:"space-y-3",children:C.map((e,t)=>U.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl transition "+(t===k?s?"bg-orange-500/20 border border-orange-500/30":"bg-orange-100 border border-orange-200":t<k?s?"bg-green-500/10":"bg-green-50":s?"bg-white/5":"bg-slate-50"),children:[U.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 text-xs font-bold "+(t<k?"bg-green-500 text-white":t===k?"bg-orange-500 text-white":s?"bg-white/20 text-white/50":"bg-slate-200 text-slate-500"),children:t<k?U.jsx($t,{className:"h-4 w-4"}):t+1}),U.jsx("div",{className:"flex-1 min-w-0",children:U.jsx("p",{className:"text-sm font-semibold truncate "+(t<=k?s?"text-white":"text-slate-900":s?"text-white/50":"text-slate-400"),children:e.title})})]},t))}),U.jsxs("div",{className:"mt-6 pt-4 border-t "+(s?"border-white/10":"border-orange-100"),children:[U.jsxs("div",{className:"flex justify-between text-sm",children:[U.jsx("span",{className:s?"text-white/50":"text-slate-500",children:"Hints used"}),U.jsx("span",{className:"font-semibold "+(s?"text-white":"text-slate-900"),children:B})]}),U.jsxs("div",{className:"flex justify-between text-sm mt-2",children:[U.jsx("span",{className:s?"text-white/50":"text-slate-500",children:"Progress"}),U.jsxs("span",{className:"font-semibold "+(s?"text-white":"text-slate-900"),children:[Math.round(k/C.length*100),"%"]})]})]}),!$&&U.jsxs("button",{onClick:async()=>{if(!M){D(!0),_(e=>e+1);try{const e=await(async({sessionId:e,userId:t,currentStep:s,hintsUsed:r})=>{try{const a=await fetch(`${co}/homework/hint`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:e,userId:t,currentStep:s,hintsUsed:r})}),n=await a.json();return a.ok&&n.success?{success:!0,hint:n.hint,hintsRemaining:n.hintsRemaining}:{success:!1,error:n.error||"Failed to get hint"}}catch(a){return console.error(" [Homework Helper] Error getting hint:",a),{success:!1,error:a.message||"Failed to get hint"}}})({sessionId:L,userId:r.id,currentStep:k,hintsUsed:B});e.success?P(t=>[...t,{type:"hint",content:` **Hint:** ${e.hint}`,timestamp:new Date}]):n(e.error||"Failed to get hint","Error")}catch(e){console.error("Error getting hint:",e),n("Failed to get hint","Error")}finally{D(!1)}}},disabled:M,className:`w-full mt-4 py-3 rounded-xl font-semibold transition flex items-center justify-center gap-2 ${s?"bg-amber-500/20 text-amber-400 hover:bg-amber-500/30 border border-amber-500/30":"bg-amber-100 text-amber-700 hover:bg-amber-200 border border-amber-200"} ${M?"opacity-50 cursor-not-allowed":""}`,children:[U.jsx(Cs,{className:"h-4 w-4"}),"Get a Hint"]})]})]}),U.jsxs("div",{className:"lg:col-span-2 rounded-3xl border overflow-hidden flex flex-col "+(s?"border-white/10 bg-gradient-to-br from-white/8 via-white/5 to-transparent":"border-orange-200/50 bg-white shadow-lg"),style:{height:"600px"},children:[U.jsx("div",{className:"p-4 border-b "+(s?"border-white/10":"border-orange-100"),children:U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center bg-gradient-to-br from-orange-500 to-rose-500",children:U.jsx(nr,{className:"h-5 w-5 text-white"})}),U.jsxs("div",{children:[U.jsx("h3",{className:"font-bold "+(s?"text-white":"text-slate-900"),children:"Study Buddy"}),U.jsx("p",{className:"text-xs "+(s?"text-white/50":"text-slate-500"),children:"Your personal learning companion"})]})]})}),U.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[I.map((e,t)=>U.jsx("div",{className:"flex "+("user"===e.type?"justify-end":"justify-start"),children:U.jsxs("div",{className:"max-w-[85%] rounded-2xl px-4 py-3 "+("user"===e.type?"bg-orange-500 text-white":"hint"===e.type?s?"bg-amber-500/20 text-amber-200 border border-amber-500/30":"bg-amber-100 text-amber-800 border border-amber-200":"celebration"===e.type?s?"bg-gradient-to-r from-green-500/20 to-emerald-500/20 text-green-200 border border-green-500/30":"bg-gradient-to-r from-green-100 to-emerald-100 text-green-800 border border-green-200":s?"bg-white/10 text-white":"bg-slate-100 text-slate-900"),children:[U.jsx("div",{className:"text-sm whitespace-pre-wrap",children:e.content.split("\n").map((t,s)=>{if(t.startsWith("**")&&t.endsWith("**"))return U.jsx("strong",{children:t.slice(2,-2)},s);if(t.includes("**")){const e=t.split("**");return U.jsx("span",{children:e.map((e,t)=>t%2==1?U.jsx("strong",{children:e},t):e)},s)}return U.jsxs("span",{children:[t,s<e.content.split("\n").length-1&&U.jsx("br",{})]},s)})}),void 0!==e.isCorrect&&U.jsx("div",{className:"mt-2 flex items-center gap-1 text-xs "+(e.isCorrect?s?"text-green-400":"text-green-600":s?"text-orange-400":"text-orange-600"),children:e.isCorrect?U.jsxs(U.Fragment,{children:[U.jsx($t,{className:"h-3 w-3"})," Good thinking!"]}):U.jsxs(U.Fragment,{children:[U.jsx(bs,{className:"h-3 w-3"})," Keep trying!"]})})]})},t)),M&&U.jsx("div",{className:"flex justify-start",children:U.jsx("div",{className:"rounded-2xl px-4 py-3 "+(s?"bg-white/10":"bg-slate-100"),children:U.jsxs("div",{className:"flex items-center gap-2",children:[U.jsx(Es,{className:"h-4 w-4 animate-spin "+(s?"text-white/50":"text-slate-500")}),U.jsx("span",{className:"text-sm "+(s?"text-white/50":"text-slate-500"),children:"Thinking..."})]})})}),U.jsx("div",{ref:o})]}),!$&&U.jsx("div",{className:"p-4 border-t "+(s?"border-white/10":"border-orange-100"),children:U.jsxs("div",{className:"flex gap-3",children:[U.jsx("input",{type:"text",value:q,onChange:e=>R(e.target.value),onKeyPress:e=>"Enter"===e.key&&Y(),placeholder:"Type your answer or question...",className:"flex-1 px-4 py-3 rounded-xl border focus:ring-2 focus:ring-orange-500 focus:border-transparent "+(s?"bg-white/10 border-white/20 text-white placeholder-white/40":"bg-orange-50/50 border-orange-200 text-slate-900 placeholder-slate-400")}),U.jsx("button",{onClick:Y,disabled:!q.trim()||M,className:`px-5 py-3 rounded-xl font-semibold transition ${!q.trim()||M?"opacity-50 cursor-not-allowed":""} bg-gradient-to-r from-orange-500 to-rose-500 text-white`,children:U.jsx(tr,{className:"h-5 w-5"})})]})}),$&&U.jsx("div",{className:"p-4 border-t "+(s?"border-white/10":"border-orange-100"),children:U.jsxs("button",{onClick:Q,className:"w-full py-3 rounded-xl font-bold transition flex items-center justify-center gap-2 bg-gradient-to-r from-green-500 to-emerald-500 text-white",children:[U.jsx(Js,{className:"h-5 w-5"}),"Try Another Problem"]})})]})]}):U.jsxs("div",{className:"rounded-3xl border shadow-2xl overflow-hidden "+(s?"border-white/10 bg-gradient-to-br from-white/8 via-white/5 to-transparent":"border-orange-200/50 bg-white"),children:[U.jsxs("div",{className:"p-6 border-b "+(s?"border-white/10":"border-orange-100"),children:[U.jsxs("label",{className:"block text-sm font-bold mb-4 "+(s?"text-white/80":"text-slate-700"),children:[U.jsx(Pt,{className:"inline h-4 w-4 mr-2"}),"What subject is this homework for?"]}),U.jsx("div",{className:"flex flex-wrap gap-2",children:uo.map(e=>U.jsxs("button",{onClick:()=>c(e.id),className:"px-4 py-2.5 rounded-xl text-sm font-semibold transition-all "+(l===e.id?"bg-gradient-to-r from-orange-500 to-rose-500 text-white shadow-lg shadow-orange-500/30":s?"bg-white/10 text-white/80 hover:bg-white/20":"bg-orange-50 text-slate-700 hover:bg-orange-100"),children:[U.jsx(e.Icon,{className:"h-4 w-4 mr-2"}),e.name]},e.id))})]}),U.jsxs("div",{className:"p-6",children:[U.jsxs("label",{className:"block text-sm font-bold mb-4 "+(s?"text-white/80":"text-slate-700"),children:[U.jsx(Ft,{className:"inline h-4 w-4 mr-2"}),"Upload your homework (photo or file)"]}),h?U.jsxs("div",{className:"relative",children:[U.jsx("img",{src:h,alt:"Homework preview",className:"w-full max-h-80 object-contain rounded-2xl border border-white/10"}),U.jsx("button",{onClick:()=>{u(null),m(null),i.current&&(i.current.value="")},className:"absolute top-3 right-3 p-2 rounded-full transition "+(s?"bg-black/50 text-white hover:bg-black/70":"bg-white/90 text-slate-700 hover:bg-white shadow-lg"),children:U.jsx(Rr,{className:"h-5 w-5"})})]}):U.jsxs("div",{onClick:()=>{var e;return null==(e=i.current)?void 0:e.click()},onDrop:e=>{var t;e.preventDefault();const s=null==(t=e.dataTransfer.files)?void 0:t[0];if(s){V({target:{files:[s]}})}},onDragOver:e=>{e.preventDefault()},className:"relative border-2 border-dashed rounded-2xl p-10 text-center cursor-pointer transition-all "+(s?"border-white/20 hover:border-orange-400/50 hover:bg-white/5":"border-orange-200 hover:border-orange-400 hover:bg-orange-50/50"),children:[U.jsx("input",{ref:i,type:"file",accept:"image/*,application/pdf",onChange:V,className:"hidden"}),U.jsx("div",{className:"mx-auto w-16 h-16 rounded-2xl flex items-center justify-center mb-4 "+(s?"bg-orange-500/20":"bg-orange-100"),children:U.jsx(yr,{className:"h-8 w-8 "+(s?"text-orange-400":"text-orange-500")})}),U.jsx("p",{className:"text-lg font-semibold mb-2 "+(s?"text-white":"text-slate-900"),children:"Drag & drop or click to upload"}),U.jsx("p",{className:"text-sm "+(s?"text-white/50":"text-slate-500"),children:"Supports JPEG, PNG, WebP, GIF, or PDF  Max 10MB"})]}),U.jsxs("div",{className:"relative my-6",children:[U.jsx("div",{className:"absolute inset-0 flex items-center",children:U.jsx("div",{className:"w-full border-t "+(s?"border-white/10":"border-orange-200")})}),U.jsx("div",{className:"relative flex justify-center",children:U.jsx("span",{className:"px-4 text-sm font-medium "+(s?"bg-[#1a1040] text-white/50":"bg-white text-slate-500"),children:"or type your problem"})})]}),U.jsx("textarea",{value:x,onChange:e=>p(e.target.value),placeholder:"Describe your homework problem in detail...",rows:4,className:"w-full px-5 py-4 rounded-2xl border resize-none focus:ring-2 focus:ring-orange-500 focus:border-transparent "+(s?"bg-white/10 border-white/20 text-white placeholder-white/40":"bg-orange-50/50 border-orange-200 text-slate-900 placeholder-slate-400")}),U.jsx("button",{onClick:async()=>{if(r)if(l)if(d||x.trim()){h&&v(h),b(!0),P([]);try{const e=await(async({userId:e,subject:t,imageData:s,problemText:r,fileName:a})=>{var n;try{console.log(" [Homework Helper] Analyzing homework:",{userId:e,subject:t,hasImage:!!s,hasText:!!r});const i=await fetch(`${co}/homework/analyze`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,subject:t,imageData:s,problemText:r,fileName:a})}),o=await i.json();return i.ok&&o.success?(console.log(" [Homework Helper] Analysis successful:",o.sessionId),{success:!0,sessionId:o.sessionId,problemSummary:o.problemSummary,problemType:o.problemType,steps:o.steps||[],initialMessage:o.initialMessage,encouragement:o.encouragement,hints:(null==(n=o.steps)?void 0:n.flatMap(e=>e.hints||[]))||[]}):(console.error(" [Homework Helper] Analysis failed:",o.error),{success:!1,error:o.error||"Failed to analyze homework"})}catch(i){return console.error(" [Homework Helper] Error analyzing homework:",i),{success:!1,error:i.message||"Failed to analyze homework. Please check your connection."}}})({userId:r.id,subject:l,imageData:h,problemText:x.trim(),fileName:null==d?void 0:d.name});if(e.success){F(e.sessionId),E(e.steps||[]),T(e.hints||[]),S(0),N(!0),w(!0),G(e.problemSummary||""),W(!!h);const t=[{type:"tutor",content:e.initialMessage||"I've analyzed your homework problem! Let's work through it together step by step. I won't give you the answer directly - instead, I'll guide you to understand the concepts and find the solution yourself. Ready to begin?",timestamp:new Date}];e.encouragement&&t.push({type:"tutor",content:` ${e.encouragement}`,timestamp:new Date}),e.problemSummary&&t.push({type:"tutor",content:` **Problem:** ${e.problemSummary}`,timestamp:new Date}),P(t),e.steps&&e.steps.length>0&&setTimeout(()=>{P(t=>[...t,{type:"tutor",content:`**Step 1: ${e.steps[0].title}**\n\n${e.steps[0].guidance}${e.steps[0].concept?`\n\n **Key concept:** ${e.steps[0].concept}`:""}`,timestamp:new Date}])},1500),a("Problem analyzed! Let's learn together.","Analysis Complete")}else n(e.error||"Failed to analyze homework","Error")}catch(e){console.error("Error analyzing homework:",e),n("An error occurred while analyzing your homework","Error")}finally{b(!1)}}else n("Please upload an image or describe your problem","Input Required");else n("Please select a subject","Subject Required");else n("Please log in to use the Homework Helper","Authentication Required")},disabled:g||!d&&!x.trim()||!l,className:`w-full mt-6 py-4 rounded-2xl font-bold text-lg transition-all flex items-center justify-center gap-3 ${g||!d&&!x.trim()||!l?"opacity-50 cursor-not-allowed":"hover:scale-[1.02] hover:shadow-xl"} bg-gradient-to-r from-orange-500 via-rose-500 to-pink-500 text-white shadow-lg shadow-orange-500/30`,children:g?U.jsxs(U.Fragment,{children:[U.jsx(Es,{className:"h-6 w-6 animate-spin"}),"Analyzing your homework..."]}):U.jsxs(U.Fragment,{children:[U.jsx(ur,{className:"h-6 w-6"}),"Start Learning Session"]})})]}),U.jsxs("div",{className:"p-6 border-t "+(s?"border-white/10 bg-white/5":"border-orange-100 bg-orange-50/30"),children:[U.jsx("h3",{className:"text-sm font-bold mb-4 "+(s?"text-white/80":"text-slate-700"),children:"How it works"}),U.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[U.jsxs("div",{className:"flex items-start gap-3",children:[U.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 "+(s?"bg-orange-500/20 text-orange-400":"bg-orange-100 text-orange-600"),children:"1"}),U.jsxs("div",{children:[U.jsx("p",{className:"text-sm font-semibold "+(s?"text-white":"text-slate-900"),children:"Upload your problem"}),U.jsx("p",{className:"text-xs mt-1 "+(s?"text-white/50":"text-slate-500"),children:"Take a photo or describe it"})]})]}),U.jsxs("div",{className:"flex items-start gap-3",children:[U.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 "+(s?"bg-rose-500/20 text-rose-400":"bg-rose-100 text-rose-600"),children:"2"}),U.jsxs("div",{children:[U.jsx("p",{className:"text-sm font-semibold "+(s?"text-white":"text-slate-900"),children:"Get guided steps"}),U.jsx("p",{className:"text-xs mt-1 "+(s?"text-white/50":"text-slate-500"),children:"AI breaks it down for you"})]})]}),U.jsxs("div",{className:"flex items-start gap-3",children:[U.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 "+(s?"bg-pink-500/20 text-pink-400":"bg-pink-100 text-pink-600"),children:"3"}),U.jsxs("div",{children:[U.jsx("p",{className:"text-sm font-semibold "+(s?"text-white":"text-slate-900"),children:"Learn by doing"}),U.jsx("p",{className:"text-xs mt-1 "+(s?"text-white/50":"text-slate-500"),children:"Solve it yourself with hints"})]})]})]})]})]})]})]})},mo={}.VITE_API_BASE_URL||"http://localhost:3003/api",xo={BRONZE:{name:"Bronze",minPoints:0,maxPoints:499,color:"#CD7F32",iconName:"Shield"},SILVER:{name:"Silver",minPoints:500,maxPoints:999,color:"#C0C0C0",iconName:"Medal"},GOLD:{name:"Gold",minPoints:1e3,maxPoints:1499,color:"#FFD700",iconName:"Trophy"},PLATINUM:{name:"Platinum",minPoints:1500,maxPoints:1999,color:"#40E0D0",iconName:"Gem"},DIAMOND:{name:"Diamond",minPoints:2e3,maxPoints:2499,color:"#B9F2FF",iconName:"Diamond"},MASTER:{name:"Master",minPoints:2500,maxPoints:1/0,color:"#FFD700",iconName:"Crown"}},po=async(e,t,s)=>{try{const r=await fetch(`${mo}/ranked/match/${e}/next`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t,clientQuestionIndex:s})}),a=await r.json();return r.ok&&a.success?{success:!0,status:a.status,currentQuestion:a.currentQuestion,winner:a.winner,playerNum:a.playerNum,player1Score:a.player1Score,player2Score:a.player2Score,player1PointChange:a.player1PointChange,player2PointChange:a.player2PointChange,pointChange:a.pointChange}:{success:!1,error:a.error}}catch(r){return console.error("Error moving to next question:",r),{success:!1,error:r.message}}},go={Shield:rr,Medal:Rs,Trophy:fr,Gem:us,Diamond:es,Crown:Xt},bo=({tier:e,points:t,size:s="md",showPoints:r=!0,showName:a=!0,className:n=""})=>{const i=xo[e]||xo.BRONZE,o=go[i.iconName]||rr,l={sm:{icon:"h-5 w-5",text:"text-xs",container:"px-2 py-1"},md:{icon:"h-8 w-8",text:"text-sm",container:"px-3 py-2"},lg:{icon:"h-12 w-12",text:"text-base",container:"px-4 py-3"},xl:{icon:"h-16 w-16",text:"text-lg",container:"px-6 py-4"}},c=l[s]||l.md;return U.jsxs("div",{className:`inline-flex flex-col items-center rounded-xl bg-gradient-to-br ${{BRONZE:"from-orange-900/50 to-orange-700/30",SILVER:"from-gray-700/50 to-gray-500/30",GOLD:"from-yellow-700/50 to-yellow-500/30",PLATINUM:"from-cyan-800/50 to-cyan-600/30",DIAMOND:"from-blue-800/50 to-blue-500/30",MASTER:"from-purple-900/50 via-pink-700/30 to-purple-800/50"}[e]} \n        shadow-lg ${{BRONZE:"shadow-orange-500/30",SILVER:"shadow-gray-400/40",GOLD:"shadow-yellow-500/50",PLATINUM:"shadow-cyan-400/50",DIAMOND:"shadow-blue-400/60",MASTER:"shadow-purple-500/70"}[e]} ${c.container} ${n}`,children:[U.jsx(o,{className:`${c.icon} ${{BRONZE:"text-orange-400",SILVER:"text-gray-300",GOLD:"text-yellow-400",PLATINUM:"text-cyan-300",DIAMOND:"text-blue-300",MASTER:"text-purple-300"}[e]} drop-shadow-lg`}),a&&U.jsx("span",{className:`${c.text} font-bold text-white mt-1`,children:i.name}),r&&void 0!==t&&U.jsxs("span",{className:`${c.text} text-white/70`,children:[t," pts"]})]})},fo={BRONZE:rr,SILVER:Rs,GOLD:fr,PLATINUM:us,DIAMOND:es,MASTER:Xt},wo=({matchId:t,userId:s,opponent:r,subject:a,difficulty:n,onComplete:i,onExit:o})=>{var l,c,d;const{isDark:u}=mt(),h=e.useRef(null),m=e.useRef(null),x=e.useRef(null),[p,g]=e.useState(null),[b,f]=e.useState(!0),[w,y]=e.useState(null),[v,j]=e.useState(0),[N,k]=e.useState(null),[S,C]=e.useState(!1),[E,A]=e.useState(null),[T,I]=e.useState(15),[P,q]=e.useState(!1),[R,M]=e.useState(0),[D,L]=e.useState(0),[F,$]=e.useState(!1),[O,B]=e.useState(null);e.useEffect(()=>{_()},[t]),e.useEffect(()=>(!p||S||F||(m.current=Date.now(),I(15),h.current=setInterval(()=>{I(e=>e<=1?(clearInterval(h.current),z(),0):e-1)},1e3)),()=>clearInterval(h.current)),[v,p,S]);const _=async()=>{f(!0);try{const e=await(async(e,t)=>{try{const s=await fetch(`${mo}/ranked/match/${e}?userId=${t}`),r=await s.json();return s.ok&&r.success?{success:!0,match:r.match}:{success:!1,error:r.error}}catch(w){return console.error("Error getting match:",w),{success:!1,error:w.message}}})(t,s);e.success?(g(e.match),j(e.match.currentQuestion),M(e.match.player1Score),L(e.match.player2Score),"pending"===e.match.status&&await(async e=>{try{const t=await fetch(`${mo}/ranked/match/${e}/start`,{method:"POST",headers:{"Content-Type":"application/json"}}),s=await t.json();return{success:s.success,status:s.status}}catch(w){return console.error("Error starting match:",w),{success:!1,error:w.message}}})(t)):y(e.error)}catch(e){y(e.message)}finally{f(!1)}},z=async()=>{S||await W(-1)},W=async(e=N)=>{if(S||null===e)return;clearInterval(h.current),C(!0);const r=Date.now()-m.current;try{console.log(` Submitting Q${v}, answer: ${e}`);const a=await(async({matchId:e,userId:t,questionIndex:s,answer:r,answerTime:a})=>{try{const n=await fetch(`${mo}/ranked/match/${e}/answer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t,questionIndex:s,answer:r,answerTime:a})}),i=await n.json();return n.ok&&i.success?{success:!0,correct:i.correct,correctAnswer:i.correctAnswer,player1Score:i.player1Score,player2Score:i.player2Score,bothAnswered:i.bothAnswered}:{success:!1,error:i.error}}catch(w){return console.error("Error submitting answer:",w),{success:!1,error:w.message}}})({matchId:t,userId:s,questionIndex:v,answer:e,answerTime:r});if(a.success){const e={correct:a.correct,correctAnswer:a.correctAnswer};M(a.player1Score),L(a.player2Score),console.log(` Result: correct=${a.correct}, bothAnswered=${a.bothAnswered}`),a.bothAnswered?(A(e),setTimeout(()=>Q(),1500)):(q(!0),x.current=e,G())}}catch(a){console.error("Error submitting answer:",a)}},H=e.useRef(null),G=()=>{H.current&&clearInterval(H.current);let e=0;H.current=setInterval(async()=>{e++;try{const r=await po(t,s,v);r.success&&(console.log(` Poll ${e}: ${r.status}, serverQ: ${r.currentQuestion}`),"completed"===r.status?(clearInterval(H.current),x.current&&(A(x.current),x.current=null),setTimeout(()=>V(r),1e3)):"continue"===r.status||"sync"===r.status?(clearInterval(H.current),M(r.player1Score),L(r.player2Score),x.current?(A(x.current),q(!1),x.current=null,setTimeout(()=>Y(r.currentQuestion),1500)):Y(r.currentQuestion)):"waiting"===r.status&&(M(r.player1Score),L(r.player2Score))),e>=40&&(clearInterval(H.current),Q())}catch(r){console.error("Poll error:",r)}},500)};e.useEffect(()=>()=>{H.current&&clearInterval(H.current)},[]);const V=e=>{H.current&&clearInterval(H.current),$(!0);const t=1===(null==p?void 0:p.playerNum)?e.player1PointChange:e.player2PointChange;B({winner:e.winner,playerNum:e.playerNum||(null==p?void 0:p.playerNum),player1Score:e.player1Score,player2Score:e.player2Score,player1PointChange:e.player1PointChange,player2PointChange:e.player2PointChange,pointChange:t}),console.log(` Match complete! Winner: ${e.winner}, My points: ${t>0?"+":""}${t}`),setTimeout(()=>{i({...e,playerNum:(null==p?void 0:p.playerNum)||e.playerNum,pointChange:t})},3e3)},Y=async e=>{console.log(` Moving to Q${e}`),j(e),k(null),C(!1),A(null),q(!1),x.current=null,await _()},Q=async()=>{try{const e=await po(t,s,v);console.log(" Next result:",e.status),e.success&&("completed"===e.status?V(e):"continue"===e.status||"sync"===e.status?Y(e.currentQuestion):"waiting"===e.status&&(M(e.player1Score),L(e.player2Score)))}catch(e){console.error("Error moving to next question:",e)}};if(b)return U.jsx("div",{className:"min-h-screen flex items-center justify-center "+(u?"bg-slate-950":"bg-slate-100"),children:U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"w-16 h-16 border-4 border-purple-500/30 border-t-purple-500 rounded-full animate-spin mx-auto mb-4"}),U.jsx("p",{className:u?"text-white/60":"text-slate-600",children:"Loading battle..."})]})});if(w)return U.jsx("div",{className:"min-h-screen flex items-center justify-center "+(u?"bg-slate-950":"bg-slate-100"),children:U.jsxs("div",{className:"text-center",children:[U.jsx("p",{className:"text-red-500 mb-4",children:w}),U.jsx("button",{onClick:o,className:"px-4 py-2 bg-purple-500 text-white rounded-lg",children:"Exit"})]})});const J=null==(l=null==p?void 0:p.questions)?void 0:l[v],K=1===(null==p?void 0:p.playerNum);return U.jsxs("div",{className:"min-h-screen "+(u?"bg-gradient-to-br from-[#0a0615] via-[#1a0a2e] to-[#0d0520]":"bg-gradient-to-br from-indigo-100 via-purple-100 to-pink-100"),children:[U.jsxs("div",{className:"sticky top-0 z-20 px-6 py-4 "+(u?"bg-black/50 backdrop-blur-xl":"bg-white/80 backdrop-blur-xl shadow-lg"),children:[U.jsxs("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center "+(u?"bg-purple-500/20":"bg-purple-100"),children:U.jsx(Nr,{className:"h-6 w-6 "+(u?"text-purple-400":"text-purple-600")})}),U.jsxs("div",{children:[U.jsx("p",{className:"font-bold "+(u?"text-white":"text-slate-900"),children:"You"}),U.jsxs("p",{className:"text-xs flex items-center gap-1 "+(u?"text-white/50":"text-slate-500"),children:[(()=>{var e;const t=fo[null==(e=null==p?void 0:p.player1)?void 0:e.tier]||rr;return U.jsx(t,{className:"h-3 w-3"})})(),null==(c=null==p?void 0:p.player1)?void 0:c.tier]})]}),U.jsx("div",{className:"text-4xl font-black "+(u?"text-purple-400":"text-purple-600"),children:K?R:D})]}),U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"text-2xl font-black "+(u?"text-white/30":"text-slate-300"),children:"VS"}),U.jsxs("div",{className:"flex items-center justify-center gap-2 mt-1 "+(T<=5?"text-red-500 animate-pulse":u?"text-white/60":"text-slate-500"),children:[U.jsx(Ht,{className:"h-4 w-4"}),U.jsxs("span",{className:"font-mono font-bold",children:[T,"s"]})]})]}),U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx("div",{className:"text-4xl font-black "+(u?"text-pink-400":"text-pink-600"),children:K?D:R}),U.jsxs("div",{className:"text-right",children:[U.jsx("p",{className:"font-bold "+(u?"text-white":"text-slate-900"),children:(null==r?void 0:r.userName)||"Opponent"}),U.jsx("p",{className:"text-xs flex items-center gap-1 "+(u?"text-white/50":"text-slate-500"),children:(null==r?void 0:r.isBot)?U.jsxs(U.Fragment,{children:[U.jsx(qt,{className:"h-3 w-3"})," Bot"]}):U.jsxs(U.Fragment,{children:[(()=>{const e=fo[null==r?void 0:r.tier]||rr;return U.jsx(e,{className:"h-3 w-3"})})(),(null==r?void 0:r.tier)||"BRONZE"]})})]}),U.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center "+(u?"bg-pink-500/20":"bg-pink-100"),children:(null==r?void 0:r.isBot)?U.jsx(qt,{className:"h-6 w-6 "+(u?"text-pink-400":"text-pink-600")}):U.jsx(Nr,{className:"h-6 w-6 "+(u?"text-pink-400":"text-pink-600")})})]})]}),U.jsxs("div",{className:"max-w-4xl mx-auto mt-4",children:[U.jsx("div",{className:"flex gap-2",children:Array.from({length:(null==p?void 0:p.totalQuestions)||5}).map((e,t)=>U.jsx("div",{className:"h-1.5 flex-1 rounded-full transition-all "+(t<v?"bg-green-500":t===v?"bg-purple-500":u?"bg-white/10":"bg-slate-200")},t))}),U.jsxs("p",{className:"text-xs text-center mt-2 "+(u?"text-white/40":"text-slate-400"),children:["Question ",v+1," of ",(null==p?void 0:p.totalQuestions)||5]})]})]}),U.jsx("div",{className:"max-w-4xl mx-auto px-6 py-8",children:F?U.jsx("div",{className:"text-center py-16",children:(()=>{const e="player1"===(null==O?void 0:O.winner)&&K||"player2"===(null==O?void 0:O.winner)&&!K,t="draw"===(null==O?void 0:O.winner),s=(null==O?void 0:O.pointChange)??(K?null==O?void 0:O.player1PointChange:null==O?void 0:O.player2PointChange);return U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"text-6xl mb-6 "+(e?"animate-bounce":""),children:e?"":t?"":""}),U.jsx("h2",{className:"text-4xl font-black mb-4 "+(u?"text-white":"text-slate-900"),children:e?"Victory!":t?"Draw!":"Defeat"}),U.jsxs("p",{className:"text-xl "+(u?"text-white/60":"text-slate-600"),children:["Final Score: ",K?R:D," - ",K?D:R]}),U.jsxs("div",{className:"mt-4 text-2xl font-bold "+(s>0?"text-green-500":s<0?"text-red-500":"text-yellow-500"),children:[s>0?"+":"",s||0," points"]}),U.jsx("p",{className:"mt-2 text-sm "+(u?"text-white/40":"text-slate-400"),children:"Returning to lobby..."})]})})()}):J?U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"rounded-3xl p-8 mb-8 "+(u?"bg-white/5 border border-white/10":"bg-white shadow-xl"),children:U.jsx("h2",{className:"text-xl md:text-2xl font-bold leading-relaxed "+(u?"text-white":"text-slate-900"),children:J.question})}),U.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:null==(d=J.options)?void 0:d.map((e,t)=>{const s=N===t,r=null!==E&&void 0!==(null==E?void 0:E.correctAnswer)&&null!==(null==E?void 0:E.correctAnswer),a=r&&E.correctAnswer===t,n=r&&s&&E.correctAnswer!==t;return U.jsx("button",{onClick:()=>(e=>{S||k(e)})(t),disabled:S,className:"p-5 rounded-2xl text-left transition-all "+(r?a?"bg-green-500 text-white ring-4 ring-green-500/30":n?"bg-red-500 text-white ring-4 ring-red-500/30":u?"bg-white/5 text-white/50":"bg-slate-100 text-slate-400":S&&s?"bg-yellow-500 text-white ring-4 ring-yellow-500/30":s?"bg-purple-500 text-white ring-4 ring-purple-500/30 scale-[1.02]":u?"bg-white/5 text-white hover:bg-white/10":"bg-white text-slate-900 hover:bg-slate-50 shadow-lg"),children:U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center font-bold "+(r?a||n?"bg-white/20":u?"bg-white/10":"bg-slate-200":S&&s||s?"bg-white/20":u?"bg-white/10":"bg-purple-100 text-purple-600"),children:r&&a?U.jsx($t,{className:"h-6 w-6"}):r&&n?U.jsx(qr,{className:"h-6 w-6"}):S&&s?U.jsx(Ht,{className:"h-5 w-5 animate-pulse"}):String.fromCharCode(65+t)}),U.jsx("span",{className:"flex-1 font-medium",children:e})]})},t)})}),!S&&null!==N&&U.jsxs("button",{onClick:()=>W(),className:"w-full mt-6 py-4 rounded-2xl font-bold text-lg bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-xl shadow-purple-500/30 hover:scale-[1.02] transition-all",children:[U.jsx(Mr,{className:"inline h-5 w-5 mr-2"}),"Submit Answer"]}),S&&!E&&U.jsx("div",{className:"mt-6 p-4 rounded-xl text-center "+(u?"bg-yellow-500/10 text-yellow-400":"bg-yellow-100 text-yellow-700"),children:U.jsxs("div",{className:"flex items-center justify-center gap-3",children:[U.jsx("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin"}),U.jsx("span",{children:"Answer submitted! Waiting for opponent..."})]})}),E&&void 0!==E.correctAnswer&&null!==E.correctAnswer&&U.jsx("div",{className:"mt-6 p-4 rounded-xl text-center "+(E.correct?u?"bg-green-500/10 text-green-400":"bg-green-100 text-green-700":u?"bg-red-500/10 text-red-400":"bg-red-100 text-red-700"),children:E.correct?U.jsxs(U.Fragment,{children:[U.jsx($t,{className:"inline h-6 w-6 mr-2"}),"Correct! +1 point"]}):U.jsxs(U.Fragment,{children:[U.jsx(qr,{className:"inline h-6 w-6 mr-2"}),"Wrong! The correct answer was ",String.fromCharCode(65+E.correctAnswer)]})})]}):U.jsxs("div",{className:"text-center py-16",children:[U.jsx("div",{className:"w-16 h-16 border-4 border-purple-500/30 border-t-purple-500 rounded-full animate-spin mx-auto mb-4"}),U.jsx("p",{className:u?"text-white/60":"text-slate-600",children:"Loading question..."})]})})]})},yo=({result:t,subject:s,onClose:r,onPlayAgain:a})=>{var n;const{isDark:i}=mt(),[o,l]=e.useState(0),[c,d]=e.useState(!1),u=1===(null==t?void 0:t.playerNum)?"player1"===(null==t?void 0:t.winner):"player2"===(null==t?void 0:t.winner),h="draw"===(null==t?void 0:t.winner),m=1===(null==t?void 0:t.playerNum)?null==t?void 0:t.player1PointChange:null==t?void 0:t.player2PointChange,x=null==t?void 0:t.player1NewRank,p=null==x?void 0:x.promoted,g=null==x?void 0:x.newTier,b=null==x?void 0:x.oldTier;return e.useEffect(()=>{const e=[setTimeout(()=>l(1),300),setTimeout(()=>l(2),800),setTimeout(()=>l(3),1500),setTimeout(()=>{l(4),(u||p)&&d(!0)},2200)];return()=>e.forEach(e=>clearTimeout(e))},[u,p]),e.useEffect(()=>{if(c){const e=setTimeout(()=>d(!1),3e3);return()=>clearTimeout(e)}},[c]),U.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center "+(i?"bg-slate-950":"bg-slate-100"),children:[c&&U.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:Array.from({length:50}).map((e,t)=>U.jsx("div",{className:"absolute animate-confetti",style:{left:100*Math.random()+"%",animationDelay:2*Math.random()+"s",animationDuration:2+2*Math.random()+"s"},children:U.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:["#FFD700","#FF6B6B","#4ECDC4","#A855F7","#3B82F6"][Math.floor(5*Math.random())]}})},t))}),U.jsx("div",{className:"absolute inset-0 "+(u?"bg-gradient-to-br from-green-900/30 via-emerald-900/20 to-transparent":h?"bg-gradient-to-br from-yellow-900/30 via-amber-900/20 to-transparent":"bg-gradient-to-br from-red-900/30 via-rose-900/20 to-transparent")}),U.jsx("div",{className:"relative z-10 max-w-lg w-full mx-4",children:U.jsxs("div",{className:"rounded-3xl p-8 "+(i?"bg-slate-900/90 border border-white/10":"bg-white shadow-2xl"),children:[U.jsxs("div",{className:"text-center transform transition-all duration-700 "+(o>=1?"translate-y-0 opacity-100":"translate-y-10 opacity-0"),children:[U.jsx("div",{className:"text-8xl mb-4 "+(u?"animate-bounce":""),children:u?"":h?"":""}),U.jsx("h1",{className:"text-4xl font-black mb-2 "+(u?"text-green-500":h?"text-yellow-500":"text-red-500"),children:u?"VICTORY!":h?"DRAW!":"DEFEAT"}),U.jsxs("p",{className:"text-lg "+(i?"text-white/60":"text-slate-500"),children:["Final Score: ",null==t?void 0:t.player1Score," - ",null==t?void 0:t.player2Score]})]}),U.jsx("div",{className:"mt-8 transform transition-all duration-700 delay-300 "+(o>=2?"translate-y-0 opacity-100":"translate-y-10 opacity-0"),children:U.jsxs("div",{className:"text-center p-6 rounded-2xl "+(i?"bg-white/5":"bg-slate-50"),children:[U.jsx("p",{className:"text-sm font-semibold mb-2 "+(i?"text-white/50":"text-slate-400"),children:"Rank Points"}),U.jsxs("div",{className:"flex items-center justify-center gap-3 text-3xl font-black "+(m>=0?"text-green-500":"text-red-500"),children:[m>=0?U.jsx(br,{className:"h-8 w-8"}):U.jsx(gr,{className:"h-8 w-8"}),U.jsxs("span",{children:[m>=0?"+":"",m]})]}),U.jsxs("p",{className:"mt-2 text-sm "+(i?"text-white/40":"text-slate-400"),children:["New Total: ",(null==x?void 0:x.newPoints)||0," points"]})]})}),U.jsx("div",{className:"mt-6 transform transition-all duration-700 delay-500 "+(o>=3?"translate-y-0 opacity-100":"translate-y-10 opacity-0"),children:p?U.jsxs("div",{className:"text-center",children:[U.jsxs("p",{className:"text-lg font-bold mb-4 "+(i?"text-yellow-400":"text-yellow-600"),children:[U.jsx(or,{className:"inline h-5 w-5 mr-2"}),"RANK UP!"]}),U.jsxs("div",{className:"flex items-center justify-center gap-4",children:[U.jsx(bo,{tier:b,size:"md",showPoints:!1}),U.jsx(yt,{className:`h-8 w-8 ${i?"text-yellow-400":"text-yellow-600"} animate-pulse`}),U.jsx("div",{className:"animate-pulse",children:U.jsx(bo,{tier:g,size:"lg",showPoints:!1})})]}),U.jsxs("p",{className:"mt-4 text-sm "+(i?"text-white/50":"text-slate-500"),children:["You've reached ",null==(n=xo[g])?void 0:n.name,"!"]})]}):U.jsx("div",{className:"flex justify-center",children:U.jsx(bo,{tier:g||b||"BRONZE",points:(null==x?void 0:x.newPoints)||0,size:"lg"})})}),U.jsxs("div",{className:"mt-8 grid grid-cols-2 gap-4 transform transition-all duration-700 delay-700 "+(o>=4?"translate-y-0 opacity-100":"translate-y-10 opacity-0"),children:[U.jsxs("button",{onClick:r,className:"py-4 rounded-xl font-bold transition-all flex items-center justify-center gap-2 "+(i?"bg-white/10 text-white hover:bg-white/20":"bg-slate-100 text-slate-700 hover:bg-slate-200"),children:[U.jsx(fs,{className:"h-5 w-5"}),"Exit"]}),U.jsxs("button",{onClick:a,className:"py-4 rounded-xl font-bold transition-all flex items-center justify-center gap-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white hover:scale-[1.02] shadow-lg shadow-purple-500/30",children:[U.jsx(dr,{className:"h-5 w-5"}),"Play Again"]})]})]})}),U.jsx("style",{children:"\n        @keyframes confetti {\n          0% {\n            transform: translateY(-100vh) rotate(0deg);\n            opacity: 1;\n          }\n          100% {\n            transform: translateY(100vh) rotate(720deg);\n            opacity: 0;\n          }\n        }\n        .animate-confetti {\n          animation: confetti 3s linear forwards;\n        }\n      "})]})},vo=[{id:"mathematics",name:"Mathematics",Icon:Dt,color:"from-blue-500 to-indigo-600"},{id:"physics",name:"Physics",Icon:jt,color:"from-yellow-500 to-orange-600"},{id:"chemistry",name:"Chemistry",Icon:ds,color:"from-green-500 to-emerald-600"},{id:"biology",name:"Biology",Icon:ts,color:"from-pink-500 to-rose-600"},{id:"english",name:"English",Icon:Pt,color:"from-purple-500 to-violet-600"},{id:"italian",name:"Italian",Icon:js,color:"from-green-600 to-red-500"},{id:"history",name:"History",Icon:vs,color:"from-amber-600 to-yellow-700"},{id:"geography",name:"Geography",Icon:ms,color:"from-teal-500 to-cyan-600"},{id:"computerScience",name:"Computer Science",Icon:Gt,color:"from-gray-600 to-slate-700"}],jo=[{id:"easy",name:"Easy",Icon:ks,description:"Win +15 / Lose -25",color:"from-green-500 to-emerald-600"},{id:"medium",name:"Medium",Icon:rr,description:"Win +20 / Lose -20",color:"from-yellow-500 to-amber-600"},{id:"hard",name:"Hard",Icon:cs,description:"Win +30 / Lose -10",color:"from-red-500 to-rose-600"}],No=()=>{var t,s,r;const a=qe(),{isDark:n}=mt(),{user:i}=Br(),{showError:o,showSuccess:l}=Hr(),c=e.useRef(null),[d,u]=e.useState(null),[h,m]=e.useState(null),[x,p]=e.useState(null),[g,b]=e.useState(null),[f,w]=e.useState([]),[y,v]=e.useState(!0),[j,N]=e.useState(!1),[k,S]=e.useState(0),[C,E]=e.useState(0),[A,T]=e.useState(0),[I,P]=e.useState(!1),[q,R]=e.useState(null),[M,D]=e.useState(null),[L,F]=e.useState(!1),[$,O]=e.useState(null);e.useEffect(()=>{(null==i?void 0:i.id)&&(B(),z())},[i]),e.useEffect(()=>{(null==i?void 0:i.id)&&d&&_()},[i,d]),e.useEffect(()=>{let e,t;if(j){e=setInterval(()=>{S(e=>e+1)},1e3);const s=async()=>{if(d&&h){const e=await(async(e,t)=>{try{const s=new URLSearchParams({subject:e,difficulty:t}),r=await fetch(`${mo}/ranked/queue/count?${s}`),a=await r.json();return r.ok&&a.success?{success:!0,count:a.count,totalForSubject:a.totalForSubject}:{success:!1,count:0,totalForSubject:0}}catch(s){return{success:!1,count:0,totalForSubject:0}}})(d,h);e.success&&T(e.totalForSubject||e.count)}};s(),t=setInterval(s,2e3)}return()=>{clearInterval(e),clearInterval(t)}},[j,d,h]);const B=async()=>{v(!0);try{const e=await(async e=>{try{const t=await fetch(`${mo}/ranked/status/${e}`),s=await t.json();return t.ok&&s.success?{success:!0,rank:s.rank}:{success:!1,error:s.error}}catch(t){return console.error("Error getting rank status:",t),{success:!1,error:t.message}}})(i.id);e.success&&p(e.rank)}catch(e){console.error("Error loading rank:",e)}finally{v(!1)}},_=async()=>{try{const e=await(async(e,t)=>{try{const s=await fetch(`${mo}/ranked/status/${e}/${t}`),r=await s.json();return s.ok&&r.success?{success:!0,subjectRank:r.subjectRank}:{success:!1,error:r.error}}catch(s){return console.error("Error getting subject rank:",s),{success:!1,error:s.message}}})(i.id,d);e.success&&b(e.subjectRank)}catch(e){console.error("Error loading subject rank:",e)}},z=async()=>{try{const e=await(async(e,t=null,s=20)=>{try{let r=`${mo}/ranked/history/${e}?limit=${s}`;t&&(r+=`&subject=${t}`);const a=await fetch(r),n=await a.json();return a.ok&&n.success?{success:!0,history:n.history}:{success:!1,error:n.error}}catch(r){return console.error("Error getting match history:",r),{success:!1,error:r.message}}})(i.id,null,5);e.success&&w(e.history)}catch(e){console.error("Error loading match history:",e)}},W=async()=>{if(d&&h){N(!0),S(0);try{const e=(null==g?void 0:g.tier)||"BRONZE",t=await(async({userId:e,userName:t,userAvatar:s,subject:r,difficulty:a})=>{try{const n=await fetch(`${mo}/ranked/queue`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,userName:t,userAvatar:s,subject:r,difficulty:a})}),i=await n.json();return n.ok&&i.success?{success:!0,status:i.status,matchId:i.matchId,opponent:i.opponent,queuePosition:i.queuePosition}:{success:!1,error:i.error}}catch(n){return console.error("Error joining queue:",n),{success:!1,error:n.message}}})({userId:i.id,userName:i.name||i.email,userAvatar:i.avatar,subject:d,difficulty:h});t.success?"matched"===t.status?(R(t.matchId),D(t.opponent),N(!1),P(!0)):(E(t.queuePosition),H(e)):(o(t.error||"Failed to join queue","Error"),N(!1))}catch(e){console.error("Error finding match:",e),o("Failed to find match","Error"),N(!1)}}else o("Please select a subject and difficulty","Selection Required")},H=e=>{c.current=setInterval(async()=>{try{const t=await(async({userId:e,subject:t,difficulty:s,tier:r})=>{try{const a=new URLSearchParams({subject:t,difficulty:s,tier:r}),n=await fetch(`${mo}/ranked/queue/status/${e}?${a}`),i=await n.json();return n.ok&&i.success?{success:!0,status:i.status,matchId:i.matchId,opponent:i.opponent,waitTime:i.waitTime,queuePosition:i.queuePosition}:{success:!1,error:i.error}}catch(a){return console.error("Error checking queue status:",a),{success:!1,error:a.message}}})({userId:i.id,subject:d,difficulty:h,tier:e});console.log(" Queue status:",t),t.success&&("matched"===t.status?(clearInterval(c.current),console.log(" Match found!",t.matchId,t.opponent),R(t.matchId),D(t.opponent),N(!1),P(!0)):"not_in_queue"===t.status?(clearInterval(c.current),N(!1)):E(t.queuePosition))}catch(t){console.error("Polling error:",t)}},1e3)},G=e=>{P(!1),O(e),F(!0),B(),_(),z()},V=()=>{F(!1),O(null),R(null),D(null)};if(I&&q)return U.jsx(wo,{matchId:q,userId:i.id,opponent:M,subject:d,difficulty:h,onComplete:G,onExit:()=>{P(!1),R(null)}});if(L&&$)return U.jsx(yo,{result:$,subject:d,onClose:V,onPlayAgain:()=>{V(),W()}});const Y=(null==g?void 0:g.tier)||"BRONZE",Q=(null==g?void 0:g.points)||0,J=(e=>{const t=(e=>e>=2500?"MASTER":e>=2e3?"DIAMOND":e>=1500?"PLATINUM":e>=1e3?"GOLD":e>=500?"SILVER":"BRONZE")(e),s=xo[t];if("MASTER"===t)return{progress:100,pointsToNext:0,nextTier:null};const r=Object.keys(xo),a=r.indexOf(t),n=r[a+1],i=xo[n],o=e-s.minPoints,l=s.maxPoints-s.minPoints+1;return{progress:Math.min(100,o/l*100),pointsToNext:i.minPoints-e,nextTier:n}})(Q);return U.jsxs("div",{className:"min-h-screen relative overflow-hidden "+(n?"bg-gradient-to-br from-[#0a0615] via-[#1a0a2e] to-[#0d0520] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-pink-100 text-slate-900"),children:[U.jsxs("div",{className:"pointer-events-none absolute inset-0 overflow-hidden",children:[U.jsx("div",{className:"absolute -top-40 -right-40 h-96 w-96 rounded-full blur-3xl "+(n?"bg-purple-600/20":"bg-purple-300/40")}),U.jsx("div",{className:"absolute top-1/2 -left-20 h-80 w-80 rounded-full blur-3xl "+(n?"bg-blue-600/15":"bg-blue-200/50")}),U.jsx("div",{className:"absolute bottom-20 right-1/4 h-64 w-64 rounded-full blur-3xl "+(n?"bg-pink-600/15":"bg-pink-200/40")})]}),U.jsxs("div",{className:"relative z-10 mx-auto max-w-6xl px-6 py-10",children:[U.jsxs("div",{className:"flex items-center justify-between mb-8",children:[U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx("div",{className:`p-4 rounded-2xl ${n?"bg-gradient-to-br from-purple-600 to-pink-600":"bg-gradient-to-br from-purple-500 to-pink-500"} shadow-xl shadow-purple-500/30`,children:U.jsx(dr,{className:"h-8 w-8 text-white"})}),U.jsxs("div",{children:[U.jsx("h1",{className:"text-3xl font-black tracking-tight "+(n?"text-white":"text-slate-900"),children:"Ranked Mode"}),U.jsx("p",{className:"mt-1 text-sm "+(n?"text-white/60":"text-slate-500"),children:"Compete in 1v1 battles and climb the ranks"})]})]}),U.jsxs("button",{onClick:()=>a("/ranked/leaderboard"),className:"inline-flex items-center gap-2 px-4 py-2.5 rounded-xl font-semibold transition "+(n?"bg-white/10 text-white hover:bg-white/20":"bg-white text-slate-700 hover:bg-slate-50 shadow-lg"),children:[U.jsx(fr,{className:"h-5 w-5 text-yellow-500"}),"Leaderboard"]})]}),j&&U.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:U.jsxs("div",{className:"rounded-3xl p-8 text-center max-w-md mx-4 "+(n?"bg-slate-900 border border-white/10":"bg-white shadow-2xl"),children:[U.jsxs("div",{className:"relative mb-6",children:[U.jsx("div",{className:"w-24 h-24 mx-auto rounded-full border-4 border-purple-500/30 border-t-purple-500 animate-spin"}),U.jsx(dr,{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 h-10 w-10 "+(n?"text-purple-400":"text-purple-600")})]}),U.jsx("h3",{className:"text-2xl font-bold mb-2 "+(n?"text-white":"text-slate-900"),children:"Finding Opponent..."}),U.jsx("p",{className:"mb-4 "+(n?"text-white/60":"text-slate-500"),children:"Searching for a worthy challenger"}),U.jsxs("div",{className:"text-4xl font-mono font-bold mb-4 "+(n?"text-purple-400":"text-purple-600"),children:[Math.floor(k/60),":",(k%60).toString().padStart(2,"0")]}),U.jsxs("div",{className:"text-sm mb-6 space-y-1 "+(n?"text-white/40":"text-slate-400"),children:[U.jsxs("p",{className:"flex items-center justify-center gap-2",children:[U.jsx(kr,{className:"h-4 w-4"}),U.jsxs("span",{children:[A," player",1!==A?"s":""," searching"]})]}),U.jsx("p",{children:k<30?`Your position: #${C}`:"Creating AI opponent..."})]}),U.jsxs("button",{onClick:async()=>{clearInterval(c.current),N(!1),S(0);try{await(async({userId:e,subject:t,difficulty:s,tier:r})=>{try{const a=await fetch(`${mo}/ranked/queue/leave`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,subject:t,difficulty:s,tier:r})});return{success:(await a.json()).success}}catch(a){return console.error("Error leaving queue:",a),{success:!1,error:a.message}}})({userId:i.id,subject:d,difficulty:h,tier:(null==g?void 0:g.tier)||"BRONZE"})}catch(e){console.error("Error leaving queue:",e)}},className:"px-6 py-3 rounded-xl font-semibold transition "+(n?"bg-red-500/20 text-red-400 hover:bg-red-500/30":"bg-red-100 text-red-600 hover:bg-red-200"),children:[U.jsx(Rr,{className:"inline h-5 w-5 mr-2"}),"Cancel"]})]})}),U.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[U.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[U.jsxs("div",{className:"rounded-3xl border p-6 "+(n?"border-white/10 bg-white/5 backdrop-blur":"border-purple-200/50 bg-white shadow-xl"),children:[U.jsxs("h2",{className:"text-lg font-bold mb-4 flex items-center gap-2 "+(n?"text-white":"text-slate-900"),children:[U.jsx(ur,{className:"h-5 w-5 text-purple-500"}),"Select Subject"]}),U.jsx("div",{className:"grid grid-cols-3 md:grid-cols-5 gap-3",children:vo.map(e=>U.jsxs("button",{onClick:()=>u(e.id),className:"p-4 rounded-2xl text-center transition-all "+(d===e.id?`bg-gradient-to-br ${e.color} text-white shadow-lg scale-105`:n?"bg-white/5 text-white/80 hover:bg-white/10":"bg-slate-50 text-slate-700 hover:bg-slate-100"),children:[U.jsx(e.Icon,{className:"h-6 w-6 mb-1"}),U.jsx("span",{className:"text-xs font-semibold",children:e.name})]},e.id))})]}),U.jsxs("div",{className:"rounded-3xl border p-6 "+(n?"border-white/10 bg-white/5 backdrop-blur":"border-purple-200/50 bg-white shadow-xl"),children:[U.jsxs("h2",{className:"text-lg font-bold mb-4 flex items-center gap-2 "+(n?"text-white":"text-slate-900"),children:[U.jsx(Mr,{className:"h-5 w-5 text-yellow-500"}),"Select Difficulty"]}),U.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:jo.map(e=>U.jsxs("button",{onClick:()=>m(e.id),className:"p-5 rounded-2xl text-left transition-all "+(h===e.id?`bg-gradient-to-br ${e.color} text-white shadow-lg scale-[1.02]`:n?"bg-white/5 text-white/80 hover:bg-white/10":"bg-slate-50 text-slate-700 hover:bg-slate-100"),children:[U.jsx(e.Icon,{className:"h-8 w-8 mb-2"}),U.jsx("span",{className:"text-lg font-bold block",children:e.name}),U.jsx("span",{className:"text-xs "+(h===e.id?"text-white/80":n?"text-white/50":"text-slate-500"),children:e.description})]},e.id))})]}),U.jsxs("button",{onClick:W,disabled:!d||!h||j,className:`w-full py-5 rounded-2xl font-bold text-xl transition-all flex items-center justify-center gap-3 ${d&&h?"hover:scale-[1.02] hover:shadow-2xl":"opacity-50 cursor-not-allowed"} bg-gradient-to-r from-purple-600 via-pink-600 to-rose-600 text-white shadow-xl shadow-purple-500/30`,children:[U.jsx(dr,{className:"h-7 w-7"}),"Find Match"]})]}),U.jsxs("div",{className:"space-y-6",children:[U.jsxs("div",{className:"rounded-3xl border p-6 text-center "+(n?"border-white/10 bg-gradient-to-br from-purple-900/50 to-pink-900/30":"border-purple-200/50 bg-gradient-to-br from-purple-50 to-pink-50"),children:[U.jsxs("h3",{className:"text-sm font-semibold mb-4 "+(n?"text-white/60":"text-slate-500"),children:[d?null==(t=vo.find(e=>e.id===d))?void 0:t.name:"Overall"," Rank"]}),U.jsx(bo,{tier:Y,points:Q,size:"xl"}),U.jsxs("div",{className:"mt-6",children:[U.jsxs("div",{className:"flex justify-between text-xs mb-2",children:[U.jsx("span",{className:n?"text-white/50":"text-slate-500",children:null==(s=xo[Y])?void 0:s.name}),J.nextTier&&U.jsx("span",{className:n?"text-white/50":"text-slate-500",children:null==(r=xo[J.nextTier])?void 0:r.name})]}),U.jsx("div",{className:"h-2 rounded-full overflow-hidden "+(n?"bg-white/10":"bg-slate-200"),children:U.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-pink-500 transition-all duration-500",style:{width:`${J.progress}%`}})}),J.pointsToNext>0&&U.jsxs("p",{className:"text-xs mt-2 "+(n?"text-white/40":"text-slate-400"),children:[J.pointsToNext," points to next rank"]})]})]}),U.jsxs("div",{className:"rounded-3xl border p-6 "+(n?"border-white/10 bg-white/5":"border-purple-200/50 bg-white shadow-lg"),children:[U.jsxs("h3",{className:"text-sm font-semibold mb-4 flex items-center gap-2 "+(n?"text-white/60":"text-slate-500"),children:[U.jsx(br,{className:"h-4 w-4"}),"Your Stats"]}),U.jsxs("div",{className:"space-y-3",children:[U.jsxs("div",{className:"flex justify-between",children:[U.jsx("span",{className:n?"text-white/60":"text-slate-500",children:"Wins"}),U.jsx("span",{className:"font-bold "+(n?"text-green-400":"text-green-600"),children:(null==g?void 0:g.wins)||(null==x?void 0:x.totalWins)||0})]}),U.jsxs("div",{className:"flex justify-between",children:[U.jsx("span",{className:n?"text-white/60":"text-slate-500",children:"Losses"}),U.jsx("span",{className:"font-bold "+(n?"text-red-400":"text-red-600"),children:(null==g?void 0:g.losses)||(null==x?void 0:x.totalLosses)||0})]}),U.jsxs("div",{className:"flex justify-between",children:[U.jsx("span",{className:n?"text-white/60":"text-slate-500",children:"Win Streak"}),U.jsxs("span",{className:"font-bold "+(n?"text-yellow-400":"text-yellow-600"),children:[" ",(null==g?void 0:g.winStreak)||0]})]}),U.jsxs("div",{className:"flex justify-between",children:[U.jsx("span",{className:n?"text-white/60":"text-slate-500",children:"Best Streak"}),U.jsxs("span",{className:"font-bold "+(n?"text-purple-400":"text-purple-600"),children:[" ",(null==g?void 0:g.bestWinStreak)||0]})]})]})]}),U.jsxs("div",{className:"rounded-3xl border p-6 "+(n?"border-white/10 bg-white/5":"border-purple-200/50 bg-white shadow-lg"),children:[U.jsxs("h3",{className:"text-sm font-semibold mb-4 flex items-center gap-2 "+(n?"text-white/60":"text-slate-500"),children:[U.jsx(Ht,{className:"h-4 w-4"}),"Recent Matches"]}),0===f.length?U.jsx("p",{className:"text-sm text-center py-4 "+(n?"text-white/40":"text-slate-400"),children:"No matches yet. Start battling!"}):U.jsx("div",{className:"space-y-2",children:f.slice(0,5).map((e,t)=>U.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl "+(n?"bg-white/5":"bg-slate-50"),children:[U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold "+(e.won?"bg-green-500/20 text-green-500":e.isDraw?"bg-yellow-500/20 text-yellow-500":"bg-red-500/20 text-red-500"),children:e.won?"W":e.isDraw?"D":"L"}),U.jsxs("div",{children:[U.jsxs("p",{className:"text-sm font-semibold "+(n?"text-white":"text-slate-900"),children:["vs ",e.opponent.userName,e.opponent.isBot&&U.jsx("span",{className:"text-xs ml-1 opacity-50",children:"(Bot)"})]}),U.jsxs("p",{className:"text-xs "+(n?"text-white/40":"text-slate-400"),children:[e.userScore," - ",e.opponentScore]})]})]}),(()=>{var t;const s=null==(t=vo.find(t=>t.id===e.subject))?void 0:t.Icon;return s?U.jsx(s,{className:"h-5 w-5 text-white/60"}):null})()]},e.matchId))})]})]})]})]})]})},ko=[{id:"mathematics",name:"Mathematics",Icon:Dt},{id:"physics",name:"Physics",Icon:jt},{id:"chemistry",name:"Chemistry",Icon:ds},{id:"biology",name:"Biology",Icon:ts},{id:"english",name:"English",Icon:Pt},{id:"italian",name:"Italian",Icon:js},{id:"history",name:"History",Icon:vs},{id:"geography",name:"Geography",Icon:ms},{id:"computerScience",name:"Computer Science",Icon:Gt}],So=()=>{var t;const s=qe(),{isDark:r}=mt(),{user:a}=Br(),[n,i]=e.useState(ko[0].id),[o,l]=e.useState([]),[c,d]=e.useState(!0),[u,h]=e.useState(null);e.useEffect(()=>{m()},[n]);const m=async()=>{d(!0);try{const e=await(async(e,t=100)=>{try{const s=await fetch(`${mo}/ranked/leaderboard/${e}?limit=${t}`),r=await s.json();return s.ok&&r.success?{success:!0,leaderboard:r.leaderboard,subject:r.subject}:{success:!1,error:r.error}}catch(s){return console.error("Error getting leaderboard:",s),{success:!1,error:s.message}}})(n,100);if(e.success&&(l(e.leaderboard),null==a?void 0:a.id)){const t=e.leaderboard.findIndex(e=>e.userId===a.id);h(-1!==t?t+1:null)}}catch(e){console.error("Error loading leaderboard:",e)}finally{d(!1)}},x=e=>1===e?U.jsx(Xt,{className:"h-6 w-6 text-yellow-500"}):2===e?U.jsx(Rs,{className:"h-6 w-6 text-gray-400"}):3===e?U.jsx(Rs,{className:"h-6 w-6 text-orange-600"}):U.jsx("span",{className:"text-lg font-bold",children:e}),p=(e,t)=>1===e?t?"bg-yellow-500/20 border-yellow-500/30":"bg-yellow-100 border-yellow-300":2===e?t?"bg-gray-500/20 border-gray-500/30":"bg-gray-100 border-gray-300":3===e?t?"bg-orange-500/20 border-orange-500/30":"bg-orange-100 border-orange-300":t?"bg-white/5 border-white/10":"bg-white border-slate-200";return U.jsxs("div",{className:"min-h-screen relative overflow-hidden "+(r?"bg-gradient-to-br from-[#0a0615] via-[#1a0a2e] to-[#0d0520] text-white":"bg-gradient-to-br from-indigo-100 via-purple-100 to-pink-100 text-slate-900"),children:[U.jsxs("div",{className:"pointer-events-none absolute inset-0 overflow-hidden",children:[U.jsx("div",{className:"absolute -top-40 right-1/4 h-96 w-96 rounded-full blur-3xl "+(r?"bg-yellow-600/20":"bg-yellow-300/40")}),U.jsx("div",{className:"absolute bottom-20 -left-20 h-80 w-80 rounded-full blur-3xl "+(r?"bg-purple-600/15":"bg-purple-200/50")})]}),U.jsxs("div",{className:"relative z-10 mx-auto max-w-4xl px-6 py-10",children:[U.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[U.jsx("button",{onClick:()=>s("/ranked"),className:"p-3 rounded-2xl transition-all "+(r?"bg-white/10 text-white hover:bg-white/20":"bg-white text-slate-700 hover:bg-slate-50 shadow-lg"),children:U.jsx(wt,{className:"h-5 w-5"})}),U.jsxs("div",{className:"flex items-center gap-4",children:[U.jsx("div",{className:`p-4 rounded-2xl ${r?"bg-gradient-to-br from-yellow-600 to-orange-600":"bg-gradient-to-br from-yellow-500 to-orange-500"} shadow-xl shadow-yellow-500/30`,children:U.jsx(fr,{className:"h-8 w-8 text-white"})}),U.jsxs("div",{children:[U.jsx("h1",{className:"text-3xl font-black tracking-tight "+(r?"text-white":"text-slate-900"),children:"Leaderboard"}),U.jsx("p",{className:"mt-1 text-sm "+(r?"text-white/60":"text-slate-500"),children:"Top players in each subject"})]})]})]}),U.jsx("div",{className:"rounded-2xl p-2 mb-6 overflow-x-auto "+(r?"bg-white/5":"bg-white shadow-lg"),children:U.jsx("div",{className:"flex gap-2 min-w-max",children:ko.map(e=>U.jsxs("button",{onClick:()=>i(e.id),className:"px-4 py-2.5 rounded-xl font-semibold transition-all whitespace-nowrap "+(n===e.id?"bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-lg":r?"text-white/70 hover:text-white hover:bg-white/10":"text-slate-600 hover:text-slate-900 hover:bg-slate-100"),children:[U.jsx(e.Icon,{className:"h-4 w-4 mr-2"}),e.name]},e.id))})}),u&&U.jsx("div",{className:"rounded-2xl p-4 mb-6 "+(r?"bg-purple-500/20 border border-purple-500/30":"bg-purple-100 border border-purple-200"),children:U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx(or,{className:"h-5 w-5 "+(r?"text-purple-400":"text-purple-600")}),U.jsx("span",{className:"font-semibold "+(r?"text-white":"text-slate-900"),children:"Your Ranking"})]}),U.jsxs("div",{className:"text-2xl font-black "+(r?"text-purple-400":"text-purple-600"),children:["#",u]})]})}),U.jsx("div",{className:"rounded-3xl border overflow-hidden "+(r?"border-white/10 bg-white/5":"border-slate-200 bg-white shadow-xl"),children:c?U.jsxs("div",{className:"p-12 text-center",children:[U.jsx("div",{className:"w-12 h-12 border-4 border-purple-500/30 border-t-purple-500 rounded-full animate-spin mx-auto mb-4"}),U.jsx("p",{className:r?"text-white/60":"text-slate-500",children:"Loading leaderboard..."})]}):0===o.length?U.jsxs("div",{className:"p-12 text-center",children:[U.jsx(kr,{className:"h-16 w-16 mx-auto mb-4 "+(r?"text-white/20":"text-slate-300")}),U.jsx("p",{className:"text-lg font-semibold "+(r?"text-white/60":"text-slate-500"),children:"No rankings yet"}),U.jsxs("p",{className:"text-sm mt-2 "+(r?"text-white/40":"text-slate-400"),children:["Be the first to compete in ",null==(t=ko.find(e=>e.id===n))?void 0:t.name,"!"]})]}):U.jsxs("div",{className:"divide-y divide-white/10",children:[U.jsxs("div",{className:"p-6 grid md:grid-cols-3 gap-4",children:[o[1]&&U.jsxs("div",{className:`order-1 md:order-1 p-4 rounded-2xl border text-center ${p(2,r)}`,children:[U.jsx("div",{className:"mb-2",children:x(2)}),U.jsx(bo,{tier:o[1].tier,size:"sm",showPoints:!1}),U.jsx("p",{className:"mt-2 font-bold truncate "+(r?"text-white":"text-slate-900"),children:o[1].userName}),U.jsxs("p",{className:"text-sm "+(r?"text-white/60":"text-slate-500"),children:[o[1].points," pts"]}),U.jsxs("p",{className:"text-xs mt-1 "+(r?"text-white/40":"text-slate-400"),children:[o[1].wins,"W - ",o[1].losses,"L"]})]}),o[0]&&U.jsxs("div",{className:`order-0 md:order-2 p-6 rounded-2xl border text-center transform md:-translate-y-4 ${p(1,r)}`,children:[U.jsx("div",{className:"mb-2",children:x(1)}),U.jsx(bo,{tier:o[0].tier,size:"md",showPoints:!1}),U.jsx("p",{className:"mt-3 font-bold text-lg truncate "+(r?"text-white":"text-slate-900"),children:o[0].userName}),U.jsxs("p",{className:"text-lg font-bold "+(r?"text-yellow-400":"text-yellow-600"),children:[o[0].points," pts"]}),U.jsxs("p",{className:"text-sm mt-1 "+(r?"text-white/50":"text-slate-500"),children:[o[0].wins,"W - ",o[0].losses,"L"]}),o[0].winStreak>0&&U.jsxs("p",{className:"text-xs mt-1 "+(r?"text-orange-400":"text-orange-600"),children:[" ",o[0].winStreak," win streak"]})]}),o[2]&&U.jsxs("div",{className:`order-2 md:order-3 p-4 rounded-2xl border text-center ${p(3,r)}`,children:[U.jsx("div",{className:"mb-2",children:x(3)}),U.jsx(bo,{tier:o[2].tier,size:"sm",showPoints:!1}),U.jsx("p",{className:"mt-2 font-bold truncate "+(r?"text-white":"text-slate-900"),children:o[2].userName}),U.jsxs("p",{className:"text-sm "+(r?"text-white/60":"text-slate-500"),children:[o[2].points," pts"]}),U.jsxs("p",{className:"text-xs mt-1 "+(r?"text-white/40":"text-slate-400"),children:[o[2].wins,"W - ",o[2].losses,"L"]})]})]}),o.slice(3).map((e,t)=>{const s=t+4,n=(null==a?void 0:a.id)===e.userId;return U.jsxs("div",{className:"flex items-center gap-4 p-4 transition-colors "+(n?r?"bg-purple-500/10":"bg-purple-50":r?"hover:bg-white/5":"hover:bg-slate-50"),children:[U.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center font-bold "+(r?"bg-white/10 text-white/80":"bg-slate-100 text-slate-600"),children:s}),U.jsxs("div",{className:"flex-1 min-w-0",children:[U.jsx("div",{className:"flex items-center gap-2",children:U.jsxs("p",{className:"font-bold truncate "+(r?"text-white":"text-slate-900"),children:[e.userName,n&&U.jsx("span",{className:"ml-2 text-xs "+(r?"text-purple-400":"text-purple-600"),children:"(You)"})]})}),U.jsxs("p",{className:"text-sm "+(r?"text-white/50":"text-slate-500"),children:[e.wins,"W - ",e.losses,"L",e.winStreak>0&&U.jsxs("span",{className:"ml-2",children:[" ",e.winStreak]})]})]}),U.jsx(bo,{tier:e.tier,size:"sm",showPoints:!1,showName:!1}),U.jsxs("div",{className:"text-right "+(r?"text-white":"text-slate-900"),children:[U.jsx("p",{className:"font-bold",children:e.points}),U.jsx("p",{className:"text-xs "+(r?"text-white/50":"text-slate-500"),children:"points"})]})]},e.userId)})]})})]})]})},Co=()=>{var t;const[s,a]=e.useState(!1),{user:n,logout:i,reloadUser:d}=Br(),h=Ie(),x=qe(),{toggleTheme:p}=mt(),[b,f]=e.useState(0),[w,y]=e.useState(0),[v,j]=e.useState(0),[N,k]=e.useState(0),[S,C]=e.useState(!1),E=r.useRef(null),[A,T]=e.useState(!1),[I,P]=e.useState((null==n?void 0:n.isTutor)||!1),[q,R]=e.useState(null),[M,D]=e.useState(!1),[L,F]=e.useState(!0),[$,O]=e.useState(null),{showFocusTest:B,testSubject:_,handleTestComplete:z,closeFocusTest:W}=lo(),H=()=>{E.current&&(clearTimeout(E.current),E.current=null),C(!0)},G=()=>{E.current&&clearTimeout(E.current),E.current=setTimeout(()=>C(!1),220)};e.useEffect(()=>{let e=null;const t=()=>{if(e&&"function"==typeof e)try{e()}catch(t){console.error("Error cleaning up unread count listener:",t)}};return(null==n?void 0:n.id)?(e=_a(null==n?void 0:n.id,e=>f(e)),t):t},[null==n?void 0:n.id]),e.useEffect(()=>{let e=null;const t=()=>{if(e&&"function"==typeof e)try{e()}catch(t){console.error("Error cleaning up unread friend messages count listener:",t)}};return(null==n?void 0:n.id)?(e=((e,t)=>{if(!e)return console.warn("subscribeUnreadFriendMessagesCount: userId is required"),()=>{};try{const s=o(dt,"messages"),r=l(s,c("receiverId","==",e),c("read","==",!1),c("chatType","==","friend"));return g(r,e=>{const s=e.size;t(s)},e=>{console.error("Error listening to unread friend messages count:",e),t(0)})}catch(s){return console.error("Error setting up unread friend messages count listener:",s),()=>{}}})(n.id,e=>{y(e)}),t):t},[null==n?void 0:n.id]),e.useEffect(()=>{let e=null;const t=()=>{if(e&&"function"==typeof e)try{e()}catch(t){console.error("Error cleaning up unread tutor messages count listener:",t)}};return(null==n?void 0:n.id)?(e=An(n.id,e=>{j(e)}),t):t},[null==n?void 0:n.id]),e.useEffect(()=>{let e=null;const t=()=>{if(e&&"function"==typeof e)try{e()}catch(t){console.error("Error cleaning up unread student messages count listener:",t)}};return(null==n?void 0:n.id)&&(null==n?void 0:n.isTutor)?(e=Tn(n.id,e=>{k(e)}),t):t},[null==n?void 0:n.id,null==n?void 0:n.isTutor]),e.useEffect(()=>{const e=new URLSearchParams(h.search),t=e.get("redirect_uri"),s=e.get("platform");if(t&&"macos"===s&&n){const e="mock_token_for_macos",s=`${t}?status=success&user_id=${n.id}&email=${encodeURIComponent(n.email)}&name=${encodeURIComponent(n.name)}&token=${e}&is_tutor=${n.isTutor||!1}`;console.log("User already logged in, redirecting to macOS app:",s),window.location.href=s}},[n,h]),e.useEffect(()=>{let e=null;const t=()=>{if(e&&"function"==typeof e)try{console.log(" Cleaning up user tutor status listener"),e()}catch(t){console.error("Error cleaning up user tutor status listener:",t)}};if(!(null==n?void 0:n.id))return t;console.log(" Setting up user tutor status listener for:",n.id,"Current isTutor:",n.isTutor);const s=u(dt,"users",n.id);return e=g(s,e=>{if(e.exists()){const t=e.data(),s=t.isTutor&&t.tutorProfile,r=!0===t.hasStudiplyPass||!0===t.studiplyPass||"pro"===t.subscription||"legendary"===t.subscription;D(r),console.log(" User status update:",{isTutor:t.isTutor,hasProfile:!!t.tutorProfile,currentIsTutor:s,previousIsTutor:I,hasStudiplyPass:r}),I&&!s&&(console.log(" Tutor profile has been removed!"),console.log(" Previous isTutor:",I,"Current isTutor:",s),T(!0),d&&(console.log(" Reloading user data..."),d())),P(s)}},e=>{console.error(" Error listening to user changes:",e),P(n.isTutor),D(!1)}),t},[null==n?void 0:n.id]),e.useEffect(()=>{let e=null;const t=()=>{if(e&&"function"==typeof e)try{console.log(" Cleaning up user progress listener"),e()}catch(t){console.error("Error cleaning up user progress listener:",t)}};if(!(null==n?void 0:n.id))return t;console.log(" Setting up user progress listener for:",n.id);const s=u(dt,"studyprogress",n.id);return e=g(s,e=>{if(e.exists()){const t=e.data(),s=sa.calculateLevelProgress(t.totalXP||0),r={...t,levelProgress:s};console.log(" User progress updated in Header:",r),R(r)}else{const e={totalXP:0,currentLevel:1,gold:0,completedQuests:[],achievements:[],levelProgress:sa.calculateLevelProgress(0)};R(e)}},e=>{console.error(" Error listening to user progress:",e)}),t},[null==n?void 0:n.id]),e.useEffect(()=>{(async()=>{if(null==n?void 0:n.id)try{const e=await(async e=>{try{const t=u(dt,"studyprogress",e),s=await m(t);if(s.exists()){const e=s.data();return{currentStreak:e.currentStreak||0,longestStreak:e.longestStreak||0,lastLoginDate:e.lastLoginDate||null}}return{currentStreak:0,longestStreak:0,lastLoginDate:null}}catch(t){return console.error("Error getting user streak:",t),{currentStreak:0,longestStreak:0,lastLoginDate:null}}})(n.id);O(e)}catch(e){console.error("Error fetching streak:",e),O(null)}else O(null)})()},[null==n?void 0:n.id]);const V=(()=>{if(n){const e=[{name:"Tutoring",href:"/tutoring",icon:Pt},{name:"Student Dashboard",href:"/student-dashboard",icon:St,unreadCount:v>0?v:void 0},{name:"Calendar",href:"/calendar",icon:Lt},{name:"Quest Academy",href:"/quest-academy",icon:cr},{name:"Ranked Mode",href:"/ranked",icon:dr},{name:"Friends",href:"/friends",icon:kr,unreadCount:w>0?w:void 0},{name:"Focus Mode",href:"/focus-mode",icon:ur},{name:"Rewards",href:"/rewards",icon:hs}];return I&&e.push({name:"Tutor Dashboard",href:"/tutor-dashboard",icon:sr,unreadCount:N>0?N:void 0}),"studiply.email@gmail.com"===(null==n?void 0:n.email)&&e.push({name:"Admin Panel",href:"/admin",icon:rr}),e}return[{name:"Home",href:"/",icon:null,unreadCount:0}]})(),Y=e=>h.pathname===e;return n?U.jsxs("div",{className:"flex h-screen",children:[U.jsxs("div",{className:"w-64 bg-slate-900 text-white flex flex-col",children:[U.jsx("div",{className:"p-6 border-b border-slate-700",children:U.jsxs(st,{to:"/",className:"flex items-center space-x-3 group hover:bg-slate-800 rounded-lg p-2 -m-2 transition-colors duration-200",children:[U.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center group-hover:shadow-lg transition-shadow duration-200",children:U.jsx("svg",{className:"w-6 h-6 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:U.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"})})}),U.jsxs("div",{children:[U.jsx("h1",{className:"text-xl font-bold group-hover:text-white transition-colors duration-200",children:"STUDIPLY"}),U.jsx("p",{className:"text-sm text-slate-400",children:"Learning Platform"})]})]})}),U.jsxs("nav",{className:"flex-1 p-4 space-y-2",children:[U.jsxs("div",{className:"mb-6",children:[U.jsx("h2",{className:"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-3",children:"Start to Study"}),V.map(e=>{const t=e.icon,s=e.unreadCount&&e.unreadCount>0;return U.jsxs(st,{to:e.href,className:"flex items-center justify-between px-3 py-2 rounded-lg transition-colors duration-200 "+(Y(e.href)?"bg-blue-600 text-white":"text-slate-300 hover:bg-slate-800 hover:text-white"),children:[U.jsxs("div",{className:"flex items-center space-x-3",children:[t&&U.jsx(t,{className:"w-5 h-5"}),U.jsx("span",{className:"font-medium",children:e.name})]}),s&&U.jsx("span",{className:"flex items-center justify-center min-w-[20px] h-5 px-1.5 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs font-semibold",children:e.unreadCount>99?"99+":e.unreadCount})]},e.name)})]}),U.jsxs("div",{children:[U.jsxs("h2",{className:"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-3 flex items-center",children:["TOOLS",U.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:U.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})]}),U.jsxs(st,{to:"/settings",className:"flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors duration-200 "+(Y("/settings")?"bg-blue-600 text-white":"text-slate-300 hover:bg-slate-800 hover:text-white"),children:[U.jsx(sr,{className:"w-5 h-5"}),U.jsx("span",{className:"font-medium",children:"Settings"})]})]})]}),U.jsxs("div",{className:"border-t border-slate-700",children:[!M&&L&&U.jsxs("div",{className:"p-3 mx-3 mt-3 mb-2 rounded-xl bg-gradient-to-r from-purple-600/20 via-pink-600/20 to-indigo-600/20 border border-purple-500/30 relative overflow-hidden",children:[U.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-500/10 via-pink-500/10 to-indigo-500/10 animate-pulse"}),U.jsxs("div",{className:"relative flex items-start gap-3",children:[U.jsx("div",{className:"flex-shrink-0 mt-0.5",children:U.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center",children:U.jsx(nr,{className:"w-4 h-4 text-white"})})}),U.jsxs("div",{className:"flex-1 min-w-0",children:[U.jsx("p",{className:"text-xs font-semibold text-white mb-1",children:"You are using a free account"}),U.jsxs(st,{to:"/purchase",className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-semibold text-white bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg hover:from-purple-600 hover:to-pink-600 transition-all duration-200 shadow-lg hover:shadow-xl",onClick:()=>F(!1),children:[U.jsx(Xt,{className:"w-3 h-3"}),"Upgrade to Pro"]})]}),U.jsx("button",{onClick:()=>F(!1),className:"flex-shrink-0 p-1 text-white/60 hover:text-white transition-colors",title:"Dismiss",children:U.jsx(Rr,{className:"w-4 h-4"})})]})]}),U.jsx("div",{className:"p-4",children:U.jsxs("div",{className:"flex items-center space-x-3",children:[U.jsx(Za,{user:n,size:"sm",className:"border border-slate-500"}),U.jsxs("div",{className:"flex-1 min-w-0",children:[U.jsxs("div",{className:"flex items-center space-x-2",children:[U.jsx("p",{className:"text-sm font-medium text-white truncate",children:(null==n?void 0:n.name)||"User"}),M&&U.jsx(Xt,{className:"w-3.5 h-3.5 text-yellow-400 flex-shrink-0",title:"Studiply Pass Pro"})]}),U.jsx("p",{className:"text-xs text-slate-400 truncate",children:(null==n?void 0:n.email)||""}),$&&$.currentStreak>0&&(()=>{const e=(e=>{const t=Math.floor(e/25)+1,s={1:{level:1,name:"Beginner",colors:{gradient:"from-blue-500 to-cyan-500",border:"border-blue-400/50",text:"text-blue-100",bg:"bg-blue-500/20"},icon:"",animation:""},2:{level:2,name:"Dedicated",colors:{gradient:"from-green-500 to-emerald-500",border:"border-green-400/60",text:"text-green-100",bg:"bg-green-500/20"},icon:"",animation:""},3:{level:3,name:"Committed",colors:{gradient:"from-purple-500 to-pink-500",border:"border-purple-400/70",text:"text-purple-100",bg:"bg-purple-500/20"},icon:"",animation:"animate-pulse"},4:{level:4,name:"Elite",colors:{gradient:"from-yellow-400 via-orange-500 to-amber-500",border:"border-yellow-400/80",text:"text-yellow-100",bg:"bg-yellow-500/20"},icon:"",animation:"animate-pulse"},5:{level:5,name:"Legendary",colors:{gradient:"from-pink-500 via-purple-500 via-blue-500 to-cyan-500",border:"border-pink-400/90",text:"text-white",bg:"bg-gradient-to-r from-pink-500/30 via-purple-500/30 via-blue-500/30 to-cyan-500/30"},icon:"",animation:"animate-pulse"}};return s[Math.min(t,5)]||s[1]})($.currentStreak);return U.jsxs("div",{className:`mt-2 inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg border ${e.colors.border} bg-gradient-to-r ${e.colors.gradient} ${e.animation}`,children:[U.jsx("span",{className:"text-xs",children:e.icon}),U.jsxs("span",{className:`text-xs font-semibold ${e.colors.text}`,children:[$.currentStreak," day",1!==$.currentStreak?"s":""," streak"]})]})})()]}),U.jsx("button",{onClick:async()=>{try{await i()}finally{p("light"),x("/",{replace:!0})}},className:"p-1 text-slate-400 hover:text-white transition-colors",title:"Logout",children:U.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:U.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})})]})})]})]}),U.jsxs("div",{className:"flex-1 flex flex-col",children:[U.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:U.jsxs("div",{className:"flex items-center justify-between",children:[U.jsx("div",{className:"flex items-center space-x-4",children:U.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:(null==(t=V.find(e=>Y(e.href)))?void 0:t.name)||"STUDIPLY"})}),U.jsxs("div",{className:"flex items-center space-x-4",children:[U.jsxs("div",{className:"relative",onMouseEnter:H,onMouseLeave:G,children:[U.jsxs("button",{className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",onMouseEnter:H,onClick:()=>{H(),(null==n?void 0:n.id)&&Wa(null==n?void 0:n.id)},title:"Notifications",children:[U.jsx(Tt,{className:"w-5 h-5"}),b>0&&U.jsx("span",{className:"absolute -top-0.5 -right-0.5 min-w-[16px] h-4 px-1 bg-red-500 text-white text-[10px] rounded-full flex items-center justify-center leading-none shadow",children:b})]}),U.jsx(fi,{open:S,onClose:()=>C(!1),onMouseEnter:H,onMouseLeave:G})]}),U.jsxs(st,{to:"/profile",className:"flex items-center space-x-3 text-gray-700 hover:text-gray-900 transition-colors group",children:[U.jsx(Za,{user:n,size:"md",className:"border-2 border-white shadow-lg flex-shrink-0 group-hover:scale-105 transition-transform duration-200"}),U.jsx("span",{className:"font-medium",children:(null==n?void 0:n.name)||"User"})]})]})]})}),U.jsx("main",{className:"flex-1 bg-gray-50 overflow-auto",children:U.jsxs(Ve,{children:[U.jsx(He,{path:"/",element:U.jsx(vi,{children:U.jsx(oa,{})})}),U.jsx(He,{path:"/tutoring",element:U.jsx(vi,{children:U.jsx(yn,{})})}),U.jsx(He,{path:"/friends",element:U.jsx(vi,{children:U.jsx(Pn,{})})}),U.jsx(He,{path:"/calendar",element:U.jsx(vi,{children:U.jsx(io,{})})}),U.jsx(He,{path:"/learning-session/:pathId/:unitId/:lessonId/:exerciseId",element:U.jsx(vi,{children:U.jsx(hi,{})})}),U.jsx(He,{path:"/quest-academy",element:U.jsx(vi,{children:U.jsx($i,{})})}),U.jsx(He,{path:"/quest-academy/quests",element:U.jsx(vi,{children:U.jsx(Qi,{})})}),U.jsx(He,{path:"/create-quest",element:U.jsx(vi,{children:U.jsx(Xi,{})})}),U.jsx(He,{path:"/homework-helper",element:U.jsx(vi,{children:U.jsx(ho,{})})}),U.jsx(He,{path:"/ranked",element:U.jsx(vi,{children:U.jsx(No,{})})}),U.jsx(He,{path:"/ranked/leaderboard",element:U.jsx(vi,{children:U.jsx(So,{})})}),U.jsx(He,{path:"/quest-execution/:subject/:category/:questId",element:U.jsx(vi,{children:U.jsx(zi,{})})}),U.jsx(He,{path:"/chat-tutor/:tutorId",element:U.jsx(vi,{children:U.jsx(ki,{})})}),U.jsx(He,{path:"/chat-friend/:friendId",element:U.jsx(vi,{children:U.jsx(Ni,{})})}),U.jsx(He,{path:"/focus-mode",element:U.jsx(vi,{children:U.jsx(Mn,{})})}),U.jsx(He,{path:"/rewards",element:U.jsx(vi,{children:U.jsx(Ci,{})})}),U.jsx(He,{path:"/purchase",element:U.jsx(vi,{children:U.jsx(Ei,{})})}),U.jsx(He,{path:"/profile",element:U.jsx(vi,{children:U.jsx(_n,{})})}),U.jsx(He,{path:"/student-dashboard",element:U.jsx(vi,{children:U.jsx(ri,{})})}),U.jsx(He,{path:"/tutor-dashboard",element:U.jsx(vi,{children:U.jsx(Gn,{})})}),U.jsx(He,{path:"/admin/tutor-accounts",element:U.jsx(ji,{children:U.jsx(ni,{})})}),U.jsx(He,{path:"/admin",element:U.jsx(ji,{children:U.jsx(Fi,{})})}),U.jsx(He,{path:"/settings",element:U.jsx(vi,{children:U.jsx(to,{})})}),U.jsx(He,{path:"/become-tutor",element:U.jsx(vi,{children:U.jsx(pi,{})})}),U.jsx(He,{path:"/desktop-auth",element:U.jsx(gi,{})}),U.jsx(He,{path:"/verify-email-change",element:U.jsx(so,{})}),U.jsx(He,{path:"/extension-download",element:U.jsx(vi,{children:U.jsx(yi,{})})}),U.jsx(He,{path:"*",element:U.jsx(vi,{children:U.jsx(yn,{})})})]})})]}),U.jsx(wi,{isVisible:A,onClose:()=>T(!1),title:"Tutor Profile Removed",message:"Your tutor profile has been removed by an administrator. You no longer have access to the tutor dashboard.",type:"warning"}),U.jsx(oo,{isOpen:B,onClose:W,onComplete:z,subject:_})]}):U.jsx("header",{className:"sticky top-0 z-50 bg-slate-900/95 backdrop-blur-xl border-b border-white/10",children:U.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[U.jsxs("div",{className:"flex justify-between items-center h-16",children:[U.jsxs(st,{to:"/",className:"flex items-center space-x-3 group",children:[U.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-blue-500 rounded-lg flex items-center justify-center shadow-md group-hover:shadow-lg transition-shadow duration-200",children:U.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:U.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"})})}),U.jsx("span",{className:"text-xl font-bold text-white group-hover:text-purple-300 transition-colors duration-200",children:"STUDIPLY"})]}),U.jsx("nav",{className:"hidden md:flex space-x-8",children:V.map(e=>U.jsxs(st,{to:e.href,className:"relative text-sm font-medium transition-colors duration-200 "+(Y(e.href)?"text-purple-400":"text-white/70 hover:text-purple-300"),children:[e.name,Y(e.href)&&U.jsx("div",{className:"absolute -bottom-1 left-0 right-0 h-0.5 bg-gradient-to-r from-purple-400 to-blue-400 rounded-full"})]},e.name))}),U.jsxs("div",{className:"hidden md:flex items-center space-x-4",children:[U.jsx(st,{to:"/login",className:"text-white/70 hover:text-purple-300 font-medium transition-colors duration-200",children:"Sign In"}),U.jsx(st,{to:"/register",className:"bg-gradient-to-r from-purple-500 to-blue-500 text-white px-6 py-2 rounded-lg hover:from-purple-600 hover:to-blue-600 transition-all duration-200 font-medium shadow-lg hover:shadow-xl transform hover:scale-105",children:"Get Started"})]}),U.jsx("button",{onClick:()=>a(!s),className:"md:hidden p-2 text-white/70 hover:text-purple-300 hover:bg-white/10 rounded-lg transition-colors duration-200",children:U.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:U.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]}),s&&U.jsx("div",{className:"md:hidden border-t border-white/10 bg-slate-800/95 backdrop-blur-sm",children:U.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1",children:[V.map(e=>U.jsx(st,{to:e.href,className:"block px-4 py-3 text-base font-medium rounded-lg transition-colors duration-200 "+(Y(e.href)?"text-purple-400 bg-white/10":"text-white/70 hover:text-purple-300 hover:bg-white/5"),onClick:()=>a(!1),children:e.name},e.name)),U.jsxs("div",{className:"pt-4 space-y-3",children:[U.jsx(st,{to:"/login",className:"block px-4 py-3 text-white/70 hover:text-purple-300 font-medium hover:bg-white/5 rounded-lg transition-colors duration-200",onClick:()=>a(!1),children:"Sign In"}),U.jsx(st,{to:"/register",className:"block mx-2 bg-gradient-to-r from-purple-500 to-blue-500 text-white px-6 py-3 rounded-lg hover:from-purple-600 hover:to-blue-600 transition-all duration-200 font-medium text-center",onClick:()=>a(!1),children:"Get Started"})]})]})})]})})};function Eo(){const{user:t}=Br(),s=Ie(),{isDark:r,toggleTheme:a}=mt(),[n,i]=e.useState(null),[o,l]=e.useState(!1),[c,d]=e.useState(!1);e.useEffect(()=>{!t&&r&&a("light")},[t,r,a]),e.useEffect(()=>{if(null==t?void 0:t.id){const e=(new Date).toISOString().split("T")[0],s=`streak_check_${t.id}`;if(localStorage.getItem(s)===e)return console.log("Streak already checked today (from localStorage), skipping"),void d(!0);if(!c){const r=async()=>{try{const r=await(async e=>{try{const t=u(dt,"studyprogress",e),s=await m(t),r=new Date,a=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate())).toISOString().split("T")[0];let n=0,i=0,o=null,l=!1;if(s.exists()){const e=s.data();if(n=e.currentStreak||0,i=e.longestStreak||0,o=e.lastLoginDate||null,o){let e=o;if(o instanceof Date?e=o.toISOString().split("T")[0]:"string"==typeof o&&(e=o.split("T")[0]),e===a)return console.log("Streak already checked today, skipping update"),{currentStreak:n,longestStreak:i,lastLoginDate:e,isNewStreak:!1,shouldShowModal:!1};const t=new Date(e+"T00:00:00Z"),s=new Date(a+"T00:00:00Z"),r=Math.floor((s-t)/864e5);if(1===r)n+=1,l=!0,console.log(`Streak increased: ${n} days`);else{if(!(r>1))return console.warn(`Unexpected daysDiff: ${r}, keeping current streak`),{currentStreak:n,longestStreak:i,lastLoginDate:e,isNewStreak:!1,shouldShowModal:!1};n=1,l=!0,console.log(`Streak reset: ${r} days gap`)}}else n=1,l=!0,console.log("First login, starting streak");n>i&&(i=n)}else n=1,i=1,l=!0,console.log("New user, starting streak");return await h(t,{currentStreak:n,longestStreak:i,lastLoginDate:a,updatedAt:(new Date).toISOString()},{merge:!0}),console.log(`Streak updated: ${n} days, lastLoginDate: ${a}`),{currentStreak:n,longestStreak:i,lastLoginDate:a,isNewStreak:l,shouldShowModal:l}}catch(t){return console.error("Error checking streak:",t),{currentStreak:0,longestStreak:0,lastLoginDate:null,isNewStreak:!1}}})(t.id);i(r);const a={...await ta(t.id),currentStreak:r.currentStreak,longestStreak:r.longestStreak};await Qr(t.id,a),!1!==r.shouldShowModal&&r.isNewStreak&&l(!0),localStorage.setItem(s,e),d(!0)}catch(r){console.error("Error checking streak:",r),localStorage.setItem(s,e),d(!0)}},a=setTimeout(()=>{r()},1e3);return()=>clearTimeout(a)}}t||(d(!1),l(!1),i(null))},[null==t?void 0:t.id,c]);const x=new URLSearchParams(s.search),p=x.get("redirect_uri"),g=x.get("platform");return p&&"macos"===g?U.jsx(xi,{}):"/desktop-auth"===s.pathname?U.jsx(gi,{}):t?U.jsxs(U.Fragment,{children:[U.jsx(Co,{}),U.jsx(Yr,{isOpen:o,onClose:()=>l(!1),streakData:n})]}):U.jsxs("div",{className:"min-h-screen bg-gray-50",children:[U.jsx(Co,{}),U.jsxs(Ve,{children:[U.jsx(He,{path:"/",element:U.jsx(oa,{})}),U.jsx(He,{path:"/home",element:U.jsx(aa,{})}),U.jsx(He,{path:"/login",element:U.jsx(ca,{})}),U.jsx(He,{path:"/register",element:U.jsx(Ia,{})}),U.jsx(He,{path:"/test",element:U.jsx(Vn,{})}),U.jsx(He,{path:"/debug",element:U.jsx(Yn,{})}),U.jsx(He,{path:"/minimal-test",element:U.jsx(Qn,{})}),U.jsx(He,{path:"/notification-test",element:U.jsx(Jn,{})}),U.jsx(He,{path:"/focus-test",element:U.jsx(Kn,{})}),U.jsx(He,{path:"/agora-test",element:U.jsx(Xn,{})}),U.jsx(He,{path:"/meeting",element:U.jsx(Zn,{})}),U.jsx(He,{path:"/tutoring",element:U.jsx(vi,{children:U.jsx(yn,{})})}),U.jsx(He,{path:"/friends",element:U.jsx(vi,{children:U.jsx(Pn,{})})}),U.jsx(He,{path:"/chat",element:U.jsx(vi,{children:U.jsx(Rn,{})})}),U.jsx(He,{path:"/focus-mode",element:U.jsx(vi,{children:U.jsx(Mn,{})})}),U.jsx(He,{path:"/profile",element:U.jsx(vi,{children:U.jsx(_n,{})})}),U.jsx(He,{path:"/tutor-dashboard",element:U.jsx(vi,{children:U.jsx(Gn,{})})}),U.jsx(He,{path:"/student-dashboard",element:U.jsx(vi,{children:U.jsx(ri,{})})}),U.jsx(He,{path:"/become-tutor",element:U.jsx(vi,{children:U.jsx(pi,{})})}),U.jsx(He,{path:"/desktop-auth",element:U.jsx(gi,{})}),U.jsx(He,{path:"/admin/tutor-accounts",element:U.jsx(vi,{children:U.jsx(ni,{})})}),U.jsx(He,{path:"/macos-login",element:U.jsx(mi,{})})]})]})}function Ao(){return e.useEffect(()=>{let e=null;const t=()=>{const e=document.documentElement,t=e.scrollHeight,s=e.clientHeight,r=window.pageYOffset||e.scrollTop||0,a=Math.max(s-48,40);if(document.body.style.setProperty("--virtual-scrollbar-top","24px"),document.body.style.setProperty("--virtual-track-height",`${a}px`),t<=s)return document.body.classList.remove("show-scrollbar"),document.body.style.setProperty("--virtual-thumb-height","0px"),document.body.style.setProperty("--virtual-thumb-offset","0px"),!1;const n=t-s,i=Math.max(s/t*a,40),o=n>0?r/n*(a-i):0;return document.body.style.setProperty("--virtual-thumb-height",`${i}px`),document.body.style.setProperty("--virtual-thumb-offset",`${o}px`),!0},s=()=>{t()&&(document.body.classList.add("show-scrollbar"),e&&clearTimeout(e),e=setTimeout(()=>{document.body.classList.remove("show-scrollbar")},1e3))},r={passive:!0};return window.addEventListener("wheel",s,r),window.addEventListener("scroll",s,r),window.addEventListener("touchmove",s,r),window.addEventListener("resize",t,r),t(),()=>{window.removeEventListener("wheel",s,r),window.removeEventListener("scroll",s,r),window.removeEventListener("touchmove",s,r),window.removeEventListener("resize",t,r),e&&clearTimeout(e),document.body.classList.remove("show-scrollbar")}},[]),U.jsx(xt,{children:U.jsx(Gr,{children:U.jsx(_r,{children:U.jsx(Ze,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:U.jsx(Eo,{})})})})})}$.createRoot(document.getElementById("root")).render(U.jsx(r.StrictMode,{children:U.jsx(Ao,{})}));
